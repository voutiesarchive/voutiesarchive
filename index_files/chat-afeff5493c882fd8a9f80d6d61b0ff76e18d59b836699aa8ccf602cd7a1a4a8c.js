define("discourse/plugins/chat/discourse/adapters/chat-message",["exports","discourse/adapters/rest"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{pathFor(e,t,s){if(s.targetMessageId)return`/chat/lookup/${s.targetMessageId}.json?chat_channel_id=${s.channelId}`
let a=`/chat/${s.channelId}/messages.json?page_size=${s.pageSize}`
return s.messageId&&(a+=`&message_id=${s.messageId}`),s.direction&&(a+=`&direction=${s.direction}`),a}apiNameFor(){return"chat-message"}}e.default=s})),define("discourse/plugins/chat/discourse/admin-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"admin.adminPlugins.show",path:"/plugins",map(){this.route("discourse-chat-incoming-webhooks",{path:"hooks"},(function(){this.route("new"),this.route("show",{path:"/:id"})}))}}})),define("discourse/plugins/chat/discourse/chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(){this.route("chat",(function(){this.route("channel",{path:"/c/:channelTitle/:channelId"},(function(){this.route("near-message",{path:"/:messageId"}),this.route("near-message-with-thread",{path:"/:messageId/t/:threadId"}),this.route("threads",{path:"/t"}),this.route("thread",{path:"/t/:threadId"},(function(){this.route("near-message",{path:"/:messageId"})}))})),this.route("direct-messages"),this.route("channels"),this.route("threads"),this.route("new-message"),this.route("channel.info",{path:"/c/:channelTitle/:channelId/info"},(function(){this.route("members"),this.route("settings")})),this.route("browse",(function(){this.route("all"),this.route("closed"),this.route("open"),this.route("archived")})),this.route("message",{path:"/message/:messageId"})}))}})),define("discourse/plugins/chat/discourse/components/browse-channels",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/routing","@ember/runloop","@ember/service","truth-helpers","discourse/components/d-button","discourse-common/config/environment","discourse-common/helpers/i18n","discourse-common/lib/debounce","discourse/plugins/chat/discourse/components/chat/list","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/components/chat-channel-card","discourse/plugins/chat/discourse/components/dc-filter-input","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const y="archived",M=["all","open","closed",y]
class C extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[c.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"modal",[c.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[c.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#r=(()=>dt7948.g(this.prototype,"filter",[s.tracked],(function(){return""})))()
#o=(()=>{dt7948.i(this,"filter")})()
get currentTab(){return this.args.currentTab??"all"}get channelsCollection(){return this.chatApi.channels({filter:this.filter,status:this.currentTab})}static#c=(()=>dt7948.n(this.prototype,"channelsCollection",[s.cached]))()
get tabs(){return this.siteSettings.chat_allow_archiving_channels?M:[...M].removeObject(y)}showChatNewMessageModal(){this.modal.show(g.default)}static#l=(()=>dt7948.n(this.prototype,"showChatNewMessageModal",[n.action]))()
setFilter(e){this.filter=e.target.value,(0,p.default)(this.debouncedLoad,h.INPUT_DELAY)}static#d=(()=>dt7948.n(this.prototype,"setFilter",[n.action]))()
debouncedLoad(){this.channelsCollection.load({limit:10})}static#h=(()=>dt7948.n(this.prototype,"debouncedLoad",[n.action]))()
focusFilterInput(e){(0,o.schedule)("afterRender",(()=>e?.focus()))}static#u=(()=>dt7948.n(this.prototype,"focusFilterInput",[n.action]))()
static#p=(()=>(0,b.setComponentTemplate)((0,v.createTemplateFactory)({id:"g+Koktg6",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-browse-view"],[12],[1,"\\n      "],[10,0],[14,0,"chat-browse-view__actions"],[12],[1,"\\n        "],[10,"nav"],[12],[1,"\\n          "],[10,"ul"],[14,0,"nav-pills chat-browse-view__filters"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["tabs"]]],null]],null],null,[[[1,"              "],[10,"li"],[15,0,[28,[32,0],["chat-browse-view__filter -",[30,1]],null]],[12],[1,"\\n                "],[8,[32,1],[[16,0,[28,[32,0],["chat-browse-view__filter-link -",[30,1]],null]]],[["@route","@current-when"],[[28,[32,0],["chat.browse.",[30,1]],null],[28,[32,2],[[30,1],[30,0,["currentTab"]]],null]]],[["default"],[[[[1,"\\n                  "],[1,[28,[32,3],[[28,[32,0],["chat.browse.filter_",[30,1]],null]],null]],[1,"\\n                "]],[]]]]],[1,"\\n              "],[13],[1,"\\n"]],[1]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,4],[[16,"placeholder",[28,[32,3],["chat.browse.filter_input_placeholder"],null]],[4,[32,6],[[30,0,["focusFilterInput"]]],null]],[["@filterAction","@icons","@containerClass"],[[30,0,["setFilter"]],[28,[32,5],null,[["right"],["magnifying-glass"]]],"filter-input"]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-browse-view__content_wrapper"],[12],[1,"\\n        "],[10,0],[14,0,"chat-browse-view__content"],[12],[1,"\\n          "],[8,[32,7],[[24,0,"chat-browse-view__cards"]],[["@collection"],[[30,0,["channelsCollection"]]]],[["default"],[[[[1,"\\n            "],[8,[30,2,["Item"]],null,null,[["default"],[[[[1,"\\n              "],[8,[32,8],null,[["@channel"],[[30,3]]],null],[1,"\\n            "]],[3]]]]],[1,"\\n\\n            "],[8,[30,2,["EmptyState"]],null,null,[["default"],[[[[1,"\\n              "],[10,1],[14,0,"empty-state-title"],[12],[1,"\\n                "],[1,[28,[32,3],["chat.empty_state.title"],null]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n                "],[10,2],[12],[1,[28,[32,3],["chat.empty_state.direct_message"],null]],[13],[1,"\\n                "],[8,[32,9],null,[["@action","@label"],[[30,0,["showChatNewMessageModal"]],"chat.empty_state.direct_message_cta"]],null],[1,"\\n              "],[13],[1,"\\n            "]],[]]]]],[1,"\\n          "]],[2]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["tab","list","channel"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/browse-channels.js",scope:()=>[a.concat,r.LinkTo,l.eq,u.default,_.default,a.hash,i.default,m.default,f.default,d.default],isStrictMode:!0}),this))()}e.default=C})),define("discourse/plugins/chat/discourse/components/channel-icon/index",["exports","@glimmer/component","@ember/template","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get firstUser(){return this.args.channel.chatable.users[0]}get groupDirectMessage(){return this.args.channel.isDirectMessageChannel&&this.args.channel.chatable.group}get channelColorStyle(){return(0,s.htmlSafe)(`color: #${this.args.channel.chatable.color}`)}get isThreadsList(){return this.args.thread??!1}static#e=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"wnr5ipV+",block:'[[[1,"\\n"],[41,[30,1,["isDirectMessageChannel"]],[[[1,"      "],[10,0],[14,0,"chat-channel-icon"],[12],[1,"\\n"],[41,[30,0,["groupDirectMessage"]],[[[1,"          "],[10,1],[14,0,"chat-channel-icon --users-count"],[12],[1,"\\n            "],[1,[30,1,["membershipsCount"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,0],[14,0,"chat-channel-icon --avatar"],[12],[1,"\\n            "],[8,[32,0],null,[["@user","@interactive"],[[30,0,["firstUser"]],false]],null],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],[[[41,[30,1,["isCategoryChannel"]],[[[1,"      "],[10,0],[14,0,"chat-channel-icon"],[12],[1,"\\n        "],[10,1],[14,0,"chat-channel-icon --category-badge"],[15,5,[30,0,["channelColorStyle"]]],[12],[1,"\\n          "],[1,[28,[32,1],["d-chat"],null]],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"            "],[1,[28,[32,1],["lock"],[["class"],["chat-channel-icon__restricted-category-icon"]]]],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,0,["isThreadsList"]],[[[1,"      "],[10,0],[14,0,"chat-channel-icon"],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-icon --avatar"],[12],[1,"\\n          "],[8,[32,0],null,[["@user","@interactive","@showPresence"],[[30,2,["preview","lastReplyUser"]],true,false]],null],[1,"\\n          "],[10,0],[14,0,"avatar-flair --threads"],[12],[1,"\\n            "],[1,[28,[32,1],["discourse-threads"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]],null]],[]]]],[]]],[1,"  "]],["@channel","@thread"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channel-icon/index.js",scope:()=>[n.default,a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/channel-name/index",["exports","@glimmer/component","@ember/helper","@ember/service","@ember/template","discourse/components/plugin-outlet","discourse/components/user-status-message","discourse/helpers/replace-emoji","discourse/plugins/chat/discourse/components/chat-channel-unread-indicator","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[a.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get unreadIndicator(){return this.args.unreadIndicator??!1}get users(){return this.args.channel.chatable.users}get prefersName(){return this.siteSettings.enable_names&&this.siteSettings.display_name_on_posts&&!this.siteSettings.prioritize_username_in_ux}get directMessageTitle(){return 0===this.users.length?this.prefersName&&this.currentUser.name||this.currentUser.username:this.prefersName?this.users.map((e=>e.name||e.username)).join(", "):this.users.mapBy("username").join(", ")}get channelColorStyle(){return(0,n.htmlSafe)(`color: #${this.args.channel.chatable.color}`)}get showUserStatus(){return!!this.args.channel.isDirectMessageChannel&&!(1!==this.users.length||!this.users[0].status)}get channelTitle(){return this.args.channel.isDirectMessageChannel?this.args.channel.title??this.directMessageTitle:this.args.channel.title}get showPluginOutlet(){return this.args.channel.isDirectMessageChannel&&!this.args.channel.chatable.group}static#n=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"xDEEWMYa",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-channel-name"],[12],[1,"\\n      "],[10,0],[14,0,"chat-channel-name__label"],[12],[1,"\\n        "],[1,[28,[32,0],[[30,0,["channelTitle"]]],null]],[1,"\\n\\n"],[41,[30,0,["showUserStatus"]],[[[1,"          "],[8,[32,1],[[24,0,"chat-channel__user-status-message"]],[["@status","@showDescription"],[[28,[32,2],[[30,0,["users"]],"0.status"],null],[52,[30,0,["site","mobileView"]],"true"]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["showPluginOutlet"]],[[[1,"          "],[8,[32,3],null,[["@name","@outletArgs","@tagName","@connectorTagName"],["after-chat-channel-username",[28,[32,4],null,[["user"],[[30,1]]]],"",""]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,3]],[[[1,"          "],[18,3,null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[30,0,["unreadIndicator"]],[[[1,"        "],[8,[32,5],null,[["@channel"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@user","@channel","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channel-name/index.js",scope:()=>[o.default,r.default,s.get,i.default,s.hash,c.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/channel-title/index",["exports","discourse/helpers/concat-class","discourse/plugins/chat/discourse/components/channel-icon","discourse/plugins/chat/discourse/components/channel-name","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"iYBpNouA",block:'[[[1,"\\n  "],[10,0],[15,0,[28,[32,0],["chat-channel-title",[52,[30,1,["isDirectMessageChannel"]],"is-dm","is-category"]],null]],[12],[1,"\\n    "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n    "],[8,[32,2],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n"],[41,[30,2],[[[1,"      "],[10,0],[15,0,[29,["unread-indicator ",[52,[30,3],"-urgent"]]]],[12],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,4]],[[[1,"      "],[18,4,null],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],["@channel","@isUnread","@isUrgent","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channel-title/index.js",scope:()=>[t.default,s.default,a.default],isStrictMode:!0}),(0,r.default)(void 0,"channel-title:ChatChannelTitle"))
e.default=o})),define("discourse/plugins/chat/discourse/components/channels-list-direct",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","truth-helpers","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/components/empty-channels-list","discourse/plugins/chat/discourse/components/chat-channel-row","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[i.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[i.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatStateManager",[i.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"site",[i.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#l=(()=>dt7948.g(this.prototype,"siteSettings",[i.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#d=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
get inSidebar(){return this.args.inSidebar??!1}get createDirectMessageChannelLabel(){return this.canCreateDirectMessageChannel?"chat.direct_messages.new":"chat.direct_messages.cannot_create"}get showDirectMessageChannels(){return this.canCreateDirectMessageChannel||!this.directMessageChannelsEmpty}get canCreateDirectMessageChannel(){return this.chat.userCanDirectMessage}get directMessageChannelsEmpty(){return 0===this.chatChannelsManager.directMessageChannels?.length}toggleChannelSection(e){this.args.toggleSection(e)}static#h=(()=>dt7948.n(this.prototype,"toggleChannelSection",[n.action]))()
openNewMessageModal(){this.modal.show(u.default)}static#u=(()=>dt7948.n(this.prototype,"openNewMessageModal",[n.action]))()
static#p=(()=>(0,g.setComponentTemplate)((0,f.createTemplateFactory)({id:"aneQqOAW",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["showDirectMessageChannels"]],[28,[32,1],[[30,0,["site","desktopView"]],[28,[32,2],[[30,0,["chatChannelsManager","displayPublicChannels"]]],null]],null]],null],[[[1,"      "],[10,0],[14,0,"chat-channel-divider direct-message-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"          "],[11,1],[24,0,"title-caret"],[24,1,"direct-message-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","direct-message-channels"],[4,[32,3],["click",[28,[32,4],[[30,0,["toggleChannelSection"]],"direct-message-channels"],null]],null],[12],[1,"\\n            "],[1,[28,[32,5],["angle-up"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[10,1],[14,0,"channel-title"],[12],[1,[28,[32,6],["chat.direct_messages.title"],null]],[13],[1,"\\n\\n"],[41,[30,0,["canCreateDirectMessageChannel"]],[[[1,"          "],[8,[32,7],[[24,0,"no-text btn-flat open-new-message-btn"],[16,"title",[28,[32,6],[[30,0,["createDirectMessageChannelLabel"]]],null]]],[["@icon","@action"],["plus",[30,0,["openNewMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,1,"direct-message-channels"],[15,0,[28,[32,8],["channels-list-container","direct-message-channels",[52,[30,0,["inSidebar"]],"collapsible-sidebar-section"],[52,[30,0,["directMessageChannelsEmpty"]],"center-empty-channels-list"]],null]],[12],[1,"\\n"],[41,[30,0,["directMessageChannelsEmpty"]],[[[1,"        "],[8,[32,9],null,[["@title","@ctaTitle","@ctaAction","@showCTA"],[[28,[32,6],["chat.no_direct_message_channels"],null],[28,[32,6],["chat.no_direct_message_channels_cta"],null],[30,0,["openNewMessageModal"]],[30,0,["canCreateDirectMessageChannel"]]]],null],[1,"\\n"]],[]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["chatChannelsManager","truncatedDirectMessageChannels"]]],null]],null],null,[[[1,"          "],[8,[32,10],null,[["@channel","@options"],[[30,1],[28,[32,11],null,[["leaveButton"],[true]]]]],null],[1,"\\n"]],[1]],null]],[]]],[1,"    "],[13],[1,"\\n\\n    "],[8,[32,12],null,[["@name","@tagName","@outletArgs"],["below-direct-chat-channels","",[28,[32,11],null,[["inSidebar"],[[30,0,["inSidebar"]]]]]]],null],[1,"\\n  "]],["channel"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channels-list-direct.js",scope:()=>[r.and,r.or,r.not,a.on,s.fn,d.default,h.default,o.default,l.default,p.default,m.default,s.hash,c.default],isStrictMode:!0}),this))()}e.default=_})),define("discourse/plugins/chat/discourse/components/channels-list-public",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","truth-helpers","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/empty-channels-list","discourse/plugins/chat/discourse/components/chat-channel-row","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[r.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[r.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[r.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#c=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#l=(()=>dt7948.g(this.prototype,"currentUser",[r.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#d=(()=>dt7948.g(this.prototype,"router",[r.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get inSidebar(){return this.args.inSidebar??!1}get hasUnreadThreads(){return this.chatTrackingStateManager.hasUnreadThreads}get hasThreadedChannels(){return this.chatChannelsManager.hasThreadedChannels}get channelList(){return!0===this.args.sortByActivity?this.chatChannelsManager.publicMessageChannelsByActivity:this.chatChannelsManager.publicMessageChannels}toggleChannelSection(e){this.args.toggleSection(e)}static#h=(()=>dt7948.n(this.prototype,"toggleChannelSection",[n.action]))()
openBrowseChannels(){this.router.transitionTo("chat.browse")}static#u=(()=>dt7948.n(this.prototype,"openBrowseChannels",[n.action]))()
static#p=(()=>(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"Q+YU9SoD",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","desktopView"]],[30,0,["inSidebar"]],[30,0,["hasThreadedChannels"]]],null],[[[1,"      "],[8,[32,1],[[24,0,"chat-channel-row --threads"]],[["@route"],["chat.threads"]],[["default"],[[[[1,"\\n        "],[10,1],[14,0,"chat-channel-title"],[12],[1,"\\n          "],[1,[28,[32,2],["discourse-threads"],[["class"],["chat-user-threads__icon"]]]],[1,"\\n          "],[1,[28,[32,3],["chat.my_threads.title"],null]],[1,"\\n        "],[13],[1,"\\n"],[41,[30,0,["hasUnreadThreads"]],[[[1,"          "],[10,0],[14,0,"c-unread-indicator"],[12],[1,"\\n            "],[10,0],[14,0,"c-unread-indicator__number"],[12],[1,"Â "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,0],[[30,0,["chatChannelsManager","displayPublicChannels"]],[30,0,["site","desktopView"]]],null],[[[1,"      "],[10,0],[14,0,"chat-channel-divider public-channels-section"],[12],[1,"\\n"],[41,[30,0,["inSidebar"]],[[[1,"          "],[11,1],[24,0,"title-caret"],[24,1,"public-channels-caret"],[24,"role","button"],[24,"title","toggle nav list"],[24,"data-toggleable","public-channels"],[4,[32,4],["click",[28,[32,5],[[30,0,["toggleChannelSection"]],"public-channels"],null]],null],[12],[1,"\\n            "],[1,[28,[32,2],["angle-up"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[10,1],[14,0,"channel-title"],[12],[1,[28,[32,3],["chat.chat_channels"],null]],[13],[1,"\\n\\n        "],[8,[32,1],[[24,0,"btn no-text btn-flat open-browse-page-btn title-action"],[16,"title",[28,[32,3],["chat.channels_list_popup.browse"],null]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n          "],[1,[28,[32,2],["pencil"],null]],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,1,"public-channels"],[15,0,[28,[32,6],["channels-list-container","public-channels",[52,[30,0,["inSidebar"]],"collapsible-sidebar-section"]],null]],[12],[1,"\\n"],[41,[30,0,["chatChannelsManager","publicMessageChannelsEmpty"]],[[[1,"        "],[8,[32,7],null,[["@title","@ctaTitle","@ctaAction","@showCTA"],[[28,[32,3],["chat.no_public_channels"],null],[28,[32,3],["chat.no_public_channels_cta"],null],[30,0,["openBrowseChannels"]],[30,0,["chatChannelsManager","displayPublicChannels"]]]],null],[1,"\\n"]],[]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["channelList"]]],null]],null],null,[[[1,"          "],[8,[32,8],null,[["@channel","@options"],[[30,1],[28,[32,9],null,[["settingsButton"],[true]]]]],null],[1,"\\n"]],[1]],null]],[]]],[1,"    "],[13],[1,"\\n\\n    "],[8,[32,10],null,[["@name","@tagName","@outletArgs"],["below-public-chat-channels","",[28,[32,9],null,[["inSidebar"],[[30,0,["inSidebar"]]]]]]],null],[1,"\\n  "]],["channel"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channels-list-public.js",scope:()=>[o.and,i.LinkTo,d.default,h.default,a.on,s.fn,l.default,u.default,p.default,s.hash,c.default],isStrictMode:!0}),this))()}e.default=f})),define("discourse/plugins/chat/discourse/components/channels-list",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-direct","discourse/plugins/chat/discourse/components/channels-list-public","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"zeAt9L8I",block:'[[[1,"\\n    "],[10,0],[14,"role","region"],[15,"aria-label",[28,[32,0],["chat.aria_roles.channels_list"],null]],[14,0,"channels-list"],[12],[1,"\\n      "],[8,[32,1],null,null,null],[1,"\\n\\n"],[41,[30,0,["chat","userCanAccessDirectMessages"]],[[[1,"        "],[8,[32,2],null,null,null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/channels-list.js",scope:()=>[a.default,i.default,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat-channel-archive-status",["exports","@glimmer/component","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse-common/lib/get-url","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get shouldRender(){return this.currentUser.admin&&(0,i.isPresent)(this.args.channel.archive)}get channelArchiveFailedMessage(){const e=this.args.channel.archive,t=e.topicId?"chat.channel_status.archive_failed":"chat.channel_status.archive_failed_no_topic"
return(0,n.htmlSafe)(d.default.t(t,{completed:e.messages,total:e.totalMessages,topic_url:this.topicUrl}))}get channelArchiveCompletedMessage(){return(0,n.htmlSafe)(d.default.t("chat.channel_status.archive_completed",{topic_url:this.topicUrl}))}retryArchive(){return this.chatApi.createChannelArchive(this.args.channel.id).catch(c.popupAjaxError)}static#n=(()=>dt7948.n(this.prototype,"retryArchive",[s.action]))()
get topicUrl(){return this.args.channel.archive.topicId?(0,l.default)(`/t/-/${this.args.channel.archive.topicId}`):""}static#r=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"WUzspRR4",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[41,[30,1,["archive","failed"]],[[[1,"        "],[10,0],[15,0,[28,[32,0],["alert alert-warn chat-channel-retry-archive",[30,1,["status"]]],null]],[12],[1,"\\n          "],[10,0],[14,0,"chat-channel-archive-failed-message"],[12],[1,"\\n            "],[1,[30,0,["channelArchiveFailedMessage"]]],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"chat-channel-archive-failed-retry"],[12],[1,"\\n            "],[8,[32,1],null,[["@action","@label"],[[30,0,["retryArchive"]],"chat.channel_archive.retry"]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,1,["archive","completed"]],[[[1,"        "],[10,0],[15,0,[28,[32,0],["chat-channel-archive-status",[30,1,["status"]]],null]],[12],[1,"\\n          "],[1,[30,0,["channelArchiveCompletedMessage"]]],[1,"\\n        "],[13],[1,"\\n      "]],[]],null]],[]]]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-archive-status.js",scope:()=>[o.default,r.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/chat-channel-card",["exports","@glimmer/component","@ember/helper","@ember/routing","@ember/service","truth-helpers","discourse/helpers/border-color","discourse/helpers/concat-class","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"ag8Xtuq6",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[15,0,[28,[32,0],["chat-channel-card",[52,[30,1,["isClosed"]],"--closed"],[52,[30,1,["isArchived"]],"--archived"]],null]],[15,5,[28,[32,1],[[30,1,["chatable","color"]]],null]],[15,"data-channel-id",[30,1,["id"]]],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-card__header"],[12],[1,"\\n          "],[8,[32,2],[[24,0,"chat-channel-card__name-container"]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[10,1],[14,0,"chat-channel-card__name"],[12],[1,"\\n              "],[1,[28,[32,3],[[30,1,["title"]]],null]],[1,"\\n            "],[13],[1,"\\n"],[41,[30,1,["chatable","read_restricted"]],[[[1,"              "],[1,[28,[32,4],["lock"],[["class"],["chat-channel-card__read-restricted"]]]],[1,"\\n"]],[]],null],[41,[30,1,["currentUserMembership","muted"]],[[[1,"              "],[10,1],[14,0,"chat-channel-card__muted"],[15,"aria-label",[28,[32,5],["chat.muted"],null]],[15,"title",[28,[32,5],["chat.muted"],null]],[12],[1,[28,[32,4],["d-muted"],null]],[13],[1,"\\n"]],[]],null],[1,"          "]],[]]]]],[1,"\\n\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-channel-card__cta"],[12],[1,"\\n"],[41,[30,1,["isFollowing"]],[[[1,"\\n            "],[8,[32,6],null,[["@channel","@options"],[[30,1],[28,[32,7],null,[["leaveClass","labelType"],["btn-transparent btn-danger chat-channel-card__leave-btn","short"]]]]],null],[1,"\\n\\n"]],[]],[[[41,[30,1,["isJoinable"]],[[[1,"            "],[8,[32,6],null,[["@channel","@options"],[[30,1],[28,[32,7],null,[["joinClass","labelType"],["btn-primary btn-small chat-channel-card__join-btn","short"]]]]],null],[1,"\\n          "]],[]],null]],[]]],[1,"        "],[13],[1,"\\n\\n"],[41,[28,[32,8],[[30,1,["membershipsCount"]],0],null],[[[1,"          "],[8,[32,2],[[24,0,"chat-channel-card__members"],[24,"tabindex","-1"]],[["@route","@models"],["chat.channel.info.members",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[1,[28,[32,5],["chat.channel.memberships_count"],[["count"],[[30,1,["membershipsCount"]]]]]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,1,["description"]],[[[1,"          "],[10,0],[14,0,"chat-channel-card__description"],[12],[1,"\\n            "],[1,[28,[32,3],[[30,1,["description"]]],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-card.js",scope:()=>[o.default,r.default,a.LinkTo,c.default,l.default,d.default,h.default,s.hash,i.gt],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-header",["exports","@ember/component","select-kit/components/combo-box/combo-box-header","@ember/template-factory"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,a.createTemplateFactory)({id:"Lr5V79a1",block:'[[[10,0],[14,0,"select-kit-header-wrapper"],[12],[1,"\\n"],[41,[30,0,["selectedContent"]],[[[1,"    "],[8,[39,1],null,[["@channel"],[[30,0,["selectedContent"]]]],null],[1,"\\n"]],[]],[[[1,"    "],[1,[28,[35,2],["chat.incoming_webhooks.channel_placeholder"],null]],[1,"\\n"]],[]]],[1,"\\n  "],[1,[28,[35,3],[[30,0,["caretIcon"]]],[["class"],["caret-icon"]]]],[1,"\\n"],[13]],[],false,["if","channel-title","i18n","d-icon"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-header.hbs",isStrictMode:!1})
class i extends s.default{}e.default=i,(0,t.setComponentTemplate)(n,i)})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser-row",["exports","@ember/component","@ember-decorators/component","select-kit/components/select-kit/select-kit-row","@ember/template-factory"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,n.createTemplateFactory)({id:"0Vwx6mQC",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["item"]]]],null]],[],false,["channel-title"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-channel-chooser-row.hbs",isStrictMode:!1}),r=dt7948.c(class extends a.default{},[(0,s.classNames)("chat-channel-chooser-row")])
e.default=(0,t.setComponentTemplate)(i,r)})),define("discourse/plugins/chat/discourse/components/chat-channel-chooser",["exports","@ember-decorators/component","select-kit/components/combo-box","select-kit/components/select-kit"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=dt7948.c(class extends s.default{modifyComponentForRow(){return"chat-channel-chooser-row"}},[(0,a.pluginApiIdentifiers)("chat-channel-chooser"),(0,a.selectKitOptions)({headerComponent:"chat-channel-chooser-header"}),(0,t.classNames)("chat-channel-chooser")])
e.default=n})),define("discourse/plugins/chat/discourse/components/chat-channel-leave-btn",["exports","@glimmer/component","@ember/service","@ember/utils","discourse/components/d-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
get shouldRender(){return this.site.desktopView&&(0,a.isPresent)(this.args.channel)}get leaveChatTitleKey(){return this.args.channel.isDirectMessageChannel?"chat.direct_messages.leave":"chat.leave"}static#n=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"i/jTa6Vf",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-flat chat-channel-leave-btn"]],[["@icon","@action","@title"],["xmark",[30,1],[30,0,["leaveChatTitleKey"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],["@onLeaveChannel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-leave-btn.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker",["exports","@glimmer/component","@ember/object","@ember/service","@popperjs/core","ember-modifier","discourse/lib/offset-calculator","discourse/plugins/chat/discourse/components/chat-emoji-picker","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[a.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
context="chat-channel-message"
listenToBodyScroll=(()=>(0,i.modifier)((()=>{const e=()=>{this.chatEmojiPickerManager.close()}
return document.addEventListener("scroll",e),()=>{document.removeEventListener("scroll",e)}})))()
didSelectEmoji(e){this.chatEmojiPickerManager.picker?.didSelectEmoji(e),this.chatEmojiPickerManager.close()}static#n=(()=>dt7948.n(this.prototype,"didSelectEmoji",[s.action]))()
didInsert(e){this.site.mobileView||(this._popper=(0,n.createPopper)(this.chatEmojiPickerManager.picker?.trigger,e,{placement:"top",modifiers:[{name:"eventListeners",options:{scroll:!1,resize:!1}},{name:"flip",options:{padding:{top:(0,r.headerOffset)()}}}]})),e.classList.remove("hidden")}static#r=(()=>dt7948.n(this.prototype,"didInsert",[s.action]))()
willDestroy(){super.willDestroy(...arguments),this._popper?.destroy()}static#c=(()=>dt7948.n(this.prototype,"willDestroy",[s.action]))()
static#l=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"7uySDSKx",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"hidden"],[4,[30,0,["listenToBodyScroll"]],null,null]],[["@context","@didInsert","@willDestroy","@didSelectEmoji"],["chat-channel-message",[30,0,["didInsert"]],[30,0,["willDestroy"]],[30,0,["didSelectEmoji"]]]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-message-emoji-picker.js",scope:()=>[o.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat-channel-metadata",["exports","@glimmer/component","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get lastMessageFormattedDate(){return moment(this.args.channel.lastMessage.createdAt).calendar(null,{sameDay:"LT",lastDay:`[${s.default.t("chat.dates.yesterday")}]`,lastWeek:"dddd",sameElse:"l"})}static#e=(()=>(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"DaiHO6Vo",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-channel__metadata"],[12],[1,"\\n"],[41,[30,1,["lastMessage"]],[[[1,"        "],[10,0],[14,0,"chat-channel__metadata-date"],[12],[1,"\\n          "],[1,[30,0,["lastMessageFormattedDate"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-metadata.js",isStrictMode:!0}),this))()}e.default=i})),define("discourse/plugins/chat/discourse/components/chat-channel-preview-card",["exports","@glimmer/component","@ember/helper","@ember/routing","@ember/service","@ember/utils","discourse/helpers/concat-class","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
get showJoinButton(){return this.args.channel?.isOpen&&this.args.channel?.canJoin}get hasDescription(){return!(0,i.isEmpty)(this.args.channel?.description)}static#s=(()=>(0,d.setComponentTemplate)((0,h.createTemplateFactory)({id:"11noQeda",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-channel-preview-card",[52,[51,[30,0,["hasDescription"]]],"-no-description"],[52,[51,[30,0,["showJoinButton"]]],"-no-button"]],null]],[12],[1,"\\n      "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n"],[41,[30,0,["hasDescription"]],[[[1,"        "],[10,2],[14,0,"chat-channel-preview-card__description"],[12],[1,"\\n          "],[1,[30,1,["description"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[41,[30,0,["showJoinButton"]],[[[1,"        "],[8,[32,2],null,[["@channel","@options"],[[30,1],[28,[32,3],null,[["joinClass"],["btn-primary"]]]]],null],[1,"\\n"]],[]],null],[1,"      "],[8,[32,4],[[24,0,"chat-channel-preview-card__browse-all"]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,5],["chat.browse_all_channels"],null]],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["@channel"],false,["unless","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-preview-card.js",scope:()=>[r.default,c.default,l.default,s.hash,a.LinkTo,o.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat-channel-row",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/routing","@ember/service","@ember/template","ember-modifier","truth-helpers","discourse/helpers/concat-class","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/channel-icon","discourse/plugins/chat/discourse/components/channel-name","discourse/plugins/chat/discourse/components/chat-channel-metadata","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C,w){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class S extends t.default{static#e=(()=>dt7948.g(this.prototype,"api",[c.service]))()
#C=(()=>{dt7948.i(this,"api")})()
static#s=(()=>dt7948.g(this.prototype,"capabilities",[c.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[c.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[c.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"router",[c.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#l=(()=>dt7948.g(this.prototype,"site",[c.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#d=(()=>dt7948.g(this.prototype,"isAtThreshold",[s.tracked],(function(){return!1})))()
#S=(()=>{dt7948.i(this,"isAtThreshold")})()
static#h=(()=>dt7948.g(this.prototype,"shouldRemoveChannel",[s.tracked],(function(){return!1})))()
#k=(()=>{dt7948.i(this,"shouldRemoveChannel")})()
static#u=(()=>dt7948.g(this.prototype,"showRemoveButton",[s.tracked],(function(){return!1})))()
#T=(()=>{dt7948.i(this,"showRemoveButton")})()
static#p=(()=>dt7948.g(this.prototype,"swipableRow",[s.tracked],(function(){return null})))()
#x=(()=>{dt7948.i(this,"swipableRow")})()
static#j=(()=>dt7948.g(this.prototype,"shouldReset",[s.tracked],(function(){return!1})))()
#E=(()=>{dt7948.i(this,"shouldReset")})()
static#P=(()=>dt7948.g(this.prototype,"diff",[s.tracked],(function(){return 0})))()
#A=(()=>{dt7948.i(this,"diff")})()
static#O=(()=>dt7948.g(this.prototype,"rowStyle",[s.tracked],(function(){return null})))()
#U=(()=>{dt7948.i(this,"rowStyle")})()
static#D=(()=>dt7948.g(this.prototype,"canSwipe",[s.tracked],(function(){return!0})))()
#L=(()=>{dt7948.i(this,"canSwipe")})()
registerSwipableRow=(()=>(0,d.modifier)((e=>{this.swipableRow=e})))()
onReset=(()=>(0,d.modifier)((e=>{const t=()=>{this.rowStyle=(0,l.htmlSafe)("margin-right: 0px;"),this.showRemoveButton=!1,this.shouldReset=!1}
return e.addEventListener("transitionend",t,{once:!0}),()=>{e.removeEventListener("transitionend",t),this.rowStyle=(0,l.htmlSafe)("margin-right: 0px;"),this.showRemoveButton=!1,this.shouldReset=!1}})))()
onRemoveChannel=(()=>(0,d.modifier)((e=>{e.addEventListener("transitionend",(()=>{this.chat.unfollowChannel(this.args.channel).catch(m.popupAjaxError)}),{once:!0}),e.classList.add("-fade-out")})))()
handleSwipe=(()=>(0,d.modifier)((e=>(e.addEventListener("touchstart",this.onSwipeStart,{passive:!0}),e.addEventListener("touchmove",this.onSwipe,{passive:!0}),e.addEventListener("touchend",this.onSwipeEnd),()=>{e.removeEventListener("touchstart",this.onSwipeStart),e.removeEventListener("touchmove",this.onSwipe),e.removeEventListener("touchend",this.onSwipeEnd)}))))()
onSwipeStart(e){this._initialX=e.changedTouches[0].screenX}static#I=(()=>dt7948.n(this.prototype,"onSwipeStart",[f.bind]))()
onSwipe(e){this.showRemoveButton=!0,this.shouldReset=!1,this.isAtThreshold=!1
const t=window.innerWidth/3,s=e.changedTouches[0].screenX
this.diff=this._initialX-s,this.isAtThreshold=this.diff>=t,this.diff>25?(this.isAtThreshold&&(this.diff=t+.1*(this.diff-t)),this.rowStyle=(0,l.htmlSafe)(`margin-right: ${this.diff}px;`)):this.rowStyle=(0,l.htmlSafe)("margin-right: 0px;")}static#R=(()=>dt7948.n(this.prototype,"onSwipe",[f.bind]))()
onSwipeEnd(){this.isAtThreshold?(this.rowStyle=(0,l.htmlSafe)("margin-right: 0px;"),this.shouldRemoveChannel=!0):this.shouldReset=!0}static#N=(()=>dt7948.n(this.prototype,"onSwipeEnd",[f.bind]))()
get shouldHandleSwipe(){return this.capabilities.touch&&this.args.channel.isDirectMessageChannel}get leaveDirectMessageLabel(){return _.default.t("chat.direct_messages.close")}get leaveChannelLabel(){return _.default.t("chat.channel_settings.leave_channel")}get channelHasUnread(){return this.args.channel.tracking.unreadCount>0}get shouldRenderLastMessage(){return this.site.mobileView&&this.args.channel.isDirectMessageChannel&&this.args.channel.lastMessage}get#F(){return this.args.channel?.chatable?.users?.firstObject}startTrackingStatus(){this.#F?.statusManager.trackStatus()}static#B=(()=>dt7948.n(this.prototype,"startTrackingStatus",[n.action]))()
stopTrackingStatus(){this.#F?.statusManager.stopTrackingStatus()}static#H=(()=>dt7948.n(this.prototype,"stopTrackingStatus",[n.action]))()
static#z=(()=>(0,C.setComponentTemplate)((0,w.createTemplateFactory)({id:"Wmj/IPgq",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["chat-channel-row",[52,[30,1,["focused"]],"focused"],[52,[30,1,["currentUserMembership","muted"]],"muted"],[52,[30,2,["leaveButton"]],"can-leave"],[52,[28,[32,2],[[30,0,["chat","activeChannel","id"]],[30,1,["id"]]],null],"active"],[52,[30,0,["channelHasUnread"]],"has-unread"]],null]],[24,"tabindex","0"],[16,"data-chat-channel-id",[30,1,["id"]]],[4,[32,3],[[30,0,["startTrackingStatus"]]],null],[4,[32,4],[[30,0,["stopTrackingStatus"]]],null],[4,[52,[30,0,["shouldRemoveChannel"]],[50,[30,0,["onRemoveChannel"]],2,null,null]],null,null]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[11,0],[16,0,[28,[32,1],["chat-channel-row__content",[52,[30,1,["isCategoryChannel"]],"is-category","is-dm"],[52,[30,0,["shouldReset"]],"-animate-reset"]],null]],[16,5,[30,0,["rowStyle"]]],[4,[52,[30,0,["shouldHandleSwipe"]],[50,[30,0,["registerSwipableRow"]],2,null,null]],null,null],[4,[52,[30,0,["shouldHandleSwipe"]],[50,[30,0,["handleSwipe"]],2,null,null]],null,null],[4,[52,[30,0,["shouldReset"]],[50,[30,0,["onReset"]],2,null,null]],null,null],[12],[1,"\\n        "],[8,[32,5],null,[["@channel"],[[30,1]]],null],[1,"\\n        "],[10,0],[14,0,"chat-channel-row__info"],[12],[1,"\\n          "],[8,[32,6],null,[["@channel","@unreadIndicator"],[[30,1],true]],null],[1,"\\n          "],[8,[32,7],null,[["@channel"],[[30,1]]],null],[1,"\\n"],[41,[30,0,["shouldRenderLastMessage"]],[[[1,"            "],[10,0],[14,0,"chat-channel__last-message"],[12],[1,"\\n              "],[1,[28,[32,8],[[28,[32,9],[[30,1,["lastMessage","excerpt"]]],null]],null]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n\\n"],[41,[28,[32,10],[[30,2,["leaveButton"]],[30,1,["isFollowing"]],[30,0,["site","desktopView"]]],null],[[[1,"          "],[8,[32,11],null,[["@channel","@options"],[[30,1],[28,[32,12],null,[["leaveClass","labelType","leaveIcon","leaveTitle"],["btn-flat chat-channel-leave-btn","none","xmark",[52,[30,1,["isDirectMessageChannel"]],[30,0,["leaveDirectMessageLabel"]],[30,0,["leaveChannelLabel"]]]]]]]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[30,0,["showRemoveButton"]],[[[1,"        "],[10,0],[15,0,[28,[32,1],["chat-channel-row__action-btn",[52,[30,0,["isAtThreshold"]],"-at-threshold","-not-at-threshold"]],null]],[12],[1,"\\n          "],[1,[28,[32,13],["circle-xmark"],null]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "]],[]]]]],[1,"\\n  "]],["@channel","@options"],false,["if","modifier"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-row.js",scope:()=>[o.LinkTo,u.default,h.eq,i.default,r.default,b.default,v.default,y.default,p.default,l.htmlSafe,h.and,M.default,a.hash,g.default],isStrictMode:!0}),this))()}e.default=S})),define("discourse/plugins/chat/discourse/components/chat-channel-status",["exports","@glimmer/component","discourse-common/helpers/d-icon","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/components/chat-channel-archive-status","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{LONG_FORMAT="long"
SHORT_FORMAT="short"
VALID_FORMATS=[this.SHORT_FORMAT,this.LONG_FORMAT]
get format(){return this.VALID_FORMATS.includes(this.args.format)?this.args.format:this.LONG_FORMAT}get shouldRender(){return this.channelStatusIcon&&this.args.channel.status!==n.CHANNEL_STATUSES.open}get channelStatusMessage(){return this.format===this.LONG_FORMAT?this.#W(this.args.channel.status):this.#$(this.args.channel.status)}get channelStatusIcon(){return(0,n.channelStatusIcon)(this.args.channel.status)}#$(e){switch(e){case n.CHANNEL_STATUSES.archived:return a.default.t("chat.channel_status.archived")
case n.CHANNEL_STATUSES.closed:return a.default.t("chat.channel_status.closed")
case n.CHANNEL_STATUSES.open:return a.default.t("chat.channel_status.open")
case n.CHANNEL_STATUSES.readOnly:return a.default.t("chat.channel_status.read_only")}}#W(e){switch(e){case n.CHANNEL_STATUSES.archived:return a.default.t("chat.channel_status.archived_header")
case n.CHANNEL_STATUSES.closed:return a.default.t("chat.channel_status.closed_header")
case n.CHANNEL_STATUSES.open:return a.default.t("chat.channel_status.open_header")
case n.CHANNEL_STATUSES.readOnly:return a.default.t("chat.channel_status.read_only_header")}}static#e=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"8iHhouHV",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[10,0],[14,0,"chat-channel-status"],[12],[1,"\\n        "],[1,[28,[32,0],[[30,0,["channelStatusIcon"]]],null]],[1,"\\n        "],[10,1],[12],[1,[30,0,["channelStatusMessage"]]],[13],[1,"\\n        "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-status.js",scope:()=>[s.default,i.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat-channel-title",["exports","discourse/plugins/chat/discourse/components/channel-title","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"YBFUIYUG",block:'[[[1,"\\n  "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],["@channel"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-title.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"chat-channel-title:OldChatChannelTitle"))
e.default=i})),define("discourse/plugins/chat/discourse/components/chat-channel-unread-indicator",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","discourse/plugins/chat/discourse/lib/chat-user-preferences","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get showUnreadIndicator(){return this.args.channel.tracking.unreadCount>0||this.chat.activeChannel?.id!==this.args.channel.id&&this.args.channel.unreadThreadsCountSinceLastViewed>0}get unreadCount(){return this.#V()?this.args.channel.tracking.mentionCount:this.#q()?this.args.channel.tracking.watchedThreadsUnreadCount:this.args.channel.tracking.unreadCount}get isUrgent(){return this.#G()?this.#V():this.args.channel.isDirectMessageChannel||this.#V()||this.#q()}#V(){return this.args.channel.tracking.mentionCount>0}#q(){return this.args.channel.tracking.watchedThreadsUnreadCount>0}#G(){return(0,n.hasChatIndicator)(this.currentUser).ONLY_MENTIONS}static#r=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"D4Gi2eQ7",block:'[[[1,"\\n"],[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[15,0,[28,[32,0],["chat-channel-unread-indicator",[52,[30,0,["isUrgent"]],"-urgent"]],null]],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[41,[30,0,["isUrgent"]],[[[1,[30,0,["unreadCount"]]]],[]],[[[1,"Â "]],[]]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel-unread-indicator.js",scope:()=>[a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","truth-helpers","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/url","discourse/lib/user-presence","discourse-common/helpers/i18n","discourse-common/lib/debounce","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-channel-status","discourse/plugins/chat/discourse/helpers/first-visible-message-id","discourse/plugins/chat/discourse/lib/chat-channel-subscription-manager","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse/plugins/chat/discourse/lib/check-message-visibility","discourse/plugins/chat/discourse/lib/dates-separators-positioner","discourse/plugins/chat/discourse/lib/extract-current-topic-info","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/components/chat/composer/channel","discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow","discourse/plugins/chat/discourse/components/chat/selection-manager","discourse/plugins/chat/discourse/components/chat-channel-preview-card","discourse/plugins/chat/discourse/components/chat-mention-warnings","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/components/chat-messages-container","discourse/plugins/chat/discourse/components/chat-messages-scroller","discourse/plugins/chat/discourse/components/chat-notices","discourse/plugins/chat/discourse/components/chat-skeleton","discourse/plugins/chat/discourse/components/chat-upload-drop-zone","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C,w,S,k,T,x,j,E,P,A,O,U,D,L,I,R,N,F,B,H,z){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class W extends t.default{static#e=(()=>dt7948.g(this.prototype,"appEvents",[l.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#s=(()=>dt7948.g(this.prototype,"capabilities",[l.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[l.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#r=(()=>dt7948.g(this.prototype,"chatApi",[l.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#c=(()=>dt7948.g(this.prototype,"chatChannelsManager",[l.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#l=(()=>dt7948.g(this.prototype,"chatComposerPresenceManager",[l.service]))()
#J=(()=>{dt7948.i(this,"chatComposerPresenceManager")})()
static#d=(()=>dt7948.g(this.prototype,"chatDraftsManager",[l.service]))()
#Y=(()=>{dt7948.i(this,"chatDraftsManager")})()
static#h=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[l.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#u=(()=>dt7948.g(this.prototype,"chatStateManager",[l.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#p=(()=>dt7948.g(this.prototype,"chatChannelScrollPositions",[l.service]))()
#Z=(()=>{dt7948.i(this,"chatChannelScrollPositions")})()
static#j=(()=>dt7948.g(this.prototype,"composer",[(0,l.service)("chat-channel-composer")]))()
#X=(()=>{dt7948.i(this,"composer")})()
static#P=(()=>dt7948.g(this.prototype,"pane",[(0,l.service)("chat-channel-pane")]))()
#Q=(()=>{dt7948.i(this,"pane")})()
static#O=(()=>dt7948.g(this.prototype,"currentUser",[l.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#D=(()=>dt7948.g(this.prototype,"dialog",[l.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#I=(()=>dt7948.g(this.prototype,"messageBus",[l.service]))()
#te=(()=>{dt7948.i(this,"messageBus")})()
static#R=(()=>dt7948.g(this.prototype,"router",[l.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#N=(()=>dt7948.g(this.prototype,"site",[l.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#B=(()=>dt7948.g(this.prototype,"siteSettings",[l.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#H=(()=>dt7948.g(this.prototype,"sending",[s.tracked],(function(){return!1})))()
#se=(()=>{dt7948.i(this,"sending")})()
static#z=(()=>dt7948.g(this.prototype,"showChatQuoteSuccess",[s.tracked],(function(){return!1})))()
#ae=(()=>{dt7948.i(this,"showChatQuoteSuccess")})()
static#ne=(()=>dt7948.g(this.prototype,"includeHeader",[s.tracked],(function(){return!0})))()
#ie=(()=>{dt7948.i(this,"includeHeader")})()
static#re=(()=>dt7948.g(this.prototype,"needsArrow",[s.tracked],(function(){return!1})))()
#oe=(()=>{dt7948.i(this,"needsArrow")})()
static#ce=(()=>dt7948.g(this.prototype,"atBottom",[s.tracked],(function(){return!0})))()
#le=(()=>{dt7948.i(this,"atBottom")})()
static#de=(()=>dt7948.g(this.prototype,"uploadDropZone",[s.tracked]))()
#he=(()=>{dt7948.i(this,"uploadDropZone")})()
static#ue=(()=>dt7948.g(this.prototype,"isScrolling",[s.tracked],(function(){return!1})))()
#pe=(()=>{dt7948.i(this,"isScrolling")})()
scroller=null
_mentionWarningsSeen={}
_unreachableGroupMentions=[]
_overMembersLimitGroupMentions=[]
get messagesLoader(){return new w.default((0,n.getOwner)(this),this.args.channel)}static#me=(()=>dt7948.n(this.prototype,"messagesLoader",[s.cached]))()
get messagesManager(){return this.args.channel.messagesManager}get currentUserMembership(){return this.args.channel.currentUserMembership}get hasSavedScrollPosition(){return!!this.chatChannelScrollPositions.get(this.args.channel.id)}registerScroller(e){this.scroller=e}static#ge=(()=>dt7948.n(this.prototype,"registerScroller",[a.action]))()
teardown(){document.removeEventListener("keydown",this._autoFocus),this.#fe(),(0,m.removeOnPresenceChange)(this.onPresenceChangeCallback),this.subscriptionManager.teardown(),this.updateLastReadMessage()}static#_e=(()=>dt7948.n(this.prototype,"teardown",[a.action]))()
didResizePane(){this.debounceFillPaneAttempt(),this.debouncedUpdateLastReadMessage(),k.default.apply(this.scroller)}static#be=(()=>dt7948.n(this.prototype,"didResizePane",[a.action]))()
setup(e){this.uploadDropZone=e,document.addEventListener("keydown",this._autoFocus),(0,m.onPresenceChange)({callback:this.onPresenceChangeCallback}),this.messagesManager.clear(),this.args.channel.isDirectMessageChannel&&!this.args.channel.isFollowing&&this.chatChannelsManager.follow(this.args.channel),this.args.channel.draft=this.chatDraftsManager.get(this.args.channel?.id)||j.default.createDraftMessage(this.args.channel,{user:this.currentUser}),this.composer.focus(),this.loadMessages(),this.args.channel.updateLastViewedAt()}static#ve=(()=>dt7948.n(this.prototype,"setup",[a.action]))()
loadMessages(){this.args.channel?.id&&(this.subscriptionManager=new M.default(this,this.args.channel,{onNewMessage:this.onNewMessage}),this.args.targetMessageId?this.debounceHighlightOrFetchMessage(this.args.targetMessageId):this.chatChannelScrollPositions.get(this.args.channel.id)?this.debounceHighlightOrFetchMessage(this.chatChannelScrollPositions.get(this.args.channel.id)):this.fetchMessages({fetch_from_last_read:!0}))}static#ye=(()=>dt7948.n(this.prototype,"loadMessages",[a.action]))()
onNewMessage(e){if(!this.atBottom)return this.needsArrow=!0,void(this.messagesLoader.canLoadMoreFuture=!0);(0,E.stackingContextFix)(this.scroller,(()=>{this.messagesManager.addMessages([e])})),this.debouncedUpdateLastReadMessage()}static#Me=(()=>dt7948.n(this.prototype,"onNewMessage",[_.bind]))()
onPresenceChangeCallback(e){e&&this.debouncedUpdateLastReadMessage()}static#Ce=(()=>dt7948.n(this.prototype,"onPresenceChangeCallback",[_.bind]))()
async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear()
const t=await this.messagesLoader.load(e)
if(this.messagesManager.messages=this.processMessages(this.args.channel,t),e.target_message_id)this.scrollToMessageId(e.target_message_id,{highlight:!0,position:e.position})
else if(e.fetch_from_last_read){const e=this.currentUserMembership?.lastReadMessageId
this.scrollToMessageId(e)}else e.target_date?this.scrollToMessageId(t.meta.target_message_id,{highlight:!0,position:"center"}):(this._ignoreNextScroll=!0,this.scrollToBottom())
this.debounceFillPaneAttempt(),this.debouncedUpdateLastReadMessage()}async fetchMoreMessages(e){let{direction:t}=e,s=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
if(this.messagesLoader.loading)return
const a=await this.messagesLoader.loadMore({direction:t})
if(!a)return
const n=this.processMessages(this.args.channel,a)
if(!n.length)return
const i=this.messagesManager.messages.lastObject.id;(0,E.stackingContextFix)(this.scroller,(()=>{this.messagesManager.addMessages(n)})),t!==C.FUTURE||s.noScroll||this.scrollToMessageId(i,{position:"end",forceAuto:!0}),this.debounceFillPaneAttempt()}async scrollToBottom(){this._ignoreNextScroll=!0,await(0,x.scrollListToBottom)(this.scroller),this.debouncedUpdateLastReadMessage()}static#we=(()=>dt7948.n(this.prototype,"scrollToBottom",[a.action]))()
scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._ignoreNextScroll=!0
const s=this.messagesManager.findMessage(e);(0,x.scrollListToMessage)(this.scroller,s,t)}debounceFillPaneAttempt(){this._debouncedFillPaneAttemptHandler=(0,f.default)(this,this.fillPaneAttempt,500)}fetchMessagesByDate(e){if(this.messagesLoader.loading)return
const t=this.messagesManager.findFirstMessageOfDay(new Date(e))
t.firstOfResults&&this.messagesLoader.canLoadMorePast?this.fetchMessages({target_date:e,direction:C.FUTURE}):this.highlightOrFetchMessage(t.id,{position:"center"})}static#Se=(()=>dt7948.n(this.prototype,"fetchMessagesByDate",[_.bind]))()
async fillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this.messagesManager.messages.length>200||this.messagesLoader.canLoadMorePast&&(0,c.schedule)("afterRender",(()=>{const e=this.messagesManager.messages.firstObject?.id,t=this.scroller.querySelector(`.chat-message-container[data-id="${e}"]`)
t&&(0,S.checkMessageTopVisibility)(this.scroller,t)&&this.fetchMoreMessages({direction:C.PAST})})))}processMessages(e,t){const s=[]
let a=!1
const n=this.messagesManager.messages.some((e=>e.newest))
return t?.messages?.forEach(((i,r)=>{i.firstOfResults=0===r,this.currentUser.ignored_users&&(i.hidden=this.currentUser.ignored_users.includes(i.user.username)),this.requestedTargetMessageId===i.id?i.expanded=!i.hidden:i.expanded=!(i.hidden||i.deleted_at),!n&&!a&&i.id>this.currentUserMembership?.lastReadMessageId&&(a=!0,i.newest=!0)
const o=j.default.create(e,i)
o.manager=e.messagesManager,o.thread&&this.#ke(o.thread,t.tracking.thread_tracking),s.push(o)})),s}static#Te=(()=>dt7948.n(this.prototype,"processMessages",[_.bind]))()
debounceHighlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this._debouncedHighlightOrFetchMessageHandler=(0,f.default)(this,this.highlightOrFetchMessage,e,t,100)}highlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const s=this.messagesManager.findMessage(e)
s?this.scrollToMessageId(s.id,Object.assign({highlight:!0,position:"start",autoExpand:!0,behavior:this.capabilities.isIOS?"smooth":null},t)):this.fetchMessages({target_message_id:e,position:"end"})}debouncedUpdateLastReadMessage(){this._debouncedUpdateLastReadMessageHandler=(0,f.default)(this,this.updateLastReadMessage,C.READ_INTERVAL_MS)}updateLastReadMessage(){if(!this.args.channel.isFollowing)return
const e=(0,y.default)(this.scroller)
if(!e)return
let t=this.messagesManager.findMessage(e)
if(!t)return
const s=this.args.channel.currentUserMembership?.lastReadMessageId
return s>=t.id?void 0:this.chatApi.markChannelAsRead(this.args.channel.id,t.id)}scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom(this.scroller)}static#xe=(()=>dt7948.n(this.prototype,"scrollToLatestMessage",[a.action]))()
onScroll(e){(0,c.next)((()=>{this.#je()||(k.default.apply(this.scroller),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debouncedUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:C.PAST}):e.atBottom&&this.fetchMoreMessages({direction:C.FUTURE}))}))}static#Ee=(()=>dt7948.n(this.prototype,"onScroll",[a.action]))()
onScrollEnd(e){this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.atBottom=e.atBottom,e.atBottom?(this.fetchMoreMessages({direction:C.FUTURE}),this.chatChannelScrollPositions.delete(this.args.channel.id)):this.chatChannelScrollPositions.set(this.args.channel.id,e.firstVisibleId)}static#Pe=(()=>dt7948.n(this.prototype,"onScrollEnd",[a.action]))()
async onSendMessage(e){e.message.length>this.siteSettings.chat_maximum_message_length?this.dialog.alert(b.default.t("chat.message_too_long",{count:this.siteSettings.chat_maximum_message_length})):(await e.cook(),e.editing?await this.#Ae(e):await this.#Oe(e))}static#Ue=(()=>dt7948.n(this.prototype,"onSendMessage",[a.action]))()
resetComposerMessage(){this.args.channel.resetDraft(this.currentUser)}static#De=(()=>dt7948.n(this.prototype,"resetComposerMessage",[a.action]))()
async#Ae(e){this.pane.sending=!0
const t={message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{(0,E.stackingContextFix)(this.scroller,(async()=>{await this.chatApi.editMessage(this.args.channel.id,e.id,t)}))}catch(s){(0,u.popupAjaxError)(s)}finally{e.editing=!1,this.pane.sending=!1}}async#Oe(e){this.pane.sending=!0,(0,E.stackingContextFix)(this.scroller,(async()=>{await this.args.channel.stageMessage(e)})),e.manager=this.args.channel.messagesManager,this.resetComposerMessage(),this.capabilities.isIOS||this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{const t={message:e.message,in_reply_to_id:e.inReplyTo?.id,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id))}
await this.chatApi.sendMessage(this.args.channel.id,Object.assign({},t,(0,T.extractCurrentTopicInfo)(this))),this.capabilities.isIOS||this.scrollToLatestMessage()}catch(t){this._onSendError(e.id,t)}finally{this.pane.sending=!1}}_onSendError(e,t){const s=this.args.channel.messagesManager.findStagedMessage(e)
s&&(t.jqXHR?.responseJSON?.errors?.length?(s.message="",s.cooked="",s.error=t.jqXHR.responseJSON.errors[0]):(this.chat.markNetworkAsUnreliable(),s.error="network_error")),this.resetComposerMessage()}resendStagedMessage(e){this.pane.sending=!0,e.error=null
const t={cooked:e.cooked,message:e.message,upload_ids:e.uploads.map((e=>e.id)),staged_id:e.id}
this.chatApi.sendMessage(this.args.channel.id,t).catch((e=>{this._onSendError(t.staged_id,e)})).then((()=>{this.chat.markNetworkAsReliable()})).finally((()=>{this.pane.sending=!1}))}static#Le=(()=>dt7948.n(this.prototype,"resendStagedMessage",[a.action]))()
onCloseFullScreen(){this.chatStateManager.prefersDrawer(),p.default.routeTo(this.chatStateManager.lastKnownAppURL).then((()=>{p.default.routeTo(this.chatStateManager.lastKnownChatURL)}))}static#Ie=(()=>dt7948.n(this.prototype,"onCloseFullScreen",[a.action]))()
_autoFocus(e){if(this.chatStateManager.isDrawerActive)return
const{key:t,metaKey:s,ctrlKey:a,code:n,target:i}=e
!t||t.length>1||s||a||"Space"===n||"?"===t||i&&!/^(INPUT|TEXTAREA|SELECT)$/.test(i.tagName)&&(e.preventDefault(),this.composer.focus({addText:e.key}))}static#Re=(()=>dt7948.n(this.prototype,"_autoFocus",[_.bind]))()
#fe(){(0,c.cancel)(this._debouncedHighlightOrFetchMessageHandler),(0,c.cancel)(this._debouncedUpdateLastReadMessageHandler),(0,c.cancel)(this._debouncedFillPaneAttemptHandler)}#ke(e,t){t[e.id]&&(e.tracking.unreadCount=t[e.id].unread_count,e.tracking.mentionCount=t[e.id].mention_count,e.tracking.watchedThreadsUnreadCount=t[e.id].watched_threads_unread_count)}#je(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}static#Ne=(()=>(0,H.setComponentTemplate)((0,z.createTemplateFactory)({id:"ZeU8a4iB",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-channel",[52,[30,0,["messagesLoader","loading"]],"loading"],[52,[30,0,["pane","sending"]],"chat-channel--sending"],[52,[30,0,["hasSavedScrollPosition"]],"chat-channel--saved-scroll-position"],[52,[51,[30,0,["messagesLoader","fetchedOnce"]]],"chat-channel--not-loaded-once"]],null]],[16,"data-id",[30,1,["id"]]],[4,[32,1],[[30,0,["teardown"]]],null],[4,[32,2],[[30,0,["setup"]]],null],[4,[32,3],[[30,0,["loadMessages"]],[30,2]],null],[12],[1,"\\n      "],[8,[32,4],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[8,[32,5],null,[["@channel"],[[30,1]]],null],[1,"\\n      "],[8,[32,6],null,null,null],[1,"\\n\\n      "],[8,[32,7],null,[["@onRegisterScroller","@onScroll","@onScrollEnd"],[[30,0,["registerScroller"]],[30,0,["onScroll"]],[30,0,["onScrollEnd"]]]],[["default"],[[[[1,"\\n        "],[8,[32,8],null,[["@didResizePane"],[[30,0,["didResizePane"]]]],[["default"],[[[[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"            "],[8,[32,9],null,[["@message","@disableMouseEvents","@resendStagedMessage","@fetchMessagesByDate","@context"],[[30,3],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],[30,0,["fetchMessagesByDate"]],"channel"]],null],[1,"\\n"]],[3]],[[[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[1,"              "],[8,[32,10],null,null,null],[1,"\\n"]],[]],null]],[]]],[1,"        "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["messagesLoader","loadedPast"]],[[[1,"          "],[10,0],[14,0,"all-loaded-message"],[12],[1,"\\n            "],[1,[28,[32,11],["chat.all_loaded"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n\\n      "],[8,[32,12],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["pane","selectingMessages"]],[[[1,"        "],[8,[32,13],null,[["@enableMove","@pane","@messagesManager"],[[28,[32,14],[[28,[32,15],[[30,1,["isDirectMessageChannel"]]],null],[30,1,["canModerate"]]],null],[30,0,["pane"]],[30,0,["messagesManager"]]]],null],[1,"\\n"]],[]],[[[41,[28,[32,14],[[28,[32,15],[[30,1,["isFollowing"]]],null],[30,1,["isCategoryChannel"]]],null],[[[1,"          "],[8,[32,16],null,[["@channel"],[[30,1]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,17],null,[["@channel","@uploadDropZone","@onSendMessage","@scroller"],[[30,1],[30,0,["uploadDropZone"]],[30,0,["onSendMessage"]],[30,0,["scroller"]]]],null],[1,"\\n"]],[]]]],[]]],[1,"\\n      "],[8,[32,18],null,[["@model"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@channel","@targetMessageId","message"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-channel.js",scope:()=>[h.default,o.default,i.default,r.default,v.default,N.default,D.default,R.default,I.default,L.default,F.default,g.default,A.default,O.default,d.and,d.not,U.default,P.default,B.default],isStrictMode:!0}),this))()}e.default=W})),define("discourse/plugins/chat/discourse/components/chat-composer-dropdown",["exports","@glimmer/component","@ember/helper","@ember/object","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/i18n","float-kit/components/d-menu","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{onButtonClick(e,t){t(),e.action()}static#e=(()=>dt7948.n(this.prototype,"onButtonClick",[a.action]))()
static#s=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"6zsHNoy8",block:'[[[1,"\\n"],[41,[30,1,["length"]],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["chat-composer-dropdown__trigger-btn","btn-flat",[52,[30,2],"has-active-panel"]],null]],[17,3]],[["@title","@icon","@disabled","@arrow","@placements","@identifier"],[[28,[32,2],["chat.composer.toggle_toolbar"],null],"plus",[30,4],true,[28,[32,3],["top","bottom"],null],"chat-composer-dropdown__menu"]],[["default"],[[[[1,"\\n        "],[10,"ul"],[14,0,"chat-composer-dropdown__list"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1]],null]],null],null,[[[1,"            "],[10,"li"],[15,0,[28,[32,1],["chat-composer-dropdown__item",[30,6,["id"]]],null]],[12],[1,"\\n              "],[8,[32,4],[[16,0,[28,[32,1],["chat-composer-dropdown__action-btn",[30,6,["id"]]],null]]],[["@icon","@action","@label"],[[30,6,["icon"]],[28,[32,5],[[30,0,["onButtonClick"]],[30,6],[30,5,["close"]]],null],[30,6,["label"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[6]],null],[1,"        "],[13],[1,"\\n      "]],[5]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@buttons","@hasActivePanel","&attrs","@isDisabled","menu","button"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-composer-dropdown.js",scope:()=>[o.default,i.default,r.default,s.array,n.default,s.fn],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat-composer-message-details",["exports","@ember/template","discourse/components/d-button","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"YJD9dBsc",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-composer-message-details"],[15,"data-id",[30,1,["id"]]],[15,"data-action",[52,[30,1,["editing"]],"edit","reply"]],[12],[1,"\\n    "],[10,0],[14,0,"chat-reply"],[12],[1,"\\n      "],[1,[28,[32,0],[[52,[30,1,["editing"]],"pencil","reply"]],null]],[1,"\\n      "],[8,[32,1],null,[["@user"],[[30,1,["user"]]]],null],[1,"\\n      "],[10,1],[14,0,"chat-reply__username"],[12],[1,[30,1,["user","username"]]],[13],[1,"\\n      "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n        "],[1,[28,[32,2],[[28,[32,3],[[30,1,["excerpt"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,4],[[24,0,"btn-flat cancel-message-action"]],[["@action","@icon","@title"],[[30,2],"circle-xmark","cancel"]],null],[1,"\\n  "],[13],[1,"\\n"]],["@message","@cancelAction"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-composer-message-details.js",scope:()=>[n.default,i.default,a.default,t.htmlSafe,s.default],isStrictMode:!0}),(0,c.default)(void 0,"chat-composer-message-details:ChatComposerMessageDetails"))
e.default=l})),define("discourse/plugins/chat/discourse/components/chat-composer-upload",["exports","@glimmer/component","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/uploads","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{get isImage(){return(0,n.isImage)(this.args.upload.original_filename||this.args.upload.fileName)}get fileName(){return this.args.isDone?this.args.upload.original_filename:this.args.upload.fileName}static#e=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"i49/H7Z5",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[15,0,[28,[32,0],["chat-composer-upload",[52,[30,0,["isImage"]],"chat-composer-upload--image"],[52,[51,[30,2]],"chat-composer-upload--in-progress"]],null]],[12],[1,"\\n        "],[10,0],[14,0,"preview"],[12],[1,"\\n"],[41,[30,0,["isImage"]],[[[41,[30,2],[[[1,"              "],[10,"img"],[14,0,"preview-img"],[15,"src",[30,1,["short_path"]]],[12],[13],[1,"\\n"]],[]],[[[1,"              "],[1,[28,[32,1],["far-image"],null]],[1,"\\n"]],[]]]],[]],[[[1,"            "],[1,[28,[32,1],["file-lines"],null]],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n\\n        "],[10,1],[14,0,"data"],[12],[1,"\\n"],[41,[51,[30,0,["isImage"]]],[[[1,"            "],[10,0],[14,0,"top-data"],[12],[1,"\\n              "],[10,1],[14,0,"file-name"],[12],[1,[30,0,["fileName"]]],[13],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,0],[14,0,"bottom-data"],[12],[1,"\\n"],[41,[30,2],[[[41,[51,[30,0,["isImage"]]],[[[1,"                "],[10,1],[14,0,"extension-pill"],[12],[1,[30,1,["extension"]]],[13],[1,"\\n"]],[]],null]],[]],[[[41,[30,1,["processing"]],[[[1,"                "],[10,1],[14,0,"processing"],[12],[1,[28,[32,2],["processing"],null]],[13],[1,"\\n"]],[]],[[[1,"                "],[10,1],[14,0,"uploading"],[12],[1,[28,[32,2],["uploading"],null]],[13],[1,"\\n"]],[]]],[1,"\\n              "],[10,"progress"],[14,0,"upload-progress"],[14,1,"file"],[14,"max","100"],[15,2,[30,1,["progress"]]],[12],[13],[1,"\\n"]],[]]],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,3],[[24,0,"btn-flat chat-composer-upload__remove-btn"]],[["@action","@icon","@title"],[[30,3],"xmark","chat.remove_upload"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@upload","@isDone","@onCancel"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-composer-upload.js",scope:()=>[a.default,i.default,r.default,s.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat-composer-uploads",["exports","@ember/component","@ember/object","@ember/service","@ember-decorators/component","discourse/lib/uppy-media-optimization-plugin","discourse/lib/utilities","discourse/mixins/uppy-upload","discourse-common/lib/object","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,d.createTemplateFactory)({id:"FoGAB5VV",block:'[[[41,[30,0,["showUploadsContainer"]],[[[1,"  "],[10,0],[14,0,"chat-composer-uploads-container"],[12],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["uploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@isDone","@onCancel"],[[30,1],true,[28,[37,4],[[30,0],"removeUpload",[30,1]],null]]],null],[1,"\\n"]],[1]],null],[1,"\\n"],[42,[28,[37,2],[[28,[37,2],[[30,0,["inProgressUploads"]]],null]],null],null,[[[1,"      "],[8,[39,3],null,[["@upload","@onCancel"],[[30,2],[28,[37,4],[[30,0],"cancelUploading",[30,2]],null]]],null],[1,"\\n"]],[2]],null],[1,"  "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[8,[39,5],null,[["@allowMultiple","@fileInputId","@fileInputClass"],[true,[30,0,["fileUploadElementId"]],"hidden-upload-field"]],null]],["upload","upload"],false,["if","each","-track-array","chat-composer-upload","action","pick-files-button"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer-uploads.hbs",isStrictMode:!1}),u=dt7948.c(class extends(t.default.extend(o.default)){static#e=(()=>dt7948.g(this.prototype,"mediaOptimizationWorker",[a.service]))()
#Fe=(()=>{dt7948.i(this,"mediaOptimizationWorker")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[a.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
id="chat-composer-uploader"
type="chat-composer"
existingUploads=null
uploads=null
useMultipartUploadsIfAvailable=!0
uploadDropZone=null
init(){super.init(...arguments),this.setProperties({fileInputSelector:`#${this.fileUploadElementId}`})}didReceiveAttrs(){super.didReceiveAttrs(...arguments),this.inProgressUploads?.length>0&&this._uppyInstance?.cancelAll(),this.set("uploads",this.existingUploads?(0,c.cloneJSON)(this.existingUploads):[])}didInsertElement(){super.didInsertElement(...arguments),this.composerInputEl?.addEventListener("paste",this._pasteEventListener)}willDestroyElement(){super.willDestroyElement(...arguments),this.composerInputEl?.removeEventListener("paste",this._pasteEventListener)}uploadDone(e){this.uploads.pushObject(e),this._triggerUploadsChanged()}showUploadsContainer(e,t){return e>0||t>0}static#n=(()=>dt7948.n(this.prototype,"showUploadsContainer",[(0,l.default)("uploads.length","inProgressUploads.length")]))()
cancelUploading(e){this.appEvents.trigger(`upload-mixin:${this.id}:cancel-upload`,{fileId:e.id}),this.removeUpload(e)}static#r=(()=>dt7948.n(this.prototype,"cancelUploading",[s.action]))()
removeUpload(e){this.uploads.removeObject(e),this._triggerUploadsChanged()}static#c=(()=>dt7948.n(this.prototype,"removeUpload",[s.action]))()
_uploadDropTargetOptions(){return{target:this.uploadDropZone||document.body}}_uppyReady(){this.siteSettings.composer_media_optimization_image_enabled&&this._useUploadPlugin(i.default,{optimizeFn:(e,t)=>this.mediaOptimizationWorker.optimizeImage(e,t),runParallel:!this.site.isMobileDevice}),this._onPreProcessProgress((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.processing||t?.set("processing",!0)})),this._onPreProcessComplete((e=>{const t=this.inProgressUploads.findBy("id",e.id)
t?.set("processing",!1)}))}_pasteEventListener(e){if(document.activeElement!==this.composerInputEl)return
const{canUpload:t,canPasteHtml:s,types:a}=(0,r.clipboardHelpers)(e,{siteSettings:this.siteSettings,canUpload:!0})
!t||s||a.includes("text/plain")||e&&e.clipboardData&&e.clipboardData.files&&this._addFiles([...e.clipboardData.files],{pasted:!0})}static#l=(()=>dt7948.n(this.prototype,"_pasteEventListener",[l.bind]))()
onProgressUploadsChanged(){this._triggerUploadsChanged(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})}_triggerUploadsChanged(){this.onUploadChanged?.(this.uploads,{inProgressUploadsCount:this.inProgressUploads?.length})}},[(0,n.classNames)("chat-composer-uploads")])
e.default=(0,t.setComponentTemplate)(h,u)})),define("discourse/plugins/chat/discourse/components/chat-composer",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/owner","@ember/runloop","@ember/service","@ember/utils","jquery","pretty-text/emoji","pretty-text/emoji/data","rsvp","discourse/components/modal/insert-hyperlink","discourse/lib/autocomplete","discourse/lib/body-scroll-lock","discourse/lib/hashtag-autocomplete","discourse/lib/text","discourse/lib/user-search","discourse/lib/user-status-on-autocomplete","discourse-common/lib/object","discourse-common/lib/raw-templates","discourse-i18n","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/lib/textarea-interactor","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C,w,S,k,T){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const x=(0,T.createTemplateFactory)({id:"QGTVAdKX",block:'[[[1,"\\n"],[10,0],[14,0,"chat-composer__wrapper"],[12],[1,"\\n"],[41,[30,0,["shouldRenderMessageDetails"]],[[[1,"    "],[8,[39,1],null,[["@message","@cancelAction"],[[52,[30,0,["draft","editing"]],[30,0,["draft"]],[30,0,["draft","inReplyTo"]]],[30,0,["resetDraft"]]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[11,0],[24,"role","region"],[16,"aria-label",[28,[37,2],["chat.aria_roles.composer"],null]],[16,0,[28,[37,3],["chat-composer",[52,[30,0,["isFocused"]],"is-focused"],[52,[30,0,["pane","sending"]],"is-sending"],[52,[30,0,["sendEnabled"]],"is-send-enabled","is-send-disabled"],[52,[30,0,["disabled"]],"is-disabled","is-enabled"],[52,[30,0,["draft","draftSaved"]],"is-draft-saved","is-draft-unsaved"]],null]],[4,[38,4],[[30,0,["didUpdateMessage"]],[30,0,["draft"]]],null],[4,[38,4],[[30,0,["didUpdateInReplyTo"]],[30,0,["draft","inReplyTo"]]],null],[4,[38,5],[[30,0,["setup"]]],null],[4,[38,6],[[30,0,["teardown"]]],null],[4,[38,6],[[30,0,["cancelPersistDraft"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-composer__outer-container"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[8,[39,7],null,[["@buttons","@isDisabled"],[[30,0,["dropdownButtons"]],[30,0,["disabled"]]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"chat-composer__inner-container"],[12],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"          "],[8,[39,7],null,[["@buttons","@isDisabled"],[[30,0,["dropdownButtons"]],[30,0,["disabled"]]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[11,0],[24,0,"chat-composer__input-container"],[4,[38,8],["click",[30,0,["composer","focus"]]],null],[12],[1,"\\n          "],[8,[39,9],[[16,1,[30,0,["composerId"]]],[16,2,[28,[37,10],[[30,0,["draft","message"]]],null]],[24,0,"chat-composer__input"],[16,"disabled",[30,0,["disabled"]]],[24,"autocorrect","on"],[24,"autocapitalize","sentences"],[16,"placeholder",[30,0,["placeholder"]]],[16,"rows",1],[16,"data-chat-composer-context",[30,0,["context"]]],[24,4,"text"],[4,[38,5],[[30,0,["setupTextareaInteractor"]]],null],[4,[38,8],["input",[30,0,["onInput"]]],null],[4,[38,8],["keydown",[30,0,["onKeyDown"]]],null],[4,[38,8],["focusin",[30,0,["onTextareaFocusIn"]]],null],[4,[38,8],["focusout",[30,0,["onTextareaFocusOut"]]],null],[4,[38,5],[[30,0,["setupAutocomplete"]]],null]],null,null],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,0,["inlineButtons","length"]],[[[42,[28,[37,12],[[28,[37,12],[[30,0,["inlineButtons"]]],null]],null],null,[[[1,"            "],[8,[39,13],[[16,0,[29,["-",[30,1,["id"]]]]],[16,"disabled",[28,[37,14],[[30,0,["disabled"]],[30,1,["disabled"]]],null]],[16,"tabindex",[52,[30,1,["disabled"]],-1,0]],[4,[38,8],["click",[28,[37,15],[[30,0,["handleInlineButtonAction"]],[30,1,["action"]]],null]],[["bubbles"],[false]]],[4,[38,8],["focus",[28,[37,15],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,15],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],[[30,1,["icon"]]]],null],[1,"\\n"]],[1]],null],[1,"\\n          "],[8,[39,16],null,null,null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"          "],[8,[39,13],[[24,0,"-send"],[16,"title",[28,[37,2],["chat.composer.send"],null]],[16,"disabled",[28,[37,14],[[30,0,["disabled"]],[28,[37,17],[[30,0,["sendEnabled"]]],null]],null]],[16,"tabindex",[52,[30,0,["sendEnabled"]],0,-1]],[4,[38,8],["click",[30,0,["onSend"]]],null],[4,[38,8],["mousedown",[30,0,["trapMouseDown"]]],null],[4,[38,8],["focus",[28,[37,15],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,15],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],["paper-plane"]],null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[8,[39,13],[[24,0,"-send"],[16,"title",[28,[37,2],["chat.composer.send"],null]],[16,"disabled",[28,[37,14],[[30,0,["disabled"]],[28,[37,17],[[30,0,["sendEnabled"]]],null]],null]],[16,"tabindex",[52,[30,0,["sendEnabled"]],0,-1]],[4,[38,8],["click",[30,0,["onSend"]]],null],[4,[38,8],["mousedown",[30,0,["trapMouseDown"]]],null],[4,[38,8],["focus",[28,[37,15],[[30,0,["computeIsFocused"]],true],null]],null],[4,[38,8],["blur",[28,[37,15],[[30,0,["computeIsFocused"]],false],null]],null]],[["@icon"],["paper-plane"]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n\\n"],[41,[30,0,["canAttachUploads"]],[[[1,"    "],[8,[39,18],null,[["@fileUploadElementId","@onUploadChanged","@existingUploads","@uploadDropZone","@composerInputEl"],[[30,0,["fileUploadElementId"]],[30,0,["onUploadChanged"]],[30,0,["draft","uploads"]],[30,2],[30,0,["composer","textarea","element"]]]],null],[1,"\\n"]],[]],null],[1,"\\n  "],[10,0],[14,0,"chat-replying-indicator-container"],[12],[1,"\\n    "],[8,[39,19],null,[["@presenceChannelName"],[[30,0,["presenceChannelName"]]]],null],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,20],null,[["@context","@didSelectEmoji"],[[30,0,["context"]],[30,0,["onSelectEmoji"]]]],null],[1,"\\n"],[13]],["button","@uploadDropZone"],false,["if","chat-composer-message-details","i18n","concat-class","did-update","did-insert","will-destroy","chat-composer-dropdown","on","d-textarea","readonly","each","-track-array","chat/composer/button","or","fn","chat/composer/separator","not","chat-composer-uploads","chat-replying-indicator","chat-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-composer.hbs",isStrictMode:!1})
class j extends s.default{static#e=(()=>dt7948.g(this.prototype,"capabilities",[o.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#s=(()=>dt7948.g(this.prototype,"site",[o.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[o.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#r=(()=>dt7948.g(this.prototype,"store",[o.service]))()
#Be=(()=>{dt7948.i(this,"store")})()
static#c=(()=>dt7948.g(this.prototype,"chat",[o.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#l=(()=>dt7948.g(this.prototype,"chatComposerPresenceManager",[o.service]))()
#J=(()=>{dt7948.i(this,"chatComposerPresenceManager")})()
static#d=(()=>dt7948.g(this.prototype,"chatComposerWarningsTracker",[o.service]))()
#He=(()=>{dt7948.i(this,"chatComposerWarningsTracker")})()
static#h=(()=>dt7948.g(this.prototype,"appEvents",[o.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#u=(()=>dt7948.g(this.prototype,"chatEmojiReactionStore",[o.service]))()
#ze=(()=>{dt7948.i(this,"chatEmojiReactionStore")})()
static#p=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[o.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#j=(()=>dt7948.g(this.prototype,"currentUser",[o.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#P=(()=>dt7948.g(this.prototype,"chatApi",[o.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#O=(()=>dt7948.g(this.prototype,"chatDraftsManager",[o.service]))()
#Y=(()=>{dt7948.i(this,"chatDraftsManager")})()
static#D=(()=>dt7948.g(this.prototype,"modal",[o.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#I=(()=>dt7948.g(this.prototype,"isFocused",[a.tracked],(function(){return!1})))()
#We=(()=>{dt7948.i(this,"isFocused")})()
static#R=(()=>dt7948.g(this.prototype,"inProgressUploadsCount",[a.tracked],(function(){return 0})))()
#$e=(()=>{dt7948.i(this,"inProgressUploadsCount")})()
static#N=(()=>dt7948.g(this.prototype,"presenceChannelName",[a.tracked]))()
#Ve=(()=>{dt7948.i(this,"presenceChannelName")})()
get shouldRenderMessageDetails(){return this.draft?.editing||"channel"===this.context&&this.draft?.inReplyTo}get inlineButtons(){return(0,w.chatComposerButtons)(this,"inline",this.context)}get dropdownButtons(){return(0,w.chatComposerButtons)(this,"dropdown",this.context)}get fileUploadElementId(){return this.context+"-file-uploader"}get canAttachUploads(){return this.siteSettings.chat_allow_uploads&&(0,c.isPresent)(this.args.uploadDropZone)}persistDraft(){}static#B=(()=>dt7948.n(this.prototype,"persistDraft",[n.action]))()
setupAutocomplete(e){const t=(0,l.default)(e)
this.#qe(t),this.#Ge(t),this.#Ke(t)}static#H=(()=>dt7948.n(this.prototype,"setupAutocomplete",[n.action]))()
setupTextareaInteractor(e){this.composer.textarea=new k.default((0,i.getOwner)(this),e),this.site.desktopView&&this.args.autofocus&&this.composer.focus({ensureAtEnd:!0,refreshHeight:!0})}static#z=(()=>dt7948.n(this.prototype,"setupTextareaInteractor",[n.action]))()
didUpdateMessage(){this.cancelPersistDraft(),this.composer.textarea.value=this.draft.message,this.persistDraft(),this.captureMentions({skipDebounce:!0})}static#ne=(()=>dt7948.n(this.prototype,"didUpdateMessage",[n.action]))()
didUpdateInReplyTo(){this.cancelPersistDraft(),this.persistDraft()}static#re=(()=>dt7948.n(this.prototype,"didUpdateInReplyTo",[n.action]))()
cancelPersistDraft(){(0,r.cancel)(this._persistHandler)}static#ce=(()=>dt7948.n(this.prototype,"cancelPersistDraft",[n.action]))()
handleInlineButtonAction(e,t){t.stopPropagation(),e()}static#de=(()=>dt7948.n(this.prototype,"handleInlineButtonAction",[n.action]))()
get hasContent(){const e=this.siteSettings.chat_minimum_message_length||1
return this.draft?.message?.length>=e||this.canAttachUploads&&this.hasUploads}get hasUploads(){return this.draft?.uploads?.length>0}get sendEnabled(){return(this.hasContent||this.draft?.editing)&&!this.pane.sending&&!this.inProgressUploadsCount>0}setup(){this.composer.scroller=this.args.scroller,this.appEvents.on("chat:modify-selection",this,"modifySelection"),this.appEvents.on("chat:open-insert-link-modal",this,"openInsertLinkModal")}static#ue=(()=>dt7948.n(this.prototype,"setup",[n.action]))()
teardown(){this.appEvents.off("chat:modify-selection",this,"modifySelection"),this.appEvents.off("chat:open-insert-link-modal",this,"openInsertLinkModal"),this.pane.sending=!1}static#me=(()=>dt7948.n(this.prototype,"teardown",[n.action]))()
insertDiscourseLocalDate(){const e=require("discourse/plugins/discourse-local-dates/discourse/components/modal/local-dates-create").default
this.modal.show(e,{model:{insertDate:e=>{this.composer.textarea.addText(this.composer.textarea.getSelected(),e),this.composer.focus()}}})}static#ge=(()=>dt7948.n(this.prototype,"insertDiscourseLocalDate",[n.action]))()
uploadClicked(){document.querySelector(`#${this.fileUploadElementId}`).click()}static#_e=(()=>dt7948.n(this.prototype,"uploadClicked",[n.action]))()
computeIsFocused(e){(0,r.next)((()=>{this.isFocused=e}))}static#be=(()=>dt7948.n(this.prototype,"computeIsFocused",[n.action]))()
onInput(e){this.draft.draftSaved=!1,this.draft.message=e.target.value,this.composer.textarea.refreshHeight(),this.reportReplyingPresence(),this.persistDraft(),this.captureMentions()}static#ve=(()=>dt7948.n(this.prototype,"onInput",[n.action]))()
onUploadChanged(e,t){let{inProgressUploadsCount:s}=t
this.draft.draftSaved=!1,this.inProgressUploadsCount=s||0,void 0!==e&&"undefined"!==s&&0===s&&this.draft&&(this.draft.uploads=(0,y.cloneJSON)(e)),this.composer.textarea?.focus(),this.reportReplyingPresence(),this.persistDraft()}static#ye=(()=>dt7948.n(this.prototype,"onUploadChanged",[n.action]))()
trapMouseDown(e){e?.preventDefault()}static#Me=(()=>dt7948.n(this.prototype,"trapMouseDown",[n.action]))()
async onSend(e){this.sendEnabled&&(e?.preventDefault(),!this.draft.editing||this.hasUploads||0!==this.draft.message.length?(await this.args.onSendMessage(this.draft),this.composer.textarea.refreshHeight()):this.#Je())}static#Ce=(()=>dt7948.n(this.prototype,"onSend",[n.action]))()
reportReplyingPresence(){this.args.channel&&this.draft&&this.chatComposerPresenceManager.notifyState(this.presenceChannelName,!this.draft.editing&&this.hasContent)}modifySelection(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{type:null,context:null}
if(t.context!==this.context)return
const s=this.composer.textarea.getSelected("",{lineVal:!0})
"bold"===t.type?this.composer.textarea.applySurround(s,"**","**","bold_text"):"italic"===t.type?this.composer.textarea.applySurround(s,"_","_","italic_text"):"code"===t.type&&this.composer.textarea.applySurround(s,"`","`","code_text")}static#we=(()=>dt7948.n(this.prototype,"modifySelection",[n.action]))()
onTextareaFocusOut(e){this.isFocused=!1,(0,g.enableBodyScroll)(e.target)}static#Se=(()=>dt7948.n(this.prototype,"onTextareaFocusOut",[n.action]))()
onTextareaFocusIn(e){this.isFocused=!0
const t=e.target;(0,g.disableBodyScroll)(t),this.capabilities.isIOS&&(t.style.transform="translateY(-99999px)",t.focus(),window.requestAnimationFrame((()=>{window.requestAnimationFrame((()=>{t.style.transform=""}))})))}static#Te=(()=>dt7948.n(this.prototype,"onTextareaFocusIn",[n.action]))()
onKeyDown(e){if(!(this.site.mobileView||e.altKey||e.metaKey||this.#Ye())){if("Escape"===e.key&&!e.shiftKey)return this.handleEscape(e)
if("Enter"===e.key){if(e.shiftKey)return
if(!e.ctrlKey){const{pre:e}=this.composer.textarea.getSelected({lineVal:!0})
if(this.composer.textarea.isInside(e,/(^|\n)```/g))return}return this.onSend(),e.preventDefault(),!1}if("ArrowUp"===e.key&&!this.hasContent&&!this.draft.editing)if(e.shiftKey&&this.lastMessage?.replyable)this.composer.replyTo(this.lastMessage)
else{const e=this.lastUserMessage(this.currentUser)
e?.editable&&(this.composer.edit(e),this.args.channel.draft=e)}}}static#xe=(()=>dt7948.n(this.prototype,"onKeyDown",[n.action]))()
openInsertLinkModal(e){if((arguments.length>1&&void 0!==arguments[1]?arguments[1]:{context:null}).context!==this.context)return
const t=this.composer.textarea.getSelected("",{lineVal:!0}),s=t?.value
this.modal.show(p.default,{model:{linkText:s,toolbarEvent:{addText:e=>this.composer.textarea.addText(t,e)}}})}static#Ee=(()=>dt7948.n(this.prototype,"openInsertLinkModal",[n.action]))()
onSelectEmoji(e){const t=`:${e}:`
this.chatEmojiReactionStore.track(t),this.composer.textarea.addText(this.composer.textarea.getSelected(),t),this.site.desktopView?this.composer.focus():this.chatEmojiPickerManager.close()}static#Pe=(()=>dt7948.n(this.prototype,"onSelectEmoji",[n.action]))()
captureMentions(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{skipDebounce:!1}
this.hasContent?this.chatComposerWarningsTracker.trackMentions(this.draft,e.skipDebounce):this.chatComposerWarningsTracker.reset()}static#Ue=(()=>dt7948.n(this.prototype,"captureMentions",[n.action]))()
#Ze(e){const t=this.store.createRecord("user",e)
this.draft.mentionedUsers.set(t.id,t)}#qe(e){this.siteSettings.enable_mentions&&e.autocomplete({template:(0,M.findRawTemplate)("user-selector-autocomplete"),key:"@",width:"100%",treatAsTextarea:!0,autoSelectFirstSuggestion:!0,transformComplete:e=>(e.isUser&&this.#Ze(e),e.username||e.name),dataSource:e=>((0,v.destroyUserStatuses)(),(0,b.default)({term:e,includeGroups:!0}).then((e=>{if(e?.users?.length>0){const t=this.chat.presenceChannel.users?.mapBy("username")
e.users.forEach((e=>{t.includes(e.username)&&(e.cssClasses="is-online")})),(0,v.initUserStatusHtml)((0,i.getOwner)(this),e.users)}return e}))),onRender:e=>{(0,v.renderUserStatusHtml)(e)},afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus(),this.captureMentions()},onClose:v.destroyUserStatuses})}#Ke(e){(0,f.setupHashtagAutocomplete)(this.site.hashtag_configurations["chat-composer"],e,this.siteSettings,{treatAsTextarea:!0,afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()}})}#Ge(e){this.siteSettings.enable_emoji&&e.autocomplete({template:(0,M.findRawTemplate)("emoji-selector-autocomplete"),key:":",afterComplete:(e,t)=>{t.preventDefault(),this.composer.textarea.value=e,this.composer.focus()},treatAsTextarea:!0,onKeyUp:(e,t)=>{const s=/(?:^|[\s.\?,@\/#!%&*;:\[\]{}=\-_()])(:(?!:).?[\w-]*:?(?!:)(?:t\d?)?:?) ?$/gi.exec(e.substring(0,t))
if(s&&s[1])return[s[1]]},transformComplete:t=>t.code?(this.chatEmojiReactionStore.track(t.code),`${t.code}:`):(e.autocomplete({cancel:!0}),this.chatEmojiPickerManager.open({context:this.context,initialFilter:t.term}),""),dataSource:e=>new u.Promise((t=>{const s=`:${e}`
e=e.toLowerCase()
let a=Math.max(this.siteSettings.emoji_autocomplete_min_chars,2)
if(e.length<a)return t(m.SKIP)
if(!e.match(/[^-\{\}\[\]\(\)\*_\<\>\\\/].*[^-\{\}\[\]\(\)\*_\<\>\\\/]/))return t(m.SKIP)
if(""===e)return this.chatEmojiReactionStore.favorites.length?t(this.chatEmojiReactionStore.favorites.slice(0,5)):t(["slight_smile","smile","wink","sunny","blush"])
const n=this.site.custom_emoji_translation||{},i=Object.assign({},h.translations,n)
if(i[s])return t([i[s]])
const r=this.site.denied_emojis||[],o=e.match(/^:?(.*?):t([2-6])?$/)
if(o){const e=o[1],s=o[2]
if((0,d.isSkinTonableEmoji)(e)&&!r.includes(e))return t(s?[`${e}:t${s}`]:[2,3,4,5,6].map((t=>`${e}:t${t}`)))}return t((0,d.emojiSearch)(e,{maxResults:5,diversity:this.chatEmojiReactionStore.diversity,exclude:r}))})).then((e=>{if(e!==m.SKIP)return e.map((e=>({code:e,src:(0,_.emojiUrlFor)(e)})))})).then((t=>(t?.length&&t.push({label:C.default.t("composer.more_emoji"),term:e}),t)))})}#Ye(){return document.querySelector(".autocomplete")}#Je(){new S.default((0,i.getOwner)(this),this.draft,this.context).delete(),this.resetDraft()}}e.default=j,(0,t.setComponentTemplate)(x,j)})),define("discourse/plugins/chat/discourse/components/chat-drawer",["exports","@ember/component","@ember/object","@ember/runloop","@ember/service","@ember/template","@ember-decorators/component","@ember-decorators/object","discourse/lib/url","discourse/lib/utilities","discourse-common/lib/get-url","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p=(0,u.createTemplateFactory)({id:"SvLvpgHy",block:'[[[41,[30,0,["chatStateManager","isDrawerActive"]],[[[1,"  "],[1,[28,[35,1],["chat-drawer-active"],null]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"  "],[1,[28,[35,1],["chat-drawer-expanded"],null]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["chatStateManager","isDrawerActive"]],[[[1,"  "],[11,0],[16,"data-chat-channel-id",[30,0,["chat","activeChannel","id"]]],[16,"data-chat-thread-id",[30,0,["chat","activeChannel","activeThread","id"]]],[16,0,[28,[37,2],["chat-drawer",[52,[30,0,["chatStateManager","isDrawerExpanded"]],"is-expanded"]],null]],[16,5,[30,0,["drawerStyle"]]],[4,[38,3],[".chat-drawer-resizer",[30,0,["didResize"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-drawer-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-drawer-resizer"],[12],[13],[1,"\\n\\n      "],[8,[39,4],null,[["@name","@outletArgs"],["chat-drawer-before-content",[28,[37,5],null,[["currentRouteName"],[[30,0,["chatDrawerRouter","currentRouteName"]]]]]]],null],[1,"\\n\\n      "],[8,[30,0,["chatDrawerRouter","component"]],null,[["@params","@openURL","@openInFullPage","@toggleExpand","@close","@drawerActions"],[[30,0,["chatDrawerRouter","params"]],[30,0,["openURL"]],[30,0,["openInFullPage"]],[30,0,["toggleExpand"]],[30,0,["close"]],[30,0,["drawerActions"]]]],null],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]],null]],[],false,["if","bodyClass","concat-class","chat/resizable-node","plugin-outlet","hash"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-drawer.hbs",isStrictMode:!1}),m=dt7948.c(class extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"chatDrawerSize",[n.service]))()
#Xe=(()=>{dt7948.i(this,"chatDrawerSize")})()
static#r=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#c=(()=>dt7948.g(this.prototype,"chatStateManager",[n.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#l=(()=>dt7948.g(this.prototype,"chatDrawerRouter",[n.service]))()
#Qe=(()=>{dt7948.i(this,"chatDrawerRouter")})()
loading=!1
sizeTimer=null
rafTimer=null
hasUnreadMessages=!1
drawerStyle=null
didInsertElement(){super.didInsertElement(...arguments),this.chat.userCanChat&&(this._checkSize(),this.appEvents.on("chat:open-url",this,"openURL"),this.appEvents.on("chat:toggle-close",this,"close"),this.appEvents.on("composer:closed",this,"_checkSize"),this.appEvents.on("composer:opened",this,"_checkSize"),this.appEvents.on("composer:resized",this,"_checkSize"),this.appEvents.on("composer:div-resizing",this,"_dynamicCheckSize"),window.addEventListener("resize",this._checkSize),this.appEvents.on("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.on("composer:resize-ended",this,"_clearDynamicCheckSize"),this.computeDrawerStyle())}willDestroyElement(){super.willDestroyElement(...arguments),this.chat.userCanChat&&(window.removeEventListener("resize",this._checkSize),this.appEvents&&(this.appEvents.off("chat:open-url",this,"openURL"),this.appEvents.off("chat:toggle-close",this,"close"),this.appEvents.off("composer:closed",this,"_checkSize"),this.appEvents.off("composer:opened",this,"_checkSize"),this.appEvents.off("composer:resized",this,"_checkSize"),this.appEvents.off("composer:div-resizing",this,"_dynamicCheckSize"),this.appEvents.off("composer:resize-started",this,"_startDynamicCheckSize"),this.appEvents.off("composer:resize-ended",this,"_clearDynamicCheckSize")),this.sizeTimer&&((0,a.cancel)(this.sizeTimer),this.sizeTimer=null),this.rafTimer&&window.cancelAnimationFrame(this.rafTimer))}_fireHiddenAppEvents(){this.appEvents.trigger("chat:rerender-header")}static#d=(()=>dt7948.n(this.prototype,"_fireHiddenAppEvents",[(0,o.observes)("chatStateManager.isDrawerActive")]))()
computeDrawerStyle(){const{width:e,height:t}=this.chatDrawerSize.size
let s=`width: ${(0,l.escapeExpression)((e||"0").toString())}px;`
s+=`height: ${(0,l.escapeExpression)((t||"0").toString())}px;`,this.set("drawerStyle",(0,i.htmlSafe)(s))}get drawerActions(){return{openInFullPage:this.openInFullPage,close:this.close,toggleExpand:this.toggleExpand}}_dynamicCheckSize(){this.chatStateManager.isDrawerActive&&(this.rafTimer||(this.rafTimer=window.requestAnimationFrame((()=>{this.rafTimer=null,this._performCheckSize()}))))}static#h=(()=>dt7948.n(this.prototype,"_dynamicCheckSize",[h.bind]))()
_startDynamicCheckSize(){this.chatStateManager.isDrawerActive&&document.querySelector(".chat-drawer-outlet-container").classList.add("clear-transitions")}_clearDynamicCheckSize(){this.chatStateManager.isDrawerActive&&(document.querySelector(".chat-drawer-outlet-container").classList.remove("clear-transitions"),this._checkSize())}_checkSize(){this.sizeTimer=(0,a.throttle)(this,this._performCheckSize,150)}static#u=(()=>dt7948.n(this.prototype,"_checkSize",[h.bind]))()
_performCheckSize(){if(this.isDestroying||this.isDestroyed)return
const e=document.querySelector(".chat-drawer-outlet-container")
if(!e)return
const t=document.getElementById("reply-control"),s=t.classList.contains("closed")
e.style.setProperty("--composer-right",(s?15:Math.max(15,t.offsetLeft))+"px")}openURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
this.chat.activeChannel=null,this.chatDrawerRouter.stateFor(this._routeFromURL(e)),this.chatStateManager.didOpenDrawer(e)}static#p=(()=>dt7948.n(this.prototype,"openURL",[s.action]))()
_routeFromURL(e){let t=this.router.recognize((0,d.default)(e||"/"))
return"index"===t.localName&&(t=t.parent),t}async openInFullPage(){return this.chatStateManager.storeAppURL(),this.chatStateManager.prefersFullPage(),this.chat.activeChannel=null,await new Promise((e=>(0,a.next)(e))),c.default.routeTo(this.chatStateManager.lastKnownChatURL)}static#j=(()=>dt7948.n(this.prototype,"openInFullPage",[s.action]))()
toggleExpand(){this.computeDrawerStyle(),this.chatStateManager.didToggleDrawer(),this.appEvents.trigger("chat:toggle-expand",this.chatStateManager.isDrawerExpanded)}static#P=(()=>dt7948.n(this.prototype,"toggleExpand",[s.action]))()
close(){this.computeDrawerStyle(),this.chatStateManager.didCloseDrawer(),this.chat.activeChannel=null}static#O=(()=>dt7948.n(this.prototype,"close",[s.action]))()
didResize(e,t){let{width:s,height:a}=t
this.chatDrawerSize.size={width:s,height:a}}static#D=(()=>dt7948.n(this.prototype,"didResize",[s.action]))()},[(0,r.tagName)("")])
e.default=(0,t.setComponentTemplate)(p,m)}))
define("discourse/plugins/chat/discourse/components/chat-emoji-avatar",["exports","discourse/helpers/replace-emoji","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"jVj1V68A",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-emoji-avatar"],[12],[1,"\\n    "],[10,0],[14,0,"chat-emoji-avatar-container"],[12],[1,"\\n      "],[1,[28,[32,0],[[30,1]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["@emoji"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-emoji-avatar.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"chat-emoji-avatar:ChatEmojiAvatar"))
e.default=i})),define("discourse/plugins/chat/discourse/components/chat-emoji-picker",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/template","discourse/lib/text","discourse-common/config/environment","discourse-common/lib/debounce","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.FITZPATRICK_MODIFIERS=void 0
const p=(0,u.createTemplateFactory)({id:"Hd5IILWg",block:'[[[1,"\\n"],[41,[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],[30,1]],null],[[[1,"  "],[11,0],[16,0,[28,[37,2],["chat-emoji-picker",[52,[30,0,["chatEmojiPickerManager","closing"]],"closing"]],null]],[17,2],[4,[38,3],[[30,0,["addClickOutsideEventListener"]]],null],[4,[38,3],[[30,0,["chatEmojiPickerManager","loadEmojis"]]],null],[4,[38,3],[[52,[30,3],[30,3],[28,[37,4],null,null]]],null],[4,[38,5],[[52,[30,4],[30,4],[28,[37,4],null,null]]],null],[4,[38,5],[[30,0,["removeClickOutsideEventListener"]]],null],[4,[38,6],["keydown",[30,0,["trapKeyDownEvents"]]],null],[12],[1,"\\n    "],[10,0],[14,0,"chat-emoji-picker__filter-container"],[12],[1,"\\n      "],[8,[39,7],[[16,"autofocus",true],[16,"placeholder",[28,[37,8],["chat.emoji_picker.search_placeholder"],null]],[4,[38,3],[[52,[30,0,["site","desktopView"]],[30,0,["focusFilter"]],[28,[37,4],null,null]]],null],[4,[38,3],[[28,[37,11],[[30,0,["didInputFilter"]],[30,0,["chatEmojiPickerManager","picker","initialFilter"]]],null]],null]],[["@value","@filterAction","@icons","@containerClass"],[[30,0,["chatEmojiPickerManager","picker","initialFilter"]],[28,[37,9],[[30,0,["didInputFilter"]]],null],[28,[37,10],null,[["left"],["magnifying-glass"]]],"chat-emoji-picker__filter"]],[["default"],[[[[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__fitzpatrick-scale"],[24,"role","toolbar"],[4,[38,6],["keyup",[30,0,["didNavigateFitzpatrickScale"]]],null],[12],[1,"\\n"],[41,[30,0,["isExpandedFitzpatrickScale"]],[[[42,[28,[37,13],[[28,[37,13],[[30,0,["fitzpatrickModifiers"]]],null]],null],null,[[[1,"\\n"],[41,[28,[37,14],[[30,5,["scale"]],[30,0,["chatEmojiReactionStore","diversity"]]],null],[[[1,"                "],[11,"button"],[16,"title",[28,[37,15],["t",[30,5,["scale"]]],null]],[24,"tabindex","-1"],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn",[28,[37,15],["t",[30,5,["scale"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,5,["scale"]]],null]],null],[4,[38,6],["click",[28,[37,11],[[30,0,["didRequestFitzpatrickScale"]],[30,5,["scale"]]],null]],null],[12],[1,"\\n                  "],[1,[28,[35,16],["check"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[5]],null]],[]],null],[1,"\\n          "],[11,"button"],[16,"title",[28,[37,15],["t",[30,0,["fitzpatrick","scale"]]],null]],[16,0,[28,[37,2],["chat-emoji-picker__fitzpatrick-modifier-btn current",[28,[37,15],["t",[30,0,["chatEmojiReactionStore","diversity"]]],null]],null]],[24,4,"button"],[4,[38,6],["keyup",[30,0,["didToggleFitzpatrickScale"]]],null],[4,[38,6],["click",[30,0,["didToggleFitzpatrickScale"]]],null],[12],[13],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["chatEmojiPickerManager","sections","length"]],[[[41,[28,[37,1],[[30,0,["filteredEmojis"]],null],null],[[[1,"        "],[10,0],[14,0,"chat-emoji-picker__sections-nav"],[12],[1,"\\n          "],[10,0],[14,0,"chat-emoji-picker__sections-nav__indicator"],[15,5,[30,0,["navIndicatorStyle"]]],[12],[13],[1,"\\n\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[8,[39,18],[[16,0,[28,[37,2],["btn-flat","chat-emoji-picker__section-btn",[52,[28,[37,1],[[30,0,["chatEmojiPickerManager","lastVisibleSection"]],[30,7]],null],"active"]],null]],[24,"tabindex","-1"],[16,5,[30,0,["navBtnStyle"]]],[16,"data-section",[30,7]]],[["@action"],[[28,[37,11],[[30,0,["didRequestSection"]],[30,7]],null]]],[["default"],[[[[1,"\\n"],[41,[28,[37,1],[[30,7],"favorites"],null],[[[1,"                "],[1,[28,[35,19],[":star:"],null]],[1,"\\n"]],[]],[[[1,"                "],[10,"img"],[14,"width","18"],[14,"height","18"],[14,0,"emoji"],[15,"src",[28,[37,20],[[30,6],"0.url"],null]],[12],[13],[1,"\\n"]],[]]],[1,"            "]],[]]]]],[1,"\\n"]],[6,7]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[11,0],[24,0,"chat-emoji-picker__scrollable-content"],[4,[38,21],null,null],[12],[1,"\\n        "],[11,0],[24,0,"chat-emoji-picker__sections"],[24,"role","button"],[4,[38,6],["click",[30,0,["didSelectEmoji"]]],null],[4,[38,6],["keydown",[30,0,["onSectionsKeyDown"]]],null],[12],[1,"\\n"],[41,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],[[[1,"            "],[10,0],[14,0,"chat-emoji-picker__section filtered"],[12],[1,"\\n"],[42,[28,[37,13],[[28,[37,13],[[30,0,["filteredEmojis"]]],null]],null],null,[[[1,"                "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,8],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,8,["name"]]],[15,"data-tonable",[52,[30,8,["tonable"]],"true"]],[15,"alt",[30,8,["name"]]],[15,"title",[28,[37,23],[[30,8],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[8]],[[[1,"                "],[10,2],[14,0,"chat-emoji-picker__no-results"],[12],[1,"\\n                  "],[1,[28,[35,8],["chat.emoji_picker.no_results"],null]],[1,"\\n                "],[13],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[42,[28,[37,17],[[30,0,["groups"]]],null],null,[[[1,"            "],[10,0],[15,0,[28,[37,2],["chat-emoji-picker__section",[52,[28,[37,14],[[30,0,["filteredEmojis"]],null],null],"hidden"]],null]],[15,"data-section",[30,10]],[14,"role","region"],[15,"aria-label",[28,[37,8],[[28,[37,15],["chat.emoji_picker.",[30,10]],null]],[["translatedFallback"],[[30,10]]]]],[12],[1,"\\n              "],[10,"h2"],[14,0,"chat-emoji-picker__section-title"],[12],[1,"\\n                "],[1,[28,[35,8],[[28,[37,15],["chat.emoji_picker.",[30,10]],null]],[["translatedFallback"],[[30,10]]]]],[1,"\\n              "],[13],[1,"\\n              "],[10,0],[14,0,"chat-emoji-picker__section-emojis"],[12],[1,"\\n"],[44,[[28,[37,20],[[30,9],"0"],null]],[[[1,"                  "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,11],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","0"],[15,"data-emoji",[30,11,["name"]]],[15,"data-tonable",[52,[30,11,["tonable"]],"true"]],[15,"alt",[30,11,["name"]]],[15,"title",[28,[37,23],[[30,11],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[11]]],[1,"\\n"],[41,[28,[37,25],[[30,0,["chatEmojiPickerManager","visibleSections"]],[30,10]],null],[[[42,[28,[37,13],[[28,[37,13],[[30,9]],null]],null],null,[[[41,[28,[37,26],[[30,13],0],null],[[[1,"                      "],[10,"img"],[14,"width","32"],[14,"height","32"],[14,0,"emoji"],[15,"src",[28,[37,22],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"tabindex","-1"],[15,"data-emoji",[30,12,["name"]]],[15,"data-tonable",[52,[30,12,["tonable"]],"true"]],[15,"alt",[30,12,["name"]]],[15,"title",[28,[37,23],[[30,12],[30,0,["chatEmojiReactionStore","diversity"]]],null]],[14,"loading","lazy"],[12],[13],[1,"\\n"]],[]],null]],[12,13]],null]],[]],null],[1,"              "],[13],[1,"\\n            "],[13],[1,"\\n"]],[9,10]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,0],[14,0,"spinner medium"],[12],[13],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n\\n"],[41,[28,[37,27],[[30,0,["site","mobileView"]],[28,[37,1],[[30,0,["chatEmojiPickerManager","picker","context"]],"chat-channel-message"],null]],null],[[[1,"    "],[10,0],[14,0,"chat-emoji-picker__backdrop"],[12],[13],[1,"\\n"]],[]],null]],[]],null]],["@context","&attrs","@didInsert","@willDestroy","fitzpatrick","emojis","section","emoji","emojis","section","emoji","emoji","index"],false,["if","eq","concat-class","did-insert","noop","will-destroy","on","dc-filter-input","i18n","with-event-value","hash","fn","each","-track-array","not-eq","concat","d-icon","-each-in","d-button","replace-emoji","get","chat/emoji-picker-scroll-listener","tonable-emoji-url","tonable-emoji-title","let","includes","gt","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-emoji-picker.hbs",isStrictMode:!1}),m=e.FITZPATRICK_MODIFIERS=[{scale:1,modifier:null},{scale:2,modifier:":t2"},{scale:3,modifier:":t3"},{scale:4,modifier:":t4"},{scale:5,modifier:":t5"},{scale:6,modifier:":t6"}]
class g extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[r.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#s=(()=>dt7948.g(this.prototype,"emojiPickerScrollObserver",[r.service]))()
#et=(()=>{dt7948.i(this,"emojiPickerScrollObserver")})()
static#n=(()=>dt7948.g(this.prototype,"chatEmojiReactionStore",[r.service]))()
#ze=(()=>{dt7948.i(this,"chatEmojiReactionStore")})()
static#r=(()=>dt7948.g(this.prototype,"capabilities",[r.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#c=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#l=(()=>dt7948.g(this.prototype,"filteredEmojis",[a.tracked],(function(){return null})))()
#tt=(()=>{dt7948.i(this,"filteredEmojis")})()
static#d=(()=>dt7948.g(this.prototype,"isExpandedFitzpatrickScale",[a.tracked],(function(){return!1})))()
#st=(()=>{dt7948.i(this,"isExpandedFitzpatrickScale")})()
fitzpatrickModifiers=(()=>m)()
get groups(){const e=this.chatEmojiPickerManager.emojis
return{...{favorites:this.chatEmojiReactionStore.favorites.filter((e=>!this.site.denied_emojis?.includes(e))).map((e=>({name:e,group:"favorites",url:(0,c.emojiUrlFor)(e)})))},...e}}get flatEmojis(){if(!this.chatEmojiPickerManager.emojis)return[]
let{favorites:e,...t}=this.chatEmojiPickerManager.emojis
return Object.values(t).flat()}get navIndicatorStyle(){const e=this.chatEmojiPickerManager.lastVisibleSection,t=Object.keys(this.groups).indexOf(e)
return(0,o.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%; transform: translateX(${100*t}%);`)}get navBtnStyle(){return(0,o.htmlSafe)(`width: ${100/Object.keys(this.groups).length}%;`)}trapKeyDownEvents(e){"Escape"===e.key&&this.chatEmojiPickerManager.close(),"ArrowUp"===e.key&&e.stopPropagation(),"ArrowDown"===e.key&&e.target.classList.contains("dc-filter-input")&&(e.stopPropagation(),e.preventDefault(),document.querySelector('.chat-emoji-picker__scrollable-content .emoji[tabindex="0"]')?.focus())}static#h=(()=>dt7948.n(this.prototype,"trapKeyDownEvents",[n.action]))()
didNavigateFitzpatrickScale(e){if("keyup"!==e.type)return
const t=[...e.target.closest(".chat-emoji-picker__fitzpatrick-scale")?.querySelectorAll(".chat-emoji-picker__fitzpatrick-modifier-btn")||[]]
"ArrowRight"===e.key&&(e.preventDefault(),e.target===t[t.length-1]?t[0].focus():e.target.nextElementSibling?.focus()),"ArrowLeft"===e.key&&(e.preventDefault(),e.target===t[0]?t[t.length-1].focus():e.target.previousElementSibling?.focus())}static#u=(()=>dt7948.n(this.prototype,"didNavigateFitzpatrickScale",[n.action]))()
didToggleFitzpatrickScale(e){if("keyup"===e.type){if("Escape"===e.key)return e.preventDefault(),void(this.isExpandedFitzpatrickScale=!1)
if("Enter"!==e.key)return}this.isExpandedFitzpatrickScale=!this.isExpandedFitzpatrickScale}static#p=(()=>dt7948.n(this.prototype,"didToggleFitzpatrickScale",[n.action]))()
didRequestFitzpatrickScale(e,t){if("keyup"===t.type){if("Escape"===t.key)return t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,void this._focusCurrentFitzpatrickScale()
if("Enter"!==t.key)return}t.preventDefault(),t.stopPropagation(),this.isExpandedFitzpatrickScale=!1,this.chatEmojiReactionStore.diversity=e,this._focusCurrentFitzpatrickScale()}static#j=(()=>dt7948.n(this.prototype,"didRequestFitzpatrickScale",[n.action]))()
_focusCurrentFitzpatrickScale(){(0,i.schedule)("afterRender",(()=>{document.querySelector(".chat-emoji-picker__fitzpatrick-modifier-btn.current")?.focus()}))}didInputFilter(e){e?.length?(0,d.default)(this,this.debouncedDidInputFilter,e,l.INPUT_DELAY):this.filteredEmojis=null}static#P=(()=>dt7948.n(this.prototype,"didInputFilter",[n.action]))()
focusFilter(e){(0,i.schedule)("afterRender",(()=>{e?.focus({preventScroll:!0})}))}static#O=(()=>dt7948.n(this.prototype,"focusFilter",[n.action]))()
debouncedDidInputFilter(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:""
e=e.toLowerCase(),this.filteredEmojis=this.flatEmojis.filter((t=>t.name.toLowerCase().includes(e)||t.search_aliases?.any((t=>t.toLowerCase().includes(e))))),(0,i.schedule)("afterRender",(()=>{const e=document.querySelector(".chat-emoji-picker__scrollable-content")
e&&(e.scrollTop=0)}))}onSectionsKeyDown(e){"Enter"===e.key?this.didSelectEmoji(e):this.didNavigateSection(e)}static#D=(()=>dt7948.n(this.prototype,"onSectionsKeyDown",[n.action]))()
didNavigateSection(e){const t=e=>[...e.querySelectorAll(".emoji")],s=e=>{t(e)[0].focus()},a=e.target.closest(".chat-emoji-picker__section"),n=()=>{document.querySelector(".dc-filter-input")?.focus()},i=()=>[...document.querySelectorAll(".chat-emoji-picker__section:not(.hidden) .emoji")]
if("ArrowRight"===e.key){e.preventDefault()
const t=e.target.nextElementSibling
if(t)t.focus()
else{const e=a.nextElementSibling
e&&s(e)}}if("ArrowLeft"===e.key){e.preventDefault()
const s=e.target.previousElementSibling
if(s)s.focus()
else{const e=a.previousElementSibling
e?(e=>{const s=t(e)
s[s.length-1].focus()})(e):n()}}if("ArrowDown"===e.key){e.preventDefault(),e.stopPropagation()
const t=i().filter((t=>t.offsetTop>e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
if(t)t.focus()
else{const e=a.nextElementSibling
e&&s(e)}}if("ArrowUp"===e.key){e.preventDefault(),e.stopPropagation()
const t=i().reverse().filter((t=>t.offsetTop<e.target.offsetTop)).findBy("offsetLeft",e.target.offsetLeft)
t?t.focus():n()}}static#I=(()=>dt7948.n(this.prototype,"didNavigateSection",[n.action]))()
didSelectEmoji(e){if(e.target.classList.contains("emoji")&&("click"===e.type||"Enter"===e.key)){e.preventDefault(),e.stopPropagation()
let t=e.target.dataset.emoji
const s=e.target.dataset.tonable,a=this.chatEmojiReactionStore.diversity
s&&a>1&&(t=`${t}:t${a}`),this.args.didSelectEmoji?.(t)}}static#R=(()=>dt7948.n(this.prototype,"didSelectEmoji",[n.action]))()
didRequestSection(e){const t=document.querySelector(".chat-emoji-picker__scrollable-content")
this.filteredEmojis=null,this.emojiPickerScrollObserver.enabled=!1,this.chatEmojiPickerManager.addVisibleSections([e]),this.chatEmojiPickerManager.lastVisibleSection=e,t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="hidden"),(0,i.schedule)("afterRender",(()=>{const s=document.querySelector(`.chat-emoji-picker__section[data-section="${e}"] .emoji:nth-child(1)`);([...document.querySelectorAll(`.chat-emoji-picker__section[data-section="${e}"] .emoji`)].find((e=>e.offsetTop>s.offsetTop))||s).focus(),(0,i.later)((()=>{t&&this.capabilities.isIOS&&(document.querySelector(".chat-emoji-picker__scrollable-content").style.overflow="scroll"),this.emojiPickerScrollObserver.enabled=!0}),200)}))}static#N=(()=>dt7948.n(this.prototype,"didRequestSection",[n.action]))()
addClickOutsideEventListener(){document.addEventListener("click",this.didClickOutside)}static#B=(()=>dt7948.n(this.prototype,"addClickOutsideEventListener",[n.action]))()
removeClickOutsideEventListener(){document.removeEventListener("click",this.didClickOutside)}static#H=(()=>dt7948.n(this.prototype,"removeClickOutsideEventListener",[n.action]))()
didClickOutside(e){e.target.closest(".chat-emoji-picker")||this.chatEmojiPickerManager.close()}static#z=(()=>dt7948.n(this.prototype,"didClickOutside",[h.bind]))()}e.default=g,(0,t.setComponentTemplate)(p,g)})),define("discourse/plugins/chat/discourse/components/chat-footer",["exports","@glimmer/component","@ember/service","truth-helpers","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/footer/unread-indicator","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#n=(()=>dt7948.g(this.prototype,"chatHistory",[s.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#r=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#c=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#l=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#d=(()=>dt7948.g(this.prototype,"chatChannelsManager",[s.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#h=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
get includeThreads(){return!!this.siteSettings.chat_threads_enabled&&this.chatChannelsManager.hasThreadedChannels}get directMessagesEnabled(){return this.chat.userCanAccessDirectMessages}get currentRouteName(){const e=this.chatHistory.currentRoute?.name
return"chat"===e?"chat.channels":e}get enabledRouteCount(){return[this.includeThreads,this.directMessagesEnabled,this.siteSettings.enable_public_channels].filter(Boolean).length}get shouldRenderFooter(){return(this.site.mobileView||this.chatStateManager.isDrawerExpanded)&&this.chatStateManager.hasPreloadedChannels&&this.enabledRouteCount>1}static#u=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"3LZPbP4o",block:'[[[1,"\\n"],[41,[30,0,["shouldRenderFooter"]],[[[1,"      "],[10,"nav"],[14,0,"c-footer"],[12],[1,"\\n        "],[8,[32,0],[[16,"aria-label",[28,[32,1],["chat.channel_list.aria_label"],null]],[24,1,"c-footer-channels"],[16,0,[28,[32,2],["btn-transparent","c-footer__item",[52,[28,[32,3],[[30,0,["currentRouteName"]],"chat.channels"],null],"--active"]],null]]],[["@route","@icon","@translatedLabel"],["chat.channels","comments",[28,[32,1],["chat.channel_list.title"],null]]],[["default"],[[[[1,"\\n          "],[8,[32,4],null,null,null],[1,"\\n        "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["directMessagesEnabled"]],[[[1,"          "],[8,[32,0],[[16,"aria-label",[28,[32,1],["chat.direct_messages.aria_label"],null]],[24,1,"c-footer-direct-messages"],[16,0,[28,[32,2],["btn-transparent","c-footer__item",[52,[28,[32,3],[[30,0,["currentRouteName"]],"chat.direct-messages"],null],"--active"]],null]]],[["@route","@icon","@translatedLabel"],["chat.direct-messages","users",[28,[32,1],["chat.direct_messages.title"],null]]],[["default"],[[[[1,"\\n            "],[8,[32,5],null,null,null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["includeThreads"]],[[[1,"          "],[8,[32,0],[[16,"aria-label",[28,[32,1],["chat.my_threads.aria_label"],null]],[24,1,"c-footer-threads"],[16,0,[28,[32,2],["btn-transparent","c-footer__item",[52,[28,[32,3],[[30,0,["currentRouteName"]],"chat.threads"],null],"--active"]],null]]],[["@route","@icon","@translatedLabel"],["chat.threads","discourse-threads",[28,[32,1],["chat.my_threads.title"],null]]],[["default"],[[[[1,"\\n            "],[8,[32,6],null,null,null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-footer.js",scope:()=>[n.default,r.default,i.default,a.eq,o.UnreadChannelsIndicator,o.UnreadDirectMessagesIndicator,o.UnreadThreadsIndicator],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat-header",["exports","@glimmer/component","@glimmer/tracking","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-common/lib/get-url","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#n=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"previousURL",[s.tracked]))()
#nt=(()=>{dt7948.i(this,"previousURL")})()
title=(()=>o.default.t("chat.back_to_forum"))()
heading=(()=>o.default.t("chat.heading"))()
constructor(){super(...arguments),this.router.on("routeDidChange",this,this.#it)}get shouldRender(){return this.siteSettings.chat_enabled&&this.site.mobileView&&this.isChatOpen}willDestroy(){super.willDestroy(...arguments),this.router.off("routeDidChange",this,this.#it)}get isChatOpen(){return this.router.currentURL.startsWith("/chat")}get forumLink(){return(0,r.default)(this.previousURL??this.router.rootURL)}#it(){this.isChatOpen||(this.previousURL=this.router.currentURL)}static#c=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"Cw+adMhm",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[10,0],[14,0,"c-header"],[12],[1,"\\n        "],[10,3],[15,6,[30,0,["forumLink"]]],[14,0,"btn-flat back-to-forum"],[15,"title",[30,0,["title"]]],[12],[1,"\\n          "],[1,[28,[32,0],["arrow-left"],null]],[1,"\\n          "],[1,[30,0,["title"]]],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,1],[[24,0,"c-heading"]],[["@route"],["chat.index"]],[["default"],[[[[1,[30,0,["heading"]]]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[18,1,null],[1,"\\n"]],[]]],[1,"  "]],["&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-header.js",scope:()=>[i.default,a.LinkTo],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat-mention-warnings",["exports","@glimmer/component","@ember/service","@ember/template","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-common/lib/get-url","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#s=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#n=(()=>dt7948.g(this.prototype,"chatComposerWarningsTracker",[s.service]))()
#He=(()=>{dt7948.i(this,"chatComposerWarningsTracker")})()
get unreachableGroupMentions(){return this.chatComposerWarningsTracker.unreachableGroupMentions}get overMembersLimitGroupMentions(){return this.chatComposerWarningsTracker.overMembersLimitGroupMentions}get hasTooManyMentions(){return this.chatComposerWarningsTracker.tooManyMentions}get channelWideMentionDisallowed(){return this.chatComposerWarningsTracker.channelWideMentionDisallowed}get mentionsCount(){return this.chatComposerWarningsTracker.mentionsCount}get unreachableGroupMentionsCount(){return this.unreachableGroupMentions.length}get overMembersLimitMentionsCount(){return this.overMembersLimitGroupMentions.length}get hasUnreachableGroupMentions(){return this.unreachableGroupMentionsCount>0}get hasOverMembersLimitGroupMentions(){return this.overMembersLimitMentionsCount>0}get warningsCount(){return this.unreachableGroupMentionsCount+this.overMembersLimitMentionsCount}get show(){return this.hasTooManyMentions||this.channelWideMentionDisallowed||this.hasUnreachableGroupMentions||this.hasOverMembersLimitGroupMentions}get listStyleClass(){return this.hasTooManyMentions?"chat-mention-warnings-list__simple":this.warningsCount>1?"chat-mention-warnings-list__multiple":"chat-mention-warnings-list__simple"}get warningHeaderText(){return this.mentionsCount<=this.warningsCount||this.hasTooManyMentions?o.default.t("chat.mention_warning.groups.header.all"):o.default.t("chat.mention_warning.groups.header.some")}get tooManyMentionsBody(){if(this.hasTooManyMentions)return this.currentUser.admin?(0,a.htmlSafe)(o.default.t("chat.mention_warning.too_many_mentions_admin",{count:this.siteSettings.max_mentions_per_chat_message,siteSettingUrl:(0,r.default)("/admin/site_settings/category/plugins?filter=max_mentions_per_chat_message")})):(0,a.htmlSafe)(o.default.t("chat.mention_warning.too_many_mentions",{count:this.siteSettings.max_mentions_per_chat_message}))}get unreachableBody(){if(this.hasUnreachableGroupMentions)switch(this.unreachableGroupMentionsCount){case 1:return o.default.t("chat.mention_warning.groups.unreachable_1",{group:this.unreachableGroupMentions[0]})
case 2:return o.default.t("chat.mention_warning.groups.unreachable_2",{group1:this.unreachableGroupMentions[0],group2:this.unreachableGroupMentions[1]})
default:return o.default.t("chat.mention_warning.groups.unreachable_multiple",{group:this.unreachableGroupMentions[0],count:this.unreachableGroupMentionsCount-1})}}get overMembersLimitBody(){if(this.hasOverMembersLimitGroupMentions)return(0,a.htmlSafe)(o.default.messageFormat("chat.mention_warning.groups.too_many_members_MF",{groupCount:this.overMembersLimitMentionsCount,isAdmin:this.currentUser.admin,siteSettingUrl:(0,r.default)("/admin/site_settings/category/plugins?filter=max_users_notified_per_group_mention"),notificationLimit:this.siteSettings.max_users_notified_per_group_mention,group1:this.overMembersLimitGroupMentions[0],group2:this.overMembersLimitGroupMentions[1]}))}static#r=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"MvGWhoP2",block:'[[[1,"\\n"],[41,[30,0,["show"]],[[[1,"      "],[10,0],[14,0,"chat-mention-warnings"],[12],[1,"\\n        "],[10,0],[14,0,"chat-mention-warning__icon"],[12],[1,"\\n          "],[1,[28,[32,0],["triangle-exclamation"],null]],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-mention-warning__text"],[12],[1,"\\n          "],[10,0],[14,0,"chat-mention-warning__header"],[12],[1,"\\n            "],[1,[30,0,["warningHeaderText"]]],[1,"\\n          "],[13],[1,"\\n          "],[10,"ul"],[15,0,[30,0,["listStyleClass"]]],[12],[1,"\\n"],[41,[30,0,["hasTooManyMentions"]],[[[1,"              "],[10,"li"],[12],[1,[30,0,["tooManyMentionsBody"]]],[13],[1,"\\n"]],[]],[[[41,[30,0,["channelWideMentionDisallowed"]],[[[1,"                "],[10,"li"],[12],[1,[28,[32,1],["chat.mention_warning.channel_wide_mentions_disallowed"],null]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasUnreachableGroupMentions"]],[[[1,"                "],[10,"li"],[12],[1,[30,0,["unreachableBody"]]],[13],[1,"\\n"]],[]],null],[41,[30,0,["hasOverMembersLimitGroupMentions"]],[[[1,"                "],[10,"li"],[12],[1,[30,0,["overMembersLimitBody"]]],[13],[1,"\\n"]],[]],null]],[]]],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-mention-warnings.js",scope:()=>[n.default,i.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat-message-actions-desktop",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","@popperjs/core","truth-helpers","discourse/components/bookmark-icon","discourse/components/d-button","discourse/helpers/concat-class","select-kit/components/dropdown-select-box","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/lib/chat-message-container","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const w="full"
class S extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[h.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[h.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#n=(()=>dt7948.g(this.prototype,"site",[h.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#r=(()=>dt7948.g(this.prototype,"size",[s.tracked],(function(){return w})))()
#rt=(()=>{dt7948.i(this,"size")})()
popper=null
get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new y.default((0,r.getOwner)(this),this.message,this.context)}get shouldRenderFavoriteReactions(){return this.size===w}onWheel(){this.chat.activeMessage=null}static#c=(()=>dt7948.n(this.prototype,"onWheel",[i.action]))()
setup(e){this.popper?.destroy(),(0,d.schedule)("afterRender",(()=>{const t=(0,v.default)(this.message.id,this.context)
if(!t)return
const s=t.closest(".popper-viewport")
this.size=s.clientWidth<500?"reduced":w,t&&(this.popper=(0,u.createPopper)(t,e,{placement:"top-end",strategy:"fixed",modifiers:[{name:"flip",enabled:!0,options:{boundary:s,fallbackPlacements:["bottom-end"]}},{name:"hide",enabled:!0},{name:"eventListeners",options:{scroll:!1}},{name:"offset",options:{offset:[-2,-10]}}]}))}))}static#l=(()=>dt7948.n(this.prototype,"setup",[i.action]))()
teardown(){this.popper?.destroy(),this.popper=null}static#d=(()=>dt7948.n(this.prototype,"teardown",[i.action]))()
static#h=(()=>(0,M.setComponentTemplate)((0,C.createTemplateFactory)({id:"rzsE0a3s",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","desktopView"]],[30,0,["chat","activeMessage","model","persisted"]]],null],[[[1,"      "],[11,0],[16,0,[28,[32,1],["chat-message-actions-container",[28,[32,2],["is-size-",[30,0,["size"]]],null]],null]],[16,"data-id",[30,0,["message","id"]]],[4,[32,3],[[30,0,["setup"]]],null],[4,[32,4],[[30,0,["setup"]],[30,0,["chat","activeMessage","model","id"]]],null],[4,[32,5],["wheel",[30,0,["onWheel"]]],[["passive"],[true]]],[4,[32,6],[[30,0,["teardown"]]],null],[12],[1,"\\n        "],[10,0],[15,0,[28,[32,1],["chat-message-actions",[52,[51,[30,0,["messageInteractor","secondaryActions","length"]]],"has-no-secondary-actions"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldRenderFavoriteReactions"]],[[[42,[28,[31,3],[[28,[31,3],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],"emoji",[[[1,"              "],[8,[32,7],null,[["@reaction","@onReaction","@message","@showCount","@disableTooltip"],[[30,1],[30,0,["messageInteractor","react"]],[30,0,["message"]],false,true]],null],[1,"\\n"]],[1]],null]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canInteractWithMessage"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat bookmark-btn"]],[["@action","@translatedTitle"],[[30,0,["messageInteractor","toggleBookmark"]],[30,0,["message","bookmark","reminderTitle"]]]],[["default"],[[[[1,"\\n              "],[8,[32,9],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"            "],[8,[32,8],[[24,0,"btn-flat reply-btn"]],[["@action","@icon","@title"],[[30,0,["messageInteractor","reply"]],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,0],[[30,0,["messageInteractor","message"]],[30,0,["messageInteractor","secondaryActions","length"]]],null],[[[1,"            "],[8,[32,10],[[24,0,"more-buttons secondary-actions"]],[["@options","@content","@onChange"],[[28,[32,11],null,[["icon","placement","customStyle","btnCustomClasses"],["ellipsis-vertical","left","true","btn-flat"]]],[30,0,["messageInteractor","secondaryActions"]],[30,0,["messageInteractor","handleSecondaryActions"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["reaction"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-actions-desktop.js",scope:()=>[p.and,f.default,a.concat,o.default,c.default,n.on,l.default,b.default,g.default,m.default,_.default,a.hash],isStrictMode:!0}),this))()}e.default=S})),define("discourse/plugins/chat/discourse/components/chat-message-actions-mobile",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/service","truth-helpers","discourse/components/bookmark-icon","discourse/components/d-button","discourse/components/d-modal","discourse/helpers/concat-class","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/lib/chat-message-interactor","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class v extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[c.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"site",[c.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"capabilities",[c.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#r=(()=>dt7948.g(this.prototype,"hasExpandedReply",[s.tracked],(function(){return!1})))()
#ot=(()=>{dt7948.i(this,"hasExpandedReply")})()
get message(){return this.chat.activeMessage.model}get context(){return this.chat.activeMessage.context}get messageInteractor(){return new f.default((0,r.getOwner)(this),this.message,this.context)}vibrate(){this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5)}static#c=(()=>dt7948.n(this.prototype,"vibrate",[i.action]))()
expandReply(e){e.stopPropagation(),this.hasExpandedReply=!0}static#l=(()=>dt7948.n(this.prototype,"expandReply",[i.action]))()
collapseMenu(e){e.preventDefault(),this.args.closeModal()}static#d=(()=>dt7948.n(this.prototype,"collapseMenu",[i.action]))()
actAndCloseMenu(e){this.args.closeModal(),this.messageInteractor[e]()}static#h=(()=>dt7948.n(this.prototype,"actAndCloseMenu",[i.action]))()
react(e,t){this.args.closeModal(),this.messageInteractor.react(e,t)}static#u=(()=>dt7948.n(this.prototype,"react",[i.action]))()
openEmojiPicker(e,t){this.args.closeModal(),this.messageInteractor.openEmojiPicker(e,t)}static#p=(()=>dt7948.n(this.prototype,"openEmojiPicker",[i.action]))()
static#j=(()=>(0,_.setComponentTemplate)((0,b.createTemplateFactory)({id:"p0zzYxDK",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["site","mobileView"]],[30,0,["chat","activeMessage","model","persisted"]]],null],[[[1,"      "],[8,[32,1],[[24,0,"chat-message-actions"],[4,[32,2],[[30,0,["vibrate"]]],null]],[["@closeModal","@headerClass"],[[30,1],"hidden"]],[["body"],[[[[1,"\\n          "],[10,0],[14,0,"selected-message-container"],[12],[1,"\\n            "],[10,0],[14,0,"selected-message"],[12],[1,"\\n              "],[8,[32,3],null,[["@user"],[[30,0,["message","user"]]]],null],[1,"\\n              "],[11,1],[24,"role","button"],[16,0,[28,[32,4],["selected-message-reply",[52,[30,0,["hasExpandedReply"]],"is-expanded"]],null]],[4,[32,5],["touchstart",[30,0,["expandReply"]]],[["passive"],[true]]],[12],[1,"\\n                "],[1,[30,0,["message","message"]]],[1,"\\n              "],[13],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,"ul"],[14,0,"secondary-actions"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["messageInteractor","secondaryActions"]]],null]],null],null,[[[1,"              "],[10,"li"],[14,0,"chat-message-action-item"],[15,"data-id",[30,2,["id"]]],[12],[1,"\\n                "],[8,[32,6],[[24,0,"chat-message-action"]],[["@translatedLabel","@icon","@action"],[[30,2,["name"]],[30,2,["icon"]],[28,[32,7],[[30,0,["actAndCloseMenu"]],[30,2,["id"]]],null]]],null],[1,"\\n              "],[13],[1,"\\n"]],[2]],null],[1,"          "],[13],[1,"\\n\\n"],[41,[28,[32,8],[[30,0,["messageInteractor","canReact"]],[30,0,["messageInteractor","canReply"]]],null],[[[1,"            "],[10,0],[14,0,"main-actions"],[12],[1,"\\n"],[41,[30,0,["messageInteractor","canReact"]],[[[42,[28,[31,2],[[28,[31,2],[[30,0,["messageInteractor","emojiReactions"]]],null]],null],null,[[[1,"                  "],[8,[32,9],null,[["@reaction","@onReaction","@message","@showCount"],[[30,3],[30,0,["react"]],[30,0,["message"]],false]],null],[1,"\\n"]],[3]],null],[1,"\\n                "],[8,[32,6],[[24,"data-id","react"],[24,0,"btn-flat react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canBookmark"]],[[[1,"                "],[8,[32,6],[[24,"data-id","bookmark"],[24,0,"btn-flat bookmark-btn"]],[["@action"],[[28,[32,7],[[30,0,["actAndCloseMenu"]],"toggleBookmark"],null]]],[["default"],[[[[1,"\\n                  "],[8,[32,10],null,[["@bookmark"],[[30,0,["message","bookmark"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["messageInteractor","canReply"]],[[[1,"                "],[8,[32,6],[[24,"data-id","reply"],[24,0,"chat-message-action reply-btn btn-flat"]],[["@action","@icon","@title"],[[28,[32,7],[[30,0,["actAndCloseMenu"]],"reply"],null],"reply","chat.reply"]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n"]],[]],null],[1,"        "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@closeModal","button","reaction"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-actions-mobile.js",scope:()=>[l.and,u.default,o.default,g.default,p.default,n.on,h.default,a.fn,l.or,m.default,d.default],isStrictMode:!0}),this))()}e.default=v})),define("discourse/plugins/chat/discourse/components/chat-message-collapser",["exports","@ember/component","@glimmer/component","@ember/service","@ember/template","discourse/lib/utilities","discourse-common/lib/dom-from-string","discourse-i18n","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.isCollapsible=function(e,t){const s=Array.prototype.slice.call((0,r.default)(e))
return u(s)||g(s)||f(t)||b(s)||y(s)}
const l=(0,c.createTemplateFactory)({id:"0kb4UYGW",block:'[[[10,0],[14,0,"chat-message-collapser"],[12],[1,"\\n"],[41,[30,0,["hasUploads"]],[[[1,"    "],[1,[28,[35,1],[[30,1]],null]],[1,"\\n\\n    "],[8,[39,2],null,[["@header","@onToggle"],[[30,0,["uploadsHeader"]],[30,2]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-uploads"],[12],[1,"\\n"],[42,[28,[37,4],[[28,[37,4],[[30,3]],null]],null],null,[[[1,"          "],[8,[39,5],null,[["@upload"],[[30,4]]],null],[1,"\\n"]],[4]],null],[1,"      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[42,[28,[37,4],[[28,[37,4],[[30,0,["cookedBodies"]]],null]],null],null,[[[41,[30,5,["needsCollapser"]],[[[1,"        "],[8,[39,2],null,[["@header","@onToggle"],[[30,5,["header"]],[30,2]]],[["default"],[[[[1,"\\n"],[41,[30,5,["videoAttributes"]],[[[1,"            "],[10,0],[14,0,"chat-message-collapser-lazy-video"],[12],[1,"\\n              "],[8,[39,6],null,[["@videoAttributes"],[[30,5,["videoAttributes"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[1,[30,5,["body"]]],[1,"\\n"]],[]]],[1,"        "]],[]]]]],[1,"\\n"]],[]],[[[1,"        "],[1,[30,5,["body"]]],[1,"\\n"]],[]]]],[5]],null]],[]]],[13]],["@cooked","@onToggleCollapse","@uploads","upload","cooked"],false,["if","html-safe","collapser","each","-track-array","chat-upload","lazy-video"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-message-collapser.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[a.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get hasUploads(){return f(this.args.uploads)}get uploadsHeader(){let e=""
return e=1===this.args.uploads.length?this.args.uploads[0].original_filename:o.default.t("chat.uploaded_files",{count:this.args.uploads.length}),(0,n.htmlSafe)(`<span class="chat-message-collapser-link-small">${(0,i.escapeExpression)(e)}</span>`)}get cookedBodies(){const e=Array.prototype.slice.call((0,r.default)(this.args.cooked))
return u(e)?this.lazyVideoCooked(e):g(e)?this.imageOneboxCooked(e):b(e)?this.imageCooked(e):y(e)?this.galleryCooked(e):[]}lazyVideoCooked(e){return e.reduce(((e,t)=>{if(this.siteSettings.lazy_videos_enabled&&h(t)){const s=(0,requirejs("discourse/plugins/discourse-lazy-videos/lib/lazy-video-attributes").default)(t)
if(this.siteSettings[`lazy_${s.providerName}_enabled`]){const a=(0,i.escapeExpression)(s.url),r=s.title,o=(0,n.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link" rel="noopener noreferrer" href="${a}">${r}</a>`)
e.push({header:o,body:t,videoAttributes:s,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageOneboxCooked(e){return e.reduce(((e,t)=>{if(m(t)){let s=p(t)?t.firstChild.src:t.firstElementChild.href
s=(0,i.escapeExpression)(s)
const a=(0,n.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${s}">${s}</a>`)
e.push({header:a,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}imageCooked(e){return e.reduce(((e,t)=>{if(_(t)){const s=(0,i.escapeExpression)(t.firstElementChild.src),a=(0,i.escapeExpression)(t.firstElementChild.alt),r=(0,n.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${s}">${a||s}</a>`)
e.push({header:r,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}galleryCooked(e){return e.reduce(((e,t)=>{if(v(t)){const s=(0,i.escapeExpression)(t.firstElementChild.href),a=(0,i.escapeExpression)(t.firstElementChild.firstElementChild.textContent)
t.firstElementChild.removeChild(t.firstElementChild.firstElementChild)
const r=(0,n.htmlSafe)(`<a target="_blank" class="chat-message-collapser-link-small" rel="noopener noreferrer" href="${s}">${a}</a>`)
e.push({header:r,body:t,needsCollapser:!0})}else e.push({body:t,needsCollapser:!1})
return e}),[])}}function h(e){return e.classList.contains("lazy-video-container")}function u(e){return e.some((e=>h(e)))}function p(e){return e.firstChild&&"IMG"===e.firstChild.nodeName&&e.firstChild.classList.contains("animated")&&e.firstChild.classList.contains("onebox")}function m(e){return p(e)||function(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.classList.contains("onebox")&&e.firstElementChild.firstElementChild&&"IMG"===e.firstElementChild.firstElementChild.nodeName}(e)}function g(e){return e.some((e=>m(e)))}function f(e){return e?.length>0}function _(e){return"P"===e.nodeName&&e.firstElementChild&&"IMG"===e.firstElementChild.nodeName&&!e.firstElementChild.classList.contains("emoji")}function b(e){return e.some((e=>_(e)))}function v(e){return e.firstElementChild&&"A"===e.firstElementChild.nodeName&&e.firstElementChild.firstElementChild&&e.firstElementChild.firstElementChild.classList.contains("outer-box")}function y(e){return e.some((e=>v(e)))}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator",["exports","@glimmer/component","@ember/routing","@ember/service","@ember/template","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat-emoji-avatar","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get route(){return this.hasThread?"chat.channel.thread":"chat.channel.near-message"}get model(){return this.hasThread?[...this.args.message.channel.routeModels,this.args.message.thread.id]:[...this.args.message.channel.routeModels,this.args.message.inReplyTo.id]}get hasThread(){return this.args.message?.channel?.threadingEnabled&&this.args.message?.thread?.id}static#s=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"zfH8D9bT",block:'[[[1,"\\n"],[41,[30,1,["inReplyTo"]],[[[1,"      "],[8,[32,0],[[24,0,"chat-reply is-direct-reply"]],[["@route","@models"],[[30,0,["route"]],[30,0,["model"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["share"],[["title"],["chat.in_reply_to"]]]],[1,"\\n\\n"],[41,[30,1,["inReplyTo","chatWebhookEvent","emoji"]],[[[1,"          "],[8,[32,2],null,[["@emoji"],[[30,1,["inReplyTo","chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[32,3],null,[["@user"],[[30,1,["inReplyTo","user"]]]],null],[1,"\\n"]],[]]],[1,"\\n        "],[10,1],[14,0,"chat-reply__excerpt"],[12],[1,"\\n          "],[1,[28,[32,4],[[28,[32,5],[[30,1,["inReplyTo","excerpt"]]],null]],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator.js",scope:()=>[s.LinkTo,r.default,o.default,c.default,i.default,n.htmlSafe],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat-message-reaction",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","@ember/template","ember-modifier","truth-helpers","discourse/helpers/concat-class","discourse/lib/text","discourse/plugins/chat/discourse/lib/get-reaction-text","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"site",[i.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"tooltip",[i.service]))()
#ct=(()=>{dt7948.i(this,"tooltip")})()
registerTooltip=(()=>(0,o.modifier)((e=>{if(this.args.disableTooltip||!this.popoverContent?.length)return
const t=this.tooltip.register(e,{content:(0,r.htmlSafe)(this.popoverContent),identifier:"chat-message-reaction-tooltip",animated:!1,placement:"top",fallbackPlacements:["bottom"],triggers:this.site.mobileView?["hold"]:["hover"]})
return()=>{t.destroy()}})))()
get showCount(){return this.args.showCount??!0}get emojiString(){return`:${this.args.reaction.emoji}:`}get emojiUrl(){return(0,d.emojiUrlFor)(this.args.reaction.emoji)}handleClick(e){e.stopPropagation(),this.args.onReaction?.(this.args.reaction.emoji,this.args.reaction.reacted?"remove":"add")}static#r=(()=>dt7948.n(this.prototype,"handleClick",[n.action]))()
get popoverContent(){if(this.args.reaction.count&&this.args.reaction.users?.length)return(0,d.emojiUnescape)((0,h.getReactionText)(this.args.reaction,this.currentUser))}static#c=(()=>dt7948.n(this.prototype,"popoverContent",[s.cached]))()
static#l=(()=>(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"OAZengKh",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,1],[30,0,["emojiUrl"]]],null],[[[1,"      "],[11,"button"],[16,"title",[30,0,["emojiString"]]],[16,"data-emoji-name",[30,1,["emoji"]]],[24,"tabindex","0"],[16,0,[28,[32,1],["chat-message-reaction",[52,[30,1,["reacted"]],"reacted"]],null]],[24,4,"button"],[4,[32,2],["click",[30,0,["handleClick"]]],[["passive"],[true]]],[4,[30,0,["registerTooltip"]],null,null],[12],[1,"\\n        "],[10,"img"],[14,"loading","lazy"],[14,0,"emoji"],[14,"width","20"],[14,"height","20"],[15,"alt",[30,0,["emojiString"]]],[15,"src",[30,0,["emojiUrl"]]],[12],[13],[1,"\\n\\n"],[41,[28,[32,0],[[30,0,["showCount"]],[30,1,["count"]]],null],[[[1,"          "],[10,1],[14,0,"count"],[12],[1,[30,1,["count"]]],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@reaction"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-reaction.js",scope:()=>[c.and,l.default,a.on],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/chat/discourse/components/chat-message-separator",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","ember-modifier","discourse/helpers/concat-class","discourse-common/helpers/i18n","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h="is-pinned"
class u extends t.default{track=(()=>(0,i.modifier)((e=>{const t=new IntersectionObserver((e=>{let[t]=e
t.isIntersecting&&t.intersectionRatio<1&&t.boundingClientRect.y<t.intersectionRect.y?t.target.classList.add(h):t.target.classList.remove(h)}),{threshold:[0,1]})
return t.observe(e),()=>{t?.disconnect()}})))()
onDateClick(){return this.args.fetchMessagesByDate?.(this.firstMessageOfTheDayAt)}static#e=(()=>dt7948.n(this.prototype,"onDateClick",[n.action]))()
get firstMessageOfTheDayAt(){const e=this.args.message
return e.previousMessage&&this.#lt(e.previousMessage.createdAt,e.createdAt)?void 0:this.#dt(e.createdAt)}static#s=(()=>dt7948.n(this.prototype,"firstMessageOfTheDayAt",[s.cached]))()
get formattedFirstMessageDate(){if(this.firstMessageOfTheDayAt)return this.#ht(this.firstMessageOfTheDayAt)}static#n=(()=>dt7948.n(this.prototype,"formattedFirstMessageDate",[s.cached]))()
#lt(e,t){return e.getFullYear()===t.getFullYear()&&e.getMonth()===t.getMonth()&&e.getDate()===t.getDate()}#dt(e){return moment(e).startOf("day").format()}#ht(e){return moment(e).calendar(moment(),{sameDay:`[${c.default.t("chat.chat_message_separator.today")}]`,lastDay:`[${c.default.t("chat.chat_message_separator.yesterday")}]`,lastWeek:"LL",sameElse:"LL"})}static#r=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"Ld2OGiuY",block:'[[[1,"\\n"],[41,[30,0,["formattedFirstMessageDate"]],[[[1,"      "],[11,0],[16,0,[28,[32,0],["chat-message-separator-date",[52,[30,1,["newest"]],"with-last-visit"]],null]],[24,"role","button"],[4,[32,1],["click",[30,0,["onDateClick"]]],[["passive"],[true]]],[12],[1,"\\n        "],[11,0],[24,0,"chat-message-separator__text-container"],[4,[30,0,["track"]],null,null],[12],[1,"\\n          "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n            "],[1,[30,0,["formattedFirstMessageDate"]]],[1,"\\n\\n"],[41,[30,1,["newest"]],[[[1,"              "],[10,1],[14,0,"chat-message-separator__last-visit"],[12],[1,"\\n                "],[10,1],[14,0,"chat-message-separator__last-visit-separator"],[12],[1,"-"],[13],[1,"\\n                "],[1,[28,[32,2],["chat.last_visit"],null]],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,1,["newest"]],[[[1,"      "],[10,0],[14,0,"chat-message-separator-new"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-separator__text-container"],[12],[1,"\\n          "],[10,1],[14,0,"chat-message-separator__text"],[12],[1,"\\n            "],[1,[28,[32,2],["chat.last_visit"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"chat-message-separator__line-container"],[12],[1,"\\n          "],[10,0],[14,0,"chat-message-separator__line"],[12],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-separator.js",scope:()=>[r.default,a.on,o.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat-message-text",["exports","@glimmer/component","@ember/template","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat-message-collapser","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get isEdited(){return this.args.edited??!1}get isCollapsible(){return(0,n.isCollapsible)(this.args.cooked,this.args.uploads)}static#e=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"uDFmalJR",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-text"],[12],[1,"\\n"],[41,[30,0,["isCollapsible"]],[[[1,"        "],[8,[32,0],null,[["@cooked","@uploads","@onToggleCollapse"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],[[[1,"        "],[1,[28,[32,1],[[30,1]],null]],[1,"\\n"]],[]]],[1,"\\n"],[41,[30,0,["isEdited"]],[[[1,"        "],[10,1],[14,0,"chat-message-edited"],[12],[1,"("],[1,[28,[32,2],["chat.edited"],null]],[1,")"],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[18,4,null],[1,"\\n    "],[13],[1,"\\n  "]],["@cooked","@uploads","@onToggleCollapse","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-text.js",scope:()=>[n.default,s.htmlSafe,a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat-message-thread-indicator",["exports","@glimmer/component","@ember/routing","@ember/template","discourse/helpers/format-date","discourse/helpers/replace-emoji","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat-thread-participants","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{get interactiveUser(){return this.args.interactiveUser??!0}get threadMessageRoute(){return[...this.args.message.thread.routeModels,this.args.message.thread.preview.lastReplyId]}static#e=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"Gc6fstT2",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-message-thread-indicator"],[16,"title",[28,[32,1],["chat.threads.open"],null]],[24,"tabindex","0"],[17,1]],[["@route","@models"],["chat.channel.thread.near-message",[30,0,["threadMessageRoute"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-avatar"],[12],[1,"\\n        "],[8,[32,2],null,[["@user","@avatarSize","@interactive"],[[30,2,["thread","preview","lastReplyUser"]],"small",[30,0,["interactiveUser"]]]],null],[1,"\\n      "],[13],[1,"\\n\\n      "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-info"],[12],[1,"\\n        "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-username"],[12],[1,"\\n          "],[1,[30,2,["thread","preview","lastReplyUser","username"]]],[1,"\\n        "],[13],[1,"\\n        "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-timestamp"],[12],[1,"\\n          "],[1,[28,[32,3],[[30,2,["thread","preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-message-thread-indicator__replies-count"],[12],[1,"\\n        "],[1,[28,[32,1],["chat.thread.replies"],[["count"],[[30,2,["thread","preview","replyCount"]]]]]],[1,"\\n      "],[13],[1,"\\n      "],[8,[32,4],null,[["@thread"],[[30,2,["thread"]]]],null],[1,"\\n      "],[10,0],[14,0,"chat-message-thread-indicator__last-reply-excerpt"],[12],[1,"\\n        "],[1,[28,[32,5],[[28,[32,6],[[30,2,["thread","preview","lastReplyExcerpt"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["&attrs","@message"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message-thread-indicator.js",scope:()=>[s.LinkTo,r.default,c.default,n.default,o.default,i.default,a.htmlSafe],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat-message",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/helper","@ember/modifier","@ember/object","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","ember-modifier","truth-helpers","discourse/components/d-button","discourse/helpers/concat-class","discourse/lib/transformer","discourse/lib/update-user-status-on-mention","discourse/lib/zoom-check","discourse-common/lib/debounce","discourse-common/lib/get-url","discourse-common/lib/later","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message/avatar","discourse/plugins/chat/discourse/components/chat/message/error","discourse/plugins/chat/discourse/components/chat/message/info","discourse/plugins/chat/discourse/components/chat/message/left-gutter","discourse/plugins/chat/discourse/components/chat-message-actions-mobile","discourse/plugins/chat/discourse/components/chat-message-in-reply-to-indicator","discourse/plugins/chat/discourse/components/chat-message-reaction","discourse/plugins/chat/discourse/components/chat-message-separator","discourse/plugins/chat/discourse/components/chat-message-text","discourse/plugins/chat/discourse/components/chat-message-thread-indicator","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/modifiers/chat/on-long-press","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C,w,S,k,T,x,j,E,P,A,O,U,D,L,I,R){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.MESSAGE_CONTEXT_THREAD=e.MENTION_KEYWORDS=void 0,e.addChatMessageDecorator=function(e){N.push(e)},e.default=void 0,e.resetChatMessageDecorators=function(){N=[]}
let N=[]
const F=e.MENTION_KEYWORDS=["here","all"],B=e.MESSAGE_CONTEXT_THREAD="thread"
class H extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[u.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"dialog",[u.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#n=(()=>dt7948.g(this.prototype,"currentUser",[u.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#r=(()=>dt7948.g(this.prototype,"appEvents",[u.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#c=(()=>dt7948.g(this.prototype,"capabilities",[u.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#l=(()=>dt7948.g(this.prototype,"chat",[u.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#d=(()=>dt7948.g(this.prototype,"chatApi",[u.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#h=(()=>dt7948.g(this.prototype,"chatEmojiReactionStore",[u.service]))()
#ze=(()=>{dt7948.i(this,"chatEmojiReactionStore")})()
static#u=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[u.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#p=(()=>dt7948.g(this.prototype,"chatChannelPane",[u.service]))()
#ut=(()=>{dt7948.i(this,"chatChannelPane")})()
static#j=(()=>dt7948.g(this.prototype,"chatThreadPane",[u.service]))()
#pt=(()=>{dt7948.i(this,"chatThreadPane")})()
static#P=(()=>dt7948.g(this.prototype,"chatChannelsManager",[u.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#O=(()=>dt7948.g(this.prototype,"router",[u.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#D=(()=>dt7948.g(this.prototype,"toasts",[u.service]))()
#mt=(()=>{dt7948.i(this,"toasts")})()
static#I=(()=>dt7948.g(this.prototype,"modal",[u.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#R=(()=>dt7948.g(this.prototype,"isActive",[s.tracked],(function(){return!1})))()
#gt=(()=>{dt7948.i(this,"isActive")})()
toggleCheckIfPossible=(()=>(0,p.modifier)((e=>{let t=!1
const s=()=>{this.pane.selectingMessages&&(event.shiftKey?this.messageInteractor.bulkSelect(!this.args.message.selected):this.messageInteractor.select(!this.args.message.selected))}
return this.pane.selectingMessages&&(e.addEventListener("click",s,{passive:!0}),t=!0),()=>{t&&e.removeEventListener("click",s)}})))()
get pane(){return this.threadContext?this.chatThreadPane:this.chatChannelPane}get messageInteractor(){return new L.default((0,o.getOwner)(this),this.args.message,this.args.context)}get deletedAndCollapsed(){return this.args.message?.deletedAt&&this.collapsed}get hiddenAndCollapsed(){return this.args.message?.hidden&&this.collapsed}get collapsed(){return!this.args.message?.expanded}get deletedMessageLabel(){let e=1
const t=s=>{const a=s.previousMessage
a?.deletedAt&&(e++,t(a))}
return t(this.args.message),S.default.t("chat.deleted",{count:e})}get shouldRender(){return this.args.message.expanded||!this.args.message.deletedAt||this.args.message.deletedAt&&!this.args.message.nextMessage?.deletedAt}get shouldRenderOpenEmojiPickerButton(){return this.chat.userCanInteractWithChat&&this.site.desktopView}get secondaryActionsIsExpanded(){return document.querySelector(".more-buttons.secondary-actions.is-expanded")}expand(){const e=t=>{const s=t.previousMessage
s?.deletedAt&&(s.expanded=!0,e(s))}
this.args.message.expanded=!0,this.refreshStatusOnMentions(),e(this.args.message)}static#N=(()=>dt7948.n(this.prototype,"expand",[r.action]))()
toggleChecked(e){e.stopPropagation(),e.shiftKey?this.messageInteractor.bulkSelect(e.target.checked):this.messageInteractor.select(e.target.checked)}static#B=(()=>dt7948.n(this.prototype,"toggleChecked",[r.action]))()
willDestroyMessage(){(0,h.cancel)(this._invitationSentTimer),(0,h.cancel)(this._disableMessageActionsHandler),(0,h.cancel)(this._makeMessageActiveHandler),(0,h.cancel)(this._debounceDecorateCookedMessageHandler),this.#ft(),this.chat.activeMessage=null}static#H=(()=>dt7948.n(this.prototype,"willDestroyMessage",[r.action]))()
refreshStatusOnMentions(){(0,h.schedule)("afterRender",(()=>{this.args.message.mentionedUsers.forEach((e=>{const t=`/u/${e.username.toLowerCase()}`
this.messageContainer.querySelectorAll(`a.mention[href="${t}"]`).forEach((t=>{(0,b.updateUserStatusOnMention)((0,o.getOwner)(this),t,e.status)}))}))}))}static#z=(()=>dt7948.n(this.prototype,"refreshStatusOnMentions",[r.action]))()
didInsertMessage(e){this.messageContainer=e,this.initMentionedUsers(),this.decorateMentions(e),this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions()}static#ne=(()=>dt7948.n(this.prototype,"didInsertMessage",[r.action]))()
didUpdateMessageId(){this.debounceDecorateCookedMessage()}static#re=(()=>dt7948.n(this.prototype,"didUpdateMessageId",[r.action]))()
didUpdateMessageVersion(){this.debounceDecorateCookedMessage(),this.refreshStatusOnMentions(),this.initMentionedUsers()}static#ce=(()=>dt7948.n(this.prototype,"didUpdateMessageVersion",[r.action]))()
debounceDecorateCookedMessage(){this._debounceDecorateCookedMessageHandler=(0,y.default)(this,this.decorateCookedMessage,this.args.message,100)}initMentionedUsers(){this.args.message.mentionedUsers.forEach((e=>{e.statusManager.isTrackingStatus()||(e.statusManager.trackStatus(),e.on("status-changed",this,"refreshStatusOnMentions"))}))}decorateMentions(e){if(this.args.message.channel.allowChannelWideMentions){const t=[...e.querySelectorAll("span.mention")]
F.forEach((e=>{const s=t.filter((t=>t.textContent.trim()===`@${e}`)),a=(0,_.applyValueTransformer)("mentions-class",[],{user:{username:e}})
s.forEach((e=>{e.classList.add(...a)}))}))}this.args.message.mentionedUsers.forEach((t=>{const s=(0,M.default)(`/u/${t.username.toLowerCase()}`),a=e.querySelectorAll(`a.mention[href="${s}"]`),n=(0,_.applyValueTransformer)("mentions-class",[],{user:t})
a.forEach((e=>{e.classList.add(...n)}))}))}decorateCookedMessage(e){(0,h.schedule)("afterRender",(()=>{N.forEach((t=>{t.call(this,this.messageContainer,e.channel)}))}))}static#de=(()=>dt7948.n(this.prototype,"decorateCookedMessage",[r.action]))()
get show(){return!this.args.message?.deletedAt||this.currentUser.id===this.args.message?.user?.id||this.currentUser.staff||this.args.message?.channel?.canModerate}onMouseEnter(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this.secondaryActionsIsExpanded||(this._onMouseEnterMessageDebouncedHandler=(0,y.default)(this,this._debouncedOnHoverMessage,250)))}static#ue=(()=>dt7948.n(this.prototype,"onMouseEnter",[r.action]))()
onMouseMove(){this.site.mobileView||this.chat.activeMessage?.model?.id!==this.args.message.id&&(this.secondaryActionsIsExpanded||this._setActiveMessage())}static#me=(()=>dt7948.n(this.prototype,"onMouseMove",[r.action]))()
onMouseLeave(e){(0,h.cancel)(this._onMouseEnterMessageDebouncedHandler),this.site.mobileView||(e.toElement||e.relatedTarget)?.closest(".chat-message-actions-container")||this.secondaryActionsIsExpanded||(this.chat.activeMessage=null)}static#ge=(()=>dt7948.n(this.prototype,"onMouseLeave",[r.action]))()
_debouncedOnHoverMessage(){this._setActiveMessage()}static#_e=(()=>dt7948.n(this.prototype,"_debouncedOnHoverMessage",[w.bind]))()
_setActiveMessage(){this.args.disableMouseEvents||((0,h.cancel)(this._onMouseEnterMessageDebouncedHandler),this.chat.userCanInteractWithChat&&this.args.message.expanded&&(this.chat.activeMessage={model:this.args.message,context:this.args.context}))}onLongPressStart(e,t){this.args.message.expanded&&this.args.message.persisted&&"IMG"!==t.target.tagName&&(this._makeMessageActiveHandler=(0,C.default)((()=>{this.isActive=!0}),125))}static#be=(()=>dt7948.n(this.prototype,"onLongPressStart",[r.action]))()
onLongPressCancel(){(0,h.cancel)(this._makeMessageActiveHandler),this.isActive=!1,this._disableMessageActionsHandler=(0,C.default)((()=>{document.documentElement.classList.remove("disable-message-actions-touch")}),200)}static#ve=(()=>dt7948.n(this.prototype,"onLongPressCancel",[r.action]))()
onLongPressEnd(e,t){"IMG"!==t.target.tagName&&((0,h.cancel)(this._makeMessageActiveHandler),this.isActive=!1,(0,v.default)()||(document.documentElement.classList.add("disable-message-actions-touch"),document.activeElement.blur(),document.querySelector(".chat-composer__input")?.blur(),this._setActiveMessage(),this.modal.show(E.default)))}static#ye=(()=>dt7948.n(this.prototype,"onLongPressEnd",[r.action]))()
get hasActiveState(){return this.isActive||this.chat.activeMessage?.model?.id===this.args.message.id}get hasReply(){return this.args.message.inReplyTo&&!this.hideReplyToInfo}get hideUserInfo(){const e=this.args.message,t=e.previousMessage
return!!t&&(!e.firstOfResults&&(!e.chatWebhookEvent&&(!t.deletedAt&&(!(Math.abs(new Date(e.createdAt)-new Date(t.createdAt))>3e5)&&(e.inReplyTo?e.inReplyTo?.id===t.id&&e.user?.id===t.user?.id:e.user?.id===t.user?.id)))))}get hideReplyToInfo(){return this.threadContext||this.args.message?.inReplyTo?.id===this.args.message?.previousMessage?.id||this.threadingEnabled}get threadingEnabled(){return(this.args.message?.channel?.threadingEnabled||this.args.message?.thread?.force)&&!!this.args.message?.thread}get showThreadIndicator(){return!this.threadContext&&this.threadingEnabled&&this.args.message?.thread&&this.args.message?.thread.preview.replyCount>0}get threadContext(){return this.args.context===B}get shouldRenderStopMessageStreamingButton(){return this.args.message.streaming&&(this.currentUser.admin||this.args.message.inReplyTo?.user?.id===this.currentUser.id)}stopMessageStreaming(e){this.chatApi.stopMessageStreaming(e.channel.id,e.id)}static#Me=(()=>dt7948.n(this.prototype,"stopMessageStreaming",[r.action]))()
#ft(){this.args.message.mentionedUsers.forEach((e=>{e.statusManager.stopTrackingStatus(),e.off("status-changed",this,"refreshStatusOnMentions")}))}static#Ce=(()=>(0,a.setComponentTemplate)((0,R.createTemplateFactory)({id:"9Vl/Z9cM",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],null,[["@fetchMessagesByDate","@message"],[[30,1],[30,2]]],null],[1,"\\n\\n      "],[11,0],[16,0,[28,[32,1],["chat-message-container",[52,[30,0,["pane","selectingMessages"]],"-selectable"],[52,[30,2,["highlighted"]],"-highlighted"],[52,[30,2,["streaming"]],"-streaming"],[52,[28,[32,2],[[30,2,["user","id"]],[30,0,["currentUser","id"]]],null],"is-by-current-user"],[52,[28,[32,2],[[30,2,["id"]],[30,0,["currentUser","id"]]],null],"is-by-current-user"],[52,[28,[32,2],[[30,2,["id"]],[30,2,["channel","currentUserMembership","lastReadMessageId"]]],null],"-last-read"],[52,[30,2,["staged"]],"-staged","-persisted"],[52,[30,2,["processed"]],"-processed","-not-processed"],[52,[30,0,["hasActiveState"]],"-active"],[52,[30,2,["bookmark"]],"-bookmarked"],[52,[30,2,["deletedAt"]],"-deleted"],[52,[30,2,["selected"]],"-selected"],[52,[30,2,["error"]],"-errored"],[52,[30,0,["showThreadIndicator"]],"has-thread-indicator"],[52,[30,0,["hideUserInfo"]],"-user-info-hidden"],[52,[30,0,["hasReply"]],"has-reply"]],null]],[16,"data-id",[30,2,["id"]]],[16,"data-thread-id",[30,2,["thread","id"]]],[17,3],[4,[32,3],[[30,0,["didInsertMessage"]]],null],[4,[32,4],[[30,0,["didUpdateMessageId"]],[30,2,["id"]]],null],[4,[32,4],[[30,0,["didUpdateMessageVersion"]],[30,2,["version"]]],null],[4,[32,5],[[30,0,["willDestroyMessage"]]],null],[4,[32,6],["mouseenter",[30,0,["onMouseEnter"]]],[["passive"],[true]]],[4,[32,6],["mouseleave",[30,0,["onMouseLeave"]]],[["passive"],[true]]],[4,[32,6],["mousemove",[30,0,["onMouseMove"]]],[["passive"],[true]]],[4,[30,0,["toggleCheckIfPossible"]],null,null],[4,[32,7],[[30,0,["onLongPressStart"]],[30,0,["onLongPressEnd"]],[30,0,["onLongPressCancel"]]],null],[12],[1,"\\n"],[41,[30,0,["show"]],[[[41,[30,0,["pane","selectingMessages"]],[[[1,"            "],[8,[32,8],[[24,0,"chat-message-selector"],[4,[32,6],["click",[30,0,["toggleChecked"]]],null]],[["@type","@checked"],["checkbox",[30,2,["selected"]]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["deletedAndCollapsed"]],[[[1,"            "],[10,0],[14,0,"chat-message-text -deleted"],[12],[1,"\\n              "],[8,[32,9],[[24,0,"btn-flat chat-message-expand"]],[["@action","@translatedLabel"],[[30,0,["expand"]],[30,0,["deletedMessageLabel"]]]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[41,[30,0,["hiddenAndCollapsed"]],[[[1,"            "],[10,0],[14,0,"chat-message-text -hidden"],[12],[1,"\\n              "],[8,[32,9],[[24,0,"btn-flat chat-message-expand"]],[["@action","@label"],[[30,0,["expand"]],"chat.hidden"]],null],[1,"\\n            "],[13],[1,"\\n"]],[]],[[[1,"            "],[10,0],[14,0,"chat-message"],[12],[1,"\\n"],[41,[51,[30,0,["hideReplyToInfo"]]],[[[1,"                "],[8,[32,10],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["hideUserInfo"]],[[[1,"                "],[8,[32,11],null,[["@message","@threadContext"],[[30,2],[30,0,["threadContext"]]]],null],[1,"\\n"]],[]],[[[1,"                "],[8,[32,12],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]]],[1,"\\n              "],[10,0],[14,0,"chat-message-content"],[12],[1,"\\n                "],[8,[32,13],null,[["@message","@show","@threadContext"],[[30,2],[28,[32,14],[[30,0,["hideUserInfo"]]],null],[30,0,["threadContext"]]]],null],[1,"\\n\\n                "],[8,[32,15],null,[["@cooked","@uploads","@edited"],[[30,2,["cooked"]],[30,2,["uploads"]],[30,2,["edited"]]]],[["default"],[[[[1,"\\n"],[41,[30,2,["reactions","length"]],[[[1,"                    "],[10,0],[14,0,"chat-message-reaction-list"],[12],[1,"\\n"],[42,[28,[31,3],[[28,[31,3],[[30,2,["reactions"]]],null]],null],null,[[[1,"                        "],[8,[32,16],null,[["@reaction","@onReaction","@message","@showTooltip"],[[30,4],[30,0,["messageInteractor","react"]],[30,2],true]],null],[1,"\\n"]],[4]],null],[1,"\\n"],[41,[30,0,["shouldRenderOpenEmojiPickerButton"]],[[[1,"                        "],[8,[32,9],[[24,0,"chat-message-react-btn"]],[["@action","@icon","@title","@forwardEvent"],[[30,0,["messageInteractor","openEmojiPicker"]],"discourse-emojis","chat.react",true]],null],[1,"\\n"]],[]],null],[1,"                    "],[13],[1,"\\n"]],[]],null],[1,"                "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderStopMessageStreamingButton"]],[[[1,"                  "],[10,0],[14,0,"stop-streaming-btn-container"],[12],[1,"\\n                    "],[8,[32,9],null,[["@class","@icon","@label","@action"],["stop-streaming-btn","stop-circle","cancel",[28,[32,17],[[30,0,["stopMessageStreaming"]],[30,2]],null]]],null],[1,"\\n\\n                  "],[13],[1,"\\n"]],[]],null],[1,"\\n                "],[8,[32,18],null,[["@message","@onRetry"],[[30,2],[30,5]]],null],[1,"\\n              "],[13],[1,"\\n\\n"],[41,[30,0,["showThreadIndicator"]],[[[1,"                "],[8,[32,19],null,[["@message"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "]],[]]]],[]]]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@fetchMessagesByDate","@message","&attrs","reaction","@resendStagedMessage"],false,["if","unless","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-message.js",scope:()=>[O.default,f.default,m.eq,c.default,l.default,d.default,i.on,I.default,a.Input,g.default,P.default,j.default,k.default,x.default,m.not,U.default,A.default,n.fn,T.default,D.default],isStrictMode:!0}),this))()}e.default=H})),define("discourse/plugins/chat/discourse/components/chat-messages-container",["exports","@ember/helper","discourse/plugins/chat/discourse/modifiers/chat/on-resize","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"voufEXQ1",block:'[[[1,"\\n  "],[11,0],[24,0,"chat-messages-container"],[4,[32,0],[[30,1],[28,[32,1],null,[["delay","immediate"],[100,true]]]],null],[12],[1,"\\n    "],[18,2,null],[1,"\\n  "],[13],[1,"\\n"]],["@didResizePane","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-messages-container.js",scope:()=>[s.default,t.hash],isStrictMode:!0}),(0,i.default)(void 0,"chat-messages-container:ChatMessagesContainer"))
e.default=r})),define("discourse/plugins/chat/discourse/components/chat-messages-scroller",["exports","@ember/helper","@ember/render-modifiers/modifiers/did-insert","discourse/plugins/chat/discourse/modifiers/chat/scrollable-list","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"tVuIdDlD",block:'[[[1,"\\n  "],[11,0],[24,0,"chat-messages-scroller popper-viewport"],[4,[32,0],[[30,1]],null],[4,[32,1],[[28,[32,2],null,[["onScroll","onScrollEnd","reverse"],[[30,2],[30,3],true]]]],null],[12],[1,"\\n    "],[18,4,null],[1,"\\n  "],[13],[1,"\\n"]],["@onRegisterScroller","@onScroll","@onScrollEnd","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-messages-scroller.js",scope:()=>[s.default,a.default,t.hash],isStrictMode:!0}),(0,r.default)(void 0,"chat-messages-scroller:ChatMessagesScroller"))
e.default=o})),define("discourse/plugins/chat/discourse/components/chat-notice",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c={mention_without_membership:i.default}
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"noticesManager",[(0,a.service)("chat-channel-notices-manager")]))()
#_t=(()=>{dt7948.i(this,"noticesManager")})()
clearNotice(){this.noticesManager.clearNotice(this.args.notice)}static#s=(()=>dt7948.n(this.prototype,"clearNotice",[s.action]))()
get component(){return c[this.args.notice.type]}static#n=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"tdJFxcKd",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-notices__notice"],[12],[1,"\\n\\n"],[41,[30,1,["textContent"]],[[[1,"        "],[10,2],[14,0,"chat-notices__notice__content"],[12],[1,"\\n          "],[1,[30,1,["textContent"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[8,[30,0,["component"]],null,[["@channel","@notice","@clearNotice"],[[30,2],[30,1],[30,0,["clearNotice"]]]],null],[1,"\\n"]],[]]],[1,"\\n      "],[8,[32,0],[[24,0,"btn-transparent chat-notices__notice__clear"]],[["@icon","@action"],["xmark",[30,0,["clearNotice"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@notice","@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-notice.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat-notices",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/components/chat-notice","discourse/plugins/chat/discourse/components/chat-retention-reminder","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"noticesManager",[(0,s.service)("chat-channel-notices-manager")]))()
#_t=(()=>{dt7948.i(this,"noticesManager")})()
get noticesForChannel(){return this.noticesManager.notices.filter((e=>e.channelId===this.args.channel.id))}static#s=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"w5+Mqhw3",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-notices"],[12],[1,"\\n      "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["noticesForChannel"]]],null]],null],null,[[[1,"        "],[8,[32,1],null,[["@notice","@channel"],[[30,2],[30,1]]],null],[1,"\\n"]],[2]],null],[1,"    "],[13],[1,"\\n  "]],["@channel","notice"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-notices.js",scope:()=>[n.default,a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat-replying-indicator",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/render-modifiers/modifiers/will-destroy","@ember/service","@ember/utils","discourse/helpers/concat-class","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[o.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"presence",[o.service]))()
#bt=(()=>{dt7948.i(this,"presence")})()
static#n=(()=>dt7948.g(this.prototype,"presenceChannel",[s.tracked],(function(){return null})))()
#vt=(()=>{dt7948.i(this,"presenceChannel")})()
async updateSubscription(){await this.unsubscribe(),await this.subscribe()}static#r=(()=>dt7948.n(this.prototype,"updateSubscription",[a.action]))()
async subscribe(){this.presenceChannel=this.presence.getChannel(this.args.presenceChannelName),await this.presenceChannel.subscribe()}static#c=(()=>dt7948.n(this.prototype,"subscribe",[a.action]))()
async unsubscribe(){this.presenceChannel?.subscribed&&await this.presenceChannel.unsubscribe()}static#l=(()=>dt7948.n(this.prototype,"unsubscribe",[a.action]))()
get users(){return this.presenceChannel?.get("users")?.filter((e=>e.id!==this.currentUser.id))||[]}get usernames(){return this.users.mapBy("username")}get text(){if(1===this.usernames.length)return d.default.t("chat.replying_indicator.single_user",{username:this.usernames[0]})
if(this.usernames.length<4){const e=this.usernames[this.usernames.length-1],t=this.usernames.slice(0,this.usernames.length-1).join(d.default.t("word_connector.comma"))
return d.default.t("chat.replying_indicator.multiple_users",{commaSeparatedUsernames:t,lastUsername:e})}const e=this.usernames.slice(0,2).join(d.default.t("word_connector.comma"))
return d.default.t("chat.replying_indicator.many_users",{commaSeparatedUsernames:e,count:this.usernames.length-2})}get shouldRender(){return(0,c.isPresent)(this.usernames)}static#d=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"mY3LAGZX",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[11,0],[16,0,[28,[32,0],["chat-replying-indicator",[52,[30,0,["presenceChannel","subscribed"]],"is-subscribed"]],null]],[4,[32,1],[[30,0,["subscribe"]]],null],[4,[32,2],[[30,0,["updateSubscription"]],[30,1]],null],[4,[32,3],[[30,0,["unsubscribe"]]],null],[12],[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"          "],[10,1],[14,0,"chat-replying-indicator__text"],[12],[1,[30,0,["text"]]],[13],[1,"\\n          "],[10,1],[14,0,"chat-replying-indicator__wave"],[12],[1,"\\n            "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n            "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n            "],[10,1],[14,0,"chat-replying-indicator__dot"],[12],[1,"."],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@presenceChannelName"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-replying-indicator.js",scope:()=>[l.default,n.default,i.default,r.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder-text",["exports","@glimmer/component","@ember/service","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get type(){return this.args.type??"long"}get text(){return this.args.channel.isDirectMessageChannel?this.#yt>0?a.default.t(`chat.retention_reminders.${this.type}`,{count:this.siteSettings.chat_dm_retention_days}):a.default.t(`chat.retention_reminders.indefinitely_${this.type}`):this.#yt>0?a.default.t(`chat.retention_reminders.${this.type}`,{count:this.siteSettings.chat_channel_retention_days}):a.default.t(`chat.retention_reminders.indefinitely_${this.type}`)}get#yt(){return this.args.channel.isDirectMessageChannel?this.siteSettings.chat_dm_retention_days:this.siteSettings.chat_channel_retention_days}static#s=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"jf5EPrBy",block:'[[[1,"\\n    "],[10,1],[14,0,"chat-retention-reminder-text"],[12],[1,"\\n      "],[1,[30,0,["text"]]],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-retention-reminder-text.js",isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat-retention-reminder",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax","discourse/lib/ajax-error","discourse/plugins/chat/discourse/components/chat-retention-reminder-text","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get show(){return this.args.channel?.isDirectMessageChannel&&this.currentUser?.get("needs_dm_retention_reminder")||this.args.channel?.isCategoryChannel&&this.currentUser?.get("needs_channel_retention_reminder")}async dismiss(){try{await(0,i.ajax)("/chat/dismiss-retention-reminder",{method:"POST",data:{chatable_type:this.args.channel.chatableType}})
const e=this.args.channel.isDirectMessageChannel?"needs_dm_retention_reminder":"needs_channel_retention_reminder"
this.currentUser.set(e,!1)}catch(e){(0,r.popupAjaxError)(e)}}static#s=(()=>dt7948.n(this.prototype,"dismiss",[s.action]))()
static#n=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"GPnNGhtq",block:'[[[1,"\\n"],[41,[30,0,["show"]],[[[1,"      "],[10,0],[14,0,"chat-retention-reminder"],[12],[1,"\\n        "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n        "],[8,[32,1],[[24,0,"no-text btn-icon btn-transparent dismiss-btn"]],[["@action","@icon"],[[30,0,["dismiss"]],"xmark"]],null],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-retention-reminder.js",scope:()=>[o.default,n.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat-side-panel-resizer",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"zRFG2Lu3",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-side-panel-resizer"],[12],[13],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-side-panel-resizer.js",isStrictMode:!0}),(0,a.default)(void 0,"chat-side-panel-resizer:ChatSidePanelResizer"))
e.default=n})),define("discourse/plugins/chat/discourse/components/chat-side-panel",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/lib/key-value-store","discourse/plugins/chat/discourse/modifiers/chat/resizable-node","discourse/plugins/chat/discourse/components/chat-side-panel-resizer","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatStateManager",[i.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#s=(()=>dt7948.g(this.prototype,"site",[i.service]))()
#b=(()=>{dt7948.i(this,"site")})()
store=(()=>new r.default("discourse_chat_side_panel_size_"))()
setupSize(e){if(this.site.mobileView)return
if(!this.chatStateManager.isFullPageActive)return
const t=Math.min(this.store.getObject("width"),this.mainContainerWidth-250)
e.animate([{width:e.style.width},{width:t+"px"}],{duration:0,fill:"forwards"}),this.storeWidth(t)}static#n=(()=>dt7948.n(this.prototype,"setupSize",[a.action]))()
didResize(e,t){const s=this.mainContainerWidth-t.width
t.width>=250&&s>=250&&(e.animate([{width:e.style.width},{width:t.width+"px"}],{duration:0,fill:"forwards"}),this.storeWidth(t.width))}static#r=(()=>dt7948.n(this.prototype,"didResize",[a.action]))()
get mainContainerWidth(){return document.getElementById("main-chat-outlet").clientWidth}storeWidth(e){this.store.setObject({key:"width",value:e})}static#c=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"+D+oFGit",block:'[[[1,"\\n"],[41,[30,0,["chatStateManager","isSidePanelExpanded"]],[[[1,"      "],[11,0],[24,0,"chat-side-panel"],[4,[32,0],[[30,0,["setupSize"]]],null],[4,[32,1],[".chat-side-panel-resizer",[30,0,["didResize"]],[28,[32,2],null,[["position","vertical","mutate","resetOnWindowResize"],[false,false,false,true]]]],null],[12],[1,"\\n        "],[18,1,null],[1,"\\n\\n"],[41,[30,0,["site","desktopView"]],[[[1,"          "],[8,[32,3],null,null,null],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-side-panel.js",scope:()=>[n.default,o.default,s.hash,c.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat-skeleton",["exports","@glimmer/component","@ember/template","@ember/component","@ember/template-factory"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get placeholders(){return Array.from({length:15},(()=>({image:5===this.#Mt(1,10),rows:Array.from({length:this.#Mt(1,5)},(()=>(0,s.htmlSafe)(`width: ${this.#Mt(20,95)}%`))),reactions:Array.from({length:this.#Mt(0,3)})})))}#Mt(e,t){return Math.floor(Math.random()*(t-e+1)+e)}static#e=(()=>(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"roMafkk/",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-skeleton -animation"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,0,["placeholders"]]],null]],null],null,[[[1,"        "],[10,0],[14,0,"chat-skeleton__body"],[12],[1,"\\n          "],[10,0],[14,0,"chat-skeleton__message"],[12],[1,"\\n            "],[10,0],[14,0,"chat-skeleton__message-avatar"],[12],[13],[1,"\\n            "],[10,0],[14,0,"chat-skeleton__message-poster"],[12],[13],[1,"\\n            "],[10,0],[14,0,"chat-skeleton__message-content"],[12],[1,"\\n"],[41,[30,1,["image"]],[[[1,"                "],[10,0],[14,0,"chat-skeleton__message-img"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n              "],[10,0],[14,0,"chat-skeleton__message-text"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1,["rows"]]],null]],null],null,[[[1,"                  "],[10,0],[14,0,"chat-skeleton__message-msg"],[15,5,[30,2]],[12],[13],[1,"\\n"]],[2]],null],[1,"              "],[13],[1,"\\n\\n"],[41,[30,1,["reactions"]],[[[1,"                "],[10,0],[14,0,"chat-skeleton__message-reactions"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1,["reactions"]]],null]],null],null,[[[1,"                    "],[10,0],[14,0,"chat-skeleton__message-reaction"],[12],[13],[1,"\\n"]],[]],null],[1,"                "],[13],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[1]],null],[1,"    "],[13],[1,"\\n  "]],["placeholder","row"],false,["each","-track-array","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-skeleton.js",isStrictMode:!0}),this))()}e.default=i})),define("discourse/plugins/chat/discourse/components/chat-thread-list",["exports","@glimmer/component","@glimmer/tracking","@ember/service","ember-modifier","truth-helpers","discourse/components/conditional-loading-spinner","discourse/lib/is-element-in-viewport","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat/thread-list/item","discourse/plugins/chat/discourse/modifiers/chat/track-message","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"messageBus",[a.service]))()
#te=(()=>{dt7948.i(this,"messageBus")})()
static#r=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[a.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
noThreadsLabel=(()=>l.default.t("chat.threads.none"))()
subscribe=(()=>(0,n.modifier)(((e,t)=>{let[s]=t
return this.messageBus.subscribe(`/chat/${s.id}`,this.onMessageBus,s.channelMessageBusLastId),()=>{s&&this.messageBus.unsubscribe(`/chat/${s.id}`,this.onMessageBus)}})))()
fill=(()=>(0,n.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,o.default)(e)&&this.loadThreads()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()}))))()
loadMore=(()=>(0,n.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.loadThreads),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))()
get threadsCollection(){return this.chatApi.threads(this.args.channel.id,this.handleLoadedThreads)}static#c=(()=>dt7948.n(this.prototype,"threadsCollection",[s.cached]))()
loadThreads(){this.threadsCollection.load({limit:10})}static#l=(()=>dt7948.n(this.prototype,"loadThreads",[c.bind]))()
get threadsManager(){return this.args.channel.threadsManager}get sortedThreads(){return this.threadsManager.threads.filter((e=>!e.originalMessage.deletedAt&&e.originalMessage?.id!==e.lastMessageId)).sort(((e,t)=>e.tracking.watchedThreadsUnreadCount&&t.tracking.watchedThreadsUnreadCount?e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1:e.tracking.watchedThreadsUnreadCount?-1:t.tracking.watchedThreadsUnreadCount?1:e.tracking.unreadCount&&t.tracking.unreadCount?e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1:e.tracking.unreadCount?-1:t.tracking.unreadCount?1:e.preview.lastReplyCreatedAt>t.preview.lastReplyCreatedAt?-1:1))}static#d=(()=>dt7948.n(this.prototype,"sortedThreads",[s.cached]))()
get lastThread(){return this.sortedThreads[this.sortedThreads.length-1]}get shouldRender(){return!!this.args.channel}onMessageBus(e){switch(e.type){case"delete":this.handleDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)}}static#h=(()=>dt7948.n(this.prototype,"onMessageBus",[c.bind]))()
handleDeleteMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.deleted_id)
t&&(t.originalMessage.deletedAt=new Date)}handleRestoreMessage(e){const t=this.threadsManager.threads.findBy("originalMessage.id",e.chat_message.id)
t&&(t.originalMessage.deletedAt=null)}handleLoadedThreads(e){return e.threads.map((t=>{const s=this.threadsManager.add(this.args.channel,t,{replace:!0})
return this.chatTrackingStateManager.setupChannelThreadState(this.args.channel,e.tracking),s}))}static#u=(()=>dt7948.n(this.prototype,"handleLoadedThreads",[c.bind]))()
static#p=(()=>(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"puIZL12K",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[11,0],[24,0,"chat-thread-list"],[4,[30,0,["subscribe"]],[[30,1]],null],[12],[1,"\\n        "],[11,0],[24,0,"chat-thread-list__items"],[4,[30,0,["fill"]],null,null],[12],[1,"\\n\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["sortedThreads"]]],null]],null],"id",[[[1,"            "],[8,[32,0],[[4,[52,[28,[32,1],[[30,2],[30,0,["lastThread"]]],null],[50,[32,2],2,[[30,0,["load"]]],null]],null,null]],[["@thread"],[[30,2]]],null],[1,"\\n"]],[2]],[[[41,[30,0,["threadsCollection","fetchedOnce"]],[[[1,"              "],[10,0],[14,0,"chat-thread-list__no-threads"],[12],[1,"\\n                "],[1,[30,0,["noThreadsLabel"]]],[1,"\\n              "],[13],[1,"\\n"]],[]],null]],[]]],[1,"\\n          "],[8,[32,3],null,[["@condition"],[[30,0,["threadsCollection","loading"]]]],null],[1,"\\n\\n          "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n            "],[10,"br"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@channel","thread"],false,["if","each","-track-array","modifier"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-list.js",scope:()=>[d.default,i.eq,h.default,r.default],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/chat/discourse/components/chat-thread-participants",["exports","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{get showParticipants(){if(this.args.thread)return this.includeOriginalMessageUser?this.participantsUsers.length>1:this.participantsUsers.length>0}get includeOriginalMessageUser(){return this.args.includeOriginalMessageUser??!0}get participantsUsers(){const e=this.args.thread.preview.participantUsers
return this.includeOriginalMessageUser?e.length>3?e.slice(0,2).concat(e[e.length-1]):e:e.filter((e=>e.id!==this.args.thread.originalMessage.user.id))}get otherCountLabel(){return s.default.t("chat.thread.participants_other_count",{count:this.args.thread.preview.otherParticipantCount})}static#e=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"uIyMf295",block:'[[[1,"\\n"],[41,[30,0,["showParticipants"]],[[[1,"      "],[11,0],[24,0,"chat-thread-participants"],[17,1],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-participants__avatar-group"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["participantsUsers"]]],null]],null],null,[[[1,"            "],[8,[32,0],null,[["@user","@avatarSize","@showPresence","@interactive"],[[30,2],"tiny",false,false]],null],[1,"\\n"]],[2]],null],[1,"        "],[13],[1,"\\n"],[41,[30,3,["preview","otherParticipantCount"]],[[[1,"          "],[10,0],[14,0,"chat-thread-participants__other-count"],[12],[1,"\\n            "],[1,[30,0,["otherCountLabel"]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["&attrs","user","@thread"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread-participants.js",scope:()=>[a.default],isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat-thread-title-prompt",["exports","@glimmer/component","@ember/object","@ember/runloop","@ember/service","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/models/user-chat-thread-membership"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"modal",[n.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#n=(()=>dt7948.g(this.prototype,"toasts",[n.service]))()
#mt=(()=>{dt7948.i(this,"toasts")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[n.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
toastText=(()=>({title:i.default.t("chat.thread_title_toast.title"),message:i.default.t("chat.thread_title_toast.message"),dismissLabel:i.default.t("chat.thread_title_toast.dismiss_action"),primaryLabel:i.default.t("chat.thread_title_toast.primary_action")}))()
constructor(){super(...arguments),(0,a.next)((()=>{this.canShowToast&&(this.show(),this.updateThreadTitlePrompt())}))}get membership(){return this.args.thread.currentUserMembership}async updateThreadTitlePrompt(){try{const e=await this.chatApi.updateCurrentUserThreadTitlePrompt(this.args.thread.channel.id,this.args.thread.id)
this.args.thread.currentUserMembership=c.default.create(e.membership)}catch(e){console.log("Couldn't save thread title prompt status",e),this.membership&&(this.membership.threadTitlePromptSeen=!1)}}static#l=(()=>dt7948.n(this.prototype,"updateThreadTitlePrompt",[s.action]))()
disableFutureThreadTitlePrompts(){this.currentUser.set("user_option.show_thread_title_prompts",!1),this.currentUser.save()}static#d=(()=>dt7948.n(this.prototype,"disableFutureThreadTitlePrompts",[s.action]))()
get canShowToast(){if(this.site.desktopView||this.args.thread.originalMessage?.user?.id!==this.currentUser.id&&!this.currentUser.admin)return!1
const e=null===this.args.thread.title,t=this.args.thread.replyCount>=o.THREAD_TITLE_PROMPT_THRESHOLD,s=this.currentUser.user_option.show_thread_title_prompts,a=!this.membership?.threadTitlePromptSeen
return e&&t&&s&&a}show(){this.toasts.default({duration:5e3,showProgressBar:!0,class:"thread-toast",data:{title:this.toastText.title,message:this.toastText.message,actions:[{label:this.toastText.dismissLabel,class:"btn-link toast-hide",action:e=>{this.disableFutureThreadTitlePrompts(),e.close()}},{label:this.toastText.primaryLabel,class:"btn-primary toast-action",action:e=>{this.modal.show(r.default,{model:this.args.thread}),e.close()}}]}})}}e.default=l})),define("discourse/plugins/chat/discourse/components/chat-thread-tracking-dropdown",["exports","@ember-decorators/component","select-kit/components/notifications-button","select-kit/components/select-kit","discourse/plugins/chat/discourse/lib/chat-notification-levels"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=dt7948.c(class extends s.default{content=(()=>n.threadNotificationButtonLevels)()},[(0,a.pluginApiIdentifiers)("thread-notifications-button"),(0,a.selectKitOptions)({i18nPrefix:"chat.thread.notifications",showFullTitle:!1,btnCustomClasses:"btn-flat",customStyle:!0}),(0,t.classNames)("thread-notifications-button")])
e.default=i})),define("discourse/plugins/chat/discourse/components/chat-thread",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/owner","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/runloop","@ember/service","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/notification-levels","discourse-common/lib/debounce","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-thread-title-prompt","discourse/plugins/chat/discourse/helpers/first-visible-message-id","discourse/plugins/chat/discourse/lib/chat-channel-thread-subscription-manager","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/lib/chat-ios-hacks","discourse/plugins/chat/discourse/lib/chat-messages-loader","discourse/plugins/chat/discourse/lib/dates-separators-positioner","discourse/plugins/chat/discourse/lib/extract-current-topic-info","discourse/plugins/chat/discourse/lib/scroll-helpers","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/user-chat-thread-membership","discourse/plugins/chat/discourse/components/chat/composer/thread","discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow","discourse/plugins/chat/discourse/components/chat/selection-manager","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/components/chat-messages-container","discourse/plugins/chat/discourse/components/chat-messages-scroller","discourse/plugins/chat/discourse/components/chat-skeleton","discourse/plugins/chat/discourse/components/chat-upload-drop-zone","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C,w,S,k,T,x,j,E,P,A,O,U,D,L){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class I extends t.default{static#e=(()=>dt7948.g(this.prototype,"appEvents",[c.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#s=(()=>dt7948.g(this.prototype,"capabilities",[c.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[c.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#r=(()=>dt7948.g(this.prototype,"chatApi",[c.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#c=(()=>dt7948.g(this.prototype,"chatComposerPresenceManager",[c.service]))()
#J=(()=>{dt7948.i(this,"chatComposerPresenceManager")})()
static#l=(()=>dt7948.g(this.prototype,"chatHistory",[c.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#d=(()=>dt7948.g(this.prototype,"chatDraftsManager",[c.service]))()
#Y=(()=>{dt7948.i(this,"chatDraftsManager")})()
static#h=(()=>dt7948.g(this.prototype,"chatThreadComposer",[c.service]))()
#Ct=(()=>{dt7948.i(this,"chatThreadComposer")})()
static#u=(()=>dt7948.g(this.prototype,"chatThreadPane",[c.service]))()
#pt=(()=>{dt7948.i(this,"chatThreadPane")})()
static#p=(()=>dt7948.g(this.prototype,"dialog",[c.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#j=(()=>dt7948.g(this.prototype,"currentUser",[c.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#P=(()=>dt7948.g(this.prototype,"router",[c.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#O=(()=>dt7948.g(this.prototype,"siteSettings",[c.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#D=(()=>dt7948.g(this.prototype,"atBottom",[s.tracked],(function(){return!0})))()
#le=(()=>{dt7948.i(this,"atBottom")})()
static#I=(()=>dt7948.g(this.prototype,"isScrolling",[s.tracked],(function(){return!1})))()
#pe=(()=>{dt7948.i(this,"isScrolling")})()
static#R=(()=>dt7948.g(this.prototype,"needsArrow",[s.tracked],(function(){return!1})))()
#oe=(()=>{dt7948.i(this,"needsArrow")})()
static#N=(()=>dt7948.g(this.prototype,"uploadDropZone",[s.tracked]))()
#he=(()=>{dt7948.i(this,"uploadDropZone")})()
scroller=null
get messagesLoader(){return new y.default((0,n.getOwner)(this),this.args.thread)}static#B=(()=>dt7948.n(this.prototype,"messagesLoader",[s.cached]))()
get messagesManager(){return this.args.thread.messagesManager}handleKeydown(e){if("Escape"===e.key)return this.router.transitionTo("chat.channel",...this.args.thread.channel.routeModels)}static#H=(()=>dt7948.n(this.prototype,"handleKeydown",[a.action]))()
setup(e){this.uploadDropZone=e,this.messagesManager.clear(),this.args.thread.draft=this.chatDraftsManager.get(this.args.thread.channel?.id,this.args.thread.id)||S.default.createDraftMessage(this.args.thread.channel,{user:this.currentUser,thread:this.args.thread}),this.chatThreadComposer.focus(),this.loadMessages()}static#z=(()=>dt7948.n(this.prototype,"setup",[a.action]))()
teardown(){this.subscriptionManager.teardown(),(0,o.cancel)(this._debouncedFillPaneAttemptHandler),(0,o.cancel)(this._debounceUpdateLastReadMessageHandler)}static#ne=(()=>dt7948.n(this.prototype,"teardown",[a.action]))()
onScroll(e){(0,o.next)((()=>{this.#je()||(M.default.apply(this.scroller),this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!0,this.debounceUpdateLastReadMessage(),e.atTop||!this.capabilities.isIOS&&e.up&&e.distanceToTop.percentage<40?this.fetchMoreMessages({direction:b.PAST}):e.atBottom&&this.fetchMoreMessages({direction:b.FUTURE}))}))}static#re=(()=>dt7948.n(this.prototype,"onScroll",[a.action]))()
onScrollEnd(e){this.needsArrow=this.messagesLoader.fetchedOnce&&this.messagesLoader.canLoadMoreFuture||e.distanceToBottom.pixels>250&&!e.atBottom,this.isScrolling=!1,this.atBottom=e.atBottom,this.args.setFullTitle?.(e.atTop),e.atBottom&&this.fetchMoreMessages({direction:b.FUTURE})}static#ce=(()=>dt7948.n(this.prototype,"onScrollEnd",[a.action]))()
debounceUpdateLastReadMessage(){this._debounceUpdateLastReadMessageHandler=(0,u.default)(this,this.updateLastReadMessage,b.READ_INTERVAL_MS)}updateLastReadMessage(){if(!this.args.thread?.currentUserMembership)return
const e=(0,f.default)(this.scroller)
if(!e)return
const t=this.messagesManager.findMessage(e)
if(!t)return
return this.args.thread.currentUserMembership.lastReadMessageId>=t.id?void 0:this.chatApi.markThreadAsRead(this.args.thread.channel.id,this.args.thread.id,t.id)}static#de=(()=>dt7948.n(this.prototype,"updateLastReadMessage",[p.bind]))()
registerScroller(e){this.scroller=e}static#ue=(()=>dt7948.n(this.prototype,"registerScroller",[a.action]))()
loadMessages(){this.fetchMessages(),this.subscriptionManager=new _.default(this,this.args.thread,{onNewMessage:this.onNewMessage})}static#me=(()=>dt7948.n(this.prototype,"loadMessages",[a.action]))()
didResizePane(){this._ignoreNextScroll=!0,this.debounceFillPaneAttempt(),this.debounceUpdateLastReadMessage(),M.default.apply(this.scroller)}static#ge=(()=>dt7948.n(this.prototype,"didResizePane",[a.action]))()
async fetchMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.messagesLoader.loading)return
this.messagesManager.clear(),e.target_message_id??=e.targetMessageId||this.args.targetMessageId||this.args.thread.currentUserMembership?.lastReadMessageId,e.target_message_id||(e.direction=b.FUTURE)
const t=await this.messagesLoader.load(e)
if(!t)return
const[s,a]=this.processMessages(this.args.thread,t);(0,v.stackingContextFix)(this.scroller,(()=>{this.messagesManager.addMessages(s)})),this.args.thread.details=a,a.target_message_id?this.scrollToMessageId(a.target_message_id,{highlight:!0}):this.scrollToTop(),this.debounceFillPaneAttempt()}async fetchMoreMessages(e){let{direction:t}=e
if(this.messagesLoader.loading)return
const s=await this.messagesLoader.loadMore({direction:t})
if(!s)return
const[a,n]=this.processMessages(this.args.thread,s)
a?.length&&((0,v.stackingContextFix)(this.scroller,(()=>{this.messagesManager.addMessages(a)})),this.args.thread.details=n,t===b.FUTURE?this.scrollToMessageId(a.firstObject.id,{position:"end",behavior:"auto"}):t===b.PAST&&this.scrollToMessageId(a.lastObject.id),this.debounceFillPaneAttempt())}static#_e=(()=>dt7948.n(this.prototype,"fetchMoreMessages",[a.action]))()
scrollToLatestMessage(){this.messagesLoader.canLoadMoreFuture?this.fetchMessages():this.messagesManager.messages.length>0&&this.scrollToBottom()}static#be=(()=>dt7948.n(this.prototype,"scrollToLatestMessage",[a.action]))()
debounceFillPaneAttempt(){this.messagesLoader.fetchedOnce&&(this._debouncedFillPaneAttemptHandler=(0,u.default)(this,this.fillPaneAttempt,500))}async fillPaneAttempt(){if(this.messagesManager.messages.length>200)return
if(!this.messagesLoader.canLoadMorePast)return
const e=this.messagesManager.messages.firstObject
e?.visible&&await this.fetchMoreMessages({direction:b.PAST})}scrollToMessageId(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{highlight:!1,position:"start",autoExpand:!1}
this._ignoreNextScroll=!0
const s=this.messagesManager.findMessage(e);(0,w.scrollListToMessage)(this.scroller,s,t)}onNewMessage(e){if(!this.atBottom)return this.needsArrow=!0,void(this.messagesLoader.canLoadMoreFuture=!0);(0,v.stackingContextFix)(this.scroller,(()=>{this.messagesManager.addMessages([e])}))}static#ve=(()=>dt7948.n(this.prototype,"onNewMessage",[p.bind]))()
processMessages(e,t){return[t.messages.map((t=>{const s=(this.currentUser.ignored_users||[]).includes(t.user.username)
return S.default.create(e.channel,{...t,hidden:s,expanded:!(s||t.deleted_at),manager:this.messagesManager,thread:e})})),t.meta]}static#ye=(()=>dt7948.n(this.prototype,"processMessages",[p.bind]))()
async onSendMessage(e){e.message.length>this.siteSettings.chat_maximum_message_length?this.dialog.alert(m.default.t("chat.message_too_long",{count:this.siteSettings.chat_maximum_message_length})):(await e.cook(),e.editing?await this.#Ae(e):await this.#Oe(e))}static#Me=(()=>dt7948.n(this.prototype,"onSendMessage",[a.action]))()
fetchMessagesByDate(e){if(this.messagesLoader.loading)return
const t=this.messagesManager.findFirstMessageOfDay(new Date(e))
t.firstOfResults&&this.messagesLoader.canLoadMorePast?this.fetchMessages({target_date:e,direction:b.FUTURE}):this.highlightOrFetchMessage(t.id,{position:"center"})}static#Ce=(()=>dt7948.n(this.prototype,"fetchMessagesByDate",[p.bind]))()
highlightOrFetchMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const s=this.messagesManager.findMessage(e)
s?this.scrollToMessageId(s.id,Object.assign({highlight:!0,position:"start",autoExpand:!0,behavior:this.capabilities.isIOS?"smooth":null},t)):this.fetchMessages({target_message_id:e})}static#we=(()=>dt7948.n(this.prototype,"highlightOrFetchMessage",[a.action]))()
resetComposerMessage(){this.args.thread.draft=S.default.createDraftMessage(this.args.thread.channel,{user:this.currentUser,thread:this.args.thread})}static#Se=(()=>dt7948.n(this.prototype,"resetComposerMessage",[a.action]))()
async#Oe(e){if(!this.chatThreadPane.sending){this.chatThreadPane.sending=!0,this._ignoreNextScroll=!0,(0,v.stackingContextFix)(this.scroller,(async()=>{await this.args.thread.stageMessage(e)})),this.resetComposerMessage(),this.messagesLoader.canLoadMoreFuture||this.scrollToLatestMessage()
try{const t={message:e.message,in_reply_to_id:null,staged_id:e.id,upload_ids:e.uploads.map((e=>e.id)),thread_id:e.thread.id},s=await this.chatApi.sendMessage(this.args.thread.channel.id,Object.assign({},t,(0,C.extractCurrentTopicInfo)(this)))
this.args.thread.currentUserMembership??=k.default.create({notification_level:h.NotificationLevels.TRACKING,last_read_message_id:s.message_id}),this.scrollToLatestMessage()}catch(t){this.#wt(e.id,t)}finally{this.chatDraftsManager.remove(this.args.thread.channel.id,this.args.thread.id),this.chatThreadPane.sending=!1}}}async#Ae(e){this.chatThreadPane.sending=!0
const t={message:e.message,upload_ids:e.uploads.map((e=>e.id))}
this.resetComposerMessage()
try{return await this.chatApi.editMessage(e.channel.id,e.id,t)}catch(s){(0,d.popupAjaxError)(s)}finally{this.chatDraftsManager.remove(this.args.thread.channel.id,this.args.thread.id),this.chatThreadPane.sending=!1}}async scrollToBottom(){this._ignoreNextScroll=!0,await(0,w.scrollListToBottom)(this.scroller)}static#Te=(()=>dt7948.n(this.prototype,"scrollToBottom",[a.action]))()
async scrollToTop(){this._ignoreNextScroll=!0,await(0,w.scrollListToTop)(this.scroller)}static#xe=(()=>dt7948.n(this.prototype,"scrollToTop",[a.action]))()
resendStagedMessage(){}static#Ee=(()=>dt7948.n(this.prototype,"resendStagedMessage",[a.action]))()
#wt(e,t){const s=this.args.thread.messagesManager.findStagedMessage(e)
s&&(t.jqXHR?.responseJSON?.errors?.length?s.error=t.jqXHR.responseJSON.errors[0]:(this.chat.markNetworkAsUnreliable(),s.error="network_error")),this.resetComposerMessage()}#je(){const e=this._ignoreNextScroll
return this._ignoreNextScroll=!1,e}static#Pe=(()=>(0,D.setComponentTemplate)((0,L.createTemplateFactory)({id:"5Hov7UQ6",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-thread",[52,[30,0,["messagesLoader","loading"]],"loading"]],null]],[16,"data-id",[30,1,["id"]]],[4,[32,1],[[30,0,["setup"]]],null],[4,[32,2],[[30,0,["teardown"]]],null],[12],[1,"\\n      "],[8,[32,3],null,[["@onRegisterScroller","@onScroll","@onScrollEnd"],[[30,0,["registerScroller"]],[30,0,["onScroll"]],[30,0,["onScrollEnd"]]]],[["default"],[[[[1,"\\n        "],[8,[32,4],null,[["@didResizePane"],[[30,0,["didResizePane"]]]],[["default"],[[[[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,0,["messagesManager","messages"]]],null]],null],"id",[[[1,"            "],[8,[32,5],null,[["@message","@disableMouseEvents","@resendStagedMessage","@fetchMessagesByDate","@context"],[[30,2],[30,0,["isScrolling"]],[30,0,["resendStagedMessage"]],[30,0,["fetchMessagesByDate"]],"thread"]],null],[1,"\\n"]],[2]],null],[1,"\\n"],[41,[51,[30,0,["messagesLoader","fetchedOnce"]]],[[[41,[30,0,["messagesLoader","loading"]],[[[1,"              "],[8,[32,6],null,null,null],[1,"\\n"]],[]],null]],[]],null],[1,"        "]],[]]]]],[1,"\\n      "]],[]]]]],[1,"\\n\\n      "],[8,[32,7],null,[["@onScrollToBottom","@isVisible"],[[30,0,["scrollToLatestMessage"]],[30,0,["needsArrow"]]]],null],[1,"\\n\\n"],[41,[30,0,["chatThreadPane","selectingMessages"]],[[[1,"        "],[8,[32,8],null,[["@pane","@messagesManager"],[[30,0,["chatThreadPane"]],[30,0,["messagesManager"]]]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[32,9],null,[["@channel","@thread","@onSendMessage","@uploadDropZone","@scroller"],[[30,3],[30,1],[30,0,["onSendMessage"]],[30,0,["uploadDropZone"]],[30,0,["scroller"]]]],null],[1,"\\n"]],[]]],[1,"\\n      "],[8,[32,10],null,[["@model"],[[30,1]]],null],[1,"\\n      "],[8,[32,11],null,[["@thread"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@thread","message","@channel"],false,["if","each","-track-array","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-thread.js",scope:()=>[l.default,i.default,r.default,A.default,P.default,E.default,O.default,x.default,j.default,T.default,U.default,g.default],isStrictMode:!0}),this))()}e.default=I})),define("discourse/plugins/chat/discourse/components/chat-to-topic-selector",["exports","@ember/component","@ember/object/computed","@ember/template","discourse-common/utils/decorators","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.NEW_TOPIC_SELECTION=e.NEW_MESSAGE_SELECTION=e.EXISTING_TOPIC_SELECTION=void 0
const r=(0,i.createTemplateFactory)({id:"OEXnvwcR",block:'[[[10,0],[14,0,"chat-to-topic-selector"],[12],[1,"\\n  "],[10,0],[14,0,"radios"],[12],[1,"\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-topic","move-to-entity",[30,0,["newTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.split_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-existing-topic"],[12],[1,"\\n      "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-existing-topic","move-to-entity",[30,0,["existingTopicSelection"]],[30,0,["selection"]]]],null],[1,"\\n      "],[10,"b"],[12],[1,[28,[35,1],["topic.merge_topic.radio_label"],null]],[13],[1,"\\n    "],[13],[1,"\\n\\n"],[41,[30,0,["allowNewMessage"]],[[[1,"      "],[10,"label"],[14,0,"radio-label"],[14,"for","move-to-new-message"],[12],[1,"\\n        "],[8,[39,0],null,[["@id","@name","@value","@selection"],["move-to-new-message","move-to-entity",[30,0,["newMessageSelection"]],[30,0,["selection"]]]],null],[1,"\\n        "],[10,"b"],[12],[1,[28,[35,1],["topic.move_to_new_message.radio_label"],null]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n\\n"],[41,[30,0,["newTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["newTopicInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-topic-name"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.split_topic.topic_name"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-topic-name"]],null],[1,"\\n\\n      "],[10,"label"],[12],[1,[28,[35,1],["categories.category"],null]],[13],[1,"\\n\\n      "],[8,[39,4],[[24,0,"small"]],[["@id","@value","@onChange"],["new-topic-category-selector",[30,0,["categoryId"]],[28,[37,5],[[28,[37,6],[[30,0,["categoryId"]]],null]],null]]],null],[1,"\\n\\n"],[41,[30,0,["canAddTags"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable","@categoryId"],[[30,0,["tags"]],true,[30,0,["categoryId"]]]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["existingTopic"]],[[[1,"    "],[10,2],[12],[1,[30,0,["existingTopicInstruction"]]],[13],[1,"\\n    "],[10,"form"],[12],[1,"\\n      "],[8,[39,8],null,[["@topicChangedCallback"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[37,9],[[30,0,["allowNewMessage"]],[30,0,["newMessage"]]],null],[[[1,"    "],[10,2],[12],[1,[30,0,["newMessageInstruction"]]],[13],[1,"\\n\\n    "],[10,"form"],[12],[1,"\\n      "],[10,"label"],[14,"for","split-message-title"],[12],[1,"\\n        "],[1,[28,[35,1],["topic.move_to_new_message.message_title"],null]],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[39,3],null,[["@value","@placeholderKey","@id"],[[30,0,["topicTitle"]],"composer.title_placeholder","split-message-title"]],null],[1,"\\n\\n"],[41,[30,0,["canTagMessages"]],[[[1,"        "],[10,"label"],[12],[1,[28,[35,1],["tagging.tags"],null]],[13],[1,"\\n        "],[8,[39,7],null,[["@tags","@filterable"],[[30,0,["tags"]],true]],null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]],null],[13]],["@topicChangedCallback"],false,["radio-button","i18n","if","text-field","category-chooser","fn","mut","tag-chooser","choose-topic","and"]]',moduleName:"discourse/plugins/chat/discourse/components/chat-to-topic-selector.hbs",isStrictMode:!1}),o=e.NEW_TOPIC_SELECTION="new_topic",c=e.EXISTING_TOPIC_SELECTION="existing_topic",l=e.NEW_MESSAGE_SELECTION="new_message"
class d extends t.default{newTopicSelection=(()=>o)()
existingTopicSelection=(()=>c)()
newMessageSelection=(()=>l)()
selection=null
static#e=(()=>dt7948.g(this.prototype,"newTopic",[(0,s.equal)("selection",o)]))()
#St=(()=>{dt7948.i(this,"newTopic")})()
static#s=(()=>dt7948.g(this.prototype,"existingTopic",[(0,s.equal)("selection",c)]))()
#kt=(()=>{dt7948.i(this,"existingTopic")})()
static#n=(()=>dt7948.g(this.prototype,"newMessage",[(0,s.equal)("selection",l)]))()
#Tt=(()=>{dt7948.i(this,"newMessage")})()
static#r=(()=>dt7948.g(this.prototype,"canAddTags",[(0,s.alias)("site.can_create_tag")]))()
#xt=(()=>{dt7948.i(this,"canAddTags")})()
static#c=(()=>dt7948.g(this.prototype,"canTagMessages",[(0,s.alias)("site.can_tag_pms")]))()
#jt=(()=>{dt7948.i(this,"canTagMessages")})()
topicTitle=null
categoryId=null
tags=null
selectedTopicId=null
chatMessageIds=null
chatChannelId=null
newTopicInstruction(){return(0,a.htmlSafe)(this.instructionLabels[o])}static#l=(()=>dt7948.n(this.prototype,"newTopicInstruction",[(0,n.default)()]))()
existingTopicInstruction(){return(0,a.htmlSafe)(this.instructionLabels[c])}static#d=(()=>dt7948.n(this.prototype,"existingTopicInstruction",[(0,n.default)()]))()
newMessageInstruction(){return(0,a.htmlSafe)(this.instructionLabels[l])}static#h=(()=>dt7948.n(this.prototype,"newMessageInstruction",[(0,n.default)()]))()}e.default=d,(0,t.setComponentTemplate)(r,d)}))
define("discourse/plugins/chat/discourse/components/chat-upload-drop-zone",["exports","@glimmer/component","discourse-i18n","discourse/plugins/chat/discourse/models/chat-thread","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{get title(){return this.#Et()?s.default.t("chat.upload_to_thread"):s.default.t("chat.upload_to_channel",{title:this.args.model.title})}#Et(){return this.args.model instanceof a.default}static#e=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"9AdGyOVy",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-upload-drop-zone"],[12],[1,"\\n      "],[10,0],[14,0,"chat-upload-drop-zone__content"],[12],[1,"\\n        "],[10,0],[14,0,"chat-upload-drop-zone__background"],[12],[1,"\\n          "],[10,"svg"],[14,"width","94"],[14,"height","90"],[14,"viewBox","0 0 94 90"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n            "],[10,"path"],[14,"d","M94 40.5591C94 69.8685 64.0686 90 40.9592 90C17.8499 90 0 83.9085 0 60.6907C0 37.4729 28.458 0 51.5674 0C74.6768 0 94 17.3413 94 40.5591Z"],[14,"fill","#D1F0FF"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-upload-drop-zone__illustration"],[12],[1,"\\n          "],[10,"svg"],[14,"width","106"],[14,"height","84"],[14,"viewBox","0 0 106 84"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n            "],[10,"rect"],[14,"x","55.832"],[14,"y","6.82959"],[14,"width","45.7854"],[14,"height","33.8408"],[14,"transform","rotate(13.4039 55.832 6.82959)"],[14,"fill","#D9D9D9"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M100.66 13.7645L61.1414 4.34705C58.6715 3.75846 56.1786 5.37298 55.59 7.84288L47.6214 41.2815C47.0102 43.8464 48.5297 46.3167 50.9996 46.9053L90.518 56.3227C92.9879 56.9113 95.5532 55.4145 96.1644 52.8496L104.133 19.4109C104.722 16.941 103.225 14.3757 100.66 13.7645ZM58.7093 41.5144C58.5961 41.9894 58.1482 42.1838 57.7682 42.0933L53.2084 41.0067C52.7334 40.8935 52.5163 40.5406 52.6295 40.0656L53.7161 35.5058C53.8067 35.1258 54.1822 34.8137 54.6572 34.9269L59.122 35.9909C59.502 36.0815 59.7915 36.552 59.7009 36.932L58.7093 41.5144ZM61.6069 29.3549C61.4938 29.8299 61.0459 30.0243 60.6659 29.9338L56.1061 28.8472C55.6311 28.734 55.414 28.3811 55.5272 27.9061L56.6138 23.3463C56.7044 22.9663 57.0799 22.6542 57.5549 22.7674L62.0197 23.8314C62.3997 23.922 62.6891 24.3925 62.5986 24.7725L61.5119 29.3323L61.6069 29.3549ZM64.5046 17.1954C64.3914 17.6704 63.9435 17.8648 63.5635 17.7743L59.0037 16.6877C58.5287 16.5745 58.3117 16.2216 58.4249 15.7466L59.5115 11.1868C59.602 10.8068 59.9776 10.4947 60.4526 10.6079L64.9174 11.6719C65.2974 11.7625 65.5868 12.233 65.4962 12.613L64.5046 17.1954ZM81.6894 46.1876C81.4857 47.0426 80.5673 47.5264 79.8073 47.3453L64.6079 43.7232C63.753 43.5195 63.2464 42.6961 63.4502 41.8411L65.6234 32.7215C65.8045 31.9615 66.6506 31.36 67.5056 31.5637L82.705 35.1858C83.4649 35.3669 84.0438 36.308 83.8627 37.068L81.6894 46.1876ZM86.036 27.9483C85.8322 28.8033 84.9138 29.2872 84.1538 29.1061L68.9544 25.484C68.0995 25.2802 67.593 24.4568 67.7967 23.6018L69.97 14.4822C70.1511 13.7222 70.9971 13.1207 71.8521 13.3245L87.0515 16.9466C87.8114 17.1277 88.3903 18.0687 88.2092 18.8287L86.036 27.9483ZM92.1479 49.483C92.0347 49.958 91.5868 50.1524 91.2068 50.0619L86.742 48.9979C86.267 48.8847 86.05 48.5318 86.1631 48.0568L87.2498 43.497C87.3403 43.117 87.8109 42.8276 88.1908 42.9181L92.7507 44.0048C93.1306 44.0953 93.4201 44.5659 93.3295 44.9458L92.2429 49.5057L92.1479 49.483ZM95.0456 37.3235C94.9324 37.7985 94.4845 37.9929 94.1045 37.9024L89.6397 36.8384C89.1647 36.7252 88.9476 36.3723 89.0608 35.8973L90.1474 31.3375C90.238 30.9575 90.6135 30.6455 91.0885 30.7586L95.5533 31.8226C95.9333 31.9132 96.2228 32.3837 96.1322 32.7637L95.0456 37.3235ZM97.9432 25.164C97.8301 25.639 97.3822 25.8334 97.0022 25.7429L92.5374 24.6789C92.0624 24.5657 91.8453 24.2128 91.9585 23.7378L93.0451 19.178C93.1357 18.798 93.5112 18.486 93.8912 18.5765L98.356 19.6405C98.736 19.731 99.0254 20.2016 98.9349 20.5816L97.8483 25.1414L97.9432 25.164Z"],[14,"fill","#AFAFAF"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M30.7898 24.814L27.2823 9.2672L4.41944 14.4252C2.81904 14.7863 1.95958 16.3017 2.29486 17.7878L14.2615 70.8296C14.6226 72.43 16.0236 73.3153 17.624 72.9542L56.0337 64.2887C57.5198 63.9534 58.5193 62.5266 58.1582 60.9262L49.699 23.4311L34.1523 26.9385C32.5519 27.2996 31.1508 26.4144 30.7898 24.814ZM48.719 19.0871C48.5643 18.4012 48.0666 17.7927 47.4804 17.3243L33.7501 8.64894C33.0754 8.32063 32.3121 8.13243 31.6263 8.28717L30.9404 8.44191L34.2415 23.0742L48.8738 19.773L48.719 19.0871Z"],[14,"fill","#0AADFF"],[12],[13],[1,"\\n            "],[10,"rect"],[14,"x","41.7334"],[14,"y","40.3967"],[14,"width","37.6309"],[14,"height","28.6511"],[14,"transform","rotate(6.29289 41.7334 40.3967)"],[14,"fill","#66CCFF"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M76.768 40.4721L44.4638 36.9097C42.3671 36.6785 40.548 38.2071 40.3254 40.2261L37.8591 62.5905C37.6279 64.6872 39.0788 66.4977 41.1755 66.729L73.4796 70.2913C75.4987 70.514 77.3869 69.0716 77.6181 66.9749L80.0843 44.6105C80.307 42.5915 78.787 40.6947 76.768 40.4721ZM73.4248 66.5125L42.0524 63.0529C41.7418 63.0187 41.6036 62.8462 41.6379 62.5356L44.0014 41.103C44.0271 40.8701 44.2081 40.6542 44.5187 40.6885L75.891 44.1481C76.124 44.1738 76.3312 44.4324 76.3056 44.6654L73.9421 66.098C73.9078 66.4086 73.6577 66.5382 73.4248 66.5125ZM49.9226 44.4284C48.1365 44.2314 46.6623 45.4836 46.4739 47.192C46.2769 48.978 47.4514 50.4437 49.2375 50.6407C50.9459 50.8291 52.4892 49.6631 52.6862 47.8771C52.8746 46.1687 51.631 44.6168 49.9226 44.4284ZM45.725 59.6852L70.5743 62.4255L71.2594 56.2131L65.1708 48.7036C64.8254 48.2725 64.2818 48.2126 63.8507 48.558L53.5908 56.7799L50.8186 53.4088C50.4732 52.9777 49.9296 52.9178 49.4985 53.2632L46.136 55.9578L45.725 59.6852Z"],[14,"fill","white"],[12],[13],[1,"\\n            "],[10,"path"],[14,"d","M37.8174 63.0181L77.5892 66.862L77.012 72.8342C76.9057 73.9336 75.9283 74.7388 74.8288 74.6325L39.0385 71.1734C37.939 71.0671 37.1339 70.0897 37.2402 68.9902L37.8174 63.0181Z"],[14,"fill","white"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n        "],[10,0],[14,0,"chat-upload-drop-zone__text"],[12],[1,"\\n          "],[10,1],[14,0,"chat-upload-drop-zone__text__title"],[12],[1,"\\n            "],[1,[30,0,["title"]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-upload-drop-zone.js",isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat-upload",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","@ember/template","truth-helpers","discourse/lib/uploads","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[i.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#s=(()=>dt7948.g(this.prototype,"loaded",[s.tracked],(function(){return!1})))()
#Pt=(()=>{dt7948.i(this,"loaded")})()
IMAGE_TYPE="image"
VIDEO_TYPE="video"
AUDIO_TYPE="audio"
ATTACHMENT_TYPE="attachment"
get type(){return(0,c.isImage)(this.args.upload.original_filename)?this.IMAGE_TYPE:(0,c.isVideo)(this.args.upload.original_filename)?this.VIDEO_TYPE:(0,c.isAudio)(this.args.upload.original_filename)?this.AUDIO_TYPE:this.ATTACHMENT_TYPE}get size(){const e=this.args.upload.width,t=this.args.upload.height,s=Math.min(this.siteSettings.max_image_width/e,this.siteSettings.max_image_height/t)
return{width:e*s,height:t*s}}get imageUrl(){return this.args.upload.thumbnail?.url??this.args.upload.url}get imageStyle(){if(this.args.upload.dominant_color&&!this.loaded)return(0,r.htmlSafe)(`background-color: #${this.args.upload.dominant_color};`)}imageLoaded(){this.loaded=!0}static#n=(()=>dt7948.n(this.prototype,"imageLoaded",[n.action]))()
static#r=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"eGuoRuIs",block:'[[[1,"\\n"],[41,[28,[32,0],[[30,0,["type"]],[30,0,["IMAGE_TYPE"]]],null],[[[1,"      "],[11,"img"],[24,0,"chat-img-upload"],[16,"data-orig-src",[30,1,["short_url"]]],[16,"data-large-src",[30,1,["url"]]],[16,"height",[30,0,["size","height"]]],[16,"width",[30,0,["size","width"]]],[16,"src",[30,0,["imageUrl"]]],[16,5,[30,0,["imageStyle"]]],[24,"loading","lazy"],[24,"tabindex","0"],[16,"data-dominant-color",[30,1,["dominant_color"]]],[4,[32,1],["load",[30,0,["imageLoaded"]]],null],[12],[13],[1,"\\n"]],[]],[[[41,[28,[32,0],[[30,0,["type"]],[30,0,["VIDEO_TYPE"]]],null],[[[1,"      "],[10,"video"],[14,0,"chat-video-upload"],[14,"preload","metadata"],[14,"height","150"],[14,"controls",""],[12],[1,"\\n        "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[28,[32,0],[[30,0,["type"]],[30,0,["AUDIO_TYPE"]]],null],[[[1,"      "],[10,"audio"],[14,0,"chat-audio-upload"],[14,"preload","metadata"],[14,"controls",""],[12],[1,"\\n        "],[10,"source"],[15,"src",[30,1,["url"]]],[12],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[1,"      "],[10,3],[14,0,"chat-other-upload"],[15,"data-orig-href",[30,1,["short_url"]]],[15,6,[30,1,["url"]]],[12],[1,"\\n        "],[1,[30,1,["original_filename"]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]],[]]]],[]]],[1,"  "]],["@upload"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-upload.js",scope:()=>[o.eq,a.on],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat-user-avatar",["exports","@glimmer/component","@ember/service","@ember/template","discourse/helpers/concat-class","discourse/helpers/user-avatar","discourse/lib/url","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
get avatar(){return(0,a.htmlSafe)((0,i.renderAvatar)(this.args.user,{imageSize:this.avatarSize}))}get interactive(){return this.args.interactive??!0}get avatarSize(){return this.args.avatarSize||"tiny"}get showPresence(){return this.args.showPresence??!0}get isOnline(){const e=(this.args.chat||this.chat).presenceChannel?.users
return this.showPresence&&!!e?.find((e=>{let{id:t,username:s}=e
return this.args.user?.id===t||this.args.user?.username===s}))}get userPath(){return(0,r.userPath)(this.args.user.username)}static#s=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"hv+lI3fX",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-user-avatar",[52,[30,0,["isOnline"]],"is-online"]],null]],[15,"data-username",[30,1,["username"]]],[12],[1,"\\n"],[41,[30,0,["interactive"]],[[[1,"        "],[10,3],[14,0,"chat-user-avatar__container"],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[1,[30,0,["avatar"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,1],[14,0,"chat-user-avatar__container"],[12],[1,"\\n          "],[1,[30,0,["avatar"]]],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@user"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-avatar.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat-user-display-name",["exports","@glimmer/component","@ember/service","discourse/helpers/concat-class","discourse/lib/utilities","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get shouldPrioritizeNameInUx(){return!this.siteSettings.prioritize_username_in_ux}get hasValidName(){return this.args.user?.name&&this.args.user.name.trim().length>0}get formattedUsername(){return(0,n.formatUsername)(this.args.user?.username)}get shouldShowNameFirst(){return this.shouldPrioritizeNameInUx&&this.hasValidName}get shouldShowNameLast(){return!this.shouldPrioritizeNameInUx&&this.hasValidName}static#s=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"VcFbgqwq",block:'[[[1,"\\n    "],[10,1],[14,0,"chat-user-display-name"],[12],[1,"\\n"],[41,[30,0,["shouldShowNameFirst"]],[[[1,"        "],[10,1],[14,0,"chat-user-display-name__name -first"],[12],[1,[30,1,["name"]]],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,1],[15,0,[28,[32,0],["chat-user-display-name__username",[52,[51,[30,0,["shouldShowNameFirst"]]],"-first"]],null]],[12],[1,"\\n        "],[1,[30,0,["formattedUsername"]]],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[30,0,["shouldShowNameLast"]],[[[1,"        "],[10,1],[14,0,"chat-user-display-name__name"],[12],[1,[30,1,["name"]]],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@user"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-display-name.js",scope:()=>[a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat-user-info",["exports","@glimmer/component","ember-modifier","discourse/components/user-status-message","discourse/lib/url","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/components/chat-user-display-name","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{trackUserStatus=(()=>(0,s.modifier)(((e,t)=>{let[s]=t
return s.statusManager.trackStatus(),()=>{s.statusManager.stopTrackingStatus()}})))()
get avatarSize(){return this.args.avatarSize??"medium"}get userPath(){return(0,n.userPath)(this.args.user.username)}get interactive(){return this.args.interactive??!1}get showStatus(){return this.args.showStatus??!1}get showStatusDescription(){return this.args.showStatusDescription??!1}static#e=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"xZaYb+tP",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[32,0],null,[["@user","@avatarSize","@interactive"],[[30,1],[30,0,["avatarSize"]],[30,0,["interactive"]]]],null],[1,"\\n\\n"],[41,[30,0,["interactive"]],[[[1,"        "],[10,3],[15,6,[30,0,["userPath"]]],[15,"data-user-card",[30,1,["username"]]],[12],[1,"\\n          "],[8,[32,1],null,[["@user"],[[30,1]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[8,[32,1],null,[["@user"],[[30,1]]],null],[1,"\\n"]],[]]],[1,"\\n"],[41,[30,0,["showStatus"]],[[[1,"        "],[11,0],[24,0,"user-status"],[4,[30,0,["trackUserStatus"]],[[30,1]],null],[12],[1,"\\n          "],[8,[32,2],null,[["@status","@showDescription"],[[30,1,["status"]],[30,0,["showStatusDescription"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null]],[]],null],[1,"  "]],["@user"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat-user-info.js",scope:()=>[i.default,r.default,a.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/composer/button",["exports","discourse-common/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"FFGdtaBb",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-composer-button__wrapper"],[12],[1,"\\n    "],[11,"button"],[24,4,"button"],[24,0,"chat-composer-button"],[17,1],[12],[1,"\\n      "],[1,[28,[32,0],[[30,2]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"]],["&attrs","@icon"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/composer/button.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"button:ChatComposerButton"))
e.default=i})),define("discourse/plugins/chat/discourse/components/chat/composer/channel",["exports","@ember/object","@ember/service","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-composer"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends i.default{static#e=(()=>dt7948.g(this.prototype,"composer",[(0,s.service)("chat-channel-composer")]))()
#X=(()=>{dt7948.i(this,"composer")})()
static#s=(()=>dt7948.g(this.prototype,"pane",[(0,s.service)("chat-channel-pane")]))()
#Q=(()=>{dt7948.i(this,"pane")})()
static#n=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#r=(()=>dt7948.g(this.prototype,"chatDraftsManager",[s.service]))()
#Y=(()=>{dt7948.i(this,"chatDraftsManager")})()
context="channel"
composerId="channel-composer"
persistDraft(){this.chatDraftsManager.add(this.draft,this.args.channel.id)}static#c=(()=>dt7948.n(this.prototype,"persistDraft",[(0,a.debounce)(2e3)]))()
destroyDraft(){this.chatDraftsManager.remove(this.args.channel.id)}static#l=(()=>dt7948.n(this.prototype,"destroyDraft",[t.action]))()
resetDraft(){this.args.channel.resetDraft(this.currentUser)}static#d=(()=>dt7948.n(this.prototype,"resetDraft",[t.action]))()
get draft(){return this.args.channel.draft}get presenceChannelName(){return`/chat-reply/${this.args.channel.id}`}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.channel.canModifyMessages(this.currentUser)}get lastMessage(){return this.args.channel.lastMessage}lastUserMessage(e){return this.args.channel.messagesManager.findLastUserMessage(e)}get placeholder(){return this.args.channel.canModifyMessages(this.currentUser)?this.chat.userCanInteractWithChat?this.#At(this.args.channel):n.default.t("chat.placeholder_silenced"):n.default.t(`chat.placeholder_new_message_disallowed.${this.args.channel.status}`)}handleEscape(e){e.stopPropagation(),this.draft?.inReplyTo?this.draft.inReplyTo=null:this.draft?.editing?this.args.channel.resetDraft(this.currentUser):e.target.blur()}#At(e){if(e.isDirectMessageChannel){if(e.chatable.group)return n.default.t("chat.placeholder_group")
{const t=e.chatable.users
return 1===t.length&&t[0].id===this.currentUser.id?n.default.t("chat.placeholder_self"):n.default.t("chat.placeholder_users",{commaSeparatedNames:t.map((e=>e.name||`@${e.username}`)).join(n.default.t("word_connector.comma"))})}}return n.default.t("chat.placeholder_channel",{channelName:`#${e.title}`})}}e.default=r})),define("discourse/plugins/chat/discourse/components/chat/composer/separator",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"DwI6b+Xh",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-composer-separator"],[12],[13],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/composer/separator.js",isStrictMode:!0}),(0,a.default)(void 0,"separator:ChatComposerSeparator"))
e.default=n})),define("discourse/plugins/chat/discourse/components/chat/composer/thread",["exports","@ember/object","@ember/service","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/components/chat-composer"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends r.default{static#e=(()=>dt7948.g(this.prototype,"channelComposer",[(0,s.service)("chat-channel-composer")]))()
#Ot=(()=>{dt7948.i(this,"channelComposer")})()
static#s=(()=>dt7948.g(this.prototype,"composer",[(0,s.service)("chat-thread-composer")]))()
#X=(()=>{dt7948.i(this,"composer")})()
static#n=(()=>dt7948.g(this.prototype,"pane",[(0,s.service)("chat-thread-pane")]))()
#Q=(()=>{dt7948.i(this,"pane")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"chatDraftsManager",[s.service]))()
#Y=(()=>{dt7948.i(this,"chatDraftsManager")})()
context="thread"
composerId="thread-composer"
persistDraft(){this.chatDraftsManager.add(this.draft,this.args.thread.channel.id,this.args.thread.id)}static#l=(()=>dt7948.n(this.prototype,"persistDraft",[(0,a.debounce)(2e3)]))()
destroyDraft(){this.chatDraftsManager.remove(this.args.thread.channel.id,this.args.thread.id)}static#d=(()=>dt7948.n(this.prototype,"destroyDraft",[t.action]))()
resetDraft(){this.args.thread.resetDraft(this.currentUser)}static#h=(()=>dt7948.n(this.prototype,"resetDraft",[t.action]))()
get draft(){return this.args.thread.draft}get disabled(){return!this.chat.userCanInteractWithChat||!this.args.thread.channel.canModifyMessages(this.currentUser)}get presenceChannelName(){const e=this.args.thread
return`/chat-reply/${e.channel.id}/thread/${e.id}`}get placeholder(){return n.default.t("chat.placeholder_thread")}lastUserMessage(e){return this.args.thread.messagesManager.findLastUserMessage(e)}handleEscape(e){if(this.draft.editing)return e.stopPropagation(),void(this.args.thread.draft=i.default.createDraftMessage(this.args.thread.channel,{user:this.currentUser,thread:this.args.thread}))
this.isFocused?(e.stopPropagation(),this.composer.blur()):this.pane.close().then((()=>{this.channelComposer.focus()}))}}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/direct-message-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"appEvents",[a.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#n=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get shouldRender(){return this.chat.userCanDirectMessage&&!this.args.user.suspended}async startChatting(){try{const e=await this.chat.upsertDmChannel({usernames:[this.args.user.username]})
e&&this.router.transitionTo("chat.channel",...e.routeModels)}catch(e){(0,i.popupAjaxError)(e)}finally{this.args.modal&&this.appEvents.trigger("card:close")}}static#r=(()=>dt7948.n(this.prototype,"startChatting",[s.action]))()
static#c=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"2UMmI4GN",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-primary chat-direct-message-btn"]],[["@action","@label","@icon"],[[30,0,["startChatting"]],"chat.title_capitalized","d-chat"]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/direct-message-button.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/browse",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/browse-channels","discourse/plugins/chat/discourse/components/chat/navbar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[n.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"chatHistory",[n.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#c=(()=>dt7948.g(this.prototype,"showThreadFullTitle",[s.tracked],(function(){return!1})))()
#Ut=(()=>{dt7948.i(this,"showThreadFullTitle")})()
get showfullTitle(){return this.chatStateManager.isDrawerExpanded&&this.showThreadFullTitle}static#l=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"QoAm6kH0",block:'[[[1,"\\n    "],[10,0],[14,0,"c-drawer-routes --browse"],[12],[1,"\\n      "],[8,[32,0],null,[["@onClick","@showFullTitle"],[[30,0,["chat","toggleDrawer"]],[30,0,["showfullTitle"]]]],[["default"],[[[[1,"\\n        "],[8,[30,1,["BackButton"]],null,[["@route"],["chat.channels"]],null],[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.browse.title"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["NewChannelButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"        "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[28,[32,2],[[30,3,["currentTab"]]],null]],null]],null],null,[[[1,"            "],[8,[32,3],null,[["@currentTab"],[[30,4]]],null],[1,"\\n"]],[4]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a","@params","tab"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/browse.js",scope:()=>[o.default,i.default,a.array,r.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-info-members",["exports","@glimmer/component","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat/routes/channel-info-members","discourse/plugins/chat/discourse/components/chat/routes/channel-info-nav","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[n.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
get backButton(){return{route:"chat.channel",models:this.chat.activeChannel?.routeModels,title:i.default.t("chat.return_to_channel")}}async fetchChannel(){if(!this.args.params?.channelId)return
const e=await this.chatChannelsManager.find(this.args.params.channelId)
this.chat.activeChannel=e}static#r=(()=>dt7948.n(this.prototype,"fetchChannel",[s.action]))()
static#c=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"prPsbpc4",block:'[[[1,"\\n    "],[11,0],[24,0,"c-drawer-routes --channel-info-members"],[4,[32,0],[[30,0,["fetchChannel"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"        "],[8,[32,1],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n          "],[8,[30,1,["BackButton"]],null,[["@title","@route","@routeModels"],[[30,0,["backButton","title"]],[30,0,["backButton","route"]],[30,0,["backButton","models"]]]],null],[1,"\\n          "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n          "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n            "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n            "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n            "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n          "]],[2]]]]],[1,"\\n        "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"          "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n            "],[8,[32,2],null,[["@channel","@tab"],[[30,0,["chat","activeChannel"]],"members"]],null],[1,"\\n            "],[8,[32,3],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-info-members.js",scope:()=>[a.default,r.default,c.default,o.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-info-settings",["exports","@glimmer/component","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat/routes/channel-info-nav","discourse/plugins/chat/discourse/components/chat/routes/channel-info-settings","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[n.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
get backButton(){return{route:"chat.channel",models:this.chat.activeChannel?.routeModels,title:i.default.t("chat.return_to_channel")}}async fetchChannel(){if(!this.args.params?.channelId)return
const e=await this.chatChannelsManager.find(this.args.params.channelId)
this.chat.activeChannel=e}static#r=(()=>dt7948.n(this.prototype,"fetchChannel",[s.action]))()
static#c=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"odr3At7e",block:'[[[1,"\\n    "],[11,0],[24,0,"c-drawer-routes --channel-info-settings"],[4,[32,0],[[30,0,["fetchChannel"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"        "],[8,[32,1],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n          "],[8,[30,1,["BackButton"]],null,[["@title","@route","@routeModels"],[[30,0,["backButton","title"]],[30,0,["backButton","route"]],[30,0,["backButton","models"]]]],null],[1,"\\n          "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n          "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n            "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n            "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n            "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n          "]],[2]]]]],[1,"\\n        "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"          "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n            "],[8,[32,2],null,[["@channel","@tab"],[[30,0,["chat","activeChannel"]],"settings"]],null],[1,"\\n            "],[8,[32,3],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-info-settings.js",scope:()=>[a.default,r.default,o.default,c.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-thread",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/service","discourse/lib/ajax-error","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-thread","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[o.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[o.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[o.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"chatHistory",[o.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#c=(()=>dt7948.g(this.prototype,"showThreadFullTitle",[s.tracked],(function(){return!1})))()
#Ut=(()=>{dt7948.i(this,"showThreadFullTitle")})()
get showfullTitle(){return this.chatStateManager.isDrawerExpanded&&this.showThreadFullTitle}get backButton(){const e={models:this.chat.activeChannel?.routeModels}
return"chat.channel.threads"===this.chatHistory.previousRoute?.name?(e.title=l.default.t("chat.return_to_threads_list"),e.route="chat.channel.threads"):"chat.threads"===this.chatHistory.previousRoute?.name?(e.title=l.default.t("chat.my_threads.title"),e.route="chat.threads",e.models=[]):(e.title=l.default.t("chat.return_to_channel"),e.route="chat.channel"),e}get threadTitle(){return this.chat.activeChannel?.activeThread?.title??l.default.t("chat.thread.label")}async fetchChannelAndThread(){if(this.args.params?.channelId&&this.args.params?.threadId)try{const e=await this.chatChannelsManager.find(this.args.params.channelId)
this.chat.activeChannel=e,e.threadsManager.find(e.id,this.args.params.threadId).then((e=>{this.chat.activeChannel.activeThread=e}))}catch(e){(0,c.popupAjaxError)(e)}}static#l=(()=>dt7948.n(this.prototype,"fetchChannelAndThread",[n.action]))()
setFullTitle(e){this.showThreadFullTitle=e}static#d=(()=>dt7948.n(this.prototype,"setFullTitle",[n.action]))()
static#h=(()=>(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"umWxGQAB",block:'[[[1,"\\n    "],[11,0],[24,0,"c-drawer-routes --channel-thread"],[4,[32,0],[[30,0,["fetchChannelAndThread"]]],null],[4,[32,1],[[30,0,["fetchChannelAndThread"]],[30,1,["channelId"]]],null],[4,[32,1],[[30,0,["fetchChannelAndThread"]],[30,1,["threadId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"        "],[8,[32,2],null,[["@onClick","@showFullTitle"],[[30,0,["chat","toggleDrawer"]],[30,0,["showfullTitle"]]]],[["default"],[[[[1,"\\n          "],[8,[30,2,["BackButton"]],null,[["@title","@route","@routeModels"],[[30,0,["backButton","title"]],[30,0,["backButton","route"]],[30,0,["backButton","models"]]]],null],[1,"\\n          "],[8,[30,2,["Title"]],null,[["@title","@icon"],[[30,0,["threadTitle"]],"discourse-threads"]],null],[1,"\\n          "],[8,[30,2,["Actions"]],null,null,[["default"],[[[[1,"\\n            "],[8,[30,3,["ToggleDrawerButton"]],null,null,null],[1,"\\n            "],[8,[30,3,["FullPageButton"]],null,null,null],[1,"\\n            "],[8,[30,3,["CloseDrawerButton"]],null,null,null],[1,"\\n          "]],[3]]]]],[1,"\\n        "]],[2]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"          "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[28,[32,3],[[30,0,["chat","activeChannel","activeThread"]]],null]],null]],null],null,[[[41,[30,4],[[[1,"                "],[8,[32,4],null,[["@thread","@targetMessageId","@setFullTitle"],[[30,4],[30,1,["messageId"]],[30,0,["setFullTitle"]]]],null],[1,"\\n"]],[]],null]],[4]],null],[1,"          "],[13],[1,"\\n"]],[]],null]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@params","navbar","a","thread"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-thread.js",scope:()=>[i.default,r.default,d.default,a.array,h.default],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-threads",["exports","@glimmer/component","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","@ember/template","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-thread-list","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatStateManager",[n.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
backLinkTitle=(()=>c.default.t("chat.return_to_list"))()
get title(){return(0,i.htmlSafe)(c.default.t("chat.threads.list")+" - "+(0,r.default)(this.chat.activeChannel.title))}async fetchChannel(){if(this.args.params?.channelId)try{const e=await this.chatChannelsManager.find(this.args.params.channelId)
this.chat.activeChannel=e}catch(e){(0,o.popupAjaxError)(e)}}static#r=(()=>dt7948.n(this.prototype,"fetchChannel",[s.action]))()
static#c=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"xJr4hufA",block:'[[[1,"\\n    "],[10,0],[14,0,"c-drawer-routes --channel-threads"],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"        "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n          "],[8,[30,1,["BackButton"]],null,[["@title","@route","@routeModels"],[[30,0,["backLinkTitle"]],"chat.channel",[30,0,["chat","activeChannel","routeModels"]]]],null],[1,"\\n          "],[8,[30,1,["Title"]],null,[["@title","@icon"],[[30,0,["title"]],"discourse-threads"]],null],[1,"\\n          "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n            "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n            "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n            "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n          "]],[2]]]]],[1,"\\n        "]],[1]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"        "],[11,0],[24,0,"chat-drawer-content"],[4,[32,1],[[30,0,["fetchChannel"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[1,"            "],[8,[32,2],null,[["@channel","@includeHeader"],[[30,0,["chat","activeChannel"]],false]],null],[1,"\\n"]],[]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-threads.js",scope:()=>[l.default,a.default,d.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channel",["exports","@glimmer/component","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/did-update","@ember/service","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[r.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[r.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[r.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"chatHistory",[r.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
get backBtnRoute(){return"chat.browse"===this.chatHistory.previousRoute?.name?"chat.browse":this.chat.activeChannel?.isDirectMessageChannel?"chat.direct-messages":"chat.channels"}fetchChannel(){if(this.args.params?.channelId)return this.chatChannelsManager.find(this.args.params.channelId).then((e=>{this.chat.activeChannel=e}))}static#c=(()=>dt7948.n(this.prototype,"fetchChannel",[a.action]))()
static#l=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"/0GqFz2H",block:'[[[1,"\\n    "],[10,0],[14,0,"c-drawer-routes --channel"],[12],[1,"\\n      "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n        "],[8,[30,1,["BackButton"]],null,[["@route"],[[30,0,["backBtnRoute"]]]],null],[1,"\\n        "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["ThreadsListButton"]],null,[["@channel"],[[30,0,["chat","activeChannel"]]]],null],[1,"\\n          "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"        "],[11,0],[24,0,"chat-drawer-content"],[4,[32,1],[[30,0,["fetchChannel"]]],null],[4,[32,2],[[30,0,["fetchChannel"]],[30,3,["channelId"]]],null],[12],[1,"\\n"],[41,[30,0,["chat","activeChannel"]],[[[42,[28,[31,2],[[28,[31,2],[[28,[32,3],[[30,0,["chat","activeChannel"]]],null]],null]],null],null,[[[41,[30,4],[[[1,"                "],[8,[32,4],null,[["@targetMessageId","@channel"],[[28,[31,3],[[30,3,["messageId"]]],null],[30,4]]],null],[1,"\\n"]],[]],null]],[4]],null]],[]],null],[1,"        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a","@params","channel"],false,["if","each","-track-array","readonly"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channel.js",scope:()=>[o.default,n.default,i.default,s.array,c.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/channels",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-public","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-footer","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"SUWSlHvZ",block:'[[[1,"\\n    "],[10,0],[14,0,"c-drawer-routes --channels"],[12],[1,"\\n      "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.heading"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"        "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n          "],[8,[32,2],null,[["@sortByActivity"],[true]],null],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,3],null,null,null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/channels.js",scope:()=>[i.default,a.default,n.default,r.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/direct-messages",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-direct","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-footer","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"pJgLbnTU",block:'[[[1,"\\n    "],[10,0],[14,0,"c-drawer-routes --direct-messages"],[12],[1,"\\n      "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.heading"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"        "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n          "],[8,[32,2],null,null,null],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,3],null,null,null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["navbar","a"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/direct-messages.js",scope:()=>[i.default,a.default,n.default,r.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/drawer-routes/threads",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-footer","discourse/plugins/chat/discourse/components/user-threads","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"k2Dw/KDw",block:'[[[1,"\\n    "],[10,0],[14,0,"c-drawer-routes --threads"],[12],[1,"\\n      "],[8,[32,0],null,[["@onClick"],[[30,0,["chat","toggleDrawer"]]]],[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.heading"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["ThreadsListButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["ToggleDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["FullPageButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["CloseDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"        "],[10,0],[14,0,"chat-drawer-content"],[12],[1,"\\n          "],[8,[32,2],null,null,null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[32,3],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/drawer-routes/threads.js",scope:()=>[n.default,a.default,r.default,i.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/footer/unread-indicator",["exports","@glimmer/component","@ember/service","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.UnreadThreadsIndicator=e.UnreadDirectMessagesIndicator=e.UnreadChannelsIndicator=void 0
const r="channels",o="threads"
e.UnreadChannelsIndicator=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"a+meD7JI",block:'[[[1,"\\n  "],[8,[32,0],null,[["@badgeType"],[[32,1]]],null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",scope:()=>[c,r],isStrictMode:!0}),(0,i.default)(void 0,"unread-indicator:UnreadChannelsIndicator")),e.UnreadDirectMessagesIndicator=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"a+meD7JI",block:'[[[1,"\\n  "],[8,[32,0],null,[["@badgeType"],[[32,1]]],null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",scope:()=>[c,"dms"],isStrictMode:!0}),(0,i.default)(void 0,"unread-indicator:UnreadDirectMessagesIndicator")),e.UnreadThreadsIndicator=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"a+meD7JI",block:'[[[1,"\\n  "],[8,[32,0],null,[["@badgeType"],[[32,1]]],null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",scope:()=>[c,o],isStrictMode:!0}),(0,i.default)(void 0,"unread-indicator:UnreadThreadsIndicator"))
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[s.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
badgeType=this.args.badgeType
get urgentCount(){return this.badgeType===r?this.chatTrackingStateManager.publicChannelMentionCount:"dms"===this.badgeType?this.chatTrackingStateManager.directMessageUnreadCount:this.badgeType===o?this.chatTrackingStateManager.watchedThreadsUnreadCount:0}get unreadCount(){return this.badgeType===r?this.chatTrackingStateManager.publicChannelUnreadCount:this.badgeType===o&&this.chatTrackingStateManager.hasUnreadThreads?1:0}get showUrgent(){return this.urgentCount>0}get showUnread(){return this.unreadCount>0}get urgentBadgeCount(){let e=this.urgentCount
return e>99?"99+":e}static#s=(()=>(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"10K3G6tk",block:'[[[1,"\\n"],[41,[30,0,["showUrgent"]],[[[1,"      "],[10,0],[14,0,"c-unread-indicator -urgent"],[12],[1,"\\n        "],[10,0],[14,0,"c-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["urgentBadgeCount"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,0,["showUnread"]],[[[1,"      "],[10,0],[14,0,"c-unread-indicator"],[12],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/footer/unread-indicator.js",isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/form",["exports","@glimmer/component","discourse/plugins/chat/discourse/components/chat/form/section","@ember/component","@ember/template-factory"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get yieldableArgs(){return{section:s.default}}static#e=(()=>(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"Q+UnUyWk",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-form"],[12],[1,"\\n      "],[18,1,[[30,0,["yieldableArgs"]]]],[1,"\\n    "],[13],[1,"\\n  "]],["&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form.js",isStrictMode:!0}),this))()}e.default=i})),define("discourse/plugins/chat/discourse/components/chat/form/row",["exports","@ember/routing","discourse/helpers/concat-class","discourse-common/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"OiuLfajB",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[8,[32,0],[[16,0,[28,[32,1],["chat-form__row -link",[52,[30,2],"-separator"]],null]]],[["@route","@models"],[[30,1],[30,3]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-form__row-content"],[12],[1,"\\n        "],[1,[30,4]],[1,"\\n        "],[1,[28,[32,2],["chevron-right"],[["class"],["chat-form__row-icon"]]]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],[[[1,"    "],[10,0],[15,0,[28,[32,1],["chat-form__row",[52,[30,2],"-separator"]],null]],[12],[1,"\\n      "],[10,0],[14,0,"chat-form__row-content"],[12],[1,"\\n"],[41,[30,4],[[[1,"          "],[10,1],[14,0,"chat-form__row-label"],[12],[1,[30,4]],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,5]],[[[1,"          "],[10,1],[14,0,"chat-form__row-label"],[12],[1,"\\n            "],[18,5,null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[48,[30,6]],[[[1,"          "],[10,0],[14,0,"chat-form__row-action"],[12],[18,6,null],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n\\n"],[41,[48,[30,7]],[[[1,"        "],[10,0],[14,0,"chat-form__row-description"],[12],[1,"\\n          "],[18,7,null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n"]],[]]]],["@route","@separator","@routeModels","@label","&default","&action","&description"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form/row.js",scope:()=>[t.LinkTo,s.default,a.default],isStrictMode:!0}),(0,r.default)(void 0,"row:ChatFormRow"))
e.default=o})),define("discourse/plugins/chat/discourse/components/chat/form/section",["exports","@glimmer/component","discourse/plugins/chat/discourse/components/chat/form/row","@ember/component","@ember/template-factory"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{get yieldableArgs(){return{row:s.default}}static#e=(()=>(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"/xrcZgND",block:'[[[1,"\\n    "],[11,0],[24,0,"chat-form__section"],[17,1],[12],[1,"\\n"],[41,[30,2],[[[1,"        "],[10,0],[14,0,"chat-form__section-title"],[12],[1,"\\n          "],[1,[30,2]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[10,0],[14,0,"chat-form__section-content"],[12],[1,"\\n        "],[18,3,[[30,0,["yieldableArgs"]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","@title","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/form/section.js",isStrictMode:!0}),this))()}e.default=i})),define("discourse/plugins/chat/discourse/components/chat/header/icon",["exports","@glimmer/component","@ember/service","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-common/lib/get-url","discourse-i18n","discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get showUnreadIndicator(){return(!this.chatStateManager.isFullPageActive||!this.site.desktopView)&&!this.currentUserInDnD}get currentUserInDnD(){return this.args.currentUserInDnD||this.currentUser.isInDoNotDisturb()}get chatSeparateSidebarMode(){return(0,l.getUserChatSeparateSidebarMode)(this.currentUser)}get isActive(){return this.args.isActive||this.chatStateManager.isFullPageActive||this.chatStateManager.isDrawerActive}get title(){return this.chatStateManager.isFullPageActive&&!this.chatSeparateSidebarMode.never&&this.site.desktopView?o.default.t("sidebar.panels.forum.label"):o.default.t("chat.title_capitalized")}get icon(){return this.chatStateManager.isFullPageActive&&!this.chatSeparateSidebarMode.never&&this.site.desktopView?"shuffle":"d-chat"}get href(){return this.site.mobileView&&this.chatStateManager.isFullPageActive?(0,r.default)("/chat"):this.chatStateManager.isFullPageActive&&!this.chatSeparateSidebarMode.never?(0,r.default)(this.chatStateManager.lastKnownAppURL||"/"):this.chatStateManager.isDrawerActive?(0,r.default)("/chat"):(0,r.default)(this.chatStateManager.lastKnownChatURL||"/chat")}static#c=(()=>(0,d.setComponentTemplate)((0,h.createTemplateFactory)({id:"4ZYOm2ZW",block:'[[[1,"\\n    "],[10,"li"],[14,0,"header-dropdown-toggle chat-header-icon"],[12],[1,"\\n      "],[8,[32,0],[[24,"tabindex","0"],[16,0,[28,[32,1],["icon","btn-flat",[52,[30,0,["isActive"]],"active"]],null]],[16,"title",[30,0,["title"]]]],[["@href"],[[30,0,["href"]]]],[["default"],[[[[1,[28,[32,2],[[30,0,["icon"]]],null]],[41,[30,0,["showUnreadIndicator"]],[[[1,"          "],[8,[32,3],null,[["@urgentCount","@unreadCount","@indicatorPreference"],[[30,1],[30,2],[30,3]]],null],[1,"\\n"]],[]],null],[1,"      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],["@urgentCount","@unreadCount","@indicatorPreference"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/header/icon.js",scope:()=>[a.default,n.default,i.default,c.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/controllers/preferences-chat","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[s.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
static#s=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get urgentCount(){return this.args.urgentCount||this.chatTrackingStateManager.allChannelUrgentCount}get mentionCount(){return this.args.mentionCount||this.chatTrackingStateManager.allChannelMentionCount}get unreadCount(){return this.args.unreadCount||this.chatTrackingStateManager.publicChannelUnreadCount}get hasUnreads(){return this.unreadCount>0||this.chatTrackingStateManager.hasUnreadThreads}get indicatorPreference(){return this.args.indicatorPreference||this.currentUser.user_option.chat_header_indicator_preference}get showUrgentIndicator(){return this.onlyMentions?this.mentionCount>0:this.urgentCount>0&&this.#Dt([a.HEADER_INDICATOR_PREFERENCE_ALL_NEW,a.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS])}get showUnreadIndicator(){return this.hasUnreads&&this.#Dt([a.HEADER_INDICATOR_PREFERENCE_ALL_NEW])}get urgentCountLabel(){let e=this.onlyMentions?this.mentionCount:this.urgentCount
return e>99?"99+":e}get onlyMentions(){return this.#Dt([a.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS])}#Dt(e){return!(!this.currentUser||this.indicatorPreference===a.HEADER_INDICATOR_PREFERENCE_NEVER)&&e.includes(this.indicatorPreference)}static#n=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"ZelwfVyf",block:'[[[1,"\\n"],[41,[30,0,["showUrgentIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator -urgent"],[12],[1,"\\n        "],[10,0],[14,0,"chat-channel-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["urgentCountLabel"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-channel-unread-indicator"],[12],[13],[1,"\\n    "]],[]],null]],[]]],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/header/icon/unread-indicator.js",isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat/list/empty-state",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"5IieK/P5",block:'[[[1,"\\n  "],[11,0],[24,0,"c-list-empty-state"],[17,1],[12],[1,"\\n    "],[18,2,null],[1,"\\n  "],[13],[1,"\\n"]],["&attrs","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/list/empty-state.js",isStrictMode:!0}),(0,a.default)(void 0,"empty-state:EmptyState"))
e.default=n})),define("discourse/plugins/chat/discourse/components/chat/list/index",["exports","@glimmer/component","@ember/helper","@ember/object","ember-modifier","discourse/components/conditional-loading-spinner","discourse/lib/is-element-in-viewport","discourse-common/config/environment","discourse-common/lib/debounce","discourse/plugins/chat/discourse/components/chat/list/empty-state","discourse/plugins/chat/discourse/components/chat/list/item","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{loadMore=(()=>(0,n.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.loadCollection),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))()
fill=(()=>(0,n.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,r.default)(e)&&this.loadCollection()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()}))))()
get itemComponent(){return this.args.itemComponent??d.default}loadCollection(){(0,c.default)(this,this.debouncedLoadCollection,o.INPUT_DELAY)}static#e=(()=>dt7948.n(this.prototype,"loadCollection",[a.action]))()
async debouncedLoadCollection(){await this.args.collection.load({limit:10})}static#s=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"Dr5JZae5",block:'[[[1,"\\n    "],[10,0],[14,0,"c-list"],[12],[1,"\\n      "],[11,0],[17,1],[4,[30,0,["fill"]],null,null],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[30,2,["items"]]],null]],null],null,[[[1,"          "],[18,4,[[28,[32,0],null,[["Item"],[[50,[30,0,["itemComponent"]],0,null,[["item"],[[30,3]]]]]]]]],[1,"\\n"]],[3]],[[[41,[30,2,["fetchedOnce"]],[[[1,"            "],[18,4,[[28,[32,0],null,[["EmptyState"],[[32,1]]]]]],[1,"\\n"]],[]],null]],[]]],[1,"      "],[13],[1,"\\n\\n      "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n        "],[10,"br"],[12],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,2],null,[["@condition"],[[30,2,["loading"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","@collection","item","&default"],false,["each","-track-array","yield","component","if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/list/index.js",scope:()=>[s.hash,l.default,i.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/chat/list/item",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"Ox3k3YOe",block:'[[[18,2,[[30,1]]]],["@item","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/list/item.js",isStrictMode:!0}),(0,a.default)(void 0,"item:Item"))
e.default=n})),define("discourse/plugins/chat/discourse/components/chat/message-creator/add-members",["exports","@glimmer/component","@ember/object","@ember/service","truth-helpers","discourse/components/d-button","discourse/lib/ajax-error","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/members-count","discourse/plugins/chat/discourse/components/chat/message-creator/members-selector","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"toasts",[a.service]))()
#mt=(()=>{dt7948.i(this,"toasts")})()
static#c=(()=>dt7948.g(this.prototype,"siteSettings",[a.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#l=(()=>dt7948.g(this.prototype,"loadingSlider",[a.service]))()
#Lt=(()=>{dt7948.i(this,"loadingSlider")})()
get membersCount(){const e=this.args.members?.reduce(((e,t)=>"group"===t.type?e+t.model.chat_enabled_user_count:e+1),0)
return e+(this.args.channel?.membershipsCount??0)}get maxMembers(){return this.siteSettings.chat_max_direct_message_users}async saveGroupMembers(){try{this.loadingSlider.transitionStarted()
const e=this.args.members.filter((e=>"user"===e.type)).mapBy("model.username"),t=this.args.members.filter((e=>"group"===e.type)).mapBy("model.name")
await this.chatApi.addMembersToChannel(this.args.channel.id,{usernames:e,groups:t}),this.toasts.success({data:{message:o.default.t("saved")}}),this.router.transitionTo("chat.channel",...this.args.channel.routeModels)}catch(e){(0,r.popupAjaxError)(e)}finally{this.loadingSlider.transitionEnded()}}static#d=(()=>dt7948.n(this.prototype,"saveGroupMembers",[s.action]))()
static#h=(()=>(0,d.setComponentTemplate)((0,h.createTemplateFactory)({id:"A/D5G1ze",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__add-members-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__add-members"],[12],[1,"\\n        "],[8,[32,0],null,[["@count","@max"],[[30,0,["membersCount"]],[30,0,["maxMembers"]]]],null],[1,"\\n\\n        "],[8,[32,1],null,[["@channel","@members","@onChange","@close","@cancel","@membersCount","@maxReached"],[[30,1],[30,2],[30,3],[30,4],[30,5],[30,0,["membersCount"]],[28,[32,2],[[30,0,["membersCount"]],[30,0,["maxMembers"]]],null]]],null],[1,"\\n\\n"],[41,[30,2,["length"]],[[[1,"          "],[10,0],[14,0,"chat-message-creator__add-members-footer-container"],[12],[1,"\\n            "],[10,0],[14,0,"chat-message-creator__add-members-footer"],[12],[1,"\\n              "],[8,[32,3],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,5]]],null],[1,"\\n\\n              "],[8,[32,3],[[24,0,"btn-primary add-to-channel"]],[["@label","@action"],["chat.direct_message_creator.add_to_channel",[30,0,["saveGroupMembers"]]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@channel","@members","@onChangeMembers","@close","@cancel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/add-members.js",scope:()=>[c.default,l.default,n.gte,i.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat/message-creator/channel",["exports","@glimmer/component","@ember/service","truth-helpers","discourse/plugins/chat/discourse/components/channel-title","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get isUrgent(){return this.args.item.model.isDirectMessageChannel||this.args.item.model.isCategoryChannel&&this.args.item.model.tracking.mentionCount>0||this.args.item.model.isCategoryChannel&&this.args.item.model.tracking.watchedThreadsUnreadCount>0}static#s=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"yrgsQUjE",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__chatable -category-channel"],[15,"data-disabled",[28,[32,0],[[30,1,["enabled"]]],null]],[12],[1,"\\n      "],[8,[32,1],null,[["@channel","@isUnread","@isUrgent"],[[30,1,["model"]],[28,[32,2],[[30,1,["tracking","unreadCount"]],0],null],[30,0,["isUrgent"]]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@item"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/channel.js",scope:()=>[a.not,n.default,a.gt],isStrictMode:!0}),this))()}e.default=o}))
define("discourse/plugins/chat/discourse/components/chat/message-creator/constants",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.MODES=void 0
e.MODES={search:"SEARCH",new_group:"NEW_GROUP",add_members:"ADD_MEMBERS"}})),define("discourse/plugins/chat/discourse/components/chat/message-creator/group",["exports","@glimmer/component","@ember/service","discourse-common/helpers/d-icon","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
group_with_too_many_members=(()=>n.default.t("chat.new_message_modal.group_with_too_many_members",{membersCount:this.args.item.model.chat_enabled_user_count}))()
get isDisabled(){return this.args.membersCount?this.args.membersCount+this.args.item.model.chat_enabled_user_count>this.siteSettings.chat_max_direct_message_users:!this.args.item.enabled}static#n=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"9ujXsGpR",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__chatable -group"],[15,"data-disabled",[30,0,["isDisabled"]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__group-icon"],[12],[1,"\\n        "],[1,[28,[32,0],["user-group"],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__group-name"],[12],[1,"\\n        "],[1,[30,1,["model","name"]]],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[30,0,["isDisabled"]],[[[1,"        "],[10,1],[14,0,"chat-message-creator__disabled-warning"],[12],[1,"\\n          "],[1,[30,0,["group_with_too_many_members"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@item"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/group.js",scope:()=>[a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/message-creator/index",["exports","@glimmer/component","@glimmer/tracking","@ember/object","discourse/plugins/chat/discourse/components/chat/message-creator/add-members","discourse/plugins/chat/discourse/components/chat/message-creator/constants","discourse/plugins/chat/discourse/components/chat/message-creator/new-group","discourse/plugins/chat/discourse/components/chat/message-creator/search","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"mode",[s.tracked],(function(){return i.MODES.search})))()
#It=(()=>{dt7948.i(this,"mode")})()
static#s=(()=>dt7948.g(this.prototype,"members",[s.tracked],(function(){return[]})))()
#Rt=(()=>{dt7948.i(this,"members")})()
get componentForMode(){switch(this.args.mode??this.mode){case i.MODES.search:return o.default
case i.MODES.new_group:return r.default
case i.MODES.add_members:return n.default}}changeMode(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[]
this.mode=e,this.changeMembers(t)}static#n=(()=>dt7948.n(this.prototype,"changeMode",[a.action]))()
changeMembers(e){this.members=e}static#r=(()=>dt7948.n(this.prototype,"changeMembers",[a.action]))()
cancelAction(){return this.args.onCancel?.()||this.changeMode(i.MODES.search)}static#c=(()=>dt7948.n(this.prototype,"cancelAction",[a.action]))()
static#l=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"KOmH179J",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator"],[12],[1,"\\n        "],[8,[30,0,["componentForMode"]],null,[["@channel","@onChangeMode","@onChangeMembers","@close","@cancel","@members"],[[30,1],[30,0,["changeMode"]],[30,0,["changeMembers"]],[30,2],[30,0,["cancelAction"]],[30,0,["members"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@channel","@onClose"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/index.js",isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat/message-creator/lib/chatables-loader",["exports","@ember/owner","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-chatable"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[s.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#s=(()=>dt7948.g(this.prototype,"loadingSlider",[s.service]))()
#Lt=(()=>{dt7948.i(this,"loadingSlider")})()
constructor(e){(0,t.setOwner)(this,(0,t.getOwner)(e))}async search(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{includeUsers:!0,includeGroups:!0,includeCategoryChannels:!0,includeDirectMessageChannels:!0,excludedUserIds:null,preloadChannels:!1}
if(this.request?.abort(),!e&&t.preloadChannels)return this.#Nt()
if(!e)return[]
try{this.loadingSlider.transitionStarted(),this.request=(0,a.ajax)("/chat/api/chatables",{data:{term:e,include_users:t.includeUsers,include_category_channels:t.includeCategoryChannels,include_direct_message_channels:t.includeDirectMessageChannels,excluded_memberships_channel_id:t.excludedMembershipsChannelId}})
const s=await this.request
return this.loadingSlider.transitionEnded(),[...s.users,...s.groups,...s.direct_message_channels,...s.category_channels].map((e=>{const t=r.default.create(e)
return t.tracking=this.#Ft(t),t})).slice(0,10)}catch(s){(0,n.popupAjaxError)(s)}}static#n=(()=>dt7948.n(this.prototype,"search",[i.bind]))()
#Nt(){return this.chatChannelsManager.allChannels.map((e=>{let t
return 1===e.chatable?.users?.length?(t=r.default.createUser(e.chatable.users[0]),t.tracking=this.#Ft(t)):(t=r.default.createChannel(e),t.tracking=e.tracking),t})).filter(Boolean).slice(0,10)}#Ft(e){if("channel"!==!e.type)return this.chatChannelsManager.allChannels.find((t=>t.id===e.model.id))?.tracking}}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/message-creator/lib/iterate-list",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getNext=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t?.identifier){const s=e.mapBy("identifier").indexOf(t?.identifier)
return s<e.length-1?e.objectAt(s+1):e[0]}return e[0]},e.getPrevious=function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
if(0===e.length)return null
if(e=e.filterBy("enabled"),t?.identifier){const s=e.mapBy("identifier").indexOf(t?.identifier)
return s>0?e.objectAt(s-1):e.objectAt(e.length-1)}return e.objectAt(e.length-1)}})),define("discourse/plugins/chat/discourse/components/chat/message-creator/list-action",["exports","discourse/components/d-button","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"FZmzvD8+",block:'[[[1,"\\n  "],[8,[32,0],[[24,0,"btn btn-flat"]],[["@icon","@translatedLabel"],[[30,1,["icon"]],[30,1,["label"]]]],null],[1,"\\n"]],["@item"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/list-action.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"list-action:ListAction"))
e.default=i})),define("discourse/plugins/chat/discourse/components/chat/message-creator/list-handler",["exports","@glimmer/component","ember-modifier","discourse/plugins/chat/discourse/components/chat/message-creator/lib/iterate-list","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{handleKeydown=(()=>(0,s.modifier)((e=>{const t=e=>{"ArrowDown"===e.key?(e.preventDefault(),e.stopPropagation(),this.args.onHighlight((0,a.getNext)(this.args.items,this.args.highlightedItem))):"ArrowUp"===e.key?(e.preventDefault(),e.stopPropagation(),this.args.onHighlight((0,a.getPrevious)(this.args.items,this.args.highlightedItem))):"Enter"===e.key&&this.args.highlightedItem&&(e.preventDefault(),e.stopPropagation(),e.shiftKey&&this.args.onShifSelect?this.args.onShifSelect(this.args.highlightedItem):this.args.onSelect(this.args.highlightedItem))}
return e.addEventListener("keydown",t),()=>{e.removeEventListener("keydown",t)}})))()
static#e=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"D4sxaCLN",block:'[[[1,"\\n    "],[11,1],[24,5,"display: contents"],[17,1],[4,[30,0,["handleKeydown"]],null,null],[12],[1,"\\n      "],[18,2,null],[1,"\\n    "],[13],[1,"\\n  "]],["&attrs","&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/list-handler.js",isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat/message-creator/list",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","truth-helpers","discourse/helpers/concat-class","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/channel","discourse/plugins/chat/discourse/components/chat/message-creator/group","discourse/plugins/chat/discourse/components/chat/message-creator/list-action","discourse/plugins/chat/discourse/components/chat/message-creator/user","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{cantAddMoreMembersLabel=(()=>o.default.t("chat.new_message_modal.cant_add_more_members"))()
componentForItem(e){switch(e){case"list-action":return d.default
case"user":return h.default
case"group":return l.default
case"channel":return c.default}}handleEnter(e,t){"Enter"===t.key&&(t.shiftKey&&this.args.onShiftSelect?this.args.onShiftSelect?.(e):this.args.onSelect?.(e))}static#e=(()=>dt7948.n(this.prototype,"handleEnter",[n.action]))()
handleClick(e,t){t.shiftKey&&this.args.onShiftSelect?this.args.onShiftSelect?.(e):this.args.onSelect?.(e)}static#s=(()=>dt7948.n(this.prototype,"handleClick",[n.action]))()
static#n=(()=>(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"9RazZaz7",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[10,0],[14,0,"chat-message-creator__list-container"],[12],[1,"\\n"],[41,[30,2],[[[1,"          "],[10,0],[14,0,"chat-message-creator__warning-max-members"],[12],[1,[30,0,["cantAddMoreMembersLabel"]]],[13],[1,"\\n"]],[]],[[[1,"          "],[10,"ul"],[14,0,"chat-message-creator__list"],[12],[1,"\\n"],[42,[28,[31,2],[[28,[31,2],[[30,1]],null]],null],null,[[[1,"              "],[11,"li"],[16,0,[28,[32,0],["chat-message-creator__list-item",[52,[28,[32,1],[[30,3,["identifier"]],[30,4,["identifier"]]],null],"-highlighted"]],null]],[24,"role","button"],[24,"tabindex","0"],[16,"data-identifier",[30,3,["identifier"]]],[16,1,[30,3,["id"]]],[4,[32,2],["click",[28,[32,3],[[30,0,["handleClick"]],[30,3]],null]],null],[4,[32,2],["keypress",[28,[32,3],[[30,0,["handleEnter"]],[30,3]],null]],null],[4,[32,2],["mousemove",[28,[32,3],[[30,5],[30,3]],null]],null],[4,[32,2],["mouseleave",[28,[32,3],[[30,5],null],null]],null],[12],[1,"\\n                "],[46,[28,[30,0,["componentForItem"]],[[30,3,["type"]]],null],null,[["membersCount","item"],[[30,6],[30,3]]],null],[1,"\\n              "],[13],[1,"\\n"]],[3]],null],[1,"          "],[13],[1,"\\n"]],[]]],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@items","@maxReached","item","@highlightedItem","@onHighlight","@membersCount"],false,["if","each","-track-array","component"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/list.js",scope:()=>[r.default,i.eq,a.on,s.fn],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/chat/discourse/components/chat/message-creator/member",["exports","@ember/helper","truth-helpers","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const d=(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"lFqMkUzx",block:'[[[1,"\\n  "],[8,[32,0],[[16,0,[28,[32,1],["chat-message-creator__member btn-default",[52,[30,1],"-highlighted"]],null]]],[["@action"],[[28,[32,2],[[30,2],[30,3]],null]]],[["default"],[[[[1,"\\n"],[41,[28,[32,3],[[30,3,["type"]],"user"],null],[[[1,"      "],[8,[32,4],null,[["@user","@interactive","@showPresence"],[[30,3,["model"]],false,false]],null],[1,"\\n      "],[10,1],[14,0,"chat-message-creator__member-username"],[12],[1,"\\n        "],[1,[30,3,["model","username"]]],[1,"\\n      "],[13],[1,"\\n"]],[]],[[[41,[28,[32,3],[[30,3,["type"]],"group"],null],[[[1,"      "],[10,0],[14,0,"chat-message-creator__group-icon"],[12],[1,"\\n        "],[1,[28,[32,5],["user-group"],null]],[1,"\\n      "],[13],[1,"\\n      "],[10,1],[14,0,"chat-message-creator__member-group"],[12],[1,"\\n        "],[1,[30,3,["model","name"]]],[1,"\\n      "],[13],[1,"\\n    "]],[]],null]],[]]],[1,"\\n    "],[1,[28,[32,5],["xmark"],null]],[1,"\\n  "]],[]]]]],[1,"\\n"]],["@highlighted","@onSelect","@member"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/member.js",scope:()=>[a.default,n.default,t.fn,s.eq,r.default,i.default],isStrictMode:!0}),(0,l.default)(void 0,"member:Member"))
e.default=d})),define("discourse/plugins/chat/discourse/components/chat/message-creator/members-count",["exports","@glimmer/component","truth-helpers","discourse/helpers/concat-class","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get countLabel(){return n.default.t("chat.direct_message_creator.members_counter",{count:this.args.count,max:this.args.max})}static#e=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"DAeEDTUT",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],["chat-message-creator__members-count",[52,[28,[32,1],[[30,1],[30,2]],null],"-reached-limit"]],null]],[12],[1,"\\n      "],[1,[30,0,["countLabel"]]],[1,"\\n    "],[13],[1,"\\n  "]],["@count","@max"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/members-count.js",scope:()=>[a.default,s.gte],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/message-creator/members-selector",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/components/d-button","discourse-common/config/environment","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/lib/chatables-loader","discourse/plugins/chat/discourse/components/chat/message-creator/list","discourse/plugins/chat/discourse/components/chat/message-creator/list-handler","discourse/plugins/chat/discourse/components/chat/message-creator/members","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class g extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#s=(()=>dt7948.g(this.prototype,"chatables",[s.tracked],(function(){return[]})))()
#Bt=(()=>{dt7948.i(this,"chatables")})()
static#n=(()=>dt7948.g(this.prototype,"filter",[s.tracked],(function(){return""})))()
#o=(()=>{dt7948.i(this,"filter")})()
static#r=(()=>dt7948.g(this.prototype,"highlightedMember",[s.tracked]))()
#Ht=(()=>{dt7948.i(this,"highlightedMember")})()
static#c=(()=>dt7948.g(this.prototype,"highlightedChatable",[s.tracked]))()
#zt=(()=>{dt7948.i(this,"highlightedChatable")})()
placeholder=(()=>c.default.t("chat.direct_message_creator.group_name"))()
get items(){return this.chatables.filter((e=>!this.highlightedMemberIds.includes(e.model.id)))}get highlightedMemberIds(){return this.args.members.map((e=>e.model.id))}highlightMember(e){this.highlightedMember=e}static#l=(()=>dt7948.n(this.prototype,"highlightMember",[a.action]))()
highlightChatable(e){this.highlightedChatable=e}static#d=(()=>dt7948.n(this.prototype,"highlightChatable",[a.action]))()
selectChatable(e){if(!e.enabled)return
const t="group"===e.type?e.model.chat_enabled_user_count:1
this.args.membersCount+t>this.siteSettings.chat_max_direct_message_users||(this.highlightedMemberIds.includes(e.model.id)?this.unselectMember(e):(this.args.onChange?.([...this.args.members,e]),this.highlightedChatable=this.items[0]),this.filter="",this.focusFilterAction?.(),this.highlightedMember=null)}static#h=(()=>dt7948.n(this.prototype,"selectChatable",[a.action]))()
registerFocusFilterAction(e){this.focusFilterAction=e}static#u=(()=>dt7948.n(this.prototype,"registerFocusFilterAction",[a.action]))()
onFilter(e){this.searchHandler=(0,o.default)(this,this.fetch,e.target.value,r.INPUT_DELAY)}static#p=(()=>dt7948.n(this.prototype,"onFilter",[a.action]))()
async fetch(e){this.highlightedMember=null
const t=new l.default(this)
this.chatables=await t.search(e,{includeCategoryChannels:!1,includeDirectMessageChannels:!1,excludedMembershipsChannelId:this.args.channel?.id}),this.highlightedChatable=this.items[0]}static#j=(()=>dt7948.n(this.prototype,"fetch",[a.action]))()
unselectMember(e){this.args.onChange?.(this.args.members.filter((t=>t!==e))),this.highlightedMember=null,this.highlightedChatable=this.items[0],this.focusFilterAction?.()}static#P=(()=>dt7948.n(this.prototype,"unselectMember",[a.action]))()
static#O=(()=>(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"MC51huPc",block:'[[[1,"\\n    "],[8,[32,0],null,[["@items","@highlightedItem","@onHighlight","@onSelect"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["highlightChatable"]],[30,0,["selectChatable"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-message-creator__add-members-header-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__add-members-header"],[12],[1,"\\n          "],[8,[32,1],null,[["@filter","@members","@highlightedMember","@onFilter","@registerFocusFilterAction","@onHighlightMember","@onSelectMember"],[[30,0,["filter"]],[30,1],[30,0,["highlightedMember"]],[30,0,["onFilter"]],[30,0,["registerFocusFilterAction"]],[30,0,["highlightMember"]],[30,0,["unselectMember"]]]],null],[1,"\\n\\n          "],[8,[32,2],[[24,0,"btn-flat chat-message-creator__add-members__close-btn"]],[["@action","@icon"],[[30,2],"xmark"]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n\\n      "],[8,[32,3],null,[["@items","@highlightedItem","@onSelect","@onHighlight","@maxReached","@membersCount"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["selectChatable"]],[30,0,["highlightChatable"]],[30,3],[30,4]]],null],[1,"\\n\\n    "]],[]]]]],[1,"\\n  "]],["@members","@cancel","@maxReached","@membersCount"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/members-selector.js",scope:()=>[h.default,u.default,i.default,d.default],isStrictMode:!0}),this))()}e.default=g})),define("discourse/plugins/chat/discourse/components/chat/message-creator/members",["exports","@glimmer/component","@ember/component","@ember/modifier","@ember/object","@ember/render-modifiers/modifiers/did-insert","truth-helpers","discourse-common/helpers/d-icon","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/lib/iterate-list","discourse/plugins/chat/discourse/components/chat/message-creator/member","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{addMoreMembersLabel=(()=>c.default.t("chat.new_message_modal.user_search_placeholder"))()
onFilter(){this.args.onFilter(...arguments)}static#e=(()=>dt7948.n(this.prototype,"onFilter",[n.action]))()
registerFocusFilterAction(e){this.args.registerFocusFilterAction((()=>e.focus()))}static#s=(()=>dt7948.n(this.prototype,"registerFocusFilterAction",[n.action]))()
handleKeypress(e){return"Backspace"===e.key&&""===e.target.value?(e.preventDefault(),e.stopPropagation(),void(this.args.highlightedMember?this.args.onSelectMember(this.args.highlightedMember):this.args.onHighlightMember(this.args.members.lastObject))):"ArrowLeft"===e.key&&""===e.target.value?(e.preventDefault(),e.stopPropagation(),void this.args.onHighlightMember((0,l.getPrevious)(this.args.members,this.args.highlightedMember))):"ArrowRight"===e.key&&""===e.target.value?(e.preventDefault(),e.stopPropagation(),void this.args.onHighlightMember((0,l.getNext)(this.args.members,this.args.highlightedMember))):"Enter"===e.key&&this.args.highlightedMember?(e.preventDefault(),e.stopPropagation(),void this.args.onSelectMember(this.args.highlightedMember)):void(this.highlightedMember=null)}static#n=(()=>dt7948.n(this.prototype,"handleKeypress",[n.action]))()
static#r=(()=>(0,s.setComponentTemplate)((0,h.createTemplateFactory)({id:"88qNaKCo",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__members-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__members"],[12],[1,"\\n        "],[1,[28,[32,0],["magnifying-glass"],null]],[1,"\\n\\n"],[42,[28,[31,1],[[28,[31,1],[[30,1]],null]],null],null,[[[1,"          "],[8,[32,1],null,[["@member","@onSelect","@highlighted"],[[30,2],[30,3],[28,[32,2],[[30,2],[30,4]],null]]],null],[1,"\\n"]],[2]],null],[1,"\\n        "],[8,[32,3],[[16,"placeholder",[30,0,["addMoreMembersLabel"]]],[24,0,"chat-message-creator__members-input"],[16,"autofocus",true],[4,[32,4],["input",[30,0,["onFilter"]]],null],[4,[32,4],["keydown",[30,0,["handleKeypress"]]],null],[4,[32,5],[[30,0,["registerFocusFilterAction"]]],null]],[["@value"],[[30,5]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@members","member","@onSelectMember","@highlightedMember","@filter"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/members.js",scope:()=>[o.default,d.default,r.eq,s.Input,a.on,i.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat/message-creator/new-group",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/object","@ember/service","truth-helpers","discourse/components/d-button","discourse/lib/ajax-error","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/members-count","discourse/plugins/chat/discourse/components/chat/message-creator/members-selector","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[i.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[i.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[i.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#r=(()=>dt7948.g(this.prototype,"newGroupTitle",[s.tracked],(function(){return""})))()
#Wt=(()=>{dt7948.i(this,"newGroupTitle")})()
placeholder=(()=>l.default.t("chat.direct_message_creator.group_name"))()
get membersCount(){return this.args.members?.reduce(((e,t)=>"group"===t.type?e+t.model.chat_enabled_user_count:e+1),0)}get maxMembers(){return this.siteSettings.chat_max_direct_message_users}async createGroup(){try{const e=this.args.members.filter((e=>"user"===e.type)).mapBy("model.username"),t=this.args.members.filter((e=>"group"===e.type)).mapBy("model.name"),s=await this.chat.createDmChannel({usernames:e,groups:t},{name:this.newGroupTitle})
if(!s)return
this.args.close?.(),this.router.transitionTo("chat.channel",...s.routeModels)}catch(e){(0,c.popupAjaxError)(e)}}static#c=(()=>dt7948.n(this.prototype,"createGroup",[n.action]))()
static#l=(()=>(0,a.setComponentTemplate)((0,u.createTemplateFactory)({id:"pOezDteM",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__new-group-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__new-group"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__new-group-header-container"],[12],[1,"\\n          "],[10,0],[14,0,"chat-message-creator__new-group-header"],[12],[1,"\\n            "],[8,[32,0],[[24,3,"channel-name"],[24,0,"chat-message-creator__new-group-header__input"],[16,"placeholder",[30,0,["placeholder"]]]],[["@value"],[[30,0,["newGroupTitle"]]]],null],[1,"\\n\\n            "],[8,[32,1],null,[["@count","@max"],[[30,0,["membersCount"]],[30,0,["siteSettings","chat_max_direct_message_users"]]]],null],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n\\n        "],[8,[32,2],null,[["@members","@channel","@onChange","@close","@cancel","@membersCount","@maxReached"],[[30,1],[30,2],[30,3],[30,4],[30,5],[30,0,["membersCount"]],[28,[32,3],[[30,0,["membersCount"]],[30,0,["maxMembers"]]],null]]],null],[1,"\\n\\n"],[41,[30,1,["length"]],[[[1,"          "],[10,0],[14,0,"chat-message-creator__new-group-footer-container"],[12],[1,"\\n            "],[10,0],[14,0,"chat-message-creator__new-group-footer"],[12],[1,"\\n              "],[8,[32,4],[[24,0,"btn-primary btn-flat"]],[["@label","@action"],["cancel",[30,5]]],null],[1,"\\n              "],[8,[32,4],[[24,0,"btn-primary create-chat-group"]],[["@label","@action"],["chat.new_message_modal.create_new_group_chat",[30,0,["createGroup"]]]],null],[1,"\\n\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@members","@channel","@onChangeMembers","@close","@cancel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/new-group.js",scope:()=>[a.Input,d.default,h.default,r.gte,o.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/chat/message-creator/search-input",["exports","@glimmer/component","@ember/component","@ember/modifier","discourse-common/helpers/d-icon","discourse-i18n","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{filterPlaceholder=(()=>i.default.t("chat.new_message_modal.filter"))()
static#e=(()=>(0,s.setComponentTemplate)((0,r.createTemplateFactory)({id:"tyOF9Rxg",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__search-input-container"],[12],[1,"\\n      "],[10,0],[14,0,"chat-message-creator__search-input"],[12],[1,"\\n        "],[1,[28,[32,0],["magnifying-glass"],[["class"],["chat-message-creator__search-input__search-icon"]]]],[1,"\\n        "],[8,[32,1],[[24,0,"chat-message-creator__search-input__input"],[16,"placeholder",[30,0,["filterPlaceholder"]]],[4,[32,2],["input",[30,1]],null]],null,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@onFilter"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/search-input.js",scope:()=>[n.default,s.Input,a.on],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/message-creator/search",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/render-modifiers/modifiers/did-insert","@ember/service","discourse/components/d-button","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator/constants","discourse/plugins/chat/discourse/components/chat/message-creator/lib/chatables-loader","discourse/plugins/chat/discourse/components/chat/message-creator/list","discourse/plugins/chat/discourse/components/chat/message-creator/list-handler","discourse/plugins/chat/discourse/components/chat/message-creator/search-input","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class v extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[r.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[r.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"chatables",[s.tracked],(function(){return[]})))()
#Bt=(()=>{dt7948.i(this,"chatables")})()
static#r=(()=>dt7948.g(this.prototype,"highlightedChatable",[s.tracked]))()
#zt=(()=>{dt7948.i(this,"highlightedChatable")})()
static#c=(()=>dt7948.g(this.prototype,"term",[s.tracked]))()
#$t=(()=>{dt7948.i(this,"term")})()
static#l=(()=>dt7948.g(this.prototype,"loading",[s.tracked],(function(){return!1})))()
#Vt=(()=>{dt7948.i(this,"loading")})()
get items(){const e=[]
return this.loading?e:(this.term?.length||e.push({identifier:"new-group",type:"list-action",label:h.default.t("chat.new_message_modal.new_group_chat"),enabled:!0,icon:"users",id:"new-group-chat"}),[...e,...this.chatables])}prefillAddMembers(e){this.args.onChangeMode(u.MODES.new_group,[e])}static#d=(()=>dt7948.n(this.prototype,"prefillAddMembers",[n.action]))()
highlightChatable(e){this.highlightedChatable=e}static#h=(()=>dt7948.n(this.prototype,"highlightChatable",[n.action]))()
async selectChatable(e){switch(e.type){case"list-action":this.args.onChangeMode(u.MODES.new_group)
break
case"user":if(!e.enabled)return
await this.startOneToOneChannel(e.model.username)
break
case"group":if(!e.enabled)return
this.args.onChangeMode(u.MODES.new_group,[e])
break
default:this.router.transitionTo("chat.channel",...e.model.routeModels),this.args.close()}}static#u=(()=>dt7948.n(this.prototype,"selectChatable",[n.action]))()
onFilter(e){this.chatables=[],this.term=e?.target?.value,this.searchHandler=(0,d.default)(this,this.fetch,e.target.value,l.INPUT_DELAY)}static#p=(()=>dt7948.n(this.prototype,"onFilter",[n.action]))()
async fetch(){const e=new p.default(this)
this.chatables=await e.search(this.term,{preloadChannels:!this.term}),this.highlightedChatable=this.items[0]}static#j=(()=>dt7948.n(this.prototype,"fetch",[n.action]))()
async startOneToOneChannel(e){try{const t=await this.chat.upsertDmChannel({usernames:[e]})
if(!t)return
this.args.close?.(),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){(0,c.popupAjaxError)(t)}}async startGroupChannel(e){try{const t=await this.chat.upsertDmChannel({groups:[e]})
if(!t)return
this.args.close?.(),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){(0,c.popupAjaxError)(t)}}static#P=(()=>(0,_.setComponentTemplate)((0,b.createTemplateFactory)({id:"8x1l771W",block:'[[[1,"\\n    "],[8,[32,0],null,[["@items","@highlightedItem","@onHighlight","@onSelect","@onShifSelect"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["highlightChatable"]],[30,0,["selectChatable"]],[30,0,["prefillAddMembers"]]]],[["default"],[[[[1,"\\n      "],[10,0],[14,0,"chat-message-creator__search-container"],[12],[1,"\\n        "],[10,0],[14,0,"chat-message-creator__search"],[12],[1,"\\n          "],[11,0],[24,0,"chat-message-creator__section"],[4,[32,1],[[28,[32,2],[[30,0,["fetch"]],null],null]],null],[12],[1,"\\n            "],[8,[32,3],null,[["@filter","@onFilter"],[[30,0,["term"]],[30,0,["onFilter"]]]],null],[1,"\\n\\n            "],[8,[32,4],[[24,0,"btn-flat chat-message-creator__search-input__cancel-button"]],[["@icon","@action"],["xmark",[30,1]]],null],[1,"\\n          "],[13],[1,"\\n\\n          "],[8,[32,5],null,[["@items","@highlightedItem","@onSelect","@onHighlight","@onShiftSelect"],[[30,0,["items"]],[30,0,["highlightedChatable"]],[30,0,["selectChatable"]],[30,0,["highlightChatable"]],[30,0,["prefillAddMembers"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["@close"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/search.js",scope:()=>[g.default,i.default,a.fn,f.default,o.default,m.default],isStrictMode:!0}),this))()}e.default=v})),define("discourse/plugins/chat/discourse/components/chat/message-creator/user",["exports","@glimmer/component","@ember/service","ember-modifier","truth-helpers","discourse/components/user-status-message","discourse/helpers/user-status","discourse-i18n","discourse/plugins/chat/discourse/components/chat-user-avatar","discourse/plugins/chat/discourse/components/chat-user-display-name","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
disabledUserLabel=(()=>o.default.t("chat.new_message_modal.disabled_user"))()
trackUserStatus=(()=>(0,a.modifier)(((e,t)=>{let[s]=t
return s.statusManager.trackStatus(),()=>{s.statusManager.stopTrackingStatus()}})))()
static#s=(()=>(0,d.setComponentTemplate)((0,h.createTemplateFactory)({id:"5sGUJqVt",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-creator__chatable -user"],[15,"data-disabled",[28,[32,0],[[30,1,["enabled"]]],null]],[12],[1,"\\n      "],[8,[32,1],null,[["@user","@interactive"],[[30,1,["model"]],false]],null],[1,"\\n      "],[8,[32,2],null,[["@user"],[[30,1,["model"]]]],null],[1,"\\n\\n"],[41,[28,[32,3],[[30,1,["tracking","unreadCount"]],0],null],[[[1,"        "],[10,0],[14,0,"unread-indicator -urgent"],[12],[13],[1,"\\n"]],[]],null],[1,"\\n      "],[1,[28,[32,4],[[30,1,["model"]]],[["currentUser"],[[30,0,["currentUser"]]]]]],[1,"\\n\\n      "],[11,0],[24,0,"user-status"],[4,[30,0,["trackUserStatus"]],[[30,1,["model"]]],null],[12],[1,"\\n        "],[8,[32,5],null,[["@status","@showDescription"],[[30,1,["model","status"]],true]],null],[1,"\\n      "],[13],[1,"\\n\\n"],[41,[51,[30,1,["enabled"]]],[[[1,"        "],[10,1],[14,0,"chat-message-creator__disabled-warning"],[12],[1,"\\n          "],[1,[30,0,["disabledUserLabel"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@item"],false,["if","unless"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message-creator/user.js",scope:()=>[n.not,c.default,l.default,n.gt,r.default,i.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat/message/avatar",["exports","discourse/plugins/chat/discourse/components/chat-emoji-avatar","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"LdIBqD01",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-message-avatar"],[12],[1,"\\n"],[41,[30,1,["chatWebhookEvent","emoji"]],[[[1,"      "],[8,[32,0],null,[["@emoji"],[[30,1,["chatWebhookEvent","emoji"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[32,1],null,[["@user","@avatarSize"],[[30,1,["user"]],"medium"]],null],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],["@message"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/avatar.js",scope:()=>[t.default,s.default],isStrictMode:!0}),(0,i.default)(void 0,"avatar:Avatar"))
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/message/error",["exports","@ember/helper","truth-helpers","discourse/components/d-button","discourse-common/helpers/i18n","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"oXafRuak",block:'[[[1,"\\n"],[41,[30,1,["error"]],[[[1,"    "],[10,0],[14,0,"chat-message-error"],[12],[1,"\\n"],[41,[28,[32,0],[[30,1,["error"]],"network_error"],null],[[[1,"        "],[8,[32,1],[[24,0,"chat-message-error__retry-btn"]],[["@action","@icon"],[[28,[32,2],[[30,2],[30,1]],null],"circle-exclamation"]],[["default"],[[[[1,"\\n          "],[10,1],[14,0,"chat-message-error__retry-btn-title"],[12],[1,"\\n            "],[1,[28,[32,3],["chat.retry_staged_message.title"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,1],[14,0,"chat-message-error__retry-btn-action"],[12],[1,"\\n            "],[1,[28,[32,3],["chat.retry_staged_message.action"],null]],[1,"\\n          "],[13],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],[[[1,"        "],[1,[30,1,["error"]]],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n"]],[]],null]],["@message","@onRetry"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/error.js",scope:()=>[s.eq,a.default,t.fn,n.default],isStrictMode:!0}),(0,o.default)(void 0,"error:Error"))
e.default=c})),define("discourse/plugins/chat/discourse/components/chat/message/info",["exports","@glimmer/component","@ember/helper","@ember/render-modifiers/modifiers/did-insert","@ember/render-modifiers/modifiers/will-destroy","@ember/routing","@ember/service","truth-helpers","discourse/components/bookmark-icon","discourse/components/user-status-message","discourse/helpers/concat-class","discourse/lib/settings","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-common/utils/decorators","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/helpers/format-chat-date","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class v extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
trackStatus(){this.#qt?.statusManager.trackStatus()}static#n=(()=>dt7948.n(this.prototype,"trackStatus",[m.bind]))()
stopTrackingStatus(){this.#qt?.statusManager.stopTrackingStatus()}static#r=(()=>dt7948.n(this.prototype,"stopTrackingStatus",[m.bind]))()
get usernameClasses(){const e=this.#qt,t=this.prioritizeName?["is-full-name"]:["is-username"]
return e?(e.staff&&t.push("is-staff"),e.admin&&t.push("is-admin"),e.moderator&&t.push("is-moderator"),e.new_user&&t.push("is-new-user"),e.primary_group_name&&t.push("group--"+e.primary_group_name),t.join(" ")):t}get name(){return this.prioritizeName?this.#qt?.get("name"):this.#qt?.get("username")}get isFlagged(){return this.args.message?.reviewableId||0===this.args.message?.userFlagStatus}get prioritizeName(){return this.siteSettings.display_name_on_posts&&(0,h.prioritizeNameInUx)(this.#qt?.get("name"))}get showStatus(){return!!this.#qt?.get("status")}get#qt(){return this.args.message?.user}get routeModels(){return this.site.mobileView?[...this.args.message.channel.routeModels,this.args.message.id]:[...this.args.message.channel.routeModels,this.args.message.id,this.args.message.thread.id]}get route(){return this.site.mobileView?"chat.channel.near-message":"chat.channel.near-message-with-thread"}static#c=(()=>(0,_.setComponentTemplate)((0,b.createTemplateFactory)({id:"V3WJO7ez",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[11,0],[24,0,"chat-message-info"],[4,[32,0],[[30,0,["trackStatus"]]],null],[4,[32,1],[[30,0,["stopTrackingStatus"]]],null],[12],[1,"\\n"],[41,[30,2,["chatWebhookEvent"]],[[[41,[30,2,["chatWebhookEvent","username"]],[[[1,"            "],[10,1],[15,0,[28,[32,2],["chat-message-info__username",[30,0,["usernameClasses"]]],null]],[12],[1,"\\n              "],[1,[30,2,["chatWebhookEvent","username"]]],[1,"\\n            "],[13],[1,"\\n"]],[]],null],[1,"\\n          "],[10,1],[14,0,"chat-message-info__bot-indicator"],[12],[1,"\\n            "],[1,[28,[32,3],["chat.bot"],null]],[1,"\\n          "],[13],[1,"\\n"]],[]],[[[1,"          "],[10,1],[14,"role","button"],[15,0,[28,[32,2],["chat-message-info__username",[30,0,["usernameClasses"]],"clickable"],null]],[15,"data-user-card",[30,2,["user","username"]]],[12],[1,"\\n            "],[10,1],[14,0,"chat-message-info__username__name"],[12],[1,[30,0,["name"]]],[13],[1,"\\n"],[41,[30,0,["showStatus"]],[[[1,"              "],[10,1],[14,0,"chat-message-info__status"],[12],[1,"\\n                "],[8,[32,4],null,[["@status"],[[30,2,["user","status"]]]],null],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"          "],[13],[1,"\\n"]],[]]],[1,"\\n        "],[10,1],[14,0,"chat-message-info__date"],[12],[1,"\\n          "],[1,[28,[32,5],[[30,2],[28,[32,6],null,[["threadContext"],[[30,3]]]]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,2,["bookmark"]],[[[1,"          "],[10,1],[14,0,"chat-message-info__bookmark"],[12],[1,"\\n            "],[8,[32,7],null,[["@bookmark"],[[30,2,["bookmark"]]]],null],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["isFlagged"]],[[[1,"          "],[10,1],[14,0,"chat-message-info__flag"],[12],[1,"\\n"],[41,[30,2,["reviewableId"]],[[[1,"              "],[8,[32,8],null,[["@route","@model"],["review.show",[30,2,["reviewableId"]]]],[["default"],[[[[1,"\\n                "],[1,[28,[32,9],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],[[[1,"              "],[1,[28,[32,9],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n"]],[]]],[1,"          "],[13],[1,"\\n"]],[]],null],[1,"\\n"],[41,[28,[32,10],[[30,3],[30,2,["isOriginalThreadMessage"]]],null],[[[1,"          "],[8,[32,8],[[24,0,"chat-message-info__original-message"]],[["@route","@models"],[[30,0,["route"]],[30,0,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[10,1],[14,0,"chat-message-info__original-message__text"],[12],[1,"\\n              "],[1,[28,[32,3],["chat.see_in"],null]],[1,"\\n            "],[13],[1,"\\n            "],[8,[32,11],null,[["@channel"],[[30,2,["channel"]]]],null],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],null],[1,"      "],[13],[1,"\\n"]],[]],null],[1,"  "]],["@show","@message","@threadContext"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/info.js",scope:()=>[a.default,n.default,d.default,p.default,l.default,f.default,s.hash,c.default,i.LinkTo,u.default,o.and,g.default],isStrictMode:!0}),this))()}e.default=v})),define("discourse/plugins/chat/discourse/components/chat/message/left-gutter",["exports","@glimmer/component","@ember/helper","@ember/routing","@ember/service","truth-helpers","discourse/components/bookmark-icon","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/helpers/format-chat-date","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"8/IIAcEI",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-message-left-gutter"],[12],[1,"\\n"],[41,[30,1,["reviewableId"]],[[[1,"        "],[8,[32,0],[[24,0,"chat-message-left-gutter__flag"]],[["@route","@model"],["review.show",[30,1,["reviewableId"]]]],[["default"],[[[[1,"\\n          "],[1,[28,[32,1],["flag"],[["title"],["chat.flagged"]]]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],[[[41,[28,[32,2],[[30,1,["userFlagStatus"]],0],null],[[[1,"        "],[10,0],[14,0,"chat-message-left-gutter__flag"],[12],[1,"\\n          "],[1,[28,[32,1],["flag"],[["title"],["chat.you_flagged"]]]],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[41,[30,0,["site","desktopView"]],[[[1,"        "],[10,1],[14,0,"chat-message-left-gutter__date"],[12],[1,"\\n          "],[1,[28,[32,3],[[30,1],[28,[32,4],null,[["mode","threadContext"],["tiny",[30,2]]]]],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]],null]],[]]]],[]]],[41,[30,1,["bookmark"]],[[[1,"        "],[10,1],[14,0,"chat-message-left-gutter__bookmark"],[12],[1,"\\n          "],[8,[32,5],null,[["@bookmark"],[[30,1,["bookmark"]]]],null],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@message","@threadContext"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/message/left-gutter.js",scope:()=>[a.LinkTo,o.default,i.eq,c.default,s.hash,r.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat/modal/archive-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-common/lib/later","discourse-i18n","discourse/plugins/chat/discourse/components/chat-to-topic-selector","discourse/plugins/chat/discourse/models/chat-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class _ extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[n.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#n=(()=>dt7948.g(this.prototype,"selection",[s.tracked],(function(){return p.NEW_TOPIC_SELECTION})))()
#Gt=(()=>{dt7948.i(this,"selection")})()
static#r=(()=>dt7948.g(this.prototype,"saving",[s.tracked],(function(){return!1})))()
#Kt=(()=>{dt7948.i(this,"saving")})()
static#c=(()=>dt7948.g(this.prototype,"topicTitle",[s.tracked],(function(){return null})))()
#Jt=(()=>{dt7948.i(this,"topicTitle")})()
static#l=(()=>dt7948.g(this.prototype,"categoryId",[s.tracked],(function(){return null})))()
#Yt=(()=>{dt7948.i(this,"categoryId")})()
static#d=(()=>dt7948.g(this.prototype,"tags",[s.tracked],(function(){return null})))()
#Zt=(()=>{dt7948.i(this,"tags")})()
static#h=(()=>dt7948.g(this.prototype,"selectedTopicId",[s.tracked],(function(){return null})))()
#Xt=(()=>{dt7948.i(this,"selectedTopicId")})()
static#u=(()=>dt7948.g(this.prototype,"flash",[s.tracked]))()
#Qt=(()=>{dt7948.i(this,"flash")})()
static#p=(()=>dt7948.g(this.prototype,"flashType",[s.tracked]))()
#es=(()=>{dt7948.i(this,"flashType")})()
get channel(){return this.args.model.channel}get newTopic(){return this.selection===p.NEW_TOPIC_SELECTION}get existingTopic(){return this.selection===p.EXISTING_TOPIC_SELECTION}get buttonDisabled(){return!!this.saving||(!(!this.newTopic||!(!this.topicTitle||this.topicTitle.length<this.siteSettings.min_topic_title_length||this.topicTitle.length>this.siteSettings.max_topic_title_length))||!(!this.existingTopic||!(0,r.isEmpty)(this.selectedTopicId)))}get instructionLabels(){const e={}
return e[p.NEW_TOPIC_SELECTION]=u.default.t("chat.selection.new_topic.instructions_channel_archive"),e[p.EXISTING_TOPIC_SELECTION]=u.default.t("chat.selection.existing_topic.instructions_channel_archive"),e}get instructionsText(){return(0,i.htmlSafe)(u.default.t("chat.channel_archive.instructions",{channelTitle:this.channel.escapedTitle}))}get data(){const e={type:this.selection}
return this.newTopic&&(e.title=this.topicTitle,e.category_id=this.categoryId,e.tags=this.tags),this.existingTopic&&(e.topic_id=this.selectedTopicId),e}archiveChannel(){return this.saving=!0,this.chatApi.createChannelArchive(this.channel.id,this.data).then((()=>{this.flash=u.default.t("chat.channel_archive.process_started"),this.flashType="success",this.channel.status=m.CHANNEL_STATUSES.archived,(0,h.default)((()=>{this.args.closeModal()}),3e3)})).catch(l.popupAjaxError).finally((()=>this.saving=!1))}static#j=(()=>dt7948.n(this.prototype,"archiveChannel",[a.action]))()
newTopicSelected(e){this.selectedTopicId=e.id}static#P=(()=>dt7948.n(this.prototype,"newTopicSelected",[a.action]))()
static#O=(()=>(0,g.setComponentTemplate)((0,f.createTemplateFactory)({id:"P2TrWr8v",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-archive-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[32,1],["chat.channel_archive.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n        "],[10,2],[14,0,"chat-modal-archive-channel__instructions"],[12],[1,"\\n          "],[1,[30,0,["instructionsText"]]],[1,"\\n        "],[13],[1,"\\n        "],[8,[32,2],null,[["@selection","@topicTitle","@categoryId","@tags","@topicChangedCallback","@instructionLabels","@allowNewMessage"],[[30,0,["selection"]],[30,0,["topicTitle"]],[30,0,["categoryId"]],[30,0,["tags"]],[30,0,["newTopicSelected"]],[30,0,["instructionLabels"]],false]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,1,"chat-confirm-archive-channel"],[24,0,"btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["archiveChannel"]],"chat.channel_archive.title"]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/archive-channel.js",scope:()=>[c.default,d.default,p.default,o.default],isStrictMode:!0}),this))()}e.default=_})),define("discourse/plugins/chat/discourse/components/chat/modal/create-channel",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","@ember/template","@ember/utils","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/utilities","discourse/models/category","discourse-common/lib/debounce","discourse-i18n","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const f=(0,g.createTemplateFactory)({id:"e9KaE6Vd",block:'[[[8,[39,0],[[24,0,"chat-modal-create-channel"],[4,[38,2],["submit",[30,0,["onSave"]]],null]],[["@closeModal","@inline","@title","@flash","@tagName"],[[30,1],[30,2],[28,[37,1],["chat.create_channel.title"],null],[30,0,["flash"]],"form"]],[["body","footer"],[[[[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -name"],[12],[1,"\\n      "],[10,"label"],[14,"for","name"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.name"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"name"],[24,0,"chat-modal-create-channel__input"],[4,[38,2],["input",[28,[37,4],[[30,0,["onNameChange"]]],null]],null]],[["@type","@value"],["text",[30,0,["name"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -slug"],[12],[1,"\\n      "],[10,"label"],[14,"for","slug"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.slug"],null]],[1,"Â \\n        "],[10,1],[12],[1,"\\n          "],[1,[28,[35,5],["circle-info"],null]],[1,"\\n          "],[8,[39,6],null,null,[["default"],[[[[1,"\\n            "],[1,[28,[35,1],["chat.channel_edit_name_slug_modal.slug_description"],null]],[1,"\\n          "]],[]]]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"slug"],[24,0,"chat-modal-create-channel__input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]]],[["@type","@value"],["text",[30,0,["slug"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -description"],[12],[1,"\\n      "],[10,"label"],[14,"for","description"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.description"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,3],[[24,3,"description"],[24,0,"chat-modal-create-channel__input"]],[["@type","@value"],["textarea",[30,0,["description"]]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,0],[14,0,"chat-modal-create-channel__control"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[1,[28,[35,1],["chat.create_channel.choose_category.label"],null]],[1,"\\n      "],[13],[1,"\\n      "],[8,[39,7],null,[["@value","@onChange","@options"],[[30,0,["categoryId"]],[30,0,["onCategoryChange"]],[28,[37,8],null,[["formName","none"],["chatable_id","chat.create_channel.choose_category.none"]]]]],null],[1,"\\n\\n"],[41,[30,0,["categoryPermissionsHint"]],[[[1,"        "],[10,0],[15,0,[28,[37,10],["chat-modal-create-channel__hint",[52,[30,0,["loadingPermissionHint"]],"loading-permissions"]],null]],[12],[1,"\\n          "],[1,[30,0,["categoryPermissionsHint"]]],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"      "],[10,0],[14,0,"chat-modal-create-channel__control -auto-join"],[12],[1,"\\n        "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n          "],[8,[39,3],[[24,3,"auto_join_users"]],[["@type","@checked"],["checkbox",[30,0,["autoJoinUsers"]]]],null],[1,"\\n          "],[10,0],[14,0,"auto-join-channel"],[12],[1,"\\n            "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n              "],[1,[28,[35,1],["chat.settings.auto_join_users_label"],null]],[1,"\\n            "],[13],[1,"\\n            "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n"],[41,[30,0,["categoryName"]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info"],[["category"],[[30,0,["categoryName"]]]]]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[35,1],["chat.settings.auto_join_users_info_no_category"],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"chat-modal-create-channel__control -threading-toggle"],[12],[1,"\\n      "],[10,"label"],[14,0,"chat-modal-create-channel__label"],[12],[1,"\\n        "],[8,[39,3],[[24,3,"threading_enabled"]],[["@type","@checked"],["checkbox",[30,0,["threadingEnabled"]]]],null],[1,"\\n        "],[10,0],[14,0,"threading-channel"],[12],[1,"\\n          "],[10,1],[14,0,"chat-modal-create-channel__label-title"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.create_channel.threading.label"],null]],[1,"\\n          "],[13],[1,"\\n          "],[10,2],[14,0,"chat-modal-create-channel__label-description"],[12],[1,"\\n            "],[1,[28,[35,1],["chat.settings.channel_threading_description"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]],[[[1,"\\n    "],[10,"button"],[14,0,"btn btn-primary create"],[15,"disabled",[30,0,["createDisabled"]]],[14,4,"submit"],[12],[1,"\\n      "],[1,[28,[35,1],["chat.create_channel.create"],null]],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","on","input","with-event-value","d-icon","d-tooltip","category-chooser","hash","if","concat-class"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/create-channel.hbs",isStrictMode:!1}),_=(0,o.htmlSafe)(m.default.t("chat.create_channel.choose_category.default_hint",{link:"/categories",category:"category"}))
class b extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[r.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"dialog",[r.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[r.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"chatApi",[r.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#c=(()=>dt7948.g(this.prototype,"router",[r.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#l=(()=>dt7948.g(this.prototype,"currentUser",[r.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#d=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#h=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#u=(()=>dt7948.g(this.prototype,"flash",[a.tracked]))()
#Qt=(()=>{dt7948.i(this,"flash")})()
static#p=(()=>dt7948.g(this.prototype,"name",[a.tracked]))()
#ts=(()=>{dt7948.i(this,"name")})()
static#j=(()=>dt7948.g(this.prototype,"category",[a.tracked]))()
#ss=(()=>{dt7948.i(this,"category")})()
static#P=(()=>dt7948.g(this.prototype,"categoryId",[a.tracked]))()
#Yt=(()=>{dt7948.i(this,"categoryId")})()
static#O=(()=>dt7948.g(this.prototype,"autoGeneratedSlug",[a.tracked],(function(){return""})))()
#as=(()=>{dt7948.i(this,"autoGeneratedSlug")})()
static#D=(()=>dt7948.g(this.prototype,"categoryPermissionsHint",[a.tracked]))()
#ns=(()=>{dt7948.i(this,"categoryPermissionsHint")})()
static#I=(()=>dt7948.g(this.prototype,"autoJoinWarning",[a.tracked],(function(){return""})))()
#is=(()=>{dt7948.i(this,"autoJoinWarning")})()
static#R=(()=>dt7948.g(this.prototype,"loadingPermissionHint",[a.tracked],(function(){return!1})))()
#rs=(()=>{dt7948.i(this,"loadingPermissionHint")})()
#os=null
willDestroy(){super.willDestroy(...arguments),(0,i.cancel)(this.#os)}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0}get categorySelected(){return(0,c.isPresent)(this.category)}get createDisabled(){return!this.categorySelected||(0,c.isBlank)(this.name)}get categoryName(){return this.categorySelected?(0,h.escapeExpression)(this.category?.name):null}onShow(){this.categoryPermissionsHint=_}static#N=(()=>dt7948.n(this.prototype,"onShow",[n.action]))()
onCategoryChange(e){const t=e?u.default.findById(e):null
this.#cs(t)
const s=this.name||t?.name||""
this.categoryId=e,this.category=t,this.name=s,this.#ls(s)}static#B=(()=>dt7948.n(this.prototype,"onCategoryChange",[n.action]))()
onNameChange(e){this.#ls(e)}static#H=(()=>dt7948.n(this.prototype,"onNameChange",[n.action]))()
onSave(e){if(e.preventDefault(),this.createDisabled)return
const t=new FormData(e.currentTarget),s=Object.fromEntries(t.entries())
s.auto_join_users="on"===s.auto_join_users,s.slug??=this.autoGeneratedSlug,s.threading_enabled="on"===s.threading_enabled,s.auto_join_users?this.dialog.yesNoConfirm({message:this.autoJoinWarning,didConfirm:()=>this.#ds(s)}):this.#ds(s)}static#z=(()=>dt7948.n(this.prototype,"onSave",[n.action]))()
async#ds(e){try{const t=await this.chatApi.createChannel(e)
this.args.closeModal(),this.chatChannelsManager.follow(t),this.router.transitionTo("chat.channel",...t.routeModels)}catch(t){this.flash=(0,d.extractError)(t)}}#hs(e){const t=e.parentCategory
return t?`${this.#hs(t)}/${e.slug}`:e.slug}#us(e,t){const s=t.allowed_groups
let a
if(t.private)switch(s.length){case 1:a=m.default.t("chat.create_channel.auto_join_users.warning_1_group",{count:t.members_count,group:(0,h.escapeExpression)(s[0])})
break
case 2:a=m.default.t("chat.create_channel.auto_join_users.warning_2_groups",{count:t.members_count,group1:(0,h.escapeExpression)(s[0]),group2:(0,h.escapeExpression)(s[1])})
break
default:a=m.default.messageFormat("chat.create_channel.auto_join_users.warning_multiple_groups_MF",{groupCount:s.length-1,userCount:t.members_count,groupName:(0,h.escapeExpression)(s[0])})}else a=m.default.t("chat.create_channel.auto_join_users.public_category_warning",{category:(0,h.escapeExpression)(e.name)})
this.autoJoinWarning=a}#cs(e){if(e){const t=this.#hs(e)
return this.loadingPermissionHint=!0,this.chatApi.categoryPermissions(e.id).then((s=>{this.#us(e,s)
const a=s.allowed_groups,n=`/c/${(0,h.escapeExpression)(t)}/edit/security`
let i
switch(a.length){case 1:i=m.default.t("chat.create_channel.choose_category.hint_1_group",{settingLink:n,group:(0,h.escapeExpression)(a[0])})
break
case 2:i=m.default.t("chat.create_channel.choose_category.hint_2_groups",{settingLink:n,group1:(0,h.escapeExpression)(a[0]),group2:(0,h.escapeExpression)(a[1])})
break
default:i=m.default.t("chat.create_channel.choose_category.hint_multiple_groups",{settingLink:n,group:(0,h.escapeExpression)(a[0]),count:a.length-1})}this.categoryPermissionsHint=(0,o.htmlSafe)(i)})).finally((()=>{this.loadingPermissionHint=!1}))}this.categoryPermissionsHint=_,this.autoJoinWarning=""}#ps(e){return(0,l.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}#ls(e){(0,i.cancel)(this.#os),this.autoGeneratedSlug="",e&&(this.#os=(0,p.default)(this,this.#ps,e,300))}}e.default=b,(0,t.setComponentTemplate)(f,b)})),define("discourse/plugins/chat/discourse/components/chat/modal/delete-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/helpers/with-event-value","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-common/lib/later","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class b extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[r.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"router",[r.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"channelNameConfirmation",[s.tracked]))()
#ms=(()=>{dt7948.i(this,"channelNameConfirmation")})()
static#r=(()=>dt7948.g(this.prototype,"deleting",[s.tracked],(function(){return!1})))()
#gs=(()=>{dt7948.i(this,"deleting")})()
static#c=(()=>dt7948.g(this.prototype,"confirmed",[s.tracked],(function(){return!1})))()
#fs=(()=>{dt7948.i(this,"confirmed")})()
static#l=(()=>dt7948.g(this.prototype,"flash",[s.tracked]))()
#Qt=(()=>{dt7948.i(this,"flash")})()
static#d=(()=>dt7948.g(this.prototype,"flashType",[s.tracked]))()
#es=(()=>{dt7948.i(this,"flashType")})()
get channel(){return this.args.model.channel}get buttonDisabled(){return!(!this.deleting&&!this.confirmed)||!(!(0,c.isEmpty)(this.channelNameConfirmation)&&this.channelNameConfirmation.toLowerCase()===this.channel.title.toLowerCase())}get instructionsText(){return(0,o.htmlSafe)(g.default.t("chat.channel_delete.instructions",{name:this.channel.escapedTitle}))}deleteChannel(){return this.deleting=!0,this.chatApi.destroyChannel(this.channel.id,this.channelNameConfirmation).then((()=>{this.confirmed=!0,this.flash=g.default.t("chat.channel_delete.process_started"),this.flashType="success",(0,m.default)((()=>{this.args.closeModal(),this.router.transitionTo("chat")}),3e3)})).catch(u.popupAjaxError).finally((()=>this.deleting=!1))}static#h=(()=>dt7948.n(this.prototype,"deleteChannel",[i.action]))()
static#u=(()=>(0,f.setComponentTemplate)((0,_.createTemplateFactory)({id:"wcStbX5W",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-delete-channel"]],[["@closeModal","@inline","@title","@flash","@flashType"],[[30,1],[30,2],[28,[32,1],["chat.channel_delete.title"],null],[30,0,["flash"]],[30,0,["flashType"]]]],[["body","footer"],[[[[1,"\\n        "],[10,2],[14,0,"chat-modal-delete-channel__instructions"],[12],[1,"\\n          "],[1,[30,0,["instructionsText"]]],[1,"\\n        "],[13],[1,"\\n        "],[11,"input"],[24,1,"channel-delete-confirm-name"],[16,"placeholder",[28,[32,1],["chat.channel_delete.confirm_channel_name"],null]],[24,"autocorrect","off"],[24,"autocapitalize","off"],[24,4,"text"],[4,[32,2],["input",[28,[32,3],[[28,[32,4],[[28,[31,0],[[30,0,["channelNameConfirmation"]]],null]],null]],null]],null],[12],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,5],[[24,1,"chat-confirm-delete-channel"],[24,0,"btn-danger"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["deleteChannel"]],"chat.channel_delete.confirm"]],null],[1,"\\n        "],[8,[32,5],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,["mut"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/delete-channel.js",scope:()=>[d.default,p.default,n.on,h.default,a.fn,l.default],isStrictMode:!0}),this))()}e.default=b})),define("discourse/plugins/chat/discourse/components/chat/modal/delete-messages-confirm",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/components/d-modal","discourse/components/d-modal-cancel","discourse/lib/ajax-error","discourse-common/helpers/i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
async delete(){try{await this.chatApi.trashMessages(this.args.model.sourceChannel.id,this.args.model.selectedMessageIds)}catch(e){(0,o.popupAjaxError)(e)}finally{this.args.closeModal()}}static#s=(()=>dt7948.n(this.prototype,"delete",[s.action]))()
static#n=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"Uybvpxw2",block:'[[[1,"\\n    "],[8,[32,0],null,[["@closeModal","@headerClass"],[[30,1],"hidden"]],[["body","footer"],[[[[1,"\\n        "],[1,[28,[32,1],["chat.delete_messages.confirm"],[["count"],[[30,2,["selectedMessageIds","length"]]]]]],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,2],[[24,0,"btn-primary"]],[["@action","@label","@icon"],[[30,0,["delete"]],"delete","trash-can"]],null],[1,"\\n        "],[8,[32,3],null,[["@close"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@model"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/delete-messages-confirm.js",scope:()=>[i.default,c.default,n.default,r.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/lib/ajax-error","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const c=(0,o.createTemplateFactory)({id:"9AgN8pbG",block:'[[[8,[39,0],[[24,0,"chat-modal-edit-channel-description"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[37,1],["chat.channel_edit_description_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n    "],[10,1],[14,0,"chat-modal-edit-channel-description__description"],[12],[1,[28,[35,1],["chat.channel_edit_description_modal.description"],null]],[13],[1,"\\n    "],[8,[39,2],null,[["@value","@max"],[[30,0,["editedDescription"]],[30,0,["descriptionMaxLength"]]]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[24,0,"chat-modal-edit-channel-description__description-input"],[16,"placeholder",[28,[37,1],["chat.channel_edit_description_modal.input_placeholder"],null]],[4,[38,3],["input",[28,[37,4],[[30,0,["onChangeChatChannelDescription"]]],null]],null],[12],[1,[30,0,["editedDescription"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]],[[[1,"\\n    "],[8,[39,5],[[24,0,"btn-primary create"]],[["@action","@label","@disabled"],[[30,0,["onSaveChatChannelDescription"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n    "],[8,[39,6],null,[["@close"],[[30,1]]],null],[1,"\\n  "]],[]]]]]],["@closeModal","@inline"],false,["d-modal","i18n","char-counter","on","with-event-value","d-button","d-modal-cancel"]]',moduleName:"discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description.hbs",isStrictMode:!1})
class l extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[i.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"editedDescription",[a.tracked],(function(){return this.channel.description||""})))()
#_s=(()=>{dt7948.i(this,"editedDescription")})()
static#n=(()=>dt7948.g(this.prototype,"flash",[a.tracked]))()
#Qt=(()=>{dt7948.i(this,"flash")})()
get channel(){return this.args.model}get isSaveDisabled(){return this.channel.description===this.editedDescription||this.editedDescription?.length>280}get descriptionMaxLength(){return 280}async onSaveChatChannelDescription(){try{const e=await this.chatApi.updateChannel(this.channel.id,{description:this.editedDescription})
this.channel.description=e.channel.description,this.args.closeModal()}catch(e){this.flash=(0,r.extractError)(e)}}static#r=(()=>dt7948.n(this.prototype,"onSaveChatChannelDescription",[n.action]))()
onChangeChatChannelDescription(e){this.flash=null,this.editedDescription=e}static#c=(()=>dt7948.n(this.prototype,"onChangeChatChannelDescription",[n.action]))()}e.default=l,(0,t.setComponentTemplate)(c,l)})),define("discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/modifier","@ember/object","@ember/runloop","@ember/service","discourse/components/d-button","discourse/components/d-modal","discourse/components/d-modal-cancel","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-common/lib/debounce","float-kit/components/d-tooltip","discourse/plugins/chat/discourse/lib/slugify-channel","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class b extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[o.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"router",[o.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[o.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#r=(()=>dt7948.g(this.prototype,"editedName",[s.tracked],(function(){return this.channel.title})))()
#bs=(()=>{dt7948.i(this,"editedName")})()
static#c=(()=>dt7948.g(this.prototype,"editedSlug",[s.tracked],(function(){return this.channel.slug})))()
#vs=(()=>{dt7948.i(this,"editedSlug")})()
static#l=(()=>dt7948.g(this.prototype,"autoGeneratedSlug",[s.tracked],(function(){return this.channel.slug??(0,f.default)(this.channel)})))()
#as=(()=>{dt7948.i(this,"autoGeneratedSlug")})()
static#d=(()=>dt7948.g(this.prototype,"flash",[s.tracked]))()
#Qt=(()=>{dt7948.i(this,"flash")})()
#os=null
get channel(){return this.args.model}get isSaveDisabled(){return this.channel.title===this.editedName&&this.channel.slug===this.editedSlug||this.editedName?.length>this.siteSettings.max_topic_title_length||this.editedSlug?.length>100}async onSave(){try{const e=await this.chatApi.updateChannel(this.channel.id,{name:this.editedName,slug:this.editedSlug||this.autoGeneratedSlug||this.channel.slug})
this.channel.title=e.channel.title,this.channel.slug=e.channel.slug,await this.args.closeModal(),this.router.replaceWith("chat.channel",...this.channel.routeModels)}catch(e){this.flash=(0,u.extractError)(e)}}static#h=(()=>dt7948.n(this.prototype,"onSave",[i.action]))()
onChangeChatChannelName(e){this.flash=null,this.#ls(e?.target?.value)}static#u=(()=>dt7948.n(this.prototype,"onChangeChatChannelName",[i.action]))()
onChangeChatChannelSlug(){this.flash=null,this.#ls(this.editedName)}static#p=(()=>dt7948.n(this.prototype,"onChangeChatChannelSlug",[i.action]))()
#ls(e){(0,r.cancel)(this.#os),this.autoGeneratedSlug="",e&&(this.#os=(0,m.default)(this,this.#ps,e,300))}async#ps(e){try{await(0,h.ajax)("/slugs.json",{type:"POST",data:{name:e}}).then((e=>{this.autoGeneratedSlug=e.slug}))}catch(t){console.log(t)}}static#j=(()=>(0,a.setComponentTemplate)((0,_.createTemplateFactory)({id:"pTFBqtm1",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-edit-channel-name"]],[["@closeModal","@inline","@title","@flash"],[[30,1],[30,2],[28,[32,1],["chat.channel_edit_name_slug_modal.title"],null],[30,0,["flash"]]]],[["body","footer"],[[[[1,"\\n        "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n          "],[10,"label"],[14,"for","channel-name"],[14,0,"edit-channel-label"],[12],[1,"\\n            "],[1,[28,[32,1],["chat.channel_edit_name_slug_modal.name"],null]],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,2],[[24,3,"channel-name"],[24,0,"chat-channel-edit-name-slug-modal__name-input"],[16,"placeholder",[28,[32,1],["chat.channel_edit_name_slug_modal.input_placeholder"],null]],[4,[32,3],["input",[30,0,["onChangeChatChannelName"]]],null]],[["@type","@value"],["text",[30,0,["editedName"]]]],null],[1,"\\n        "],[13],[1,"\\n\\n        "],[10,0],[14,0,"edit-channel-control"],[12],[1,"\\n          "],[10,"label"],[14,"for","channel-slug"],[14,0,"edit-channel-label"],[12],[1,"\\n            "],[1,[28,[32,1],["chat.channel_edit_name_slug_modal.slug"],null]],[1,"Â \\n            "],[8,[32,4],null,[["@icon","@content"],["circle-info",[28,[32,1],["chat.channel_edit_name_slug_modal.slug_description"],null]]],null],[1,"\\n          "],[13],[1,"\\n          "],[8,[32,2],[[24,3,"channel-slug"],[24,0,"chat-channel-edit-name-slug-modal__slug-input"],[16,"placeholder",[30,0,["autoGeneratedSlug"]]],[4,[32,3],["input",[30,0,["onChangeChatChannelSlug"]]],null]],[["@type","@value"],["text",[30,0,["editedSlug"]]]],null],[1,"\\n        "],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,5],[[24,0,"btn-primary create"]],[["@action","@label","@disabled"],[[30,0,["onSave"]],"save",[30,0,["isSaveDisabled"]]]],null],[1,"\\n        "],[8,[32,6],null,[["@close"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name.js",scope:()=>[l.default,p.default,a.Input,n.on,g.default,c.default,d.default],isStrictMode:!0}),this))()}e.default=b})),define("discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","@ember/template","@ember/utils","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/components/chat-channel-chooser","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class g extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#c=(()=>dt7948.g(this.prototype,"destinationChannelId",[s.tracked]))()
#ys=(()=>{dt7948.i(this,"destinationChannelId")})()
get sourceChannel(){return this.args.model.sourceChannel}get selectedMessageIds(){return this.args.model.selectedMessageIds}get selectedMessageCount(){return this.selectedMessageIds?.length}get disableMoveButton(){return(0,r.isBlank)(this.destinationChannelId)}get availableChannels(){return(this.args.model.availableChannels||this.chatChannelsManager.publicMessageChannels).rejectBy("id",this.sourceChannel.id)}get instructionsText(){return(0,i.htmlSafe)(h.default.t("chat.move_to_channel.instructions",{channelTitle:this.sourceChannel.escapedTitle,count:this.selectedMessageCount}))}moveMessages(){return this.chatApi.moveChannelMessages(this.sourceChannel.id,{message_ids:this.selectedMessageIds,destination_channel_id:this.destinationChannelId}).then((e=>{this.args.closeModal(),this.router.transitionTo("chat.channel.near-message","-",e.destination_channel_id,e.first_moved_message_id)})).catch(l.popupAjaxError)}static#l=(()=>dt7948.n(this.prototype,"moveMessages",[a.action]))()
static#d=(()=>(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"rdFvTUpN",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-move-message-to-channel"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[32,1],["chat.move_to_channel.title"],null]]],[["body","footer"],[[[[1,"\\n"],[41,[30,0,["selectedMessageCount"]],[[[1,"          "],[10,2],[12],[1,[30,0,["instructionsText"]]],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[32,2],[[24,0,"chat-modal-move-message-to-channel__channel-chooser"]],[["@content","@value","@nameProperty"],[[30,0,["availableChannels"]],[30,0,["destinationChannelId"]],"title"]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,0,"btn-primary"]],[["@icon","@disabled","@action","@label"],["right-from-bracket",[30,0,["disableMoveButton"]],[30,0,["moveMessages"]],"chat.move_to_channel.confirm_move"]],null],[1,"\\n        "],[8,[32,3],[[24,0,"btn-flat"]],[["@label","@action"],["cancel",[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel.js",scope:()=>[c.default,d.default,u.default,o.default],isStrictMode:!0}),this))()}e.default=g})),define("discourse/plugins/chat/discourse/components/chat/modal/new-message",["exports","@glimmer/component","@ember/service","discourse/components/d-modal","discourse/plugins/chat/discourse/components/chat/message-creator","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
get shouldRender(){return this.siteSettings.enable_public_channels||this.chat.userCanDirectMessage}static#n=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"m24w3NYX",block:'[[[1,"\\n"],[41,[30,0,["shouldRender"]],[[[1,"      "],[8,[32,0],[[24,0,"chat-modal-new-message"]],[["@closeModal","@title","@inline","@hideHeader"],[[30,1],"chat.new_message_modal.title",[30,2],true]],[["default"],[[[[1,"\\n        "],[8,[32,1],null,[["@onClose","@channel"],[[30,1],[30,3]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@closeModal","@inline","@model"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/new-message.js",scope:()=>[a.default,n.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/modal/thread-settings",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/object","@ember/service","@ember/template","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[i.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#n=(()=>dt7948.g(this.prototype,"editedTitle",[s.tracked],(function(){return this.thread.title||""})))()
#Ms=(()=>{dt7948.i(this,"editedTitle")})()
static#r=(()=>dt7948.g(this.prototype,"saving",[s.tracked],(function(){return!1})))()
#Kt=(()=>{dt7948.i(this,"saving")})()
get buttonDisabled(){return this.saving}get thread(){return this.args.model}get threadTitleLength(){return this.editedTitle.length}saveThread(){this.saving=!0,this.chatApi.editThread(this.thread.channel.id,this.thread.id,{title:this.editedTitle}).then((()=>{this.thread.title=this.editedTitle,this.args.closeModal()})).catch(l.popupAjaxError).finally((()=>{this.saving=!1}))}static#c=(()=>dt7948.n(this.prototype,"saveThread",[n.action]))()
static#l=(()=>(0,a.setComponentTemplate)((0,u.createTemplateFactory)({id:"kYCLNf+o",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-thread-settings"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[32,1],["chat.thread_title_modal.title"],null]]],[["headerPrimaryAction","body","footer"],[[[[1,"\\n        "],[8,[32,2],[[24,0,"btn-transparent btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["saveThread"]],"chat.save"]],null],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,3],[[24,3,"thread-title"],[24,0,"chat-modal-thread-settings__title-input"],[24,"maxlength","50"],[16,"placeholder",[28,[32,1],["chat.thread_title_modal.input_placeholder"],null]]],[["@type","@value"],["text",[30,0,["editedTitle"]]]],null],[1,"\\n        "],[10,0],[14,0,"thread-title-length"],[12],[1,"\\n          "],[10,1],[12],[1,[30,0,["threadTitleLength"]]],[13],[1,"/50\\n        "],[13],[1,"\\n\\n"],[41,[30,0,["currentUser","admin"]],[[[1,"          "],[10,0],[14,0,"discourse-ai-cta"],[12],[1,"\\n            "],[10,2],[14,0,"discourse-ai-cta__title"],[12],[1,[28,[32,4],["circle-info"],null]],[1,"\\n              "],[1,[28,[32,1],["chat.thread_title_modal.discourse_ai.title"],null]],[13],[1,"\\n            "],[10,2],[14,0,"discourse-ai-cta__description"],[12],[1,[28,[32,5],[[28,[32,1],["chat.thread_title_modal.discourse_ai.description"],[["url"],["<a href=\'https://www.discourse.org/ai\' rel=\'noopener noreferrer\' target=\'_blank\'>Discourse AI</a>"]]]],null]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"      "]],[]],[[[1,"\\n        "],[8,[32,2],[[24,0,"btn-primary"]],[["@disabled","@action","@label"],[[30,0,["buttonDisabled"]],[30,0,["saveThread"]],"save"]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/thread-settings.js",scope:()=>[c.default,h.default,o.default,a.Input,d.default,r.htmlSafe],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status",["exports","@glimmer/component","@ember/object","@ember/service","@ember/template","discourse/components/d-button","discourse/components/d-modal","discourse/lib/ajax-error","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get channel(){return this.args.model}get buttonLabel(){return this.channel?.isClosed?"chat.channel_settings.open_channel":"chat.channel_settings.close_channel"}get instructions(){return this.channel?.isClosed?(0,n.htmlSafe)(l.default.t("chat.channel_open.instructions")):(0,n.htmlSafe)(l.default.t("chat.channel_close.instructions"))}get modalTitle(){return this.channel?.isClosed?"chat.channel_open.title":"chat.channel_close.title"}onStatusChange(){const e=this.channel.isClosed?d.CHANNEL_STATUSES.open:d.CHANNEL_STATUSES.closed
return this.chatApi.updateChannelStatus(this.channel.id,e).then((()=>{this.args.closeModal(),this.router.transitionTo("chat.channel",...this.channel.routeModels)})).catch(o.popupAjaxError)}static#n=(()=>dt7948.n(this.prototype,"onStatusChange",[s.action]))()
static#r=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"S6HBIoaZ",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"chat-modal-toggle-channel-status"]],[["@closeModal","@inline","@title"],[[30,1],[30,2],[28,[32,1],[[30,0,["modalTitle"]]],null]]],[["body","footer"],[[[[1,"\\n        "],[10,2],[14,0,"chat-modal-toggle-channel-status__instructions"],[12],[1,[30,0,["instructions"]]],[13],[1,"\\n      "]],[]],[[[1,"\\n        "],[8,[32,2],[[24,1,"chat-channel-toggle-btn"],[24,0,"btn-primary"]],[["@action","@label"],[[30,0,["onStatusChange"]],[30,0,["buttonLabel"]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n  "]],["@closeModal","@inline"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status.js",scope:()=>[r.default,c.default,i.default],isStrictMode:!0}),this))()}e.default=p}))
define("discourse/plugins/chat/discourse/components/chat/navbar/actions",["exports","@ember/helper","discourse/plugins/chat/discourse/components/chat/navbar/browse-channels-button","discourse/plugins/chat/discourse/components/chat/navbar/close-drawer-button","discourse/plugins/chat/discourse/components/chat/navbar/close-thread-button","discourse/plugins/chat/discourse/components/chat/navbar/close-threads-button","discourse/plugins/chat/discourse/components/chat/navbar/full-page-button","discourse/plugins/chat/discourse/components/chat/navbar/new-channel-button","discourse/plugins/chat/discourse/components/chat/navbar/new-direct-message-button","discourse/plugins/chat/discourse/components/chat/navbar/open-drawer-button","discourse/plugins/chat/discourse/components/chat/navbar/thread-settings-button","discourse/plugins/chat/discourse/components/chat/navbar/thread-tracking-dropdown","discourse/plugins/chat/discourse/components/chat/navbar/threads-list-button","discourse/plugins/chat/discourse/components/chat/navbar/toggle-drawer-button","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const _=(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"luKcWzo7",block:'[[[1,"\\n  "],[10,"nav"],[14,0,"c-navbar__actions"],[12],[1,"\\n    "],[18,1,[[28,[32,0],null,[["OpenDrawerButton","BrowseChannelsButton","NewDirectMessageButton","NewChannelButton","ThreadTrackingDropdown","CloseThreadButton","CloseThreadsButton","ThreadSettingsButton","ThreadsListButton","CloseDrawerButton","ToggleDrawerButton","FullPageButton"],[[32,1],[32,2],[32,3],[32,4],[32,5],[32,6],[32,7],[32,8],[32,9],[32,10],[32,11],[32,12]]]]]],[1,"\\n  "],[13],[1,"\\n"]],["&default"],false,["yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/actions.js",scope:()=>[t.hash,l.default,s.default,c.default,o.default,h.default,n.default,i.default,d.default,u.default,a.default,p.default,r.default],isStrictMode:!0}),(0,f.default)(void 0,"actions:ChatNavbarActions"))
e.default=_})),define("discourse/plugins/chat/discourse/components/chat/navbar/back-button",["exports","@glimmer/component","@ember/routing","discourse-common/helpers/d-icon","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get icon(){return this.args.icon??"chevron-left"}get title(){return this.args.title??n.default.t("chat.browse.back")}get targetRoute(){return this.args.route??"chat"}static#e=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"+gduAWVD",block:'[[[1,"\\n"],[41,[30,1],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__back-button no-text btn-transparent btn"],[16,"title",[30,0,["title"]]]],[["@route","@models"],[[30,2],[30,1]]],[["default"],[[[[1,"\\n"],[41,[48,[30,3]],[[[1,"          "],[18,3,null],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,1],[[30,0,["icon"]]],null]],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n"]],[]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__back-button no-text btn-transparent btn"],[16,"title",[30,0,["title"]]]],[["@route"],[[30,0,["targetRoute"]]]],[["default"],[[[[1,"\\n"],[41,[48,[30,3]],[[[1,"          "],[18,3,null],[1,"\\n"]],[]],[[[1,"          "],[1,[28,[32,1],[[30,0,["icon"]]],null]],[1,"\\n"]],[]]],[1,"      "]],[]]]]],[1,"\\n"]],[]]],[1,"  "]],["@routeModels","@route","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/back-button.js",scope:()=>[s.LinkTo,a.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/navbar/browse-channels-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
browseChannelsLabel=(()=>i.default.t("chat.channels_list_popup.browse"))()
get showBrowseChannelsButton(){return"chat.channels"===this.router.currentRoute.name}static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"yqGCXhpN",block:'[[[1,"\\n"],[41,[30,0,["showBrowseChannelsButton"]],[[[1,"      "],[8,[32,0],[[24,0,"btn no-text btn-flat c-navbar__browse-button"],[16,"title",[30,0,["browseChannelsLabel"]]]],[["@route"],["chat.browse"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["pencil"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/browse-channels-button.js",scope:()=>[s.LinkTo,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/navbar/channel-title",["exports","@ember/routing","discourse/plugins/chat/discourse/components/channel-title","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"PH5mdJQD",block:'[[[1,"\\n"],[41,[30,1],[[[1,"    "],[8,[32,0],[[24,0,"c-navbar__channel-title"]],[["@route","@models"],["chat.channel.info.settings",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n      "],[8,[32,1],null,[["@channel"],[[30,1]]],null],[1,"\\n    "]],[]]]]],[1,"\\n"]],[]],null]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/channel-title.js",scope:()=>[t.LinkTo,s.default],isStrictMode:!0}),(0,i.default)(void 0,"channel-title:ChatNavbarChannelTitle"))
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/navbar/close-drawer-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[a.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
closeDrawer(){this.chatStateManager.didCloseDrawer(),this.chat.activeChannel=null}static#n=(()=>dt7948.n(this.prototype,"closeDrawer",[s.action]))()
static#r=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"TAWVg/ye",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"btn-transparent no-text c-navbar__close-drawer-button"]],[["@icon","@action","@title"],["xmark",[30,0,["closeDrawer"]],"chat.close"]],null],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/close-drawer-button.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/chat/navbar/close-thread-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"ovcFx+Tj",block:'[[[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__close-thread-button btn-transparent btn btn-icon no-text"],[16,"title",[28,[32,1],["chat.thread.close"],null]]],[["@route","@models"],["chat.channel",[30,1,["channel","routeModels"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,2],["xmark"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@thread"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/close-thread-button.js",scope:()=>[s.LinkTo,i.default,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/navbar/close-threads-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse-common/helpers/d-icon","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
closeButtonTitle=(()=>i.default.t("chat.thread.close"))()
static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"R+DUT5Sk",block:'[[[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__close-threads-button btn-transparent btn btn-icon no-text"],[16,"title",[30,0,["closeButtonTitle"]]]],[["@route","@models"],["chat.channel",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["xmark"],null]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/close-threads-button.js",scope:()=>[s.LinkTo,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/navbar/full-page-button",["exports","@glimmer/component","@ember/object","@ember/runloop","@ember/service","discourse/components/d-button","discourse/lib/url","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[n.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
async openInFullPage(){this.chatStateManager.storeAppURL(),this.chatStateManager.prefersFullPage(),this.chat.activeChannel=null,await new Promise((e=>(0,a.next)(e))),r.default.routeTo(this.chatStateManager.lastKnownChatURL)}static#n=(()=>dt7948.n(this.prototype,"openInFullPage",[s.action]))()
static#r=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"L4RK4IA3",block:'[[[1,"\\n"],[41,[30,0,["chatStateManager","isDrawerExpanded"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-transparent no-text c-navbar__full-page-button"]],[["@icon","@title","@action"],["discourse-expand","chat.open_full_page",[30,0,["openInFullPage"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/full-page-button.js",scope:()=>[i.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/navbar/index",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","discourse/helpers/concat-class","discourse/helpers/noop","discourse/plugins/chat/discourse/modifiers/chat/on-resize","discourse/plugins/chat/discourse/components/chat/navbar/actions","discourse/plugins/chat/discourse/components/chat/navbar/back-button","discourse/plugins/chat/discourse/components/chat/navbar/channel-title","discourse/plugins/chat/discourse/components/chat/navbar/title","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class m extends t.default{handleResize(e){for(let t of e){const e=t.target.clientHeight
requestAnimationFrame((()=>{document.documentElement.style.setProperty("--chat-header-expanded-offset",`${e}px`)}))}}static#e=(()=>dt7948.n(this.prototype,"handleResize",[n.action]))()
static#s=(()=>(0,u.setComponentTemplate)((0,p.createTemplateFactory)({id:"6bA69P/o",block:'[[[1,"\\n"],[1,"    "],[11,0],[16,0,[28,[32,0],["c-navbar-container",[52,[30,1],"-clickable"],[52,[30,2],"-full-title"]],null]],[4,[32,1],["click",[52,[30,1],[30,1],[28,[32,2],null,null]]],null],[4,[32,3],[[30,0,["handleResize"]]],null],[12],[1,"\\n      "],[10,"nav"],[14,0,"c-navbar"],[12],[1,"\\n        "],[18,3,[[28,[32,4],null,[["BackButton","ChannelTitle","Title","Actions"],[[32,5],[32,6],[32,7],[32,8]]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@onClick","@showFullTitle","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/index.js",scope:()=>[i.default,a.on,r.default,o.default,s.hash,l.default,d.default,h.default,c.default],isStrictMode:!0}),this))()}e.default=m})),define("discourse/plugins/chat/discourse/components/chat/navbar/new-channel-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/plugins/chat/discourse/components/chat/modal/create-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatStateManager",[a.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#s=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#n=(()=>dt7948.g(this.prototype,"modal",[a.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#r=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
createChannel(){this.modal.show(i.default)}static#c=(()=>dt7948.n(this.prototype,"createChannel",[s.action]))()
static#l=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"PEwkGjH5",block:'[[[1,"\\n"],[41,[30,0,["currentUser","staff"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__new-channel-button btn-transparent"]],[["@action","@icon","@label"],[[30,0,["createChannel"]],"plus",[52,[30,0,["site","desktopView"]],"chat.create_channel.title"]]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/new-channel-button.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/navbar/new-direct-message-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"modal",[a.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
buttonLabel=(()=>i.default.t("chat.channels_list_popup.browse"))()
get showButtonComponent(){return"chat.direct-messages"===this.router.currentRoute.name&&this.canCreateDirectMessageChannel}get canCreateDirectMessageChannel(){return this.chat.userCanDirectMessage}openNewMessageModal(){this.modal.show(r.default)}static#r=(()=>dt7948.n(this.prototype,"openNewMessageModal",[s.action]))()
static#c=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"hO5vSjgE",block:'[[[1,"\\n"],[41,[30,0,["showButtonComponent"]],[[[1,"      "],[8,[32,0],[[24,0,"btn no-text btn-flat c-navbar__new-dm-button"],[16,"title",[30,0,["buttonLabel"]]]],[["@action","@icon"],[[30,0,["openNewMessageModal"]],"plus"]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/new-direct-message-button.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/navbar/open-drawer-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/lib/url","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatStateManager",[a.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#s=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
async openDrawer(){this.chatStateManager.prefersDrawer(),i.default.routeTo(this.chatStateManager.lastKnownAppURL).then((()=>{i.default.routeTo(this.chatStateManager.lastKnownChatURL)}))}static#n=(()=>dt7948.n(this.prototype,"openDrawer",[s.action]))()
static#r=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"rzfCPs7o",block:'[[[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"      "],[8,[32,0],[[24,0,"c-navbar__open-drawer-button btn-transparent"]],[["@icon","@title","@action"],["discourse-compress","chat.close_full_page",[30,0,["openDrawer"]]]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/open-drawer-button.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/navbar/sub-title",["exports","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,t.setComponentTemplate)((0,s.createTemplateFactory)({id:"v8Ekg8XF",block:'[[[1,"\\n  "],[10,0],[14,0,"c-navbar__sub-title"],[12],[1,"\\n"],[41,[48,[30,2]],[[[1,"      "],[18,2,null],[1,"\\n"]],[]],[[[1,"      "],[1,[30,1]],[1,"\\n"]],[]]],[1,"  "],[13],[1,"\\n"]],["@title","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/sub-title.js",isStrictMode:!0}),(0,a.default)(void 0,"sub-title:ChatNavbarSubTitle"))
e.default=n})),define("discourse/plugins/chat/discourse/components/chat/navbar/thread-settings-button",["exports","@glimmer/component","@ember/object","@ember/service","discourse/components/d-button","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"modal",[a.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
get canChangeThreadSettings(){return!!this.args.thread&&(this.currentUser.staff||this.currentUser.id===this.args.thread.originalMessage.user.id)}openThreadSettings(){this.modal.show(i.default,{model:this.args.thread})}static#n=(()=>dt7948.n(this.prototype,"openThreadSettings",[s.action]))()
static#r=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"+/omuWcJ",block:'[[[1,"\\n"],[41,[30,0,["canChangeThreadSettings"]],[[[1,"      "],[8,[32,0],[[24,0,"btn-transparent c-navbar__thread-settings-button"]],[["@action","@icon","@title"],[[30,0,["openThreadSettings"]],"gear","chat.thread.settings"]],null],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/thread-settings-button.js",scope:()=>[n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/navbar/thread-tracking-dropdown",["exports","@glimmer/component","@glimmer/tracking","@ember/object","@ember/service","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse/lib/notification-levels","discourse/plugins/chat/discourse/components/chat-thread-tracking-dropdown","discourse/plugins/chat/discourse/models/user-chat-thread-membership","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"persistedNotificationLevel",[s.tracked],(function(){return!0})))()
#Cs=(()=>{dt7948.i(this,"persistedNotificationLevel")})()
get threadNotificationLevel(){return this.membership?.notificationLevel||o.NotificationLevels.REGULAR}get membership(){return this.args.thread.currentUserMembership}async updateThreadNotificationLevel(e){let t
this.persistedNotificationLevel=!1,this.membership?(t=this.membership.notificationLevel,this.membership.notificationLevel=e):this.args.thread.currentUserMembership=l.default.create({notification_level:e,last_read_message_id:null})
try{const t=await this.chatApi.updateCurrentUserThreadNotificationsSettings(this.args.thread.channel.id,this.args.thread.id,{notificationLevel:e})
this.membership.last_read_message_id=t.membership.last_read_message_id,this.persistedNotificationLevel=!0}catch(s){this.membership.notificationLevel=t,(0,r.popupAjaxError)(s)}}static#n=(()=>dt7948.n(this.prototype,"updateThreadNotificationLevel",[a.action]))()
static#r=(()=>(0,d.setComponentTemplate)((0,h.createTemplateFactory)({id:"saHWpeA3",block:'[[[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["c-navbar__thread-tracking-dropdown",[52,[30,0,["persistedNotificationLevel"]],"-persisted"]],null]]],[["@value","@onChange"],[[30,0,["threadNotificationLevel"]],[30,0,["updateThreadNotificationLevel"]]]],null],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/thread-tracking-dropdown.js",scope:()=>[c.default,i.default],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat/navbar/threads-list-button",["exports","@glimmer/component","@ember/routing","@ember/service","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse-i18n","discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[a.service]))()
#y=(()=>{dt7948.i(this,"router")})()
threadsListLabel=(()=>r.default.t("chat.threads.list"))()
get showThreadsListButton(){return this.args.channel?.threadingEnabled&&"chat.channel.threads"!==this.router.currentRoute.name&&"chat.channel.thread"!==this.router.currentRoute.name&&"chat.channel.thread.index"!==this.router.currentRoute.name}static#s=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"HrF2otwx",block:'[[[1,"\\n"],[41,[30,0,["showThreadsListButton"]],[[[1,"      "],[8,[32,0],[[16,"title",[30,0,["threadsListLabel"]]],[16,0,[28,[32,1],["c-navbar__threads-list-button","btn","no-text","btn-flat",[52,[30,1,["threadsManager","unreadThreadCount"]],"has-unreads"]],null]]],[["@route","@models"],["chat.channel.threads",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n        "],[1,[28,[32,2],["discourse-threads"],null]],[1,"\\n        "],[8,[32,3],null,[["@channel"],[[30,1]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/threads-list-button.js",scope:()=>[s.LinkTo,n.default,i.default,o.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat/navbar/title",["exports","@ember/helper","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/d-icon","discourse/plugins/chat/discourse/components/chat/navbar/sub-title","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"lQU7/E4M",block:'[[[1,"\\n  "],[10,0],[15,"title",[30,1]],[15,0,[28,[32,0],["c-navbar__title",[52,[30,2],"full-title"]],null]],[12],[1,"\\n"],[41,[30,3],[[[1,"      "],[8,[32,1],[[24,0,"c-navbar__title-text btn-transparent"]],[["@icon","@action","@translatedLabel"],[[30,4],[30,3],[30,1]]],null],[1,"\\n"]],[]],[[[1,"      "],[10,1],[14,0,"c-navbar__title-text"],[12],[1,"\\n        "],[1,[52,[30,4],[28,[32,2],[[30,4]],null]]],[1,"\\n        "],[1,[30,1]],[1,"\\n      "],[13],[1,"\\n"]],[]]],[41,[48,[30,5]],[[[1,"      "],[18,5,[[28,[32,3],null,[["SubTitle"],[[32,4]]]]]],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],["@title","@showFullTitle","@openThreadTitleModal","@icon","&default"],false,["if","has-block","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/title.js",scope:()=>[a.default,s.default,n.default,t.hash,i.default],isStrictMode:!0}),(0,c.default)(void 0,"title:ChatNavbarTitle"))
e.default=l})),define("discourse/plugins/chat/discourse/components/chat/navbar/toggle-drawer-button",["exports","@glimmer/component","@ember/service","discourse/components/d-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"JOSsU1xt",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"btn-transparent no-text c-navbar__toggle-drawer-button"]],[["@icon","@action","@title"],[[52,[30,0,["chatStateManager","isDrawerExpanded"]],"angles-down","angles-up"],[30,0,["chat","toggleDrawer"]],[52,[30,0,["chatStateManager","isDrawerExpanded"]],"chat.collapse","chat.expand"]]],null],[1,"\\n  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/navbar/toggle-drawer-button.js",scope:()=>[a.default],isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership",["exports","@glimmer/component","@glimmer/tracking","@ember/modifier","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/modifiers/chat/later-fn","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class u extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[(0,i.service)("chat-api")]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"invitationsSent",[s.tracked],(function(){return!1})))()
#ws=(()=>{dt7948.i(this,"invitationsSent")})()
get userIds(){return this.args.notice.data.user_ids}async sendInvitations(e){e.preventDefault()
try{await this.chatApi.invite(this.args.channel.id,this.userIds,{messageId:this.args.notice.data.messageId}),this.invitationsSent=!0}catch(t){(0,r.popupAjaxError)(t)}}static#n=(()=>dt7948.n(this.prototype,"sendInvitations",[n.action]))()
static#r=(()=>(0,d.setComponentTemplate)((0,h.createTemplateFactory)({id:"43SYY4H4",block:'[[[1,"\\n    "],[10,0],[14,0,"mention-without-membership-notice"],[12],[1,"\\n"],[41,[30,0,["invitationsSent"]],[[[1,"        "],[11,1],[24,0,"mention-without-membership-notice__invitation-sent"],[4,[32,0],[[30,1],3000],null],[12],[1,"\\n          "],[1,[28,[32,1],["check"],null]],[1,"\\n          "],[10,1],[12],[1,"\\n            "],[1,[28,[32,2],["chat.mention_warning.invitations_sent"],[["count"],[[30,0,["userIds","length"]]]]]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],[[[1,"        "],[10,2],[14,0,"mention-without-membership-notice__body -without-membership"],[12],[1,"\\n          "],[10,1],[14,0,"mention-without-membership-notice__body__text"],[12],[1,[30,2,["data","text"]]],[13],[1,"\\n          "],[11,3],[24,0,"mention-without-membership-notice__body__link"],[24,6,""],[4,[32,3],["click",[30,0,["sendInvitations"]]],null],[12],[1,"\\n            "],[1,[28,[32,2],["chat.mention_warning.invite"],null]],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@clearNotice","@notice"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/notices/mention_without_membership.js",scope:()=>[l.default,o.default,c.default,a.on],isStrictMode:!0}),this))()}e.default=u})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info-members",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","ember-modifier","discourse/lib/is-element-in-viewport","discourse/lib/url","discourse/modifiers/auto-focus","discourse-common/config/environment","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-common/lib/debounce","discourse-i18n","discourse/plugins/chat/discourse/components/chat/message-creator","discourse/plugins/chat/discourse/components/chat/message-creator/constants","discourse/plugins/chat/discourse/components/chat-user-info","discourse/plugins/chat/discourse/components/dc-filter-input","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class w extends t.default{static#e=(()=>dt7948.g(this.prototype,"appEvents",[o.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[o.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"modal",[o.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#r=(()=>dt7948.g(this.prototype,"loadingSlider",[o.service]))()
#Lt=(()=>{dt7948.i(this,"loadingSlider")})()
static#c=(()=>dt7948.g(this.prototype,"site",[o.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#l=(()=>dt7948.g(this.prototype,"filter",[s.tracked],(function(){return""})))()
#o=(()=>{dt7948.i(this,"filter")})()
static#d=(()=>dt7948.g(this.prototype,"showAddMembers",[s.tracked],(function(){return!1})))()
#Ss=(()=>{dt7948.i(this,"showAddMembers")})()
addMemberLabel=(()=>f.default.t("chat.members_view.add_member"))()
filterPlaceholder=(()=>f.default.t("chat.members_view.filter_placeholder"))()
noMembershipsFoundLabel=(()=>f.default.t("chat.channel.no_memberships_found"))()
noMembershipsLabel=(()=>f.default.t("chat.channel.no_memberships"))()
onEnter=(()=>(0,c.modifier)(((e,t)=>{let[s]=t
const a=e=>{"Enter"===e.key&&s(e)}
return e.addEventListener("keydown",a),()=>{e.removeEventListener("keydown",a)}})))()
fill=(()=>(0,c.modifier)((e=>(this.resizeObserver=new ResizeObserver((()=>{(0,l.default)(e)&&this.load()})),this.resizeObserver.observe(e),()=>{this.resizeObserver.disconnect()}))))()
loadMore=(()=>(0,c.modifier)((e=>(this.intersectionObserver=new IntersectionObserver(this.load),this.intersectionObserver.observe(e),()=>{this.intersectionObserver.disconnect()}))))()
get noResults(){return this.members.fetchedOnce&&!this.members.loading}get members(){const e={}
return this.filter?.length&&(e.username=this.filter),this.chatApi.listChannelMemberships(this.args.channel.id,e)}static#h=(()=>dt7948.n(this.prototype,"members",[s.cached]))()
load(){(0,g.default)(this,this.debouncedLoad,u.INPUT_DELAY)}static#u=(()=>dt7948.n(this.prototype,"load",[i.action]))()
mutFilter(e){this.filter=e.target.value,this.load()}static#p=(()=>dt7948.n(this.prototype,"mutFilter",[i.action]))()
addMember(){this.showAddMembers=!0}static#j=(()=>dt7948.n(this.prototype,"addMember",[i.action]))()
hideAddMember(){this.showAddMembers=!1}static#P=(()=>dt7948.n(this.prototype,"hideAddMember",[i.action]))()
openMemberCard(e,t){t.preventDefault(),d.default.routeTo((0,d.userPath)(e.username_lower))}static#O=(()=>dt7948.n(this.prototype,"openMemberCard",[i.action]))()
async debouncedLoad(){this.loadingSlider.transitionStarted(),await this.members.load({limit:20}),this.loadingSlider.transitionEnded()}get addMembersMode(){return b.MODES.add_members}static#D=(()=>(0,M.setComponentTemplate)((0,C.createTemplateFactory)({id:"T6VhoNXL",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channel-info-members"],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[8,[32,0],[[24,0,"c-back-button"]],[["@route","@model"],["chat.channel.info.settings",[30,1]]],[["default"],[[[[1,"\\n          "],[1,[28,[32,1],["chevron-left"],null]],[1,"\\n          "],[1,[28,[32,2],["chat.members_view.back_to_settings"],null]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[41,[30,0,["showAddMembers"]],[[[1,"        "],[8,[32,3],null,[["@mode","@channel","@onClose","@onCancel"],[[30,0,["addMembersMode"]],[30,1],[30,0,["hideAddMember"]],[30,0,["hideAddMember"]]]],null],[1,"\\n"]],[]],[[[1,"        "],[10,0],[14,0,"c-channel-members"],[12],[1,"\\n          "],[8,[32,4],[[16,"placeholder",[30,0,["filterPlaceholder"]]],[4,[32,6],null,null]],[["@filterAction","@icons","@containerClass"],[[30,0,["mutFilter"]],[28,[32,5],null,[["right"],["magnifying-glass"]]],"c-channel-members__filter"]],null],[1,"\\n\\n          "],[11,"ul"],[24,0,"c-channel-members__list"],[4,[30,0,["fill"]],null,null],[12],[1,"\\n"],[41,[30,1,["chatable","group"]],[[[1,"              "],[11,"li"],[24,0,"c-channel-members__list-item -add-member"],[24,"role","button"],[24,"tabindex","0"],[4,[32,7],["click",[30,0,["addMember"]]],null],[4,[30,0,["onEnter"]],[[30,0,["addMember"]]],null],[12],[1,"\\n                "],[1,[28,[32,1],["plus"],null]],[1,"\\n                "],[10,1],[12],[1,[30,0,["addMemberLabel"]]],[13],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[42,[28,[31,2],[[28,[31,2],[[30,0,["members"]]],null]],null],null,[[[1,"              "],[11,"li"],[24,0,"c-channel-members__list-item -member"],[24,"tabindex","0"],[4,[32,7],["click",[28,[32,8],[[30,0,["openMemberCard"]],[30,2,["user"]]],null]],null],[4,[30,0,["onEnter"]],[[28,[32,8],[[30,0,["openMemberCard"]],[30,2,["user"]]],null]],null],[12],[1,"\\n                "],[8,[32,9],null,[["@user","@avatarSize","@interactive","@showStatus","@showStatusDescription"],[[30,2,["user"]],"tiny",false,true,true]],null],[1,"\\n              "],[13],[1,"\\n"]],[2]],[[[41,[30,0,["noResults"]],[[[1,"                "],[10,"li"],[14,0,"c-channel-members__list-item -no-results alert alert-info"],[12],[1,"\\n                  "],[1,[30,0,["noMembershipsFoundLabel"]]],[1,"\\n                "],[13],[1,"\\n"]],[]],null]],[]]],[1,"          "],[13],[1,"\\n\\n          "],[11,0],[4,[30,0,["loadMore"]],null,null],[12],[1,"\\n            "],[10,"br"],[12],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]]],[1,"    "],[13],[1,"\\n  "]],["@channel","membership"],false,["if","each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info-members.js",scope:()=>[r.LinkTo,p.default,m.default,_.default,y.default,a.hash,h.default,n.on,a.fn,v.default],isStrictMode:!0}),this))()}e.default=w})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info-nav",["exports","@glimmer/component","@ember/routing","@ember/service","truth-helpers","discourse-common/helpers/i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
get showTabs(){return this.site.desktopView&&this.args.channel.isOpen}static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"FVfuhaf3",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channel-info-nav"],[12],[1,"\\n"],[41,[30,0,["showTabs"]],[[[1,"        "],[10,"nav"],[14,0,"c-channel-info__nav"],[12],[1,"\\n          "],[10,"ul"],[14,0,"nav nav-pills"],[12],[1,"\\n            "],[10,"li"],[12],[1,"\\n              "],[8,[32,0],[[16,0,[52,[28,[32,1],[[30,1],"settings"],null],"active"]]],[["@route","@models","@replace"],["chat.channel.info.settings",[30,2,["routeModels"]],true]],[["default"],[[[[1,"\\n                "],[1,[28,[32,2],["chat.channel_info.tabs.settings"],null]],[1,"\\n              "]],[]]]]],[1,"\\n            "],[13],[1,"\\n            "],[10,"li"],[12],[1,"\\n              "],[8,[32,0],[[16,0,[52,[28,[32,1],[[30,1],"members"],null],"active"]]],[["@route","@models","@replace"],["chat.channel.info.members",[30,2,["routeModels"]],true]],[["default"],[[[[1,"\\n                "],[1,[28,[32,2],["chat.channel_info.tabs.members"],null]],[1,"\\n"],[41,[30,2,["isCategoryChannel"]],[[[1,"                  "],[10,1],[14,0,"c-channel-info__member-count"],[12],[1,"("],[1,[30,2,["membershipsCount"]]],[1,")"],[13],[1,"\\n"]],[]],null],[1,"              "]],[]]]]],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@tab","@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info-nav.js",scope:()=>[s.LinkTo,n.eq,i.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info-settings",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/routing","@ember/service","discourse/components/d-button","discourse/components/d-toggle-switch","discourse/helpers/category-badge","discourse/helpers/replace-emoji","discourse/lib/ajax-error","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","discourse-i18n","select-kit/components/combo-box","discourse/plugins/chat/discourse/components/chat/form","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","discourse/plugins/chat/discourse/components/chat-retention-reminder-text","discourse/plugins/chat/discourse/components/toggle-channel-membership-button","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_,b,v,y,M,C,w,S,k){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const T=[{name:m.default.t("chat.notification_levels.never"),value:"never"},{name:m.default.t("chat.notification_levels.mention"),value:"mention"},{name:m.default.t("chat.notification_levels.always"),value:"always"}]
class x extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[r.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"chatGuardian",[r.service]))()
#ks=(()=>{dt7948.i(this,"chatGuardian")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[r.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[r.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"siteSettings",[r.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#l=(()=>dt7948.g(this.prototype,"dialog",[r.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#d=(()=>dt7948.g(this.prototype,"modal",[r.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#h=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#u=(()=>dt7948.g(this.prototype,"toasts",[r.service]))()
#mt=(()=>{dt7948.i(this,"toasts")})()
static#p=(()=>dt7948.g(this.prototype,"router",[r.service]))()
#y=(()=>{dt7948.i(this,"router")})()
notificationLevels=(()=>T)()
settingsSectionTitle=(()=>m.default.t("chat.settings.settings_title"))()
channelInfoSectionTitle=(()=>m.default.t("chat.settings.info_title"))()
categoryLabel=(()=>m.default.t("chat.settings.category_label"))()
historyLabel=(()=>m.default.t("chat.settings.history_label"))()
adminSectionTitle=(()=>m.default.t("chat.settings.admin_title"))()
membersLabel=(()=>m.default.t("chat.channel_info.tabs.members"))()
descriptionSectionTitle=(()=>m.default.t("chat.about_view.description"))()
titleSectionTitle=(()=>m.default.t("chat.about_view.title"))()
descriptionPlaceholder=(()=>m.default.t("chat.channel_edit_description_modal.description"))()
toggleThreadingLabel=(()=>m.default.t("chat.settings.channel_threading_label"))()
toggleThreadingDescription=(()=>m.default.t("chat.settings.channel_threading_description"))()
muteSectionLabel=(()=>m.default.t("chat.settings.mute"))()
channelWideMentionsLabel=(()=>m.default.t("chat.settings.channel_wide_mentions_label"))()
autoJoinLabel=(()=>m.default.t("chat.settings.auto_join_users_label"))()
notificationsLevelLabel=(()=>m.default.t("chat.settings.notification_level"))()
get canEditChannel(){return!(!this.args.channel.isCategoryChannel||!this.chatGuardian.canEditChatChannel())||!(!this.args.channel.isDirectMessageChannel||!this.args.channel.chatable.group)}get shouldRenderDescriptionSection(){return this.args.channel.isCategoryChannel}get shouldRenderStatusSection(){return this.args.channel.isCategoryChannel}get shouldRenderArchiveRow(){return this.chatGuardian.canArchiveChannel(this.args.channel)}get toggleChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get toggleThreadingCategoryChannel(){return this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get toggleThreadingDirectMessage(){return this.args.channel.isDirectMessageChannel&&this.args.channel.isOpen}get channelWideMentionsDescription(){return m.default.t("chat.settings.channel_wide_mentions_description",{channel:this.args.channel.title})}get isChannelMuted(){return this.args.channel.currentUserMembership.muted}get shouldRenderChannelWideMentionsAvailable(){return this.args.channel.isCategoryChannel}get shouldRenderNotificationsLevelSection(){return!this.isChannelMuted}get autoJoinAvailable(){return this.siteSettings.max_chat_auto_joined_users>0&&this.args.channel.isCategoryChannel&&this.args.channel.isOpen}get shouldRenderAdminSection(){return this.canEditChannel&&(this.toggleChannelWideMentionsAvailable||this.args.channel.isCategoryChannel)}async onToggleChannelWideMentions(){const e=!this.args.channel.allowChannelWideMentions
if(this.args.channel.allowChannelWideMentions!==e)try{this.args.channel.allowChannelWideMentions=e
const t=await this._updateChannelProperty(this.args.channel,"allow_channel_wide_mentions",e)
this.args.channel.allowChannelWideMentions=t.channel.allow_channel_wide_mentions}catch(t){(0,h.popupAjaxError)(t)}}static#j=(()=>dt7948.n(this.prototype,"onToggleChannelWideMentions",[n.action]))()
async onToggleAutoJoinUsers(){return this.args.channel.autoJoinUsers?await this.onDisableAutoJoinUsers():await this.onEnableAutoJoinUsers()}static#P=(()=>dt7948.n(this.prototype,"onToggleAutoJoinUsers",[n.action]))()
async onDisableAutoJoinUsers(){if(!1!==this.args.channel.autoJoinUsers)try{this.args.channel.autoJoinUsers=!1
const e=await this._updateChannelProperty(this.args.channel,"auto_join_users",!1)
this.args.channel.autoJoinUsers=e.channel.auto_join_users}catch(e){(0,h.popupAjaxError)(e)}}static#O=(()=>dt7948.n(this.prototype,"onDisableAutoJoinUsers",[n.action]))()
onEnableAutoJoinUsers(){if(!0!==this.args.channel.autoJoinUsers)return this.dialog.confirm({message:m.default.t("chat.settings.auto_join_users_warning",{category:this.args.channel.chatable.name}),didConfirm:async()=>{try{const e=await this._updateChannelProperty(this.args.channel,"auto_join_users",!0)
this.args.channel.autoJoinUsers=e.channel.auto_join_users}catch(e){(0,h.popupAjaxError)(e)}}})}static#D=(()=>dt7948.n(this.prototype,"onEnableAutoJoinUsers",[n.action]))()
onToggleMuted(){const e=!this.args.channel.currentUserMembership.muted
this.saveNotificationSettings("muted","muted",e)}static#I=(()=>dt7948.n(this.prototype,"onToggleMuted",[n.action]))()
async saveNotificationSettings(e,t,s){if(this.args.channel.currentUserMembership[e]===s)return
this.args.channel.currentUserMembership[e]=s
const a={}
a[t]=s
try{const s=await this.chatApi.updateCurrentUserChannelNotificationsSettings(this.args.channel.id,a)
this.args.channel.currentUserMembership[e]=s.membership[t],this.toasts.success({data:{message:m.default.t("saved")}})}catch(n){(0,h.popupAjaxError)(n)}}static#R=(()=>dt7948.n(this.prototype,"saveNotificationSettings",[n.action]))()
async _updateChannelProperty(e,t,s){try{const a=await this.chatApi.updateChannel(e.id,{[t]:s})
return this.toasts.success({data:{message:m.default.t("saved")}}),a}catch(a){(0,h.popupAjaxError)(a)}}static#N=(()=>dt7948.n(this.prototype,"_updateChannelProperty",[n.action]))()
async onToggleThreadingEnabled(e){try{this.args.channel.threadingEnabled=!e
const t=await this._updateChannelProperty(this.args.channel,"threading_enabled",!e)
this.args.channel.threadingEnabled=t.channel.threading_enabled}catch(t){(0,h.popupAjaxError)(t)}}static#B=(()=>dt7948.n(this.prototype,"onToggleThreadingEnabled",[n.action]))()
onToggleChannelState(){return this.modal.show(M.default,{model:this.args.channel})}static#H=(()=>dt7948.n(this.prototype,"onToggleChannelState",[n.action]))()
onArchiveChannel(){return this.modal.show(_.default,{model:{channel:this.args.channel}})}static#z=(()=>dt7948.n(this.prototype,"onArchiveChannel",[n.action]))()
onDeleteChannel(){return this.modal.show(b.default,{model:{channel:this.args.channel}})}static#ne=(()=>dt7948.n(this.prototype,"onDeleteChannel",[n.action]))()
onEditChannelTitle(){return this.modal.show(y.default,{model:this.args.channel})}static#re=(()=>dt7948.n(this.prototype,"onEditChannelTitle",[n.action]))()
onLeaveChannel(e){return this.chatChannelsManager.remove(e),this.router.transitionTo("chat")}static#ce=(()=>dt7948.n(this.prototype,"onLeaveChannel",[n.action]))()
onEditChannelDescription(){return this.modal.show(v.default,{model:this.args.channel})}static#de=(()=>dt7948.n(this.prototype,"onEditChannelDescription",[n.action]))()
static#ue=(()=>(0,S.setComponentTemplate)((0,k.createTemplateFactory)({id:"wpqkZVXA",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channel-info-settings"],[12],[1,"\\n      "],[10,0],[14,0,"c-channel-settings"],[12],[1,"\\n        "],[8,[32,0],null,null,[["default"],[[[[1,"\\n          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["titleSectionTitle"]]]],[["default"],[[[[1,"\\n            "],[8,[30,2,["row"]],null,null,[["default","action"],[[[[1,"\\n                "],[10,0],[14,0,"c-channel-settings__name"],[12],[1,"\\n                  "],[1,[28,[32,1],[[30,3,["title"]]],null]],[1,"\\n                "],[13],[1,"\\n\\n"],[41,[30,3,["isCategoryChannel"]],[[[1,"                  "],[10,0],[14,0,"c-channel-settings__slug"],[12],[1,"\\n                    "],[8,[32,2],null,[["@route","@models"],["chat.channel",[30,3,["routeModels"]]]],[["default"],[[[[1,"\\n                      /chat/c/"],[1,[30,3,["slug"]]],[1,"/"],[1,[30,3,["id"]]],[1,"\\n                    "]],[]]]]],[1,"\\n                  "],[13],[1,"\\n"]],[]],null],[1,"              "]],[]],[[[1,"\\n"],[41,[30,0,["canEditChannel"]],[[[1,"                  "],[8,[32,3],[[24,0,"edit-name-slug-btn btn-flat"]],[["@label","@action"],["chat.channel_settings.edit",[30,0,["onEditChannelTitle"]]]],null],[1,"\\n"]],[]],null],[1,"              "]],[]]]]],[1,"\\n          "]],[2]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderDescriptionSection"]],[[[1,"            "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["descriptionSectionTitle"]]]],[["default"],[[[[1,"\\n              "],[8,[30,4,["row"]],null,null,[["default","action"],[[[[1,"\\n"],[41,[30,3,["description","length"]],[[[1,"                    "],[1,[30,3,["description"]]],[1,"\\n"]],[]],[[[1,"                    "],[1,[30,0,["descriptionPlaceholder"]]],[1,"\\n"]],[]]],[1,"                "]],[]],[[[1,"\\n"],[41,[30,0,["canEditChannel"]],[[[1,"                    "],[8,[32,3],[[24,0,"edit-description-btn btn-flat"]],[["@label","@action"],[[52,[30,3,["description","length"]],"chat.channel_settings.edit","chat.channel_settings.add"],[30,0,["onEditChannelDescription"]]]],null],[1,"\\n"]],[]],null],[1,"                "]],[]]]]],[1,"\\n            "]],[4]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"            "],[8,[30,1,["section"]],null,null,[["default"],[[[[1,"\\n              "],[8,[30,5,["row"]],null,[["@label","@route","@routeModels"],[[30,0,["membersLabel"]],"chat.channel.info.members",[30,3,["routeModels"]]]],null],[1,"\\n            "]],[5]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,3,["isOpen"]],[[[1,"            "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["settingsSectionTitle"]]]],[["default"],[[[[1,"\\n              "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["muteSectionLabel"]]]],[["action"],[[[[1,"\\n                  "],[8,[32,4],[[24,0,"c-channel-settings__mute-switch"],[4,[32,5],["click",[30,0,["onToggleMuted"]]],null]],[["@state"],[[30,3,["currentUserMembership","muted"]]]],null],[1,"\\n                "]],[]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderNotificationsLevelSection"]],[[[1,"                "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["notificationsLevelLabel"]]]],[["action"],[[[[1,"\\n                    "],[8,[32,6],[[24,0,"c-channel-settings__selector c-channel-settings__notifications-selector"]],[["@content","@value","@valueProperty","@onChange"],[[30,0,["notificationLevels"]],[30,3,["currentUserMembership","notificationLevel"]],"value",[28,[32,7],[[30,0,["saveNotificationSettings"]],"notificationLevel","notification_level"],null]]],null],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleThreadingDirectMessage"]],[[[1,"                "],[8,[30,6,["row"]],null,[["@label"],[[30,0,["toggleThreadingLabel"]]]],[["action","description"],[[[[1,"\\n                    "],[8,[32,4],[[24,0,"c-channel-settings__threading-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleThreadingEnabled"]],[30,3,["threadingEnabled"]]],null]],null]],[["@state"],[[30,3,["threadingEnabled"]]]],null],[1,"\\n                  "]],[]],[[[1,"\\n                    "],[1,[30,0,["toggleThreadingDescription"]]],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"            "]],[6]]]]],[1,"\\n"]],[]],null],[1,"\\n          "],[8,[30,1,["section"]],null,[["@title"],[[30,0,["channelInfoSectionTitle"]]]],[["default"],[[[[1,"\\n"],[41,[30,3,["isCategoryChannel"]],[[[1,"              "],[8,[30,7,["row"]],null,[["@label"],[[30,0,["categoryLabel"]]]],[["default"],[[[[1,"\\n                "],[1,[28,[32,8],[[30,3,["chatable"]]],[["link","allowUncategorized"],[true,true]]]],[1,"\\n              "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n            "],[8,[30,7,["row"]],null,[["@label"],[[30,0,["historyLabel"]]]],[["default"],[[[[1,"\\n              "],[8,[32,9],null,[["@channel","@type"],[[30,3],"short"]],null],[1,"\\n            "]],[]]]]],[1,"\\n          "]],[7]]]]],[1,"\\n\\n"],[41,[30,0,["shouldRenderAdminSection"]],[[[1,"            "],[8,[30,1,["section"]],[[24,"data-section","admin"]],[["@title"],[[30,0,["adminSectionTitle"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["autoJoinAvailable"]],[[[1,"                "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["autoJoinLabel"]]]],[["action"],[[[[1,"\\n                    "],[8,[32,4],[[24,0,"c-channel-settings__auto-join-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleAutoJoinUsers"]],[30,3,["autoJoinUsers"]]],null]],null]],[["@state"],[[30,3,["autoJoinUsers"]]]],null],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleChannelWideMentionsAvailable"]],[[[1,"                "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["channelWideMentionsLabel"]]]],[["action","description"],[[[[1,"\\n                    "],[8,[32,4],[[24,0,"c-channel-settings__channel-wide-mentions"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleChannelWideMentions"]],[30,3,["allowChannelWideMentions"]]],null]],null]],[["@state"],[[30,3,["allowChannelWideMentions"]]]],null],[1,"\\n                  "]],[]],[[[1,"\\n                    "],[1,[30,0,["channelWideMentionsDescription"]]],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["toggleThreadingCategoryChannel"]],[[[1,"                "],[8,[30,8,["row"]],null,[["@label"],[[30,0,["toggleThreadingLabel"]]]],[["action","description"],[[[[1,"\\n                    "],[8,[32,4],[[24,0,"c-channel-settings__threading-switch"],[4,[32,5],["click",[28,[32,7],[[30,0,["onToggleThreadingEnabled"]],[30,3,["threadingEnabled"]]],null]],null]],[["@state"],[[30,3,["threadingEnabled"]]]],null],[1,"\\n                  "]],[]],[[[1,"\\n                    "],[1,[30,0,["toggleThreadingDescription"]]],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["shouldRenderStatusSection"]],[[[41,[30,0,["shouldRenderArchiveRow"]],[[[1,"                  "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n                      "],[8,[32,3],[[24,0,"archive-btn chat-form__btn btn-transparent"]],[["@action","@label","@icon"],[[30,0,["onArchiveChannel"]],"chat.channel_settings.archive_channel","box-archive"]],null],[1,"\\n                    "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n                "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n"],[41,[30,3,["isOpen"]],[[[1,"                      "],[8,[32,3],[[24,0,"close-btn chat-form__btn btn-transparent"]],[["@action","@label","@icon"],[[30,0,["onToggleChannelState"]],"chat.channel_settings.close_channel","lock"]],null],[1,"\\n"]],[]],[[[1,"                      "],[8,[32,3],[[24,0,"open-btn chat-form__btn btn-transparent"]],[["@action","@label","@icon"],[[30,0,["onToggleChannelState"]],"chat.channel_settings.open_channel","unlock"]],null],[1,"\\n"]],[]]],[1,"                  "]],[]]]]],[1,"\\n\\n                "],[8,[30,8,["row"]],null,null,[["action"],[[[[1,"\\n                    "],[8,[32,3],[[24,0,"delete-btn chat-form__btn btn-transparent"]],[["@action","@label","@icon"],[[30,0,["onDeleteChannel"]],"chat.channel_settings.delete_channel","trash-can"]],null],[1,"\\n                  "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n            "]],[8]]]]],[1,"\\n"]],[]],null],[1,"\\n          "],[8,[30,1,["section"]],[[24,0,"--leave-channel"]],null,[["default"],[[[[1,"\\n"],[41,[30,3,["chatable","group"]],[[[1,"              "],[10,0],[14,0,"c-channel-settings__leave-info"],[12],[1,"\\n                "],[1,[28,[32,10],["triangle-exclamation"],null]],[1,"\\n                "],[1,[28,[32,11],["chat.channel_settings.leave_groupchat_info"],null]],[1,"\\n              "],[13],[1,"\\n"]],[]],null],[1,"            "],[8,[30,9,["row"]],null,null,[["action"],[[[[1,"\\n                "],[8,[32,12],null,[["@channel","@onLeave","@options"],[[30,3],[30,0,["onLeaveChannel"]],[28,[32,13],null,[["joinClass","leaveClass","joinIcon","leaveIcon"],["btn-primary","btn-danger","right-to-bracket","right-from-bracket"]]]]],null],[1,"\\n              "]],[]]]]],[1,"\\n          "]],[9]]]]],[1,"\\n        "]],[1]]]]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["form","section","@channel","section","section","section","section","section","section"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info-settings.js",scope:()=>[f.default,d.default,i.LinkTo,o.default,c.default,a.on,g.default,s.fn,l.default,C.default,u.default,p.default,w.default,s.hash],isStrictMode:!0}),this))()}e.default=x})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-info",["exports","@glimmer/component","@ember/object","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-channel-status","discourse/plugins/chat/discourse/components/chat/routes/channel-info-nav","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class h extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatChannelInfoRouteOriginManager",[a.service]))()
#Ts=(()=>{dt7948.i(this,"chatChannelInfoRouteOriginManager")})()
static#s=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"modal",[a.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#r=(()=>dt7948.g(this.prototype,"chatGuardian",[a.service]))()
#ks=(()=>{dt7948.i(this,"chatGuardian")})()
get canEditChannel(){return this.chatGuardian.canEditChatChannel()&&(this.args.channel.isCategoryChannel||this.args.channel.isDirectMessageChannel&&this.args.channel.chatable.group)}editChannelTitle(){return this.modal.show(i.default,{model:this.args.channel})}static#c=(()=>dt7948.n(this.prototype,"editChannelTitle",[s.action]))()
static#l=(()=>(0,l.setComponentTemplate)((0,d.createTemplateFactory)({id:"IjOuECP+",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channel-info"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["chatChannelInfoRouteOriginManager","isBrowse"]],[[[1,"          "],[8,[30,1,["BackButton"]],null,[["@route","@title"],["chat.browse",[28,[32,1],["chat.channel_info.back_to_all_channels"],null]]],null],[1,"\\n"]],[]],[[[1,"          "],[8,[30,1,["BackButton"]],null,[["@route","@routeModels","@title"],["chat.channel",[30,2,["routeModels"]],[28,[32,1],["chat.channel_info.back_to_channel"],null]]],null],[1,"\\n"]],[]]],[1,"        "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,2]]],null],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,[["@channel"],[[30,2]]],null],[1,"\\n\\n      "],[10,0],[14,0,"c-channel-info"],[12],[1,"\\n        "],[8,[32,3],null,[["@channel"],[[30,2]]],null],[1,"\\n        "],[46,[28,[31,2],null,null],null,null,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","@channel"],false,["if","component","-outlet"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-info.js",scope:()=>[r.default,n.default,o.default,c.default],isStrictMode:!0}),this))()}e.default=h})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-thread",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","discourse/plugins/chat/discourse/components/chat/thread/header","discourse/plugins/chat/discourse/components/chat-thread","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class l extends t.default{static#e=(()=>dt7948.g(this.prototype,"showfullTitle",[s.tracked],(function(){return!1})))()
#xs=(()=>{dt7948.i(this,"showfullTitle")})()
setFullTitle(e){this.showfullTitle=e}static#s=(()=>dt7948.n(this.prototype,"setFullTitle",[n.action]))()
static#n=(()=>(0,o.setComponentTemplate)((0,c.createTemplateFactory)({id:"LoaL3WoT",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channel-thread"],[12],[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[28,[32,0],[[30,1]],null]],null]],null],null,[[[1,"        "],[8,[32,1],null,[["@thread","@showFullTitle"],[[30,2],[30,0,["showfullTitle"]]]],null],[1,"\\n\\n        "],[8,[32,2],null,[["@thread","@targetMessageId","@includeHeader","@setFullTitle"],[[30,2],[30,3],true,[30,0,["setFullTitle"]]]],null],[1,"\\n"]],[2]],null],[1,"    "],[13],[1,"\\n  "]],["@thread","thread","@targetMessageId"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-thread.js",scope:()=>[a.array,i.default,r.default],isStrictMode:!0}),this))()}e.default=l})),define("discourse/plugins/chat/discourse/components/chat/routes/channel-threads",["exports","discourse/plugins/chat/discourse/components/chat/thread-list/header","discourse/plugins/chat/discourse/components/chat-thread-list","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const r=(0,a.setComponentTemplate)((0,n.createTemplateFactory)({id:"vbnP5grD",block:'[[[1,"\\n  "],[10,0],[14,0,"c-routes --channel-threads"],[12],[1,"\\n    "],[8,[32,0],null,[["@channel"],[[30,1]]],null],[1,"\\n    "],[8,[32,1],null,[["@channel","@includeHeader"],[[30,1],true]],null],[1,"\\n  "],[13],[1,"\\n"]],["@channel"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel-threads.js",scope:()=>[t.default,s.default],isStrictMode:!0}),(0,i.default)(void 0,"channel-threads:ChatRoutesChannelThreads"))
e.default=r})),define("discourse/plugins/chat/discourse/components/chat/routes/channel",["exports","@glimmer/component","@ember/service","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat-side-panel","discourse/plugins/chat/discourse/components/full-page-chat","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
get getChannelsRoute(){return this.args.channel.isDirectMessageChannel?"chat.direct-messages":"chat.channels"}static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"sx6yGhpf",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channel"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"          "],[8,[30,1,["BackButton"]],null,[["@route"],[[30,0,["getChannelsRoute"]]]],null],[1,"\\n"]],[]],null],[1,"        "],[8,[30,1,["ChannelTitle"]],null,[["@channel"],[[30,2]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,3,["OpenDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,3,["ThreadsListButton"]],null,[["@channel"],[[30,2]]],null],[1,"\\n        "]],[3]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,1],null,[["@channel","@targetMessageId"],[[30,2],[30,4]]],null],[1,"\\n    "],[13],[1,"\\n\\n    "],[8,[32,2],null,null,[["default"],[[[[1,"\\n      "],[46,[28,[31,2],null,null],null,null,null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],["navbar","@channel","action","@targetMessageId"],false,["if","component","-outlet"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channel.js",scope:()=>[a.default,i.default,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/routes/channels",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-public","discourse/plugins/chat/discourse/components/chat/navbar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"kqUTryAj",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --channels"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.chat_channels"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["OpenDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["BrowseChannelsButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,[["@sortByActivity"],[true]],null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/channels.js",scope:()=>[i.default,a.default,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/routes/direct-messages",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channels-list-direct","discourse/plugins/chat/discourse/components/chat/navbar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"cRfGHFSG",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --direct-messages"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.direct_messages.title"],null]]],null],[1,"\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["OpenDrawerButton"]],null,null,null],[1,"\\n          "],[8,[30,2,["NewDirectMessageButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/direct-messages.js",scope:()=>[i.default,a.default,n.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/routes/threads",["exports","@glimmer/component","@ember/service","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/user-threads","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>(0,r.setComponentTemplate)((0,o.createTemplateFactory)({id:"7u0t/aqW",block:'[[[1,"\\n    "],[10,0],[14,0,"c-routes --threads"],[12],[1,"\\n      "],[8,[32,0],null,null,[["default"],[[[[1,"\\n        "],[8,[30,1,["Title"]],null,[["@title"],[[28,[32,1],["chat.my_threads.title"],null]]],null],[1,"\\n\\n        "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n          "],[8,[30,2,["OpenDrawerButton"]],null,null,null],[1,"\\n        "]],[2]]]]],[1,"\\n      "]],[1]]]]],[1,"\\n\\n      "],[8,[32,2],null,null,null],[1,"\\n    "],[13],[1,"\\n  "]],["navbar","action"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/routes/threads.js",scope:()=>[n.default,a.default,i.default],isStrictMode:!0}),this))()}e.default=c})),define("discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow",["exports","discourse/components/d-button","discourse/helpers/concat-class","discourse-common/helpers/d-icon","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"pDQSNCUh",block:'[[[1,"\\n  "],[10,0],[14,0,"chat-scroll-to-bottom"],[12],[1,"\\n    "],[8,[32,0],[[16,0,[28,[32,1],["btn-flat","chat-scroll-to-bottom__button",[52,[30,1],"visible"]],null]]],[["@action"],[[30,2]]],[["default"],[[[[1,"\\n      "],[10,1],[14,0,"chat-scroll-to-bottom__arrow"],[12],[1,"\\n        "],[1,[28,[32,2],["arrow-down"],null]],[1,"\\n      "],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "],[13],[1,"\\n"]],["@isVisible","@onScrollToBottom"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/scroll-to-bottom-arrow.js",scope:()=>[t.default,s.default,a.default],isStrictMode:!0}),(0,r.default)(void 0,"scroll-to-bottom-arrow:ScrollToBottomArrow"))
e.default=o}))
define("discourse/plugins/chat/discourse/components/chat/selection-manager",["exports","@glimmer/component","@ember/object","@ember/owner","@ember/service","truth-helpers","discourse/components/d-button","discourse/lib/ajax-error","discourse/lib/utilities","discourse-common/config/environment","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/delete-messages-confirm","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends t.default{static#e=(()=>dt7948.g(this.prototype,"topicComposer",[(0,n.service)("composer")]))()
#js=(()=>{dt7948.i(this,"topicComposer")})()
static#s=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"modal",[n.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#r=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#c=(()=>dt7948.g(this.prototype,"toasts",[n.service]))()
#mt=(()=>{dt7948.i(this,"toasts")})()
static#l=(()=>dt7948.g(this.prototype,"currentUser",[n.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#d=(()=>dt7948.g(this.prototype,"api",[(0,n.service)("chat-api")]))()
#C=(()=>{dt7948.i(this,"api")})()
get enableMove(){return this.args.enableMove??!1}get anyMessagesSelected(){return this.args.pane.selectedMessageIds.length>0}get deleteCountLimitReached(){return this.args.pane.selectedMessageIds.length>50}get canDeleteMessages(){return this.args.pane.selectedMessageIds.every((e=>this.canDeleteMessage(e)))}canDeleteMessage(e){const t=this.args.messagesManager?.findMessage(e)
if(t){return(this.currentUser.id===t.user.id?t.channel?.canDeleteSelf:t.channel?.canDeleteOthers)&&!t.deletedAt&&t.channel?.canModifyMessages?.(this.currentUser)}}get deleteButtonTitle(){return h.default.t("chat.selection.delete",{selectionCount:this.args.pane.selectedMessageIds.length,totalCount:50})}async generateQuote(){const{markdown:e}=await this.api.generateQuote(this.args.pane.channel.id,this.args.pane.selectedMessageIds)
return new Blob([e],{type:"text/plain"})}static#h=(()=>dt7948.n(this.prototype,"generateQuote",[d.bind]))()
openMoveMessageModal(){this.modal.show(p.default,{model:{sourceChannel:this.args.pane.channel,selectedMessageIds:this.args.pane.selectedMessageIds}})}static#u=(()=>dt7948.n(this.prototype,"openMoveMessageModal",[s.action]))()
openDeleteMessagesModal(){this.modal.show(u.default,{model:{sourceChannel:this.args.pane.channel,selectedMessageIds:this.args.pane.selectedMessageIds}})}static#p=(()=>dt7948.n(this.prototype,"openDeleteMessagesModal",[s.action]))()
async quoteMessages(){let e
try{const t=await this.generateQuote()
e=await t.text()}catch(s){(0,o.popupAjaxError)(s)}const t={}
if(this.args.pane.channel.isCategoryChannel&&(t.categoryId=this.args.pane.channel.chatableId),this.site.mobileView)this.args.pane.channel.chatableUrl&&this.router.transitionTo(this.args.pane.channel.chatableUrl),await this.topicComposer.focusComposer({fallbackToNewTopic:!0,insertText:e,openOpts:t})
else{const s=(0,a.getOwner)(this).lookup("controller:topic")
await this.topicComposer.focusComposer({fallbackToNewTopic:!0,topic:s?.model,insertText:e,openOpts:t})}}static#j=(()=>dt7948.n(this.prototype,"quoteMessages",[s.action]))()
async copyMessages(){try{(0,l.isTesting)()||(await(0,c.clipboardCopyAsync)(this.generateQuote),this.toasts.success({duration:3e3,data:{message:h.default.t("chat.quote.copy_success")}}))}catch(e){(0,o.popupAjaxError)(e)}}static#P=(()=>dt7948.n(this.prototype,"copyMessages",[s.action]))()
static#O=(()=>(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"vcoRJbgB",block:'[[[1,"\\n    "],[10,0],[14,0,"chat-selection-management"],[15,"data-last-copy-successful",[30,0,["lastCopySuccessful"]]],[12],[1,"\\n      "],[10,0],[14,0,"chat-selection-management__buttons"],[12],[1,"\\n        "],[8,[32,0],[[24,1,"chat-quote-btn"]],[["@icon","@label","@disabled","@action"],["quote-left","chat.selection.quote_selection",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["quoteMessages"]]]],null],[1,"\\n\\n        "],[8,[32,0],[[24,1,"chat-copy-btn"]],[["@icon","@label","@disabled","@action"],["copy","chat.selection.copy",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["copyMessages"]]]],null],[1,"\\n\\n"],[41,[30,0,["enableMove"]],[[[1,"          "],[8,[32,0],[[24,1,"chat-move-to-channel-btn"]],[["@icon","@label","@disabled","@action"],["right-from-bracket","chat.selection.move_selection_to_channel",[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[30,0,["openMoveMessageModal"]]]],null],[1,"\\n"]],[]],null],[1,"\\n        "],[8,[32,0],[[24,1,"chat-delete-btn"]],[["@icon","@translatedLabel","@disabled","@action"],["trash-can",[30,0,["deleteButtonTitle"]],[28,[32,2],[[28,[32,1],[[30,0,["anyMessagesSelected"]]],null],[28,[32,1],[[30,0,["canDeleteMessages"]]],null],[30,0,["deleteCountLimitReached"]]],null],[30,0,["openDeleteMessagesModal"]]]],null],[1,"\\n\\n        "],[8,[32,0],[[24,1,"chat-cancel-selection-btn"],[24,0,"btn-secondary cancel-btn"]],[["@icon","@label","@action"],["xmark","chat.selection.cancel",[30,1,["cancelSelecting"]]]],null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@pane"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/selection-manager.js",scope:()=>[r.default,i.not,i.or],isStrictMode:!0}),this))()}e.default=f})),define("discourse/plugins/chat/discourse/components/chat/thread-list/header",["exports","@glimmer/component","@ember/service","@ember/template","discourse/helpers/replace-emoji","discourse-common/helpers/i18n","discourse-i18n","discourse/plugins/chat/discourse/components/chat/navbar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
threadListTitle=(()=>r.default.t("chat.threads.list"))()
get title(){let e=(0,n.default)(this.threadListTitle)
return this.site.mobileView&&(e+=" - "+(0,n.default)(this.args.channel.title)),(0,a.htmlSafe)(e)}static#n=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"AB7Sztyh",block:'[[[1,"\\n    "],[8,[32,0],null,null,[["default"],[[[[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"        "],[8,[30,1,["BackButton"]],null,[["@route","@routeModels","@title"],["chat.channel",[30,2,["routeModels"]],[28,[32,1],["chat.return_to_channel"],null]]],null],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[30,1,["Title"]],null,[["@title","@icon"],[[30,0,["title"]],"discourse-threads"]],null],[1,"\\n\\n      "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,3,["CloseThreadsButton"]],null,[["@channel"],[[30,2]]],null],[1,"\\n      "]],[3]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n  "]],["navbar","@channel","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread-list/header.js",scope:()=>[o.default,i.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/chat/thread-list/item",["exports","@glimmer/component","@ember/helper","@ember/modifier","@ember/object","@ember/service","truth-helpers","discourse/helpers/concat-class","discourse/helpers/format-date","discourse/helpers/replace-emoji","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/thread-unread-indicator","discourse/plugins/chat/discourse/components/chat-thread-participants","discourse/plugins/chat/discourse/components/chat-user-avatar","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends t.default{static#e=(()=>dt7948.g(this.prototype,"router",[i.service]))()
#y=(()=>{dt7948.i(this,"router")})()
openThread(e){this.router.transitionTo("chat.channel.thread",...e.routeModels)}static#s=(()=>dt7948.n(this.prototype,"openThread",[n.action]))()
static#n=(()=>(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"sKgcgRsx",block:'[[[1,"\\n    "],[11,0],[16,0,[28,[32,0],["chat-thread-list-item",[52,[28,[32,1],[[30,1,["tracking","unreadCount"]],0],null],"-is-unread"],[52,[28,[32,1],[[30,1,["tracking","watchedThreadsUnreadCount"]],0],null],"-is-urgent"]],null]],[16,"data-thread-id",[30,1,["id"]]],[17,2],[12],[1,"\\n      "],[10,0],[14,0,"chat-thread-list-item__main"],[12],[1,"\\n        "],[11,0],[16,"title",[28,[32,2],["chat.thread.view_thread"],null]],[24,"role","button"],[24,0,"chat-thread-list-item__open-button"],[4,[32,3],["click",[28,[32,4],[[30,0,["openThread"]],[30,1]],null]],[["passive"],[true]]],[12],[1,"\\n          "],[10,0],[14,0,"chat-thread-list-item__header"],[12],[1,"\\n            "],[10,0],[14,0,"chat-thread-list-item__title"],[12],[1,"\\n"],[41,[30,1,["title"]],[[[1,"                "],[1,[28,[32,5],[[30,1,["title"]]],null]],[1,"\\n"]],[]],[[[1,"                "],[1,[28,[32,5],[[30,1,["originalMessage","excerpt"]]],null]],[1,"\\n"]],[]]],[1,"            "],[13],[1,"\\n            "],[10,0],[14,0,"chat-thread-list-item__unread-indicator"],[12],[1,"\\n              "],[8,[32,6],null,[["@thread"],[[30,1]]],null],[1,"\\n            "],[13],[1,"\\n          "],[13],[1,"\\n\\n          "],[10,0],[14,0,"chat-thread-list-item__metadata"],[12],[1,"\\n            "],[10,0],[14,0,"chat-thread-list-item__members"],[12],[1,"\\n              "],[8,[32,7],null,[["@user","@showPresence","@interactive"],[[30,1,["originalMessage","user"]],false,false]],null],[1,"\\n              "],[8,[32,8],[[24,0,"chat-thread-list-item__participants"]],[["@thread","@includeOriginalMessageUser"],[[30,1],false]],null],[1,"\\n            "],[13],[1,"\\n\\n            "],[10,0],[14,0,"chat-thread-list-item__last-reply-timestamp"],[12],[1,"\\n"],[41,[30,1,["preview","lastReplyCreatedAt"]],[[[1,"                "],[1,[28,[32,9],[[30,1,["preview","lastReplyCreatedAt"]]],[["leaveAgo"],["true"]]]],[1,"\\n"]],[]],null],[1,"            "],[13],[1,"\\n          "],[13],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@thread","&attrs"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread-list/item.js",scope:()=>[o.default,r.gt,d.default,a.on,s.fn,l.default,h.default,p.default,u.default,c.default],isStrictMode:!0}),this))()}e.default=f})),define("discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator",["exports","@glimmer/component","@ember/service","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
unreadCountLabel=(()=>a.default.t("chat.unread_threads_count",{count:this.cappedUnreadCount}))()
get unreadCount(){return this.args.channel.threadsManager.unreadThreadCount}get showUnreadIndicator(){return!this.currentUser.isInDoNotDisturb()&&this.unreadCount>0}get cappedUnreadCount(){return this.unreadCount>99?"99+":this.unreadCount}static#s=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"z2Rw0liX",block:'[[[1,"\\n"],[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,0],[14,0,"chat-thread-header-unread-indicator"],[15,"title",[30,0,["unreadCountLabel"]]],[12],[1,"\\n        "],[10,0],[14,0,"chat-thread-header-unread-indicator__number"],[12],[1,[30,0,["cappedUnreadCount"]]],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator.js",isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/components/chat/thread/header",["exports","@glimmer/component","@ember/service","discourse/helpers/noop","discourse/helpers/replace-emoji","discourse-common/helpers/d-icon","discourse-i18n","truth-helpers/helpers/and","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","discourse/plugins/chat/discourse/components/chat/navbar","discourse/plugins/chat/discourse/components/chat/thread/header-unread-indicator","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"chatHistory",[s.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#n=(()=>dt7948.g(this.prototype,"modal",[s.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#r=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
get backLink(){const e=this.chatHistory.previousRoute?.name
let t,s,a
return"chat.channel.threads"===e||"chat.channel.index"===e&&this.site.desktopView?(t="chat.channel.threads",s=r.default.t("chat.return_to_threads_list"),a=this.channel?.routeModels):"chat.threads"===e?(t="chat.threads",s=r.default.t("chat.my_threads.title"),a=[]):!this.currentUser.isInDoNotDisturb()&&this.unreadCount>0?(t="chat.channel.threads",s=r.default.t("chat.return_to_threads_list"),a=this.channel?.routeModels):(t="chat.channel.index",s=r.default.t("chat.return_to_channel"),a=this.channel?.routeModels),{route:t,models:a,title:s}}get channel(){return this.args.thread?.channel}get headerTitle(){return this.args.thread?.title??r.default.t("chat.thread.label")}get unreadCount(){return this.channel?.threadsManager?.unreadThreadCount}get showThreadUnreadIndicator(){return"chat.channel.threads"===this.backLink.route&&this.unreadCount>0}get openThreadTitleModal(){return this.currentUser.admin||this.currentUser.id===this.args.thread?.originalMessage?.user?.id?()=>this.modal.show(c.default,{model:this.args.thread}):a.default}static#c=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"iUgDQ5tW",block:'[[[1,"\\n    "],[8,[32,0],null,[["@showFullTitle"],[[30,1]]],[["default"],[[[[1,"\\n"],[41,[28,[32,1],[[30,0,["channel","threadingEnabled"]],[30,3]],null],[[[1,"        "],[8,[30,2,["BackButton"]],null,[["@route","@routeModels","@title"],[[30,0,["backLink","route"]],[30,0,["backLink","models"]],[30,0,["backLink","title"]]]],[["default"],[[[[1,"\\n"],[41,[30,0,["showThreadUnreadIndicator"]],[[[1,"            "],[8,[32,2],null,[["@channel"],[[30,0,["channel"]]]],null],[1,"\\n"]],[]],null],[1,"          "],[1,[28,[32,3],["chevron-left"],null]],[1,"\\n        "]],[]]]]],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[30,2,["Title"]],null,[["@title","@openThreadTitleModal"],[[28,[32,4],[[30,0,["headerTitle"]]],null],[30,0,["openThreadTitleModal"]]]],null],[1,"\\n      "],[8,[30,2,["Actions"]],null,null,[["default"],[[[[1,"\\n        "],[8,[30,4,["ThreadTrackingDropdown"]],null,[["@thread"],[[30,3]]],null],[1,"\\n        "],[8,[30,4,["ThreadSettingsButton"]],null,[["@thread"],[[30,3]]],null],[1,"\\n        "],[8,[30,4,["CloseThreadButton"]],null,[["@thread"],[[30,3]]],null],[1,"\\n      "]],[4]]]]],[1,"\\n    "]],[2]]]]],[1,"\\n  "]],["@showFullTitle","navbar","@thread","action"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/chat/thread/header.js",scope:()=>[l.default,o.default,d.default,i.default,n.default],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/collapser",["exports","@ember/component","@ember/object","@ember-decorators/component","@ember/template-factory"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,n.createTemplateFactory)({id:"hDh7V21u",block:'[[[10,0],[14,0,"chat-message-collapser-header"],[12],[1,"\\n  "],[1,[30,0,["header"]]],[1,"\\n\\n"],[41,[30,0,["collapsed"]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-collapser-button chat-message-collapser-closed"]],[["@action","@icon"],[[30,0,["open"]],"caret-right"]],null],[1,"\\n"]],[]],[[[1,"    "],[8,[39,1],[[24,0,"chat-message-collapser-button chat-message-collapser-opened"]],[["@action","@icon"],[[30,0,["close"]],"caret-down"]],null],[1,"\\n"]],[]]],[13],[1,"\\n\\n"],[10,0],[15,0,[28,[37,2],["chat-message-collapser-body",[52,[30,0,["collapsed"]],"hidden"]],null]],[12],[1,"\\n  "],[18,1,[[30,0,["collapsed"]]]],[1,"\\n"],[13]],["&default"],false,["if","d-button","concat-class","yield"]]',moduleName:"discourse/plugins/chat/discourse/components/collapser.hbs",isStrictMode:!1}),r=dt7948.c(class extends t.default{collapsed=!1
header=null
onToggle=null
open(){this.set("collapsed",!1),this.onToggle?.(!1)}static#e=(()=>dt7948.n(this.prototype,"open",[s.action]))()
close(){this.set("collapsed",!0),this.onToggle?.(!0)}static#s=(()=>dt7948.n(this.prototype,"close",[s.action]))()},[(0,a.tagName)("")])
e.default=(0,t.setComponentTemplate)(i,r)})),define("discourse/plugins/chat/discourse/components/dc-filter-input",["exports","@glimmer/component","@glimmer/tracking","@ember/component","@ember/modifier","ember-modifier","discourse/helpers/concat-class","discourse/helpers/noop","discourse-common/helpers/d-icon","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"isFocused",[s.tracked],(function(){return!1})))()
#We=(()=>{dt7948.i(this,"isFocused")})()
focusState=(()=>(0,i.modifier)((e=>{const t=()=>{this.isFocused=!0},s=()=>{this.isFocused=!1}
return e.addEventListener("focusin",t),e.addEventListener("focusout",s),()=>{e.removeEventListener("focusin",t),e.removeEventListener("focusout",s)}})))()
static#s=(()=>(0,a.setComponentTemplate)((0,l.createTemplateFactory)({id:"oVtoWO4Q",block:'[[[1,"\\n    "],[10,0],[15,0,[28,[32,0],[[30,1],"dc-filter-input-container",[52,[30,0,["isFocused"]],"is-focused"]],null]],[12],[1,"\\n"],[41,[30,2,["left"]],[[[1,"        "],[1,[28,[32,1],[[30,2,["left"]]],[["class"],["-left"]]]],[1,"\\n"]],[]],null],[1,"\\n      "],[8,[32,2],[[24,0,"dc-filter-input"],[17,3],[4,[30,0,["focusState"]],null,null],[4,[32,3],["input",[52,[30,5],[30,5],[28,[32,4],null,null]]],null]],[["@value"],[[30,4]]],null],[1,"\\n\\n      "],[18,6,null],[1,"\\n\\n"],[41,[30,2,["right"]],[[[1,"        "],[1,[28,[32,1],[[30,2,["right"]]],[["class"],["-right"]]]],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "]],["@containerClass","@icons","&attrs","@value","@filterAction","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/dc-filter-input.js",scope:()=>[r.default,c.default,a.Input,n.on,o.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/empty-channels-list",["exports","discourse/components/d-button","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"WEydpX58",block:'[[[1,"\\n  "],[10,0],[14,0,"channel-list-empty-message"],[12],[1,"\\n    "],[10,"svg"],[14,"width","217"],[14,"height","163"],[14,"viewBox","0 0 217 163"],[14,"fill","none"],[14,"xmlns","http://www.w3.org/2000/svg","http://www.w3.org/2000/xmlns/"],[12],[1,"\\n      "],[10,"path"],[14,"d","M4 128.5C12.5 128.5 30.5 148.5 69.5 142.5C86.9422 139.817 168.5 84.5 197.5 73"],[14,"stroke","var(--tertiary-high)"],[14,"stroke-linecap","round"],[14,"stroke-dasharray","6 6"],[12],[13],[1,"\\n      "],[10,"path"],[14,"fill-rule","evenodd"],[14,"clip-rule","evenodd"],[14,"d","M53 15C39.7452 15 29 25.7452 29 39V96.4576C29 109.377 39.2089 119.913 52 120.437V137L74.3809 120.458H156C169.255 120.458 180 109.712 180 96.4576V39C180 25.7452 169.255 15 156 15H53Z"],[14,"fill","var(--secondary)"],[12],[13],[1,"\\n      "],[10,"path"],[14,"d","M52 120.437H52.5V119.957L52.0205 119.938L52 120.437ZM52 137H51.5V137.991L52.2972 137.402L52 137ZM74.3809 120.458V119.958H74.2162L74.0837 120.056L74.3809 120.458ZM29.5 39C29.5 26.0213 40.0213 15.5 53 15.5V14.5C39.469 14.5 28.5 25.469 28.5 39H29.5ZM29.5 96.4576V39H28.5V96.4576H29.5ZM52.0205 119.938C39.4962 119.424 29.5 109.108 29.5 96.4576H28.5C28.5 109.647 38.9216 120.402 51.9795 120.937L52.0205 119.938ZM52.5 137V120.437H51.5V137H52.5ZM74.0837 120.056L51.7028 136.598L52.2972 137.402L74.6781 120.86L74.0837 120.056ZM156 119.958H74.3809V120.958H156V119.958ZM179.5 96.4576C179.5 109.436 168.979 119.958 156 119.958V120.958C169.531 120.958 180.5 109.989 180.5 96.4576H179.5ZM179.5 39V96.4576H180.5V39H179.5ZM156 15.5C168.979 15.5 179.5 26.0213 179.5 39H180.5C180.5 25.469 169.531 14.5 156 14.5V15.5ZM53 15.5H156V14.5H53V15.5Z"],[14,"fill","var(--tertiary-high)"],[12],[13],[1,"\\n      "],[10,"ellipse"],[14,"cx","104"],[14,"cy","156"],[14,"rx","96"],[14,"ry","7"],[14,"fill","var(--primary-low)"],[12],[13],[1,"\\n      "],[10,"path"],[14,"d","M215.833 65.4678L209.881 73.3052C209.749 73.5001 209.525 73.6186 209.283 73.6212C209.158 73.6066 209.033 73.592 208.909 73.525C208.827 73.4803 208.755 73.415 208.695 73.3292L206.751 70.9161L204.851 71.9128C204.691 72.0124 204.513 71.9961 204.369 71.9179C204.142 71.7951 204.057 71.5092 204.18 71.2825L205.252 69.3042C205.341 69.1393 205.46 69.0174 205.598 68.959L213.217 65.6229L204.2 67.8014L202.557 65.7653C202.386 65.5394 202.333 65.244 202.478 64.9761C202.614 64.6765 202.849 64.5374 203.143 64.5366L215.222 64.2836C215.495 64.2716 215.784 64.4279 215.912 64.6838C216.04 64.9397 216.009 65.2428 215.833 65.4678Z"],[14,"fill","var(--tertiary-high)"],[12],[13],[1,"\\n      "],[10,"ellipse"],[14,"cx","148"],[14,"cy","18.4167"],[14,"rx","17"],[14,"ry","18.4167"],[14,"fill","var(--primary-low)"],[12],[13],[1,"\\n      "],[10,"path"],[14,"d","M147.883 8.27081C149.963 8.27081 151.589 9.013 152.761 10.4974C154.157 12.2552 154.855 15.1702 154.855 19.2425C154.855 23.305 154.152 26.2249 152.746 28.0023C151.584 29.4671 149.963 30.1995 147.883 30.1995C145.793 30.1995 144.108 29.3987 142.829 27.7972C141.55 26.1859 140.91 23.3196 140.91 19.1985C140.91 15.1556 141.613 12.2454 143.02 10.4681C144.182 9.00323 145.803 8.27081 147.883 8.27081ZM147.883 11.6839C147.385 11.6839 146.94 11.845 146.55 12.1673C146.159 12.4798 145.856 13.0462 145.642 13.8665C145.358 14.931 145.217 16.723 145.217 19.2425C145.217 21.762 145.344 23.4954 145.598 24.4427C145.852 25.3802 146.169 26.0052 146.55 26.3177C146.94 26.6302 147.385 26.7864 147.883 26.7864C148.381 26.7864 148.825 26.6302 149.216 26.3177C149.606 25.9954 149.909 25.4241 150.124 24.6038C150.407 23.5491 150.549 21.762 150.549 19.2425C150.549 16.723 150.422 14.9944 150.168 14.0569C149.914 13.1097 149.592 12.4798 149.201 12.1673C148.82 11.845 148.381 11.6839 147.883 11.6839Z"],[14,"fill","var(--primary)"],[12],[13],[1,"\\n      "],[10,"path"],[14,"d","M13.013 41.1986C13.4829 41.2395 13.9951 41.6417 14.228 42.2301C14.4696 42.8402 14.3716 43.484 14.057 43.8355L15.3252 47.0389C15.4373 47.3221 15.3665 47.6527 15.1482 47.8652C14.9298 48.0776 14.5988 48.1331 14.3251 48.0146L12.9866 47.4353C11.5265 46.8034 9.87709 46.7758 8.39524 47.3625L8.22091 47.4315L9.32521 50.2209C9.4805 50.6131 9.27441 51.0476 8.90395 51.1943L7.50927 51.7464C7.11702 51.9017 6.69115 51.7174 6.53585 51.3252L5.43155 48.5358C4.64704 48.8464 3.7953 48.4778 3.48472 47.6933L2.65649 45.6013C2.35453 44.8386 2.71451 43.965 3.49901 43.6545L6.46271 42.4811C7.94455 41.8945 9.12808 40.7453 9.7686 39.307L10.3478 37.9685C10.4663 37.6948 10.7455 37.5086 11.0502 37.514C11.3548 37.5195 11.6327 37.7119 11.7362 37.9734L13.013 41.1986ZM7.01486 43.8758L6.84052 43.9448L7.66875 46.0368L7.84309 45.9678C9.58644 45.2776 11.5232 45.2671 13.2748 45.9348L11.0058 40.2036C10.186 41.8893 8.75821 43.1856 7.01486 43.8758Z"],[14,"fill","var(--tertiary-high)"],[12],[13],[1,"\\n      "],[10,"path"],[14,"d","M148.762 128.636C149.155 128.701 149.422 129.101 149.358 129.494C149.29 129.91 148.913 130.181 148.52 130.116C148.103 130.048 147.833 129.671 147.901 129.255C147.965 128.862 148.346 128.568 148.762 128.636ZM151.353 129.061C151.746 129.125 152.013 129.525 151.948 129.918C151.888 130.288 151.484 130.578 151.114 130.518C150.721 130.453 150.427 130.073 150.491 129.679C150.559 129.263 150.936 128.992 151.353 129.061ZM153.943 129.485C154.336 129.549 154.626 129.953 154.539 130.343C154.471 130.759 154.094 131.03 153.701 130.965C153.307 130.901 153.014 130.52 153.082 130.104C153.146 129.711 153.527 129.417 153.943 129.485ZM152.02 124.99C155.281 125.524 157.558 128.153 157.126 130.79C156.694 133.427 153.705 135.146 150.443 134.612C149.68 134.486 148.959 134.25 148.345 133.935C147.572 134.307 146.367 134.704 144.956 134.473C144.725 134.435 144.536 134.285 144.504 134.042C144.469 133.823 144.53 133.595 144.718 133.46C144.718 133.46 145.564 132.791 146.059 131.946C145.428 131.011 145.132 129.918 145.31 128.831C145.746 126.171 148.735 124.452 152.02 124.99ZM150.625 133.501C153.262 133.933 155.659 132.64 155.996 130.581C156.329 128.546 154.451 126.528 151.815 126.096C149.178 125.664 146.754 126.977 146.421 129.013C146.258 130.007 146.622 130.827 146.966 131.334L147.369 131.923L147.008 132.529C146.84 132.834 146.625 133.131 146.394 133.378C146.98 133.284 147.484 133.105 147.845 132.927L148.338 132.675L148.843 132.924C149.391 133.204 150.001 133.399 150.625 133.501Z"],[14,"fill","var(--tertiary-high)"],[12],[13],[1,"\\n    "],[13],[1,"\\n\\n    "],[10,1],[14,0,"channel-title"],[12],[1,[30,1]],[13],[1,"\\n\\n"],[41,[30,2],[[[1,"      "],[8,[32,0],[[24,0,"btn btn-primary"]],[["@action"],[[30,3]]],[["default"],[[[[1,"\\n        "],[1,[30,4]],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]],null],[1,"  "],[13],[1,"\\n"]],["@title","@showCTA","@ctaAction","@ctaTitle"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/empty-channels-list.js",scope:()=>[t.default],isStrictMode:!0}),(0,n.default)(void 0,"empty-channels-list:EmptyChannelsList"))
e.default=i})),define("discourse/plugins/chat/discourse/components/full-page-chat",["exports","@glimmer/component","@ember/helper","@ember/service","discourse/plugins/chat/discourse/components/chat-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"gGk4kwJK",block:'[[[1,"\\n"],[42,[28,[31,1],[[28,[31,1],[[28,[32,0],[[30,1]],null]],null]],null],null,[[[1,"      "],[8,[32,1],null,[["@channel","@targetMessageId"],[[30,2],[30,3]]],null],[1,"\\n"]],[2]],null],[1,"  "]],["@channel","channel","@targetMessageId"],false,["each","-track-array"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/full-page-chat.js",scope:()=>[s.array,n.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/components/reviewable-chat-message",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/routing","@ember/service","@ember/template","truth-helpers","discourse/components/reviewable-created-by","discourse/components/reviewable-post-header","discourse-common/helpers/i18n","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/models/chat-channel","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class g extends t.default{static#e=(()=>dt7948.g(this.prototype,"store",[i.service]))()
#Be=(()=>{dt7948.i(this,"store")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[i.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
get channel(){if(this.args.reviewable.chat_channel)return u.default.create(this.args.reviewable.chat_channel)}static#n=(()=>dt7948.n(this.prototype,"channel",[s.cached]))()
static#r=(()=>(0,p.setComponentTemplate)((0,m.createTemplateFactory)({id:"QMkQiG4Z",block:'[[[1,"\\n"],[41,[30,0,["channel"]],[[[1,"      "],[10,0],[14,0,"flagged-post-header"],[12],[1,"\\n        "],[8,[32,0],null,[["@route","@models"],["chat.channel.near-message",[28,[32,1],[[30,0,["channel","slugifiedTitle"]],[30,0,["channel","id"]],[30,1,["target_id"]]],null]]],[["default"],[[[[1,"\\n          "],[8,[32,2],null,[["@channel"],[[30,0,["channel"]]]],null],[1,"\\n        "]],[]]]]],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,0,"post-contents-wrapper"],[12],[1,"\\n      "],[8,[32,3],null,[["@user"],[[30,1,["target_created_by"]]]],null],[1,"\\n      "],[10,0],[14,0,"post-contents"],[12],[1,"\\n        "],[8,[32,4],null,[["@reviewable","@createdBy","@tagName"],[[30,1],[30,1,["target_created_by"]],""]],null],[1,"\\n\\n        "],[10,0],[14,0,"post-body"],[12],[1,"\\n          "],[1,[28,[32,5],[[28,[32,6],[[30,1,["payload","message_cooked"]],[30,1,["cooked"]]],null]],null]],[1,"\\n        "],[13],[1,"\\n\\n"],[41,[30,1,["payload","transcript_topic_id"]],[[[1,"          "],[10,0],[14,0,"transcript"],[12],[1,"\\n            "],[8,[32,0],[[24,0,"btn btn-small"]],[["@route","@models"],["topic",[28,[32,1],["-",[30,1,["payload","transcript_topic_id"]]],null]]],[["default"],[[[[1,"\\n              "],[1,[28,[32,7],["review.transcript.view"],null]],[1,"\\n            "]],[]]]]],[1,"\\n          "],[13],[1,"\\n"]],[]],null],[1,"\\n        "],[18,2,null],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@reviewable","&default"],false,["if","yield"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/reviewable-chat-message.js",scope:()=>[n.LinkTo,a.array,h.default,c.default,l.default,r.htmlSafe,o.or,d.default],isStrictMode:!0}),this))()}e.default=g})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"UdTTMEaX",block:'[[[8,[39,0],null,[["@title"],["<ChatComposerMessageDetails>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message"],[[30,0,["message"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Mode"]],[["default"],[[[[1,"\\n"],[41,[30,0,["message","editing"]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Reply"]],null],[1,"\\n"]],[]],[[[1,"        "],[8,[39,6],null,[["@action","@translatedLabel"],[[30,0,["toggleMode"]],"Editing"]],null],[1,"\\n"]],[]]],[1,"    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-composer-message-details","styleguide/controls","styleguide/controls/row","if","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"site",[r.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"session",[r.service]))()
#Es=(()=>{dt7948.i(this,"session")})()
static#n=(()=>dt7948.g(this.prototype,"keyValueStore",[r.service]))()
#Ps=(()=>{dt7948.i(this,"keyValueStore")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[r.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get message(){return new o.default((0,i.getOwner)(this)).message({user:this.currentUser})}static#c=(()=>dt7948.n(this.prototype,"message",[a.cached]))()
toggleMode(){this.message.editing?(this.message.editing=!1,this.message.inReplyTo=new o.default((0,i.getOwner)(this)).message()):(this.message.editing=!0,this.message.inReplyTo=null)}static#l=(()=>dt7948.n(this.prototype,"toggleMode",[n.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-composer",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","discourse/plugins/chat/discourse/models/chat-channel","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"44rPT0VR",block:'[[[8,[39,0],null,[["@title"],["<ChatComposer>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@channel","@onSendMessage"],[[30,0,["channel"]],[30,0,["onSendMessage"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Disabled"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDisabled"]]],null]],[["@state"],[[30,0,["channel","isReadOnly"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Sending"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleSending"]]],null]],[["@state"],[[30,0,["chatChannelPane","sending"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/composer/channel","styleguide/controls","styleguide/controls/row","d-toggle-switch","on"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-composer.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatChannelComposer",[i.service]))()
#As=(()=>{dt7948.i(this,"chatChannelComposer")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelPane",[i.service]))()
#ut=(()=>{dt7948.i(this,"chatChannelPane")})()
channel=(()=>new r.default((0,n.getOwner)(this)).channel({id:-999}))()
toggleDisabled(){this.channel.status===o.CHANNEL_STATUSES.open?this.channel.status=o.CHANNEL_STATUSES.readOnly:this.channel.status=o.CHANNEL_STATUSES.open}static#n=(()=>dt7948.n(this.prototype,"toggleDisabled",[a.action]))()
toggleSending(){this.chatChannelPane.sending=!this.chatChannelPane.sending}static#r=(()=>dt7948.n(this.prototype,"toggleSending",[a.action]))()
onSendMessage(){this.chatChannelComposer.reset()}static#c=(()=>dt7948.n(this.prototype,"onSendMessage",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-header-icon",["exports","@ember/component","@glimmer/component","@glimmer/tracking","@ember/object","discourse/plugins/chat/discourse/controllers/preferences-chat","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"3vsUy2AB",block:'[[[8,[39,0],null,[["@title"],["<Chat::Header::Icon>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[10,"header"],[14,0,"d-header"],[14,5,"display: flex; align-items: center; justify-content: center;"],[12],[1,"\\n      "],[10,"ul"],[14,0,"d-header-icons"],[12],[1,"\\n        "],[10,"li"],[14,0,"header-dropdown-toggle chat-header-icon"],[12],[1,"\\n          "],[8,[39,2],null,[["@isActive","@currentUserInDnD","@unreadCount","@urgentCount","@indicatorPreference"],[[30,0,["isActive"]],[30,0,["currentUserInDnD"]],[30,0,["unreadCount"]],[30,0,["urgentCount"]],[30,0,["indicatorPreference"]]]],null],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["isActive"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleIsActive"]]],null]],[["@state"],[[30,0,["isActive"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["currentUserInDnD"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleCurrentUserInDnD"]]],null]],[["@state"],[[30,0,["currentUserInDnD"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Unread count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["unreadCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUnreadCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Urgent count"]],[["default"],[[[[1,"\\n    "],[11,"input"],[16,2,[30,0,["urgentCount"]]],[24,4,"number"],[4,[38,6],["input",[30,0,["updateUrgentCount"]]],null],[12],[13],[1,"\\n  "]],[]]]]],[1,"\\n  "],[8,[39,4],null,[["@name"],["Indicator preference"]],[["default"],[[[[1,"\\n    "],[8,[39,7],null,[["@value","@content","@onChange","@valueProperty","@nameProperty"],[[30,0,["indicatorPreference"]],[30,0,["indicatorPreferences"]],[30,0,["updateIndicatorPreference"]],null,null]],null],[1,"\\n\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/header/icon","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","combo-box"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-header-icon.hbs",isStrictMode:!1})
class c extends s.default{static#e=(()=>dt7948.g(this.prototype,"isActive",[a.tracked],(function(){return!1})))()
#gt=(()=>{dt7948.i(this,"isActive")})()
static#s=(()=>dt7948.g(this.prototype,"currentUserInDnD",[a.tracked],(function(){return!1})))()
#Os=(()=>{dt7948.i(this,"currentUserInDnD")})()
static#n=(()=>dt7948.g(this.prototype,"urgentCount",[a.tracked]))()
#Us=(()=>{dt7948.i(this,"urgentCount")})()
static#r=(()=>dt7948.g(this.prototype,"unreadCount",[a.tracked]))()
#Ds=(()=>{dt7948.i(this,"unreadCount")})()
static#c=(()=>dt7948.g(this.prototype,"indicatorPreference",[a.tracked],(function(){return i.HEADER_INDICATOR_PREFERENCE_ALL_NEW})))()
#Ls=(()=>{dt7948.i(this,"indicatorPreference")})()
get indicatorPreferences(){return[i.HEADER_INDICATOR_PREFERENCE_ALL_NEW,i.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,i.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS,i.HEADER_INDICATOR_PREFERENCE_NEVER]}toggleIsActive(){this.isActive=!this.isActive}static#l=(()=>dt7948.n(this.prototype,"toggleIsActive",[n.action]))()
toggleCurrentUserInDnD(){this.currentUserInDnD=!this.currentUserInDnD}static#d=(()=>dt7948.n(this.prototype,"toggleCurrentUserInDnD",[n.action]))()
updateUnreadCount(e){this.unreadCount=e.target.value}static#h=(()=>dt7948.n(this.prototype,"updateUnreadCount",[n.action]))()
updateUrgentCount(e){this.urgentCount=e.target.value}static#u=(()=>dt7948.n(this.prototype,"updateUrgentCount",[n.action]))()
updateIndicatorPreference(e){this.indicatorPreference=e}static#p=(()=>dt7948.n(this.prototype,"updateIndicatorPreference",[n.action]))()}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-message",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"4ZwlpP03",block:'[[[8,[39,0],null,[["@title"],["<ChatMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@message","@context"],[[30,0,["message"]],"channel"]],null],[1,"\\n  "]],[]]]]],[1,"\\n\\n  "],[8,[39,3],null,null,[["default"],[[[[1,"\\n    "],[8,[39,4],null,[["@name"],["Last Visit"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleLastVisit"]]],null]],[["@state"],[[30,0,["message","newest"]]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Deleted"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleDeleted"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","deletedAt"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Bookmark"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleBookmarked"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","bookmark"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Thread"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleThread"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","thread"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Reactions"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleReaction"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","reactions"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Upload"]],[["default"],[[[[1,"\\n      "],[8,[39,5],[[4,[38,6],["click",[30,0,["toggleUpload"]]],null]],[["@state"],[[28,[37,7],[[28,[37,7],[[30,0,["message","uploads"]]],null]],null]]],null],[1,"\\n    "]],[]]]]],[1,"\\n    "],[8,[39,4],null,[["@name"],["Message"]],[["default"],[[[[1,"\\n      "],[11,"textarea"],[4,[38,6],["input",[30,0,["updateMessage"]]],null],[12],[1,[30,0,["message","message"]]],[13],[1,"\\n    "]],[]]]]],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat-message","styleguide/controls","styleguide/controls/row","d-toggle-switch","on","not"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-message.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
manager=(()=>new r.default((0,n.getOwner)(this)))()
constructor(){super(...arguments),this.message=new o.default((0,n.getOwner)(this)).message({user:this.currentUser}),this.message.cook()}toggleDeleted(){this.message.deletedAt?this.message.deletedAt=null:this.message.deletedAt=moment()}static#s=(()=>dt7948.n(this.prototype,"toggleDeleted",[a.action]))()
toggleBookmarked(){this.message.bookmark?this.message.bookmark=null:this.message.bookmark=new o.default((0,n.getOwner)(this)).bookmark()}static#n=(()=>dt7948.n(this.prototype,"toggleBookmarked",[a.action]))()
toggleHighlighted(){this.message.highlighted=!this.message.highlighted}static#r=(()=>dt7948.n(this.prototype,"toggleHighlighted",[a.action]))()
toggleEdited(){this.message.edited=!this.message.edited}static#c=(()=>dt7948.n(this.prototype,"toggleEdited",[a.action]))()
toggleLastVisit(){this.message.newest=!this.message.newest}static#l=(()=>dt7948.n(this.prototype,"toggleLastVisit",[a.action]))()
toggleThread(){this.message.thread?(this.message.channel.threadingEnabled=!1,this.message.thread=null):(this.message.thread=new o.default((0,n.getOwner)(this)).thread({channel:this.message.channel}),this.message.thread.preview.replyCount=1,this.message.channel.threadingEnabled=!0)}static#d=(()=>dt7948.n(this.prototype,"toggleThread",[a.action]))()
async updateMessage(e){this.message.message=e.target.value,await this.message.cook()}static#h=(()=>dt7948.n(this.prototype,"updateMessage",[a.action]))()
toggleReaction(){this.message.reactions?.length?this.message.reactions=[]:this.message.reactions=[new o.default((0,n.getOwner)(this)).reaction({emoji:"heart"}),new o.default((0,n.getOwner)(this)).reaction({emoji:"rocket",reacted:!0})]}static#u=(()=>dt7948.n(this.prototype,"toggleReaction",[a.action]))()
toggleUpload(){this.message.uploads?.length?this.message.uploads=[]:this.message.uploads=[new o.default((0,n.getOwner)(this)).upload(),new o.default((0,n.getOwner)(this)).upload()]}static#p=(()=>dt7948.n(this.prototype,"toggleUpload",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/archive-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"6txBnytZ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ArchiveChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
channel=(()=>new o.default((0,n.getOwner)(this)).channel())()
openModal(){return this.modal.show(r.default,{model:{channel:this.channel}})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/create-channel","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"W0WNy+Vl",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::CreateChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel.hbs",isStrictMode:!1})
class c extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[n.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
openModal(){return this.modal.show(i.default)}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/delete-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"RePA6/AH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::DeleteChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
channel=(()=>new o.default((0,n.getOwner)(this)).channel())()
openModal(){return this.modal.show(r.default,{model:{channel:this.channel}})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-description","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"3ae/A2qR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelDescription>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
channel=(()=>new o.default((0,n.getOwner)(this)).channel())()
openModal(){return this.modal.show(r.default,{model:this.channel})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/edit-channel-name","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"ilAVl2Kg",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::EditChannelName>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
channel=(()=>new o.default((0,n.getOwner)(this)).channel())()
openModal(){return this.modal.show(r.default,{model:this.channel})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/move-message-to-channel","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"ATPl85dR",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::MoveMessageToChannel>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
channel=(()=>new o.default((0,n.getOwner)(this)).channel())()
selectedMessageIds=(()=>[new o.default((0,n.getOwner)(this)).message({channel:this.channel})].mapBy("id"))()
openModal(){return this.modal.show(r.default,{model:{sourceChannel:this.channel,selectedMessageIds:[new o.default((0,n.getOwner)(this)).message({channel:this.channel})].mapBy("id")}})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message",["exports","@ember/component","@glimmer/component","@ember/object","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/new-message","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"tf8RWlBH",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::NewMessage>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message.hbs",isStrictMode:!1})
class c extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[n.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
openModal(){return this.modal.show(i.default)}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/thread-settings","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"fzsrgZZ3",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ThreadSettings>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
openModal(){return this.modal.show(r.default,{model:new o.default((0,n.getOwner)(this)).thread()})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status",["exports","@ember/component","@glimmer/component","@ember/object","@ember/owner","@ember/service","discourse/plugins/chat/discourse/components/chat/modal/toggle-channel-status","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const l=(0,c.createTemplateFactory)({id:"h5sT+PPJ",block:'[[[8,[39,0],null,[["@title"],["<Chat::Modal::ToggleChannelStatus>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@translatedLabel","@action"],["Open modal",[30,0,["openModal"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/controls/row","d-button"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status.hbs",isStrictMode:!1})
class d extends s.default{static#e=(()=>dt7948.g(this.prototype,"modal",[i.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
openModal(){return this.modal.show(r.default,{model:new o.default((0,n.getOwner)(this)).channel()})}static#s=(()=>dt7948.n(this.prototype,"openModal",[a.action]))()}e.default=d,(0,t.setComponentTemplate)(l,d)})),define("discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item",["exports","@ember/component","@glimmer/component","@ember/owner","@ember/service","discourse/plugins/chat/discourse/lib/fabricators","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=(0,r.createTemplateFactory)({id:"lR91t83a",block:'[[[8,[39,0],null,[["@title"],["<Chat::ThreadList::Item>"]],[["default"],[[[[1,"\\n  "],[8,[39,1],null,null,[["default"],[[[[1,"\\n    "],[8,[39,2],null,[["@thread"],[[30,0,["thread"]]]],null],[1,"\\n  "]],[]]]]],[1,"\\n"]],[]]]]]],[],false,["styleguide-example","styleguide/component","chat/thread-list/item"]]',moduleName:"discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item.hbs",isStrictMode:!1})
class c extends s.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[n.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
thread=(()=>new i.default((0,a.getOwner)(this)).thread())()}e.default=c,(0,t.setComponentTemplate)(o,c)})),define("discourse/plugins/chat/discourse/components/styleguide/organisms/chat",["exports","discourse/plugins/chat/discourse/components/styleguide/chat-composer","discourse/plugins/chat/discourse/components/styleguide/chat-composer-message-details","discourse/plugins/chat/discourse/components/styleguide/chat-header-icon","discourse/plugins/chat/discourse/components/styleguide/chat-message","discourse/plugins/chat/discourse/components/styleguide/chat-modal-archive-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-create-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-delete-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-description","discourse/plugins/chat/discourse/components/styleguide/chat-modal-edit-channel-name","discourse/plugins/chat/discourse/components/styleguide/chat-modal-move-message-to-channel","discourse/plugins/chat/discourse/components/styleguide/chat-modal-new-message","discourse/plugins/chat/discourse/components/styleguide/chat-modal-thread-settings","discourse/plugins/chat/discourse/components/styleguide/chat-modal-toggle-channel-status","discourse/plugins/chat/discourse/components/styleguide/chat-thread-list-item","@ember/component","@ember/template-factory","@ember/component/template-only"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const b=(0,g.setComponentTemplate)((0,f.createTemplateFactory)({id:"D76d53AZ",block:'[[[1,"\\n  "],[8,[32,0],null,null,null],[1,"\\n  "],[8,[32,1],null,null,null],[1,"\\n  "],[8,[32,2],null,null,null],[1,"\\n  "],[8,[32,3],null,null,null],[1,"\\n  "],[8,[32,4],null,null,null],[1,"\\n\\n  "],[10,"h2"],[12],[1,"Modals"],[13],[1,"\\n\\n  "],[8,[32,5],null,null,null],[1,"\\n  "],[8,[32,6],null,null,null],[1,"\\n  "],[8,[32,7],null,null,null],[1,"\\n  "],[8,[32,8],null,null,null],[1,"\\n  "],[8,[32,9],null,null,null],[1,"\\n  "],[8,[32,10],null,null,null],[1,"\\n  "],[8,[32,11],null,null,null],[1,"\\n  "],[8,[32,12],null,null,null],[1,"\\n  "],[8,[32,13],null,null,null],[1,"\\n"]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/styleguide/organisms/chat.js",scope:()=>[n.default,t.default,m.default,s.default,a.default,i.default,d.default,o.default,c.default,l.default,u.default,r.default,p.default,h.default],isStrictMode:!0}),(0,_.default)(void 0,"chat:ChatOrganism"))
e.default=b})),define("discourse/plugins/chat/discourse/components/thread-title/index",["exports","@glimmer/component","@ember/routing","@ember/service","@ember/template","discourse/helpers/replace-emoji","discourse/lib/utilities","discourse/plugins/chat/discourse/components/thread-unread-indicator","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends t.default{static#e=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
get title(){return this.args.thread.title?(0,i.default)((0,n.htmlSafe)((0,r.escapeExpression)(this.args.thread.title))):(0,i.default)((0,n.htmlSafe)(this.args.thread.originalMessage.excerpt))}static#s=(()=>(0,c.setComponentTemplate)((0,l.createTemplateFactory)({id:"gnX2H9Yh",block:'[[[1,"\\n    "],[10,1],[14,0,"chat__thread-title-container"],[12],[1,"\\n      "],[10,1],[14,0,"chat__thread-title"],[12],[1,"\\n"],[41,[30,0,["site","desktopView"]],[[[1,"          "],[8,[32,0],[[24,0,"chat__thread-title__name"]],[["@route","@models"],["chat.channel.thread",[30,1,["routeModels"]]]],[["default"],[[[[1,"\\n            "],[1,[30,0,["title"]]],[1,"\\n          "]],[]]]]],[1,"\\n"]],[]],[[[1,"          "],[10,1],[14,0,"chat__thread-title__name"],[12],[1,"\\n            "],[1,[30,0,["title"]]],[1,"\\n          "],[13],[1,"\\n"]],[]]],[1,"\\n      "],[13],[1,"\\n      "],[8,[32,1],null,[["@thread"],[[30,1]]],null],[1,"\\n    "],[13],[1,"\\n  "]],["@thread"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/thread-title/index.js",scope:()=>[s.LinkTo,o.default],isStrictMode:!0}),this))()}e.default=d})),define("discourse/plugins/chat/discourse/components/thread-unread-indicator/index",["exports","@glimmer/component","@ember/component","@ember/template-factory"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{get unreadCount(){return this.args.thread.tracking.unreadCount}get urgentCount(){return this.args.thread.tracking.watchedThreadsUnreadCount}get showUnreadIndicator(){return this.unreadCount>0||this.urgentCount>0}get unreadCountLabel(){const e=this.urgentCount>0?this.urgentCount:this.unreadCount
return e>99?"99+":e}get isUrgent(){return this.urgentCount>0?"-urgent":""}static#e=(()=>(0,s.setComponentTemplate)((0,a.createTemplateFactory)({id:"bb5wuSVn",block:'[[[1,"\\n"],[41,[30,0,["showUnreadIndicator"]],[[[1,"      "],[10,1],[15,0,[29,["chat-thread-list-item-unread-indicator ",[30,0,["isUrgent"]]]]],[12],[1,"\\n        "],[10,1],[14,0,"chat-thread-list-item-unread-indicator__number"],[12],[1,"\\n          "],[1,[30,0,["unreadCountLabel"]]],[1,"\\n        "],[13],[1,"\\n      "],[13],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/thread-unread-indicator/index.js",isStrictMode:!0}),this))()}e.default=n})),define("discourse/plugins/chat/discourse/components/toggle-channel-membership-button",["exports","@glimmer/component","@glimmer/tracking","@ember/helper","@ember/object","@ember/service","discourse/components/d-button","discourse/components/plugin-outlet","discourse/helpers/concat-class","discourse/lib/ajax-error","discourse-i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class p extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[i.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[i.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"isLoading",[s.tracked],(function(){return!1})))()
#Is=(()=>{dt7948.i(this,"isLoading")})()
options={}
constructor(){super(...arguments),this.options={labelType:"normal",joinTitle:d.default.t("chat.channel_settings.join_channel"),joinIcon:"",joinClass:"",leaveTitle:d.default.t("chat.channel_settings.leave_channel"),leaveIcon:"",leaveClass:"",...this.args.options}}get label(){return"none"===this.options.labelType?"":"short"===this.options.labelType?this.args.channel.currentUserMembership.following?d.default.t("chat.channel_settings.leave"):d.default.t("chat.channel_settings.join"):this.args.channel.currentUserMembership.following?d.default.t("chat.channel_settings.leave_channel"):d.default.t("chat.channel_settings.join_channel")}onJoinChannel(){return this.isLoading=!0,this.chat.followChannel(this.args.channel).then((()=>{this.args.onJoin?.(this.args.channel)})).catch(l.popupAjaxError).finally((()=>{this.isDestroying||this.isDestroyed||(this.isLoading=!1)}))}static#r=(()=>dt7948.n(this.prototype,"onJoinChannel",[n.action]))()
async onLeaveChannel(){this.isLoading=!0
try{this.args.channel.chatable.group?await this.chatApi.leaveChannel(this.args.channel.id):await this.chat.unfollowChannel(this.args.channel),this.args.onLeave?.(this.args.channel)}catch(e){(0,l.popupAjaxError)(e)}finally{this.isLoading=!1}}static#c=(()=>dt7948.n(this.prototype,"onLeaveChannel",[n.action]))()
static#l=(()=>(0,h.setComponentTemplate)((0,u.createTemplateFactory)({id:"7Vy5YBdY",block:'[[[1,"\\n"],[41,[30,1,["currentUserMembership","following"]],[[[1,"      "],[8,[32,0],[[16,0,[28,[32,1],["toggle-channel-membership-button -leave",[30,0,["options","leaveClass"]]],null]]],[["@action","@translatedLabel","@translatedTitle","@icon","@disabled"],[[30,0,["onLeaveChannel"]],[30,0,["label"]],[30,0,["options","leaveTitle"]],[30,0,["options","leaveIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n"]],[]],[[[1,"      "],[8,[32,2],null,[["@name","@outletArgs","@defaultGlimmer"],["chat-join-channel-button",[28,[32,3],null,[["onJoinChannel","channel","icon","title","label","disabled"],[[30,0,["onJoinChannel"]],[30,1],[30,0,["options","joinIcon"]],[30,0,["options","joinTitle"]],[30,0,["label"]],[30,0,["isLoading"]]]]],true]],[["default"],[[[[1,"\\n        "],[8,[32,0],[[16,0,[28,[32,1],["toggle-channel-membership-button -join",[30,0,["options","joinClass"]]],null]]],[["@action","@translatedLabel","@translatedTitle","@icon","@disabled"],[[30,0,["onJoinChannel"]],[30,0,["label"]],[30,0,["options","joinTitle"]],[30,0,["options","joinIcon"]],[30,0,["isLoading"]]]],null],[1,"\\n      "]],[]]]]],[1,"\\n"]],[]]],[1,"  "]],["@channel"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/toggle-channel-membership-button.js",scope:()=>[r.default,c.default,o.default,a.hash],isStrictMode:!0}),this))()}e.default=p})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state",["exports","@ember/component","@ember/component/template-only","@ember/template-factory"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=(0,a.createTemplateFactory)({id:"O6dDc9NT",block:'[[[10,0],[14,0,"empty-state"],[12],[1,"\\n  "],[10,1],[14,0,"empty-state-title"],[12],[1,"\\n    "],[1,[28,[35,0],["user_menu.no_chat_notifications_title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,0],[14,0,"empty-state-body"],[12],[1,"\\n    "],[10,2],[12],[1,"\\n      "],[1,[28,[35,1],[[28,[37,0],["user_menu.no_chat_notifications_body"],[["preferencesUrl"],[[28,[37,2],["/my/preferences/notifications"],null]]]]],null]],[1,"\\n    "],[13],[1,"\\n  "],[13],[1,"\\n"],[13]],[],false,["i18n","html-safe","get-url"]]',moduleName:"discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list-empty-state.hbs",isStrictMode:!1})
e.default=(0,t.setComponentTemplate)(n,(0,s.default)(void 0,"chat-notifications-list-empty-state"))})),define("discourse/plugins/chat/discourse/components/user-menu/chat-notifications-list",["exports","discourse/components/user-menu/notifications-list"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{get dismissTypes(){return this.filterByTypes}get emptyStateComponent(){return"user-menu/chat-notifications-list-empty-state"}}e.default=s}))
define("discourse/plugins/chat/discourse/components/user-threads/index",["exports","@glimmer/component","@glimmer/tracking","@ember/routing","@ember/service","discourse-common/helpers/i18n","discourse-common/utils/decorators","discourse/plugins/chat/discourse/components/channel-icon","discourse/plugins/chat/discourse/components/channel-title","discourse/plugins/chat/discourse/components/chat/list","discourse/plugins/chat/discourse/components/chat-message-thread-indicator","discourse/plugins/chat/discourse/components/thread-title","discourse/plugins/chat/discourse/components/user-threads/preview","discourse/plugins/chat/discourse/models/chat-thread-preview","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class f extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[n.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"messageBus",[n.service]))()
#te=(()=>{dt7948.i(this,"messageBus")})()
static#c=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
trackedChannels={}
get threadsCollection(){return this.chatApi.userThreads(this.handleLoadedThreads)}static#l=(()=>dt7948.n(this.prototype,"threadsCollection",[s.cached]))()
willDestroy(){super.willDestroy(...arguments),Object.keys(this.trackedChannels).forEach((e=>{this.messageBus.unsubscribe(`/chat/${e}`,this.onMessage)})),this.trackedChannels={}}handleLoadedThreads(e){return e.threads.map((t=>{const s=this.chatChannelsManager.store(t.channel),a=s.threadsManager.add(s,t),n=e.tracking[a.id]
return n&&(a.tracking.mentionCount=n.mention_count,a.tracking.unreadCount=n.unread_count,a.tracking.watchedThreadsUnreadCount=n.watched_threads_unread_count),this.trackChannel(a.channel),a}))}static#d=(()=>dt7948.n(this.prototype,"handleLoadedThreads",[r.bind]))()
trackChannel(e){this.trackedChannels[e.id]||(this.trackedChannels[e.id]=e,this.messageBus.subscribe(`/chat/${e.id}`,this.onMessage,e.channelMessageBusLastId))}onMessage(e){if("update_thread_original_message"===e.type){const t=this.trackedChannels[e.channel_id]
if(!t)return
const s=t.threadsManager.threads.find((t=>t.id===e.thread_id))
s&&(s.preview=p.default.create(e.preview))}}static#h=(()=>dt7948.n(this.prototype,"onMessage",[r.bind]))()
static#u=(()=>(0,m.setComponentTemplate)((0,g.createTemplateFactory)({id:"fPGEq7KN",block:'[[[1,"\\n    "],[8,[32,0],[[24,0,"c-user-threads"]],[["@collection"],[[30,0,["threadsCollection"]]]],[["default"],[[[[1,"\\n      "],[8,[30,1,["Item"]],null,null,[["default"],[[[[1,"\\n        "],[10,0],[14,0,"c-user-thread"],[15,"data-id",[30,2,["id"]]],[12],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"            "],[8,[32,1],null,[["@thread"],[[30,2]]],null],[1,"\\n"]],[]],null],[1,"\\n"],[41,[30,0,["site","mobileView"]],[[[1,"            "],[8,[32,2],[[24,0,"c-user-thread__link"]],[["@route","@models"],["chat.channel.thread",[30,2,["routeModels"]]]],[["default"],[[[[1,"\\n              "],[8,[32,3],null,[["@channel"],[[30,2,["channel"]]]],null],[1,"\\n              "],[8,[32,4],null,[["@thread"],[[30,2]]],null],[1,"\\n\\n              "],[8,[32,5],null,[["@preview"],[[30,2,["preview"]]]],null],[1,"\\n            "]],[]]]]],[1,"\\n"]],[]],[[[1,"            "],[8,[32,3],null,[["@channel"],[[30,2,["channel"]]]],null],[1,"\\n            "],[8,[32,4],null,[["@thread"],[[30,2]]],null],[1,"\\n\\n            "],[8,[32,6],[[24,"tabindex","-1"]],[["@message","@interactiveUser","@interactiveThread"],[[30,2,["originalMessage"]],false,false]],null],[1,"\\n"]],[]]],[1,"        "],[13],[1,"\\n      "]],[2]]]]],[1,"\\n      "],[8,[30,1,["EmptyState"]],null,null,[["default"],[[[[1,"\\n        "],[10,0],[14,0,"empty-state-threads"],[12],[1,"\\n          "],[1,[28,[32,7],["chat.empty_state.my_threads"],null]],[1,"\\n        "],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "]],[1]]]]],[1,"\\n  "]],["list","thread"],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/user-threads/index.js",scope:()=>[l.default,o.default,a.LinkTo,c.default,h.default,u.default,d.default,i.default],isStrictMode:!0}),this))()}e.default=f})),define("discourse/plugins/chat/discourse/components/user-threads/preview",["exports","@glimmer/component","@ember/template","discourse/helpers/format-date","discourse/helpers/replace-emoji","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{get lastReplyDate(){return(0,a.default)(this.args.preview.lastReplyCreatedAt,{leaveAgo:!0})}static#e=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"n1JPhyTG",block:'[[[1,"\\n    "],[10,1],[14,0,"chat-message-thread-indicator__last-reply-timestamp"],[12],[1,"\\n      "],[1,[30,0,["lastReplyDate"]]],[1,"\\n    "],[13],[1,"\\n    "],[10,1],[14,0,"c-user-thread__excerpt"],[12],[1,"\\n      "],[10,1],[14,0,"c-user-thread__excerpt-poster"],[12],[1,"\\n        "],[1,[30,1,["lastReplyUser","username"]]],[1,"\\n      "],[13],[1,"\\n      "],[10,1],[12],[1,":"],[13],[1,"\\n      "],[10,1],[14,0,"c-user-thread__excerpt-text"],[12],[1,"\\n        "],[1,[28,[32,0],[[28,[32,1],[[30,1,["lastReplyExcerpt"]]],null]],null]],[1,"\\n      "],[13],[1,"\\n    "],[13],[1,"\\n  "]],["@preview"],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/components/user-threads/preview.js",scope:()=>[n.default,s.htmlSafe],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/connectors/above-site-header/chat-body-class",["exports","@glimmer/component","@ember/service","discourse/helpers/body-class","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#s=(()=>(0,n.setComponentTemplate)((0,i.createTemplateFactory)({id:"9oA6S80b",block:'[[[1,"\\n"],[41,[30,0,["chatStateManager","hasPreloadedChannels"]],[[[1,"      "],[1,[28,[32,0],["has-preloaded-chat-channels"],null]],[1,"\\n"]],[]],null],[1,"  "]],[],false,["if"]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/connectors/above-site-header/chat-body-class.js",scope:()=>[a.default],isStrictMode:!0}),this))()}e.default=r})),define("discourse/plugins/chat/discourse/connectors/user-preferences-nav/chat-preferences",["exports","@glimmer/component","@ember/routing","discourse-common/helpers/d-icon","discourse-common/helpers/i18n","@ember/component","@ember/template-factory"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static shouldRender(e,t){let{model:s}=e,{siteSettings:a,currentUser:n}=t
return a.chat_enabled&&(s.can_chat||n?.admin)}static#e=(()=>(0,i.setComponentTemplate)((0,r.createTemplateFactory)({id:"xAutR0Eb",block:'[[[1,"\\n    "],[10,"li"],[14,0,"user-nav__preferences-chat"],[12],[1,"\\n      "],[8,[32,0],null,[["@route"],["preferences.chat"]],[["default"],[[[[1,"\\n        "],[1,[28,[32,1],["d-chat"],null]],[1,"\\n        "],[10,1],[12],[1,[28,[32,2],["chat.title_capitalized"],null]],[13],[1,"\\n      "]],[]]]]],[1,"\\n    "],[13],[1,"\\n  "]],[],false,[]]',moduleName:"/var/www/discourse/app/assets/javascripts/discourse/discourse/plugins/chat/discourse/connectors/user-preferences-nav/chat-preferences.js",scope:()=>[s.LinkTo,a.default,n.default],isStrictMode:!0}),this))()}e.default=o})),define("discourse/plugins/chat/discourse/controllers/chat-channel-index",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{}e.default=s})),define("discourse/plugins/chat/discourse/controllers/chat-channel-thread",["exports","@glimmer/tracking","@ember/controller","@ember/service"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"targetMessageId",[t.tracked],(function(){return null})))()
#Rs=(()=>{dt7948.i(this,"targetMessageId")})()}e.default=n})),define("discourse/plugins/chat/discourse/controllers/chat-channel",["exports","@glimmer/tracking","@ember/controller","@ember/service"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"targetMessageId",[t.tracked],(function(){return null})))()
#Rs=(()=>{dt7948.i(this,"targetMessageId")})()
queryParams=["messageId"]}e.default=n})),define("discourse/plugins/chat/discourse/controllers/chat-draft-channel",["exports","@ember/controller","@ember/service"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()}e.default=a})),define("discourse/plugins/chat/discourse/controllers/chat-index",["exports","@ember/controller","@ember/service"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()}e.default=a})),define("discourse/plugins/chat/discourse/controllers/chat-new-message",["exports","@ember/controller"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{queryParams=["recipients"]}e.default=s})),define("discourse/plugins/chat/discourse/controllers/chat",["exports","@ember/controller","@ember/service","discourse/plugins/chat/discourse/lib/chat-constants"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[s.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#c=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get shouldUseChatSidebar(){return!this.site.mobileView&&!this.shouldUseCoreSidebar}get publicMessageChannelsEmpty(){return 0===this.chatChannelsManager.publicMessageChannels?.length&&this.chatStateManager.hasPreloadedChannels}get shouldUseCoreSidebar(){return"sidebar"===this.siteSettings.navigation_menu}get enabledRouteCount(){return[this.siteSettings.chat_threads_enabled,this.chat.userCanAccessDirectMessages,this.siteSettings.enable_public_channels].filter(Boolean).length}get shouldUseChatFooter(){return a.FOOTER_NAV_ROUTES.includes(this.router.currentRouteName)&&this.enabledRouteCount>1}get mainOutletModifierClasses(){let e=[]
return this.chatStateManager.isSidePanelExpanded&&e.push("has-side-panel-expanded"),this.router.currentRouteName.startsWith("chat.channel.info")||this.router.currentRouteName.startsWith("chat.browse")||e.push("chat-view"),e.join(" ")}}e.default=n})),define("discourse/plugins/chat/discourse/controllers/preferences-chat",["exports","@ember/controller","@ember/object","@ember/service","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/services/chat-audio-manager"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_NEVER=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW=void 0
const l=["chat_enabled","only_chat_push_notifications","ignore_channel_wide_mention","show_thread_title_prompts","chat_sound","chat_email_frequency","chat_header_indicator_preference","chat_separate_sidebar_mode"],d=e.HEADER_INDICATOR_PREFERENCE_NEVER="never",h=e.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS="dm_and_mentions",u=e.HEADER_INDICATOR_PREFERENCE_ALL_NEW="all_new",p=e.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS="only_mentions"
class m extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatAudioManager",[a.service]))()
#Ns=(()=>{dt7948.i(this,"chatAudioManager")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[a.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
subpageTitle=(()=>o.default.t("chat.admin.title"))()
emailFrequencyOptions=(()=>[{name:o.default.t("chat.email_frequency.never"),value:"never"},{name:o.default.t("chat.email_frequency.when_away"),value:"when_away"}])()
headerIndicatorOptions=(()=>[{name:o.default.t("chat.header_indicator_preference.all_new"),value:u},{name:o.default.t("chat.header_indicator_preference.dm_and_mentions"),value:h},{name:o.default.t("chat.header_indicator_preference.only_mentions"),value:p},{name:o.default.t("chat.header_indicator_preference.never"),value:d}])()
chatSeparateSidebarModeOptions=(()=>[{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.always"),value:"always"},{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.fullscreen"),value:"fullscreen"},{name:o.default.t("admin.site_settings.chat_separate_sidebar_mode.never"),value:"never"}])()
get chatSeparateSidebarMode(){const e=this.model.get("user_option.chat_separate_sidebar_mode")
return"default"===e?this.siteSettings.chat_separate_sidebar_mode:e}chatSounds(){return Object.keys(c.CHAT_SOUNDS).map((e=>({name:o.default.t(`chat.sounds.${e}`),value:e})))}static#n=(()=>dt7948.n(this.prototype,"chatSounds",[r.default]))()
onChangeChatSound(e){e&&this.chatAudioManager.play(e),this.model.set("user_option.chat_sound",e)}static#r=(()=>dt7948.n(this.prototype,"onChangeChatSound",[s.action]))()
save(){return this.set("saved",!1),this.model.save(l).then((()=>{this.set("saved",!0),(0,i.isTesting)()||location.reload()})).catch(n.popupAjaxError)}static#c=(()=>dt7948.n(this.prototype,"save",[s.action]))()}e.default=m})),define("discourse/plugins/chat/discourse/helpers/chat-guardian",["exports","@ember/component/helper","@ember/service","@ember/string"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends t.default{static#e=(()=>dt7948.g(this.prototype,"chatGuardian",[s.service]))()
#ks=(()=>{dt7948.i(this,"chatGuardian")})()
compute(e){const[t,...s]=e
if(t)return this.chatGuardian[(0,a.camelize)(t)]?.(...s)}}e.default=n})),define("discourse/plugins/chat/discourse/helpers/first-visible-message-id",["exports","discourse/plugins/chat/discourse/lib/check-message-visibility"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){let s
const a=e.querySelectorAll(":scope .chat-messages-container > [data-id]")
for(let i=a.length-1;i>=0;i--){const n=a[i]
if((0,t.checkMessageBottomVisibility)(e,n)){s=n
break}}const n=s?.dataset?.id
return n?parseInt(n,10):null}})),define("discourse/plugins/chat/discourse/helpers/format-chat-date",["exports","@ember/template","discourse/models/user","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){let i=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
const r=s.default.current(),o=r?r.user_option.timezone:moment.tz.guess(),c=moment(new Date(e.createdAt),o),l=c.format(n.default.t("dates.long_with_year")),d="tiny"===i.mode?c.format(n.default.t("chat.dates.time_tiny")):c.format(n.default.t("dates.time"))
if(e.staged)return(0,t.htmlSafe)(`<span title='${l}' tabindex="-1" class='chat-time'>${d}</span>`)
{let s
return s=i.threadContext?(0,a.default)(`/chat/c/-/${e.channel.id}/t/${e.thread.id}/${e.id}`):(0,a.default)(`/chat/c/-/${e.channel.id}/${e.id}`),(0,t.htmlSafe)(`<a title='${l}' tabindex="-1" class='chat-time' href='${s}'>${d}</a>`)}}})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-title",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){if(!e.tonable||1===t)return`:${e.name}:`
return`:${e.name}:t${t}:`}})),define("discourse/plugins/chat/discourse/helpers/tonable-emoji-url",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,t){if(!e.tonable||1===t)return e.url
return e.url.split(".png")[0]+`/${t}.png`}})),define("discourse/plugins/chat/discourse/initializers/chat-admin-plugin-configuration-nav",["exports","discourse/lib/admin-plugin-config-nav","discourse/lib/plugin-api","discourse/plugins/chat/admin/components/chat-admin-plugin-actions"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"discourse-chat-admin-plugin-configuration-nav",initialize(e){const n=e.lookup("service:current-user")
n?.admin&&(0,s.withPluginApi)("1.1.0",(e=>{e.addAdminPluginConfigurationNav("chat",t.PLUGIN_NAV_MODE_TOP,[{label:"chat.incoming_webhooks.title",route:"adminPlugins.show.discourse-chat-incoming-webhooks"}]),e.registerPluginHeaderActionComponent("chat",a.default)}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-audio",["exports","discourse/lib/plugin-api","discourse/plugins/chat/discourse/lib/chat-constants"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a=[29,30]
e.default={name:"chat-audio",initialize(e){e.lookup("service:chat").userCanChat&&(0,t.withPluginApi)("0.12.1",(t=>{t.registerDesktopNotificationHandler(((t,n,i)=>{const r=i.user_option.chat_header_indicator_preference,o=29===t.notification_type
if(!i.isInDoNotDisturb()&&i.user_option.chat_sound&&r!==s.INDICATOR_PREFERENCES.never&&(r!==s.INDICATOR_PREFERENCES.only_mentions||o)&&(r!==s.INDICATOR_PREFERENCES.dm_and_mentions||t.is_direct_message_channel||o)&&a.includes(t.notification_type)){e.lookup("service:chat-audio-manager").play(i.chat_sound)}}))}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-decorators",["exports","jquery","discourse/helpers/loading-spinner","discourse/instance-initializers/onebox-decorators","discourse/lib/hashtag-decorator","discourse/lib/highlight-syntax","discourse/lib/load-script","discourse/lib/plugin-api","discourse/lib/url","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-decorators",initializeWithPluginApi(e,t){const s=t.lookup("service:site-settings"),r=t.lookup("service:lightbox"),o=t.lookup("service:site")
e.decorateChatMessage((e=>(0,a.decorateGithubOneboxBody)(e)),{id:"onebox-github-body"}),e.decorateChatMessage((e=>{e.querySelectorAll(".onebox.githubblob li.selected").forEach((e=>{const t=this._getScrollParent(e,"onebox")
if(!t)return
const s=t.offsetHeight-t.clientHeight
t.scroll({top:e.offsetTop+s-t.offsetHeight/2+e.offsetHeight/2})}))}),{id:"onebox-github-scrolling"}),e.decorateChatMessage((e=>(0,i.default)(e,s,t.lookup("service:session"))),{id:"highlightSyntax"}),e.decorateChatMessage(this.renderChatTranscriptDates,{id:"transcriptDates"}),e.decorateChatMessage(this.forceLinksToOpenNewTab,{id:"linksNewTab"}),s.enable_experimental_lightbox?e.decorateChatMessage((e=>{r.setupLightboxes({container:e,selector:"img:not(.emoji, .avatar, .site-icon)"})}),{id:"experimental-chat-lightbox"}):e.decorateChatMessage((e=>this.lightbox(e.querySelectorAll("img:not(.emoji, .avatar)"))),{id:"lightbox"}),e.decorateChatMessage((e=>(0,n.decorateHashtags)(e,o)),{id:"hashtagIcons"})},_getScrollParent(e,t){return null===e||e.classList.contains(t)?null:e.scrollHeight>e.clientHeight?e:this._getScrollParent(e.parentNode,t)},renderChatTranscriptDates(e){e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,s=e.querySelector(".chat-transcript-datetime a")
s&&""===s.innerText&&(this.currentUserTimezone?s.innerText=moment.tz(t,this.currentUserTimezone).format(d.default.t("dates.long_no_year")):s.innerText=moment(t).format(d.default.t("dates.long_no_year")))}))},forceLinksToOpenNewTab(e){const t=e.querySelectorAll(".chat-message-text a:not([target='_blank'])")
for(let s=0;s<t.length;s++){const e=t[s]
c.default.isInternal(e.href)&&(0,l.samePrefix)(e.href)||e.setAttribute("target","_blank")}},lightbox(e){(0,r.default)("/javascripts/jquery.magnific-popup.min.js").then((function(){(0,t.default)(e).magnificPopup({type:"image",closeOnContentClick:!1,mainClass:"mfp-zoom-in",tClose:d.default.t("lightbox.close"),tLoading:s.spinnerHTML,image:{verticalFit:!0},gallery:{enabled:!0},callbacks:{elementParse:e=>{e.src=e.el[0].dataset.largeSrc||e.el[0].src}}})}))},initialize(e){e.lookup("service:chat").userCanChat&&(0,o.withPluginApi)("0.8.42",(t=>this.initializeWithPluginApi(t,e)))}}})),define("discourse/plugins/chat/discourse/initializers/chat-keyboard-shortcuts",["exports","discourse/lib/keyboard-shortcuts","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat/modal/new-message"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-keyboard-shortcuts",initialize(e){const n=e.lookup("service:chat")
if(!n.userCanChat)return
const i=e.lookup("service:router"),r=e.lookup("service:app-events"),o=e.lookup("service:modal"),c=e.lookup("service:chat-state-manager"),l=e.lookup("service:chat-thread-pane"),d=e.lookup("service:chat-thread-list-pane"),h=e.lookup("service:chat-channels-manager"),u=e=>{e.preventDefault(),e.stopPropagation(),o.show(a.default)},p=e=>{e.preventDefault(),e.stopPropagation(),n.switchChannelUpOrDown("up")},m=e=>{e.preventDefault(),e.stopPropagation(),n.switchChannelUpOrDown("down")},g=e=>e.classList.contains("chat-composer__input"),f=(e,t)=>{g(e.target)&&(e.preventDefault(),e.stopPropagation(),r.trigger("chat:modify-selection",e,{type:t,context:e.target.dataset.chatComposerContext}))};(0,s.withPluginApi)("0.12.1",(e=>{e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+k`,u,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_quick_channel_selector",definition:{keys1:["meta","k"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("alt+up",p,{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.switch_channel_arrows",definition:{keys1:["alt","&uarr;"],keys2:["alt","&darr;"],keysDelimiter:"plus",shortcutsDelimiter:"slash"}}}),e.addKeyboardShortcut("alt+down",m,{global:!0}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+b`,(e=>f(e,"bold")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_bold",definition:{keys1:["meta","b"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+i`,(e=>f(e,"italic")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_italic",definition:{keys1:["meta","i"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+e`,(e=>f(e,"code")),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.composer_code",definition:{keys1:["meta","e"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut(`${t.PLATFORM_KEY_MODIFIER}+l`,(e=>(e=>{g(e.target)&&(e.preventDefault(),e.stopPropagation(),r.trigger("chat:open-insert-link-modal",e,{context:e.target.dataset.chatComposerContext}))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.open_insert_link_modal",definition:{keys1:["meta","l"],keysDelimiter:"plus"}}}),e.addKeyboardShortcut("-",(e=>(e=>{(e=>{const t=e?.tagName.toLowerCase()
return!["input","textarea","select","button"].includes(t)})(e.target)&&(e.preventDefault(),e.stopPropagation(),c.prefersDrawer(),i.transitionTo(c.lastKnownChatURL||"chat"))})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_open",definition:{keys1:["-"]}}}),e.addKeyboardShortcut("esc",(e=>(e=>{if(!e.srcElement?.classList?.value?.includes("mfp-wrap"))return c.isDrawerActive?(e.preventDefault(),e.stopPropagation(),void r.trigger("chat:toggle-close",e)):l.isOpened?(e.preventDefault(),e.stopPropagation(),void l.close()):d.isOpened?(e.preventDefault(),e.stopPropagation(),void d.close()):void 0})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.drawer_close",definition:{keys1:["esc"]}}}),e.addKeyboardShortcut("shift+esc",(e=>(e=>{e.preventDefault(),e.stopPropagation(),c.isActive&&h.markAllChannelsRead()})(e)),{global:!0,help:{category:"chat",name:"chat.keyboard_shortcuts.mark_all_channels_read",definition:{keys1:["shift","esc"],keysDelimiter:"plus"}}})}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-plugin-decorators",["exports","discourse/lib/local-dates","discourse/lib/plugin-api"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-plugin-decorators",initializeWithPluginApi(e,s){if(e.decorateChatMessage((e=>{(0,t.applyLocalDates)(e.querySelectorAll(".discourse-local-date"),s)}),{id:"local-dates"}),s.spoiler_enabled){const t=requirejs("discourse/plugins/spoiler-alert/lib/apply-spoiler").default
e.decorateChatMessage((e=>{e.querySelectorAll(".spoiler").forEach((e=>{e.classList.remove("spoiler"),e.classList.add("spoiled"),t(e)}))}),{id:"spoiler"})}},initialize(e){if(e.lookup("service:chat").userCanChat){const t=e.lookup("service:site-settings");(0,s.withPluginApi)("0.8.42",(e=>{this.initializeWithPluginApi(e,t)}))}}}})),define("discourse/plugins/chat/discourse/initializers/chat-setup",["exports","@ember/owner","@ember/service","discourse/lib/formatter","discourse/lib/plugin-api","discourse-common/lib/get-owner","discourse-common/lib/icon-library","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/hashtag-types/channel","discourse/plugins/chat/discourse/components/chat/header/icon","discourse/plugins/chat/discourse/components/styleguide/organisms/chat"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
let p
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;(0,r.replaceIcon)("d-chat","comment")
class m{static#e=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"chatService",[(0,s.service)("chat")]))()
#Fs=(()=>{dt7948.i(this,"chatService")})()
static#n=(()=>dt7948.g(this.prototype,"chatHistory",[s.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#r=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#c=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#l=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#d=(()=>dt7948.g(this.prototype,"appEvents",[s.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
constructor(e){(0,t.setOwner)(this,e),this.appEvents.on("discourse:focus-changed",this,"_handleFocusChanged"),(0,n.withPluginApi)("0.12.1",(t=>{if(t.addAboutPageActivity("chat_messages",(e=>{const t=e["7_days"]
if(t)return{icon:"comment-dots",class:"chat-messages",activityText:c.default.t("about.activities.chat_messages",{count:t,formatted_number:(0,a.number)(t)}),period:c.default.t("about.activities.periods.last_7_days")}})),!this.chatService.userCanChat)return
if(t.onPageChange((e=>{const t=this.router.recognize(e)
t.name.startsWith("chat.")&&this.chatHistory.visit(t)})),t.registerHashtagType("channel",new d.default(e)),t.registerChatComposerButton({id:"chat-upload-btn",icon:"far-image",label:"chat.upload",position:"dropdown",action:"uploadClicked",dependentKeys:["canAttachUploads"],displayed(){return this.canAttachUploads}}),this.siteSettings.discourse_local_dates_enabled&&t.registerChatComposerButton({label:"discourse_local_dates.title",id:"local-dates",class:"chat-local-dates-btn",icon:"calendar-days",position:"dropdown",action(){this.insertDiscourseLocalDate()}}),t.registerChatComposerButton({label:"chat.emoji",id:"emoji",class:"chat-emoji-btn",icon:"far-face-smile",position:this.site.desktopView?"inline":"dropdown",context:"channel",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"channel"})}}),t.registerChatComposerButton({label:"chat.emoji",id:"channel-emoji",class:"chat-emoji-btn",icon:"discourse-emojis",position:"dropdown",context:"thread",action(){e.lookup("service:chat-emoji-picker-manager").open({context:"thread"})}}),t.decorateCookedElement((e=>{const t=(0,i.getOwnerWithFallback)(this).lookup("service:current-user"),s=t?.user_option?.timezone
e.querySelectorAll(".chat-transcript").forEach((e=>{const t=e.dataset.datetime,a=e.querySelector(".chat-transcript-datetime a, .chat-transcript-datetime span")
a.innerText=s?moment.tz(t,s).format(c.default.t("dates.long_no_year")):moment(t).format(c.default.t("dates.long_no_year")),a.dataset.dateFormatted=!0}))})),!this.chatService.userCanChat)return
document.body.classList.add("chat-enabled"),this.chatService.loadChannels()
e.lookup("service:chat-notification-manager").start(),this._registeredDocumentTitleCountCallback||(t.addDocumentTitleCounter(this.documentTitleCountCallback),this._registeredDocumentTitleCountCallback=!0),t.addCardClickListenerSelector(".chat-drawer-outlet"),this.chatService.userCanChat&&t.headerIcons.add("chat",h.default),t.addStyleguideSection?.({component:u.default,category:"organisms",id:"chat"})}))}documentTitleCountCallback(){return this.chatService.getDocumentTitleCount()}static#h=(()=>dt7948.n(this.prototype,"documentTitleCountCallback",[o.bind]))()
teardown(){this.appEvents.off("discourse:focus-changed",this,"_handleFocusChanged"),this.chatService.userCanChat&&(p=null,(0,l.clearChatComposerButtons)())}_handleFocusChanged(e){if(!this.chatService.userCanChat)return
if(!e)return void(p=Date.now())
p=p||Date.now()
Date.now()-p<=18e4||(p=Date.now())}static#u=(()=>dt7948.n(this.prototype,"_handleFocusChanged",[o.bind]))()}e.default={name:"chat-setup",before:"hashtag-css-generator",initialize(e){this.instance=new m(e)},teardown(){this.instance.teardown(),this.instance=null}}})),define("discourse/plugins/chat/discourse/initializers/chat-sidebar",["exports","@glimmer/tracking","@ember/service","@ember/string","@ember/template","discourse/components/user-status-message","discourse/helpers/decorate-username-selector","discourse/lib/plugin-api","discourse/lib/text","discourse/lib/utilities","discourse-common/lib/avatar-utils","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat/modal/new-message","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-sidebar",initialize(e){this.chatService=e.lookup("service:chat"),this.chatService.userCanChat&&(this.siteSettings=e.lookup("service:site-settings"),this.currentUser=e.lookup("service:current-user"),(0,o.withPluginApi)("1.8.0",(t=>{const s=e.lookup("service:chat-state-manager")
t.addSidebarPanel((e=>class extends e{key=(()=>m.CHAT_PANEL)()
switchButtonLabel=(()=>u.default.t("sidebar.panels.chat.label"))()
switchButtonIcon="d-chat"
get switchButtonDefaultUrl(){return s.lastKnownChatURL||"/chat"}})),(0,m.initSidebarState)(t,t.getCurrentUser())})),(0,o.withPluginApi)("1.3.0",(o=>{const g=e.lookup("service:chat-channels-manager"),f=e.lookup("service:chat-state-manager")
o.addSidebarSection(((t,a)=>{const n=class extends a{route="chat.threads"
text=(()=>u.default.t("chat.my_threads.title"))()
title=(()=>u.default.t("chat.my_threads.title"))()
name="user-threads"
prefixType="icon"
prefixValue="discourse-threads"
suffixType="icon"
suffixCSSClass="unread"
constructor(){super(...arguments),e.isDestroyed}get suffixValue(){return g.publicMessageChannels.some((e=>e.unreadThreadsCount>0))?"circle":""}}
return class extends t{static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[s.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
hideSectionHeader=!0
name="user-threads"
title=""
get links(){return[new n]}get text(){return null}get displaySection(){return this.chatChannelsManager.hasThreadedChannels}}}),m.CHAT_PANEL),this.siteSettings.enable_public_channels&&o.addSidebarSection(((i,r)=>{const o=class extends r{constructor(e){let{channel:t,chatService:s}=e
super(...arguments),this.channel=t,this.chatService=s,this.chatStateManager=f}get name(){return(0,a.dasherize)(this.channel.slugifiedTitle)}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&(this.chatStateManager.isDrawerExpanded||this.chatStateManager.isFullPageActive)&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get route(){return"chat.channel"}get models(){return this.channel.routeModels}get text(){return(0,n.htmlSafe)((0,c.emojiUnescape)(this.channel.escapedTitle))}get prefixType(){return"icon"}get prefixValue(){return"d-chat"}get prefixColor(){return this.channel.chatable.color}get title(){return this.channel.escapedDescription?(0,n.htmlSafe)(this.channel.escapedDescription):`${this.channel.escapedTitle} ${u.default.t("chat.title")}`}get prefixBadge(){return this.channel.chatable.read_restricted?"lock":""}get suffixType(){return"icon"}get suffixValue(){return this.channel.tracking.unreadCount>0||this.chatService.activeChannel?.id!==this.channel.id&&this.channel.unreadThreadsCountSinceLastViewed>0?"circle":""}get suffixCSSClass(){return this.channel.tracking.mentionCount>0?"urgent":"unread"}},l=class extends i{static#e=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"currentUserCanJoinPublicChannels",[t.tracked],(function(){return this.currentUser&&(this.currentUser.staff||this.currentUser.has_joinable_public_channels)})))()
#Bs=(()=>{dt7948.i(this,"currentUserCanJoinPublicChannels")})()
constructor(){super(...arguments),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"),this.router=e.lookup("service:router"))}get sectionLinks(){return this.chatChannelsManager.publicMessageChannels.map((e=>new o({channel:e,chatService:this.chatService})))}get name(){return"chat-channels"}get title(){return u.default.t("chat.chat_channels")}get text(){return u.default.t("chat.chat_channels")}get actions(){return[{id:"browseChannels",title:u.default.t("chat.channels_list_popup.browse"),action:()=>this.router.transitionTo("chat.browse.open")}]}get actionsIcon(){return"pencil"}get links(){return this.sectionLinks}get displaySection(){return this.chatStateManager.hasPreloadedChannels&&(this.sectionLinks.length>0||this.currentUserCanJoinPublicChannels)}}
return l}),m.CHAT_PANEL),o.addSidebarSection(((a,o)=>{const c=class extends o{route="chat.channel"
suffixType="icon"
suffixCSSClass="urgent"
hoverType="icon"
hoverValue="xmark"
hoverTitle=(()=>u.default.t("chat.direct_messages.close"))()
constructor(e){let{channel:t,chatService:s,currentUser:a}=e
if(super(...arguments),this.channel=t,this.chatService=s,this.currentUser=a,this.chatStateManager=f,this.oneOnOneMessage){const e=this.channel.chatable.users[0]
e.username!==u.default.t("chat.deleted_chat_username")&&e.statusManager.trackStatus()}}willDestroy(){this.oneOnOneMessage&&this.channel.chatable.users[0].statusManager.stopTrackingStatus()}static#e=(()=>dt7948.n(this.prototype,"willDestroy",[h.bind]))()
get oneOnOneMessage(){return 1===this.channel.chatable.users.length}get contentComponentArgs(){return this.channel.chatable.users[0].get("status")}get contentComponent(){if(this.oneOnOneMessage)return i.default}get name(){return this.channel.slugifiedTitle}get classNames(){const e=[]
return this.channel.currentUserMembership.muted&&e.push("sidebar-section-link--muted"),this.channel.id===this.chatService.activeChannel?.id&&(this.chatStateManager.isDrawerExpanded||this.chatStateManager.isFullPageActive)&&e.push("sidebar-section-link--active"),e.push(`channel-${this.channel.id}`),e.join(" ")}get models(){return this.channel.routeModels}get title(){return this.channel.chatable.group?u.default.t("chat.placeholder_channel",{channelName:this.channel.escapedTitle}):u.default.t("chat.placeholder_users",{commaSeparatedNames:this.channel.escapedTitle})}get text(){if(this.channel.chatable.group)return this.channel.title
{const e=this.channel.escapedTitle.replaceAll("@","")
return(0,n.htmlSafe)(`${(0,l.escapeExpression)(e)}${(0,r.decorateUsername)((0,l.escapeExpression)(e))}`)}}get prefixType(){return this.channel.chatable.group?"text":"image"}get prefixValue(){return this.channel.chatable.group?this.channel.membershipsCount:(0,d.avatarUrl)(this.channel.chatable.users[0].avatar_template,"tiny")}get prefixCSSClass(){const e=this.chatService.presenceChannel.users,t=this.channel.chatable.users[0]
return e?.findBy("id",t?.id)||e?.findBy("username",t?.username)?"active":""}get suffixValue(){return this.channel.tracking.unreadCount>0?"circle":""}get hoverAction(){return e=>{e.stopPropagation(),e.preventDefault(),this.chatService.unfollowChannel(this.channel)}}},m=class extends a{static#e=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"modal",[s.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#n=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#l=(()=>dt7948.g(this.prototype,"userCanDirectMessage",[t.tracked],(function(){return this.chatService.userCanDirectMessage})))()
#Hs=(()=>{dt7948.i(this,"userCanDirectMessage")})()
constructor(){super(...arguments),e.isDestroyed||(this.chatService=e.lookup("service:chat"),this.chatChannelsManager=e.lookup("service:chat-channels-manager"))}get sectionLinks(){return this.chatChannelsManager.truncatedDirectMessageChannels.map((e=>new c({channel:e,chatService:this.chatService,currentUser:this.currentUser})))}get name(){return"chat-dms"}get title(){return u.default.t("chat.direct_messages.title")}get text(){return u.default.t("chat.direct_messages.title")}get actions(){return this.userCanDirectMessage?[{id:"startDm",title:u.default.t("chat.direct_messages.new"),action:()=>{this.modal.show(p.default)}}]:[]}get actionsIcon(){return"plus"}get links(){return this.sectionLinks}get displaySection(){return this.chatStateManager.hasPreloadedChannels&&(this.sectionLinks.length>0||this.userCanDirectMessage)}}
return m}),"chat")})))}}})),define("discourse/plugins/chat/discourse/initializers/chat-user-menu",["exports","discourse/lib/plugin-api","discourse/lib/utilities","discourse-common/lib/get-url","discourse-i18n","discourse/plugins/chat/discourse/lib/slugify-channel"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-user-menu",initialize(e){(0,t.withPluginApi)("1.3.0",(t=>{e.lookup("service:chat").userCanChat&&(t.registerNotificationTypeRenderer&&(t.registerNotificationTypeRenderer("chat_invitation",(e=>class extends e{linkTitle=(()=>n.default.t("notifications.titles.chat_invitation"))()
icon="link"
description=(()=>n.default.t("notifications.chat_invitation"))()
get linkHref(){const e=this.notification.data
let t=`/chat/c/${(0,i.default)({title:e.chat_channel_title,slug:e.chat_channel_slug})||"-"}/${e.chat_channel_id}`
return e.chat_message_id&&(t+=`/${e.chat_message_id}`),(0,a.default)(t)}get label(){return(0,s.formatUsername)(this.notification.data.invited_by_username)}})),t.registerNotificationTypeRenderer("chat_mention",(e=>class extends e{get linkHref(){let e=`/chat/c/${(0,i.default)({title:this.notification.data.chat_channel_title,slug:this.notification.data.chat_channel_slug})||"-"}/${this.notification.data.chat_channel_id}`
return this.notification.data.chat_thread_id?e+=`/t/${this.notification.data.chat_thread_id}`:e+=`/${this.notification.data.chat_message_id}`,(0,a.default)(e)}get linkTitle(){return n.default.t("notifications.titles.chat_mention")}get icon(){return"d-chat"}get label(){return(0,s.formatUsername)(this.notification.data.mentioned_by_username)}get description(){const e=this.notification.data.identifier?`@${this.notification.data.identifier}`:null,t=this.notification.data.is_direct_message_channel?"notifications.popup.direct_message_chat_mention":"notifications.popup.chat_mention",s=e?"other_plain":"direct"
return n.default.t(`${t}.${s}`,{identifier:e,channel:this.notification.data.chat_channel_title})}})),t.registerNotificationTypeRenderer("chat_watched_thread",(e=>class extends e{icon="discourse-threads"
linkTitle=(()=>n.default.t("notifications.titles.chat_watched_thread"))()
description=this.notification.data.description
get label(){const e=this.notification.data
return e.user_ids.length>2?n.default.t("notifications.chat_watched_thread_label",{username:(0,s.formatUsername)(e.username2),count:e.user_ids.length-1}):2===e.user_ids.length?n.default.t("notifications.chat_watched_thread_label",{username:(0,s.formatUsername)(e.username2),username2:(0,s.formatUsername)(e.username),count:1}):(0,s.formatUsername)(e.username)}get linkHref(){const e=this.notification.data
return(0,a.default)(`/chat/c/-/${e.chat_channel_id}/t/${e.chat_thread_id}/${e.chat_message_id}`)}}))),t.registerUserMenuTab&&t.registerUserMenuTab((e=>class extends e{get id(){return"chat-notifications"}get panelComponent(){return"user-menu/chat-notifications-list"}get icon(){return"d-chat"}get count(){return this.getUnreadCountForType("chat_mention")+this.getUnreadCountForType("chat_invitation")+this.getUnreadCountForType("chat_watched_thread")}get notificationTypes(){return["chat_invitation","chat_mention","chat_message","chat_quoted","chat_watched_thread"]}})))}))}}})),define("discourse/plugins/chat/discourse/initializers/chat-user-options",["exports","discourse/lib/plugin-api"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-user-options",initialize(e){(0,t.withPluginApi)("0.11.0",(t=>{e.lookup("service:site-settings").chat_enabled&&(t.addSaveableUserOptionField("chat_enabled"),t.addSaveableUserOptionField("only_chat_push_notifications"),t.addSaveableUserOptionField("ignore_channel_wide_mention"),t.addSaveableUserOptionField("show_thread_title_prompts"),t.addSaveableUserOptionField("chat_sound"),t.addSaveableUserOptionField("chat_email_frequency"),t.addSaveableUserOptionField("chat_header_indicator_preference"),t.addSaveableUserOptionField("chat_separate_sidebar_mode"))}))}}})),define("discourse/plugins/chat/discourse/lib/chat-channel-subscription-manager",["exports","@glimmer/tracking","@ember/owner","@ember/service","discourse-common/lib/object","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-thread-preview"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c{static#e=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelNoticesManager",[a.service]))()
#zs=(()=>{dt7948.i(this,"chatChannelNoticesManager")})()
static#n=(()=>dt7948.g(this.prototype,"messageBus",[a.service]))()
#te=(()=>{dt7948.i(this,"messageBus")})()
static#r=(()=>dt7948.g(this.prototype,"channel",[t.tracked]))()
#Ws=(()=>{dt7948.i(this,"channel")})()
constructor(e,t){let{onNewMessage:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,s.setOwner)(this,(0,s.getOwner)(e)),this.channel=t,this.onNewMessage=a,this.messageBus.subscribe(this.messageBusChannel,this.onMessage,this.channel.channelMessageBusLastId)}get messagesManager(){return this.channel.messagesManager}get messageBusChannel(){return`/chat/${this.channel.id}`}teardown(){this.messageBus.unsubscribe(this.messageBusChannel,this.onMessage)}onMessage(e,t,s,a){switch(e.type){case"sent":this.handleSentMessage(e)
break
case"reaction":this.handleReactionMessage(e)
break
case"processed":this.handleProcessedMessage(e)
break
case"edit":this.handleEditMessage(e)
break
case"refresh":this.handleRefreshMessage(e)
break
case"delete":this.handleDeleteMessage(e)
break
case"bulk_delete":this.handleBulkDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)
break
case"self_flagged":this.handleSelfFlaggedMessage(e)
break
case"flag":this.handleFlaggedMessage(e)
break
case"thread_created":this.handleNewThreadCreated(e)
break
case"update_thread_original_message":this.handleThreadOriginalMessageUpdate(e)
break
case"notice":this.handleNotice(e)}this.channel.channelMessageBusLastId=a}static#c=(()=>dt7948.n(this.prototype,"onMessage",[i.bind]))()
handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if(this.handleStagedMessage(this.channel,this.messagesManager,e))return}const t=r.default.create(this.channel,e.chat_message)
t.manager=this.channel.messagesManager,this.onNewMessage?.(t),this.channel.lastMessage=t}handleStagedMessage(e,t,s){const a=t.findStagedMessage(s.staged_id)
if(a)return a.error=null,a.id=s.chat_message.id,a.staged=!1,a.excerpt=s.chat_message.excerpt,a.channel=e,a.createdAt=new Date(s.chat_message.created_at),a.cooked=s.chat_message.cooked,a}handleProcessedMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.cooked=e.chat_message.cooked,t.uploads=(0,n.cloneJSON)(e.chat_message.uploads||[]),t.processed=!0,t.incrementVersion())}handleReactionMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&t.react(e.emoji,e.action,e.user,this.currentUser.id)}handleEditMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.message=e.chat_message.message,t.cooked=e.chat_message.cooked,t.excerpt=e.chat_message.excerpt,t.uploads=(0,n.cloneJSON)(e.chat_message.uploads||[]),t.edited=e.chat_message.edited,t.streaming=e.chat_message.streaming)}handleRefreshMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&t.incrementVersion()}handleBulkDeleteMessage(e){e.deleted_ids.forEach((t=>{this.handleDeleteMessage({deleted_id:t,deleted_at:e.deleted_at})}))}handleDeleteMessage(e){const t=e.deleted_id,s=this.messagesManager.findMessage(t)
s&&(this.currentUser.staff||this.currentUser.id===s.user.id?(s.deletedAt=e.deleted_at,s.deletedById=e.deleted_by_id,s.expanded=!1):this.messagesManager.removeMessage(s),this.channel.currentUserMembership.lastReadMessageId===s.id&&(this.channel.currentUserMembership.lastReadMessageId=e.latest_not_deleted_message_id))}handleRestoreMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
if(t)t.deletedAt=null
else{const t=r.default.create(this.channel,e.chat_message)
t.manager=this.messagesManager,this.messagesManager.addMessages([t])}}handleSelfFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.userFlagStatus=e.user_flag_status)}handleFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.reviewableId=e.reviewable_id)}handleNewThreadCreated(e){this.channel.threadsManager.find(this.channel.id,e.thread_id,{fetchIfNotFound:!0}).then((e=>{const t=this.channel.messagesManager.findMessage(e.originalMessage.id)
t&&(t.thread=e)}))}handleNotice(e){this.chatChannelNoticesManager.handleNotice(e)}handleThreadOriginalMessageUpdate(e){const t=this.messagesManager.findMessage(e.original_message_id)
t?.thread&&(t.thread.preview?t.thread.preview.update(e.preview):t.thread.preview=o.default.create(e.preview))}}e.default=c})),define("discourse/plugins/chat/discourse/lib/chat-channel-thread-subscription-manager",["exports","@glimmer/tracking","@ember/owner","@ember/service","discourse-common/lib/object","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static#e=(()=>dt7948.g(this.prototype,"currentUser",[a.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"messageBus",[a.service]))()
#te=(()=>{dt7948.i(this,"messageBus")})()
static#n=(()=>dt7948.g(this.prototype,"channel",[t.tracked]))()
#Ws=(()=>{dt7948.i(this,"channel")})()
constructor(e,t){let{onNewMessage:a}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};(0,s.setOwner)(this,(0,s.getOwner)(e)),this.thread=t,this.onNewMessage=a,this.messageBus.subscribe(this.messageBusChannel,this.onMessage,this.thread.channelMessageBusLastId)}get messagesManager(){return this.thread.messagesManager}get messageBusChannel(){return`/chat/${this.thread.channel.id}/thread/${this.thread.id}`}teardown(){this.messageBus.unsubscribe(this.messageBusChannel,this.onMessage)}onMessage(e,t,s,a){switch(e.type){case"sent":this.handleSentMessage(e)
break
case"reaction":this.handleReactionMessage(e)
break
case"processed":this.handleProcessedMessage(e)
break
case"edit":this.handleEditMessage(e)
break
case"refresh":this.handleRefreshMessage(e)
break
case"delete":this.handleDeleteMessage(e)
break
case"bulk_delete":this.handleBulkDeleteMessage(e)
break
case"restore":this.handleRestoreMessage(e)
break
case"self_flagged":this.handleSelfFlaggedMessage(e)
break
case"flag":this.handleFlaggedMessage(e)
break
case"thread_created":this.handleNewThreadCreated(e)}this.thread.threadMessageBusLastId=a}static#r=(()=>dt7948.n(this.prototype,"onMessage",[i.bind]))()
handleSentMessage(e){if(e.chat_message.user.id===this.currentUser.id&&e.staged_id){if(this.handleStagedMessage(this.thread.channel,this.messagesManager,e))return}const t=r.default.create(this.thread.channel,e.chat_message)
t.thread=this.thread,t.manager=this.messagesManager,this.onNewMessage?.(t)}handleStagedMessage(e,t,s){const a=t.findStagedMessage(s.staged_id)
if(a)return a.error=null,a.id=s.chat_message.id,a.staged=!1,a.excerpt=s.chat_message.excerpt,a.channel=e,a.createdAt=new Date(s.chat_message.created_at),a}handleProcessedMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.cooked=e.chat_message.cooked,t.uploads=(0,n.cloneJSON)(e.chat_message.uploads||[]),t.processed=!0,t.incrementVersion())}handleReactionMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&t.react(e.emoji,e.action,e.user,this.currentUser.id)}handleEditMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&(t.excerpt=e.chat_message.excerpt,t.uploads=(0,n.cloneJSON)(e.chat_message.uploads||[]),t.edited=e.chat_message.edited,t.streaming=e.chat_message.streaming)}handleRefreshMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
t&&t.incrementVersion()}handleBulkDeleteMessage(e){e.deleted_ids.forEach((t=>{this.handleDeleteMessage({deleted_id:t,deleted_at:e.deleted_at})}))}handleDeleteMessage(e){const t=e.deleted_id,s=this.messagesManager.findMessage(t)
s&&(this.currentUser.staff||this.currentUser.id===s.user.id?(s.deletedAt=e.deleted_at,s.deletedById=e.deleted_by_id,s.expanded=!1):this.messagesManager.removeMessage(s),this.thread.currentUserMembership?.lastReadMessageId===s.id&&(this.thread.currentUserMembership.lastReadMessageId=e.latest_not_deleted_message_id))}handleRestoreMessage(e){const t=this.messagesManager.findMessage(e.chat_message.id)
if(t)t.deletedAt=null
else{const t=r.default.create(this.model,e.chat_message)
t.manager=this.messagesManager,this.messagesManager.addMessages([t])}}handleSelfFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.userFlagStatus=e.user_flag_status)}handleFlaggedMessage(e){const t=this.messagesManager.findMessage(e.chat_message_id)
t&&(t.reviewableId=e.reviewable_id)}handleNewThreadCreated(e){this.thread.threadsManager.find(this.thread.id,e.thread_id,{fetchIfNotFound:!0}).then((e=>{const t=this.thread.messagesManager.findMessage(e.originalMessage.id)
t&&(t.thread=e)}))}}e.default=o})),define("discourse/plugins/chat/discourse/lib/chat-composer-buttons",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.chatComposerButtons=function(e,i,r){return Object.values(s).filter((t=>{let s=a(e,t,"displayed")&&a(e,t,"position")===i
return t.context&&(s=s&&a(e,t,"context")===r),s})).map((s=>{const i={id:s.id},o=a(e,s,"label")
i.label=o||a(e,s,"translatedLabel")
const c=a(e,s,"ariaLabel")
if(c)i.ariaLabel=t.default.t(c)
else{const t=a(e,s,"translatedAriaLabel")
i.ariaLabel=t||i.label}const l=a(e,s,"title")
if(i.title=l?t.default.t(l):a(e,s,"translatedTitle"),i.classNames=(a(e,s,"classNames")||[]).join(" "),i.icon=a(e,s,"icon"),i.disabled=a(e,s,"disabled"),i.priority=a(e,s,"priority"),n(s.action))i.action=()=>{s.action.apply(e,[r])}
else{const t=s.action
i.action=()=>{e[t](r)}}return i}))},e.chatComposerButtonsDependentKeys=function(){return[].concat(...Object.values(s).mapBy("dependentKeys").filter(Boolean))},e.clearChatComposerButtons=function(){s=[]},e.registerChatComposerButton=function(e){if(!e.id)throw new Error("Attempted to register a chat composer button with no id.")
if(s[e.id])return
const t=Object.assign({id:null,action:null,icon:null,title:null,translatedTitle:null,label:null,translatedLabel:null,ariaLabel:null,translatedAriaLabel:null,position:"inline",classNames:[],dependentKeys:[],displayed:!0,disabled:!1,priority:0},e)
if(!t.icon&&!t.label&&!t.translatedLabel)throw new Error(`Attempted to register a chat composer button: ${e.id} with no icon or label.`)
s[t.id]=t}
let s={}
function a(e,t,s){const a=t[s]
return n(a)?a.apply(e):a}function n(e){return e&&"function"==typeof e}})),define("discourse/plugins/chat/discourse/lib/chat-constants",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.THREAD_TITLE_PROMPT_THRESHOLD=e.READ_INTERVAL_MS=e.PAST=e.INDICATOR_PREFERENCES=e.FUTURE=e.FOOTER_NAV_ROUTES=e.DEFAULT_MESSAGE_PAGE_SIZE=void 0
e.PAST="past",e.FUTURE="future",e.READ_INTERVAL_MS=1e3,e.DEFAULT_MESSAGE_PAGE_SIZE=50,e.THREAD_TITLE_PROMPT_THRESHOLD=5,e.FOOTER_NAV_ROUTES=["chat.direct-messages","chat.channels","chat.threads"],e.INDICATOR_PREFERENCES={all_new:"all_new",dm_and_mentions:"dm_and_mentions",only_mentions:"only_mentions",never:"never"}}))
define("discourse/plugins/chat/discourse/lib/chat-ios-hacks",["exports","@ember/runloop","discourse/services/capabilities","discourse-common/lib/later"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.stackingContextFix=function(e,n){s.capabilities.isIOS&&(e.style.overflow="hidden",e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="1")))
n?.(),s.capabilities.isIOS&&(0,t.next)((()=>{(0,t.schedule)("afterRender",(()=>{e.style.overflow="auto",(0,a.default)((()=>{e&&e.querySelectorAll(".chat-message-separator__text-container").forEach((e=>e.style.zIndex="2"))}),50)}))}))}})),define("discourse/plugins/chat/discourse/lib/chat-message-container",["exports","discourse/plugins/chat/discourse/components/chat-message"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e,s){let a
a=s===t.MESSAGE_CONTEXT_THREAD?`.chat-thread .chat-message-container[data-id="${e}"]`:`.chat-channel .chat-message-container[data-id="${e}"]`
return document.querySelector(a)}})),define("discourse/plugins/chat/discourse/lib/chat-message-flag",["exports","@ember/owner","@ember/service","discourse/lib/ajax-error","discourse-common/lib/get-url","discourse-i18n"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r{static#e=(()=>dt7948.g(this.prototype,"chatApi",[s.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
constructor(e){(0,t.setOwner)(this,e)}title(){return"flagging.title"}customSubmitLabel(){return"flagging.notify_action"}submitLabel(){return"chat.flagging.action"}targetsTopic(){return!1}editable(){return!1}_rewriteFlagDescriptions(e){return e.map((e=>(e.set("description",i.default.t(`chat.flags.${e.name_key}`,{basePath:(0,n.default)(""),defaultValue:e.description})),e)))}flagsAvailable(e){let t=e.site.flagTypes
t=t.filter((t=>e.args.model.flagModel.availableFlags.includes(t.name_key)&&t.applies_to.includes("Chat::Message")))
const s=t.indexOf(t.filterBy("name_key","notify_user")[0])
if(-1!==s){const e=t[s]
t.splice(s,1),t.splice(0,0,e)}return this._rewriteFlagDescriptions(t)}async create(e,t){e.args.closeModal()
const s=e.args.model.flagModel.channel.id,n=e.args.model.flagModel.id
try{await this.chatApi.flagMessage(s,n,{flag_type_id:e.selected.id,message:t.message,is_warning:t.isWarning,take_action:t.takeAction,queue_for_review:t.queue_for_review})}catch(i){(0,a.popupAjaxError)(i)}}}e.default=r})),define("discourse/plugins/chat/discourse/lib/chat-message-interactor",["exports","@glimmer/tracking","@ember/object","@ember/owner","@ember/service","discourse/components/modal/bookmark","discourse/components/modal/flag","discourse/lib/ajax-error","discourse/lib/bookmark-form-data","discourse/lib/utilities","discourse/models/bookmark","discourse-common/lib/get-url","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-message-flag","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-reaction"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p,m,g,f,_){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0,e.removeChatComposerSecondaryActions=function(e){e.forEach((e=>b.add(e)))},e.resetRemovedChatComposerSecondaryActions=function(){b.clear()}
const b=new Set
class v{static#e=(()=>dt7948.g(this.prototype,"appEvents",[n.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#s=(()=>dt7948.g(this.prototype,"dialog",[n.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#r=(()=>dt7948.g(this.prototype,"chatEmojiReactionStore",[n.service]))()
#ze=(()=>{dt7948.i(this,"chatEmojiReactionStore")})()
static#c=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[n.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#l=(()=>dt7948.g(this.prototype,"chatChannelComposer",[n.service]))()
#As=(()=>{dt7948.i(this,"chatChannelComposer")})()
static#d=(()=>dt7948.g(this.prototype,"chatThreadComposer",[n.service]))()
#Ct=(()=>{dt7948.i(this,"chatThreadComposer")})()
static#h=(()=>dt7948.g(this.prototype,"chatChannelPane",[n.service]))()
#ut=(()=>{dt7948.i(this,"chatChannelPane")})()
static#u=(()=>dt7948.g(this.prototype,"chatThreadPane",[n.service]))()
#pt=(()=>{dt7948.i(this,"chatThreadPane")})()
static#p=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#j=(()=>dt7948.g(this.prototype,"currentUser",[n.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#P=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#O=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#D=(()=>dt7948.g(this.prototype,"modal",[n.service]))()
#a=(()=>{dt7948.i(this,"modal")})()
static#I=(()=>dt7948.g(this.prototype,"capabilities",[n.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#R=(()=>dt7948.g(this.prototype,"toasts",[n.service]))()
#mt=(()=>{dt7948.i(this,"toasts")})()
static#N=(()=>dt7948.g(this.prototype,"message",[t.tracked],(function(){return null})))()
#$s=(()=>{dt7948.i(this,"message")})()
static#B=(()=>dt7948.g(this.prototype,"context",[t.tracked],(function(){return null})))()
#Vs=(()=>{dt7948.i(this,"context")})()
cachedFavoritesReactions=null
constructor(e,t,s){(0,a.setOwner)(this,e),this.message=t,this.context=s,this.cachedFavoritesReactions=this.chatEmojiReactionStore.favorites}get pane(){return this.context===m.MESSAGE_CONTEXT_THREAD?this.chatThreadPane:this.chatChannelPane}get emojiReactions(){let e=this.cachedFavoritesReactions
return e&&e.slice?e.slice(0,3).map((e=>this.message.reactions.find((t=>t.emoji===e))||_.default.create({emoji:e}))):[]}get canEdit(){return!this.message.deletedAt&&this.currentUser.id===this.message.user.id&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canInteractWithMessage(){return!this.message?.deletedAt&&this.message?.channel?.canModifyMessages(this.currentUser)}get canRestoreMessage(){return this.message?.deletedAt&&(this.currentUser.staff||this.message?.user?.id===this.currentUser.id&&this.message?.deletedById===this.currentUser.id)&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canBookmark(){return this.message?.channel?.canModifyMessages?.(this.currentUser)}get canReply(){return this.canInteractWithMessage&&this.context!==m.MESSAGE_CONTEXT_THREAD}get canReact(){return this.canInteractWithMessage}get canFlagMessage(){return this.currentUser.id!==this.message?.user?.id&&void 0===this.message?.userFlagStatus&&this.message.channel?.canFlag&&!this.message?.chatWebhookEvent&&!this.message?.deletedAt}get canRebakeMessage(){return this.currentUser.staff&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDeleteMessage(){return this.canDelete&&!this.message?.deletedAt&&this.message.channel?.canModifyMessages?.(this.currentUser)}get canDelete(){return this.currentUser.id===this.message.user.id?this.message.channel?.canDeleteSelf:this.message.channel?.canDeleteOthers}get composer(){return this.context===m.MESSAGE_CONTEXT_THREAD?this.chatThreadComposer:this.chatChannelComposer}get secondaryActions(){const e=[]
return e.push({id:"copyLink",name:p.default.t("chat.copy_link"),icon:"link"}),this.site.mobileView&&e.push({id:"copyText",name:p.default.t("chat.copy_text"),icon:"clipboard"}),this.canEdit&&e.push({id:"edit",name:p.default.t("chat.edit"),icon:"pencil"}),this.pane.selectingMessages||e.push({id:"select",name:p.default.t("chat.select"),icon:"list-check"}),this.canFlagMessage&&e.push({id:"flag",name:p.default.t("chat.flag"),icon:"flag"}),this.canDeleteMessage&&e.push({id:"delete",name:p.default.t("chat.delete"),icon:"trash-can"}),this.canRestoreMessage&&e.push({id:"restore",name:p.default.t("chat.restore"),icon:"arrow-rotate-left"}),this.canRebakeMessage&&e.push({id:"rebake",name:p.default.t("chat.rebake_message"),icon:"rotate"}),e.reject((e=>b.has(e.id)))}select(){let e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0]
this.message.selected=e,this.pane.onSelectMessage(this.message)}bulkSelect(e){const t=this.message.manager,s=[t.findIndexOfMessage(this.pane.lastSelectedMessage.id),t.findIndexOfMessage(this.message.id)].sort(((e,t)=>e-t))
for(let a=s[0];a<=s[1];a++)t.messages[a].selected=e}copyText(){(0,l.clipboardCopy)(this.message.message),this.toasts.success({duration:3e3,data:{message:p.default.t("chat.text_copied")}})}copyLink(){const{protocol:e,host:t}=window.location,s=this.message.channel.id,a=this.message.thread?.id
let n
n=this.context===m.MESSAGE_CONTEXT_THREAD&&a?(0,h.default)(`/chat/c/-/${s}/t/${a}/${this.message.id}`):(0,h.default)(`/chat/c/-/${s}/${this.message.id}`),n=0===n.indexOf("/")?e+"//"+t+n:n,(0,l.clipboardCopy)(n),this.toasts.success({duration:1500,data:{message:p.default.t("chat.link_copied")}})}react(e,t){if(this.chat.userCanInteractWithChat&&!this.pane.reacting)return this.capabilities.userHasBeenActive&&this.capabilities.canVibrate&&navigator.vibrate(5),this.site.mobileView&&(this.chat.activeMessage=null),t===_.REACTIONS.add&&this.chatEmojiReactionStore.track(`:${e}:`),this.pane.reacting=!0,this.message.react(e,t,this.currentUser,this.currentUser.id),this.chatApi.publishReaction(this.message.channel.id,this.message.id,e,t).catch((t=>{(0,o.popupAjaxError)(t),this.message.react(e,_.REACTIONS.remove,this.currentUser,this.currentUser.id)})).finally((()=>{this.pane.reacting=!1}))}static#H=(()=>dt7948.n(this.prototype,"react",[s.action]))()
toggleBookmark(){this.modal.show(i.default,{model:{bookmark:new c.BookmarkFormData(this.message.bookmark||d.default.createFor(this.currentUser,"Chat::Message",this.message.id)),afterSave:e=>{const t=d.default.create(e.saveData)
this.message.bookmark=t,this.appEvents.trigger("bookmarks:changed",e.saveData,t.attachedTo())},afterDelete:()=>{this.message.bookmark=null}}})}static#z=(()=>dt7948.n(this.prototype,"toggleBookmark",[s.action]))()
flag(){const e=new f.default(this.message.channel,this.message)
e.username=this.message.user?.username,e.user_id=this.message.user?.id,this.modal.show(r.default,{model:{flagTarget:new g.default((0,a.getOwner)(this)),flagModel:e,setHidden:()=>e.set("hidden",!0)}})}static#ne=(()=>dt7948.n(this.prototype,"flag",[s.action]))()
delete(){return this.chatApi.trashMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}static#re=(()=>dt7948.n(this.prototype,"delete",[s.action]))()
restore(){return this.chatApi.restoreMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}static#ce=(()=>dt7948.n(this.prototype,"restore",[s.action]))()
rebake(){return this.chatApi.rebakeMessage(this.message.channel.id,this.message.id).catch(o.popupAjaxError)}static#de=(()=>dt7948.n(this.prototype,"rebake",[s.action]))()
reply(){this.composer.replyTo(this.message)}static#ue=(()=>dt7948.n(this.prototype,"reply",[s.action]))()
edit(){this.composer.edit(this.message)}static#me=(()=>dt7948.n(this.prototype,"edit",[s.action]))()
openEmojiPicker(e,t){let{target:s}=t
const a={didSelectEmoji:this.selectReaction,trigger:s,context:"chat-channel-message"}
this.chatEmojiPickerManager.open(a)}static#ge=(()=>dt7948.n(this.prototype,"openEmojiPicker",[s.action]))()
selectReaction(e){this.chat.userCanInteractWithChat&&this.react(e,_.REACTIONS.add)}static#_e=(()=>dt7948.n(this.prototype,"selectReaction",[u.bind]))()
handleSecondaryActions(e){this[e](this.message)}static#be=(()=>dt7948.n(this.prototype,"handleSecondaryActions",[s.action]))()}e.default=v})),define("discourse/plugins/chat/discourse/lib/chat-messages-loader",["exports","@glimmer/tracking","@ember/owner","@ember/service","discourse/lib/ajax-error","discourse/plugins/chat/discourse/lib/chat-constants","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static#e=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"loading",[t.tracked],(function(){return!1})))()
#Vt=(()=>{dt7948.i(this,"loading")})()
static#n=(()=>dt7948.g(this.prototype,"canLoadMorePast",[t.tracked],(function(){return!1})))()
#qs=(()=>{dt7948.i(this,"canLoadMorePast")})()
static#r=(()=>dt7948.g(this.prototype,"canLoadMoreFuture",[t.tracked],(function(){return!1})))()
#Gs=(()=>{dt7948.i(this,"canLoadMoreFuture")})()
static#c=(()=>dt7948.g(this.prototype,"fetchedOnce",[t.tracked],(function(){return!1})))()
#Ks=(()=>{dt7948.i(this,"fetchedOnce")})()
constructor(e,t){(0,s.setOwner)(this,e),this.model=t}get loadedPast(){return!1===this.canLoadMorePast&&this.fetchedOnce}async loadMore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(!1===this.canLoadMoreFuture&&e.direction===i.FUTURE)return
if(!1===this.canLoadMorePast&&e.direction===i.PAST)return
const t=this.#Js(e.direction,this.model)
let s
e={direction:e.direction,page_size:i.DEFAULT_MESSAGE_PAGE_SIZE,target_message_id:t?.id},e=this.#Ys(e)
try{this.loading=!0,s=await this.#Zs(e),this.canLoadMoreFuture=s.meta.can_load_more_future,this.canLoadMorePast=s.meta.can_load_more_past}catch(a){(0,n.popupAjaxError)(a)}finally{this.loading=!1}return s}async load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.canLoadMorePast=!0,this.canLoadMoreFuture=!0,this.fetchedOnce=!1,this.loading=!0,t.page_size??=i.DEFAULT_MESSAGE_PAGE_SIZE,t=this.#Ys(t)
try{e=await this.#Zs(t),this.canLoadMoreFuture=e.meta.can_load_more_future,this.canLoadMorePast=e.meta.can_load_more_past,this.fetchedOnce=!0}catch(s){(0,n.popupAjaxError)(s)}finally{this.loading=!1}return e}#Zs(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return this.model instanceof r.default?this.chatApi.channelMessages(this.model.id,e):this.chatApi.channelThreadMessages(this.model.channel.id,this.model.id,e)}#Ys(e){return Object.keys(e).filter((t=>null!=e[t])).reduce(((t,s)=>({...t,[s]:e[s]})),{})}#Js(e,t){return e===i.PAST?t.messagesManager.messages.find((e=>!e.staged)):t.messagesManager.messages.findLast((e=>!e.staged))}}e.default=o})),define("discourse/plugins/chat/discourse/lib/chat-messages-manager",["exports","@glimmer/tracking","@ember/owner"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a{static#e=(()=>dt7948.g(this.prototype,"messages",[t.tracked],(function(){return[]})))()
#Xs=(()=>{dt7948.i(this,"messages")})()
constructor(e){(0,s.setOwner)(this,e)}get stagedMessages(){return this.messages.filterBy("staged")}static#s=(()=>dt7948.n(this.prototype,"stagedMessages",[t.cached]))()
get selectedMessages(){return this.messages.filterBy("selected")}static#n=(()=>dt7948.n(this.prototype,"selectedMessages",[t.cached]))()
clearSelectedMessages(){this.selectedMessages.forEach((e=>e.selected=!1))}clear(){this.messages=[]}addMessages(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
this.messages=this.messages.concat(e).uniqBy("id").sort(((e,t)=>e.createdAt-t.createdAt))}findMessage(e){return this.messages.find((t=>t.id===parseInt(e,10)))}findFirstMessageOfDay(e){return this.messages.find((t=>e.getFullYear()===t.createdAt.getFullYear()&&e.getMonth()===t.createdAt.getMonth()&&e.getDate()===t.createdAt.getDate()))}removeMessage(e){return this.messages.removeObject(e)}findStagedMessage(e){return this.stagedMessages.find((t=>t.id===e))}findIndexOfMessage(e){return this.messages.findIndex((t=>t.id===e))}findLastMessage(){return this.messages.findLast((e=>!e.deletedAt))}findLastUserMessage(e){return this.messages.findLast((t=>t.user.id===e.id&&!t.deletedAt))}}e.default=a})),define("discourse/plugins/chat/discourse/lib/chat-notification-levels",["exports","discourse/lib/notification-levels"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.threadNotificationButtonLevels=void 0
e.threadNotificationButtonLevels=[t.NotificationLevels.WATCHING,t.NotificationLevels.TRACKING,t.NotificationLevels.REGULAR].map(t.buttonDetails)})),define("discourse/plugins/chat/discourse/lib/chat-threads-manager",["exports","@glimmer/tracking","@ember/owner","@ember/service","@ember-compat/tracked-built-ins","rsvp","discourse/plugins/chat/discourse/models/chat-thread"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static#e=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[a.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[a.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatApi",[a.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#r=(()=>dt7948.g(this.prototype,"_cached",[t.tracked],(function(){return new n.TrackedObject})))()
#Qs=(()=>{dt7948.i(this,"_cached")})()
static#c=(()=>dt7948.g(this.prototype,"_unreadThreadOverview",[t.tracked],(function(){return new n.TrackedMap})))()
#ea=(()=>{dt7948.i(this,"_unreadThreadOverview")})()
constructor(e){(0,s.setOwner)(this,e)}get unreadThreadCount(){return this.unreadThreadOverview.size}get unreadThreadOverview(){return this._unreadThreadOverview}set unreadThreadOverview(e){this._unreadThreadOverview.clear()
for(const[t,s]of Object.entries(e))this.markThreadUnread(t,s)}markThreadUnread(e,t){this.unreadThreadOverview.set(parseInt(e,10),new Date(t))}get threads(){return Object.values(this._cached)}static#l=(()=>dt7948.n(this.prototype,"threads",[t.cached]))()
async find(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{fetchIfNotFound:!0}
const a=this.#ta(t)
return a?i.default.resolve(a):s.fetchIfNotFound?this.#sa(e,t):i.default.resolve()}remove(e){delete this._cached[e.id]}add(e,t){let s
return(arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}).replace||(s=this.#ta(t.id)),s||(s=t instanceof r.default?t:r.default.create(e,t),this.#aa(s)),t?.meta?.message_bus_last_ids?.thread_message_bus_last_id&&(s.threadMessageBusLastId=t.meta.message_bus_last_ids.thread_message_bus_last_id),s}#aa(e){this._cached[e.id]=e}#ta(e){return this._cached[e]}async#sa(e,t){return this.chatApi.thread(e,t).then((t=>this.chatChannelsManager.find(e).then((e=>e.threadsManager.add(e,t.thread)))))}}e.default=o})),define("discourse/plugins/chat/discourse/lib/chat-user-preferences",["exports","discourse/plugins/chat/discourse/controllers/preferences-chat"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.hasChatIndicator=function(e){const s=e.user_option.chat_header_indicator_preference
return{ALL_NEW:s===t.HEADER_INDICATOR_PREFERENCE_ALL_NEW,DM_AND_MENTIONS:s===t.HEADER_INDICATOR_PREFERENCE_DM_AND_MENTIONS,ONLY_MENTIONS:s===t.HEADER_INDICATOR_PREFERENCE_ONLY_MENTIONS,NEVER:s===t.HEADER_INDICATOR_PREFERENCE_NEVER}}})),define("discourse/plugins/chat/discourse/lib/check-message-visibility",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.checkMessageBottomVisibility=function(e,t){const s=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().bottom-s<=e.clientHeight+1},e.checkMessageTopVisibility=function(e,t){const s=window.pageYOffset+e.getBoundingClientRect().top
return t.getBoundingClientRect().top-s>=-1}})),define("discourse/plugins/chat/discourse/lib/collection",["exports","@glimmer/tracking","rsvp","discourse/lib/ajax","discourse-common/utils/decorators"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i{static#e=(()=>dt7948.g(this.prototype,"items",[t.tracked],(function(){return[]})))()
#na=(()=>{dt7948.i(this,"items")})()
static#s=(()=>dt7948.g(this.prototype,"meta",[t.tracked],(function(){return{}})))()
#ia=(()=>{dt7948.i(this,"meta")})()
static#n=(()=>dt7948.g(this.prototype,"loading",[t.tracked],(function(){return!1})))()
#Vt=(()=>{dt7948.i(this,"loading")})()
static#r=(()=>dt7948.g(this.prototype,"fetchedOnce",[t.tracked],(function(){return!1})))()
#Ks=(()=>{dt7948.i(this,"fetchedOnce")})()
constructor(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
this._resourceURL=e,this._handler=t,this._params=s,this._fetchedAll=!1}get loadMoreURL(){return this.meta?.load_more_url}get totalRows(){return this.meta?.total_rows}get length(){return this.items?.length}[Symbol.iterator](){let e=0
return{next:()=>e<this.length?{value:this.items[e++],done:!1}:{done:!0}}}load(){let e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
if(this.loading||this._fetchedAll||this.totalRows&&this.items.length>=this.totalRows)return s.Promise.resolve()
if(this.loading=!0,this.loadMoreURL)e=this.loadMoreURL
else{const s=Object.entries(t).filter((e=>{let[,t]=e
return void 0!==t})),a=new URLSearchParams(s).toString()
e=this._resourceURL+(a?`?${a}`:"")}return this.#ra(e).then((e=>{const s=this._handler(e)
s.length&&(this.items=(this.items??[]).concat(s)),(!s.length||s.length<t.limit)&&(this._fetchedAll=!0),this.meta=e.meta,this.fetchedOnce=!0})).finally((()=>{this.loading=!1}))}static#c=(()=>dt7948.n(this.prototype,"load",[n.bind]))()
#ra(e){return(0,a.ajax)(e,{type:"GET",data:this._params})}}e.default=i})),define("discourse/plugins/chat/discourse/lib/dates-separators-positioner",["exports","@ember/runloop"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=class{static apply(e){(0,t.schedule)("afterRender",(()=>{const t=[...e.querySelectorAll(".chat-message-separator-date")].reverse(),s=e.querySelector(".chat-messages-container").clientHeight
t.map(((e,a)=>{const n={bottom:0,date:e},i=e.nextElementSibling
if(a>0){const e=t[a-1].nextElementSibling
n.bottom=s-e.offsetTop}if(1===t.length)n.height=s
else if(0===a)n.height=s-i.offsetTop
else{const e=t[a-1].nextElementSibling
n.height=s-i.offsetTop-(s-e.offsetTop)}return n})).forEach((e=>{e.date.style.bottom=e.bottom+"px",e.date.style.height=e.height+"px"}))}))}}})),define("discourse/plugins/chat/discourse/lib/extract-current-topic-info",["exports","@ember/owner"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.extractCurrentTopicInfo=function(e){const s=(0,t.getOwner)(e).lookup("controller:topic")?.model
if(!s)return
const a={context_topic_id:s.id},n=s.currentPost,i=s.postStream.posts,r=i.find((e=>e.post_number===n)),o=i.findLast((e=>!e.hidden&&!e.deleted_at&&e.post_number<n)),c=i.find((e=>!e.hidden&&!e.deleted_at&&e.post_number>n))
return a.context_post_ids=[o?.id,r?.id,c?.id].filter(Boolean),a}})),define("discourse/plugins/chat/discourse/lib/fabricators",["exports","@ember/application/instance","@ember/owner","discourse/lib/fabricators","discourse/models/category","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-message-reaction","discourse/plugins/chat/discourse/models/chat-thread","discourse/plugins/chat/discourse/models/chat-thread-preview"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=class{constructor(e){if(e&&!(e instanceof t.default))throw new Error("First argument of ChatFabricators constructor must be the owning ApplicationInstance");(0,s.setOwner)(this,e),this.coreFabricators=new a.default(e)}message(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||this.channel(),s=o.default.create(t,Object.assign({id:e.id||(0,a.incrementSequence)(),user:e.user||this.coreFabricators.user(),message:e.message||"@discobot **abc**defghijklmnopqrstuvwxyz [discourse](discourse.org) :rocket: ",created_at:e.created_at||moment()},e)),n=s.message.toString()
return n.length<=50?s.excerpt=n:s.excerpt=n.slice(0,50)+"...",s}channel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.id||(0,a.incrementSequence)(),s=e.chatable||this.coreFabricators.category(),r=i.default.create({id:t,chatable_type:(s instanceof n.default?i.CHATABLE_TYPES.categoryChannel:i.CHATABLE_TYPES.directMessageChannel)||s?.type||e.chatable_type,chatable_id:s?.id||e.chatable_id,title:e.title?e.title:s instanceof n.default?s.name:null,description:e.description,chatable:s,status:e.status||i.CHANNEL_STATUSES.open,slug:s?.slug||s instanceof n.default?s.slug:null,meta:Object.assign({can_delete_self:!0},e.meta||{}),archive_failed:e.archive_failed??!1,memberships_count:e.memberships_count??0})
return r.lastMessage=this.message({channel:r}),r}directMessage(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return r.default.create({group:e.group??!1,users:e.users??[this.coreFabricators.user(),this.coreFabricators.user()]})}directMessageChannel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.chatable||this.directMessage({id:e.chatable_id||(0,a.incrementSequence)(),group:e.group??!1,users:e.users})
return this.channel(Object.assign(e,{chatable_type:i.CHATABLE_TYPES.directMessageChannel,chatable_id:t.id,chatable:t,memberships_count:t.users.length}))}thread(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
const t=e.channel||this.channel()
return l.default.create(t,{id:e.id||(0,a.incrementSequence)(),title:e.title,original_message:e.original_message||this.message({channel:t}),preview:e.preview||this.threadPreview({channel:t})})}threadPreview(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return d.default.create({last_reply_id:e.last_reply_id||(0,a.incrementSequence)(),last_reply_created_at:e.last_reply_created_at||Date.now(),last_reply_excerpt:e.last_reply_excerpt||"This is a reply",participant_count:e.participant_count??0,participant_users:e.participant_users??[]})}reaction(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return c.default.create({count:e.count??1,users:e.users||[this.coreFabricators.user()],emoji:e.emoji||"heart",reacted:e.reacted??!1})}}})),define("discourse/plugins/chat/discourse/lib/get-reaction-text",["exports","discourse-i18n"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.MAX_DISPLAYED_USERNAMES=void 0,e.getReactionText=function(e,s){if(0===e.count)return
return e.reacted?function(e,s){if(1===e.count)return t.default.t("chat.reactions.only_you",{emoji:e.emoji})
const i=a(e.users,s)
if(2===e.count)return t.default.t("chat.reactions.you_and_single_user",{emoji:e.emoji,username:i.pop()})
const r=e.count-i.length-1
if(r>0)return t.default.t("chat.reactions.you_multiple_users_and_more",{emoji:e.emoji,commaSeparatedUsernames:n(i),count:r})
return t.default.t("chat.reactions.you_and_multiple_users",{emoji:e.emoji,username:i.pop(),commaSeparatedUsernames:n(i)})}(e,s):function(e,s){const i=a(e.users,s)
if(1===e.count)return t.default.t("chat.reactions.single_user",{emoji:e.emoji,username:i.pop()})
const r=e.count-i.length
if(r>0)return t.default.t("chat.reactions.multiple_users_and_more",{emoji:e.emoji,commaSeparatedUsernames:n(i),count:r})
return t.default.t("chat.reactions.multiple_users",{emoji:e.emoji,username:i.pop(),commaSeparatedUsernames:n(i)})}(e,s)}
const s=e.MAX_DISPLAYED_USERNAMES=15
function a(e,t){return e.filter((e=>e.id!==t?.id)).slice(0,s).mapBy("username")}function n(e){return e.join(t.default.t("word_connector.comma"))}})),define("discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.getUserChatSeparateSidebarMode=function(e){let t=e?.get("user_option.chat_separate_sidebar_mode")
"default"===t&&(t=e.siteSettings.chat_separate_sidebar_mode)
return{never:"never"===t,always:"always"===t,fullscreen:"fullscreen"===t}}})),define("discourse/plugins/chat/discourse/lib/hashtag-types/channel",["exports","@ember/service","discourse/lib/hashtag-types/base","discourse-common/lib/icon-library"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#s=(()=>dt7948.g(this.prototype,"currentUser",[t.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#n=(()=>dt7948.g(this.prototype,"site",[t.service]))()
#b=(()=>{dt7948.i(this,"site")})()
get type(){return"channel"}get preloadedData(){return this.currentUser?this.chatChannelsManager.publicMessageChannels:[]}generateColorCssClasses(e){const t=e.colors?e.colors[0]:e.chatable.color
return[`.d-icon.hashtag-color--${this.type}-${e.id} { color: #${t} }`]}generateIconHTML(e){return e.colors?this.onLoad(e):this.load(e.id),(0,a.iconHTML)(e.icon,{class:`hashtag-color--${this.type}-${e.id}`})}isLoaded(e){return!this.site.lazy_load_categories||super.isLoaded(e)}}e.default=n})),define("discourse/plugins/chat/discourse/lib/init-sidebar-state",["exports","discourse/lib/sidebar/panels","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.CHAT_PANEL=void 0,e.initSidebarState=function(e,n){const i=(0,s.getUserChatSeparateSidebarMode)(n)
i.fullscreen?(e.setCombinedSidebarMode(),e.showSidebarSwitchPanelButtons()):i.always?e.setSeparatedSidebarMode():(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons())
if(e.getSidebarPanel()?.key!==t.MAIN_PANEL&&e.getSidebarPanel()?.key!==a)return
e.setSidebarPanel(t.MAIN_PANEL)}
const a=e.CHAT_PANEL="chat"})),define("discourse/plugins/chat/discourse/lib/scroll-helpers",["exports","@ember/runloop","discourse/plugins/chat/discourse/lib/chat-ios-hacks"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.scrollListToBottom=async function(e){await new Promise((a=>{(0,s.stackingContextFix)(e,(()=>{e.scrollTo({top:0,behavior:"auto"}),(0,t.next)(a)}))}))},e.scrollListToMessage=function(e,a){let n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{highlight:!1,position:"start",autoExpand:!1}
if(!a)return
a?.deletedAt&&n.autoExpand&&(a.expanded=!0);(0,t.schedule)("afterRender",(()=>{const t=e.querySelector(`.chat-message-container[data-id='${a.id}']`)
t&&(n.highlight&&a.highlight(),(0,s.stackingContextFix)(e,(()=>{t.scrollIntoView({behavior:"auto",block:n.position||"center"})})))}))},e.scrollListToTop=async function(e){await new Promise((a=>{(0,s.stackingContextFix)(e,(()=>{e.scrollTo({top:-e.scrollHeight,behavior:"auto"}),(0,t.next)(a)}))}))}})),define("discourse/plugins/chat/discourse/lib/slugify-channel",["exports","discourse/lib/utilities"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){if(e.slug)return e.slug
if(!e.escapedTitle&&!e.title)return"-"
const s=(0,t.slugify)(e.escapedTitle||e.title),a=(s.length?s:e.title.trim().toLowerCase().replace(/\s|_+/g,"-")).slice(0,100)
if(!a)return"-"
return a}})),define("discourse/plugins/chat/discourse/lib/textarea-interactor",["exports","@ember/destroyable","@ember/object","@ember/owner","@ember/runloop","@ember/service","discourse/mixins/textarea-text-manipulation"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends(s.default.extend(r.default)){static#e=(()=>dt7948.g(this.prototype,"capabilities",[i.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#s=(()=>dt7948.g(this.prototype,"site",[i.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[i.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
constructor(e,s){super(...arguments),(0,a.setOwner)(this,e),this.textarea=s,this._textarea=s,this.element=this._textarea,this.ready=!0,this.composerFocusSelector=`#${s.id}`,this.init(),this.composerEventPrefix=null,this.textarea.addEventListener("paste",this.paste),(0,t.registerDestructor)(this,(e=>e.teardown()))}teardown(){this.textarea.removeEventListener("paste",this.paste)}set value(e){this._textarea.value=e
const t=new Event("input",{bubbles:!0,cancelable:!0})
this._textarea.dispatchEvent(t)}blur(){(0,n.next)((()=>{(0,n.schedule)("afterRender",(()=>{this._textarea.blur()}))}))}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{ensureAtEnd:!1,refreshHeight:!0,addText:null};(0,n.next)((()=>{(0,n.schedule)("afterRender",(()=>{e.refreshHeight&&this.refreshHeight(),e.ensureAtEnd&&this.ensureCaretAtEnd(),this.capabilities.isIpadOS||this.site.mobileView||(e.addText&&this.addText(this.getSelected(),e.addText),this.focusTextArea())}))}))}ensureCaretAtEnd(){(0,n.schedule)("afterRender",(()=>{this._textarea.setSelectionRange(this._textarea.value.length,this._textarea.value.length)}))}refreshHeight(){(0,n.schedule)("afterRender",(()=>{this._textarea.style.height="auto",this._textarea.style.height=this._textarea.scrollHeight+1+"px"}))}}e.default=o})),define("discourse/plugins/chat/discourse/lib/transform-auto-links",["exports","discourse/lib/hashtag-decorator","discourse-common/lib/get-url"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){const n=a.parseFromString(e,"text/html")
return function(e){(e.querySelectorAll("span.mention")||[]).forEach((e=>{let t=document.createElement("a"),a=document.createTextNode(e.innerText)
t.classList.add("mention"),t.appendChild(a),t.href=(0,s.default)(`/u/${e.innerText.substring(1)}`),e.replaceWith(t)}))}(n),function(e){(e.querySelectorAll("span.hashtag-raw")||[]).forEach((e=>{(0,t.generatePlaceholderHashtagHTML)("category",e,{id:-1,text:"...",relative_url:"/",slug:"",icon:"square-full"})}))}(n),n.body.innerHTML}
const a=new DOMParser})),define("discourse/plugins/chat/discourse/models/chat-channel-archive",["exports","@glimmer/tracking"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s{static create(){return new s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"failed",[t.tracked]))()
#oa=(()=>{dt7948.i(this,"failed")})()
static#s=(()=>dt7948.g(this.prototype,"completed",[t.tracked]))()
#ca=(()=>{dt7948.i(this,"completed")})()
static#n=(()=>dt7948.g(this.prototype,"messages",[t.tracked]))()
#Xs=(()=>{dt7948.i(this,"messages")})()
static#r=(()=>dt7948.g(this.prototype,"topicId",[t.tracked]))()
#la=(()=>{dt7948.i(this,"topicId")})()
static#c=(()=>dt7948.g(this.prototype,"totalMessages",[t.tracked]))()
#da=(()=>{dt7948.i(this,"totalMessages")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.failed=e.archive_failed,this.completed=e.archive_completed,this.messages=e.archived_messages,this.topicId=e.archive_topic_id,this.totalMessages=e.total_messages}}e.default=s})),define("discourse/plugins/chat/discourse/models/chat-channel",["exports","@glimmer/tracking","pretty-text/guid","discourse/lib/utilities","discourse/models/category","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/lib/chat-threads-manager","discourse/plugins/chat/discourse/lib/slugify-channel","discourse/plugins/chat/discourse/models/chat-channel-archive","discourse/plugins/chat/discourse/models/chat-direct-message","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-channel-membership"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u,p){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.CHATABLE_TYPES=e.CHANNEL_STATUSES=void 0,e.channelStatusIcon=function(e){if(e===g.open)return null
switch(e){case g.closed:return"lock"
case g.readOnly:return"comment-slash"
case g.archived:return"archive"}},e.default=void 0
const m=e.CHATABLE_TYPES={directMessageChannel:"DirectMessage",categoryChannel:"Category"},g=e.CHANNEL_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
const f=[g.readOnly,g.archived],_=[g.closed,g.readOnly,g.archived]
class b{static create(){return new b(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"title",[t.tracked]))()
#ha=(()=>{dt7948.i(this,"title")})()
static#s=(()=>dt7948.g(this.prototype,"slug",[t.tracked]))()
#ua=(()=>{dt7948.i(this,"slug")})()
static#n=(()=>dt7948.g(this.prototype,"description",[t.tracked]))()
#pa=(()=>{dt7948.i(this,"description")})()
static#r=(()=>dt7948.g(this.prototype,"status",[t.tracked]))()
#ma=(()=>{dt7948.i(this,"status")})()
static#c=(()=>dt7948.g(this.prototype,"activeThread",[t.tracked]))()
#ga=(()=>{dt7948.i(this,"activeThread")})()
static#l=(()=>dt7948.g(this.prototype,"meta",[t.tracked]))()
#ia=(()=>{dt7948.i(this,"meta")})()
static#d=(()=>dt7948.g(this.prototype,"chatableId",[t.tracked]))()
#fa=(()=>{dt7948.i(this,"chatableId")})()
static#h=(()=>dt7948.g(this.prototype,"chatableType",[t.tracked]))()
#_a=(()=>{dt7948.i(this,"chatableType")})()
static#u=(()=>dt7948.g(this.prototype,"chatableUrl",[t.tracked]))()
#ba=(()=>{dt7948.i(this,"chatableUrl")})()
static#p=(()=>dt7948.g(this.prototype,"autoJoinUsers",[t.tracked]))()
#va=(()=>{dt7948.i(this,"autoJoinUsers")})()
static#j=(()=>dt7948.g(this.prototype,"allowChannelWideMentions",[t.tracked]))()
#ya=(()=>{dt7948.i(this,"allowChannelWideMentions")})()
static#P=(()=>dt7948.g(this.prototype,"membershipsCount",[t.tracked]))()
#Ma=(()=>{dt7948.i(this,"membershipsCount")})()
static#O=(()=>dt7948.g(this.prototype,"archive",[t.tracked]))()
#Ca=(()=>{dt7948.i(this,"archive")})()
static#D=(()=>dt7948.g(this.prototype,"tracking",[t.tracked]))()
#wa=(()=>{dt7948.i(this,"tracking")})()
static#I=(()=>dt7948.g(this.prototype,"threadingEnabled",[t.tracked]))()
#Sa=(()=>{dt7948.i(this,"threadingEnabled")})()
static#R=(()=>dt7948.g(this.prototype,"draft",[t.tracked]))()
#ka=(()=>{dt7948.i(this,"draft")})()
threadsManager=(()=>new o.default((0,i.getOwnerWithFallback)(this)))()
messagesManager=(()=>new r.default((0,i.getOwnerWithFallback)(this)))()
static#N=(()=>dt7948.g(this.prototype,"_currentUserMembership",[t.tracked]))()
#Ta=(()=>{dt7948.i(this,"_currentUserMembership")})()
static#B=(()=>dt7948.g(this.prototype,"_lastMessage",[t.tracked]))()
#xa=(()=>{dt7948.i(this,"_lastMessage")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.id=e.id,this.chatableId=e.chatable_id,this.chatableUrl=e.chatable_url,this.chatableType=e.chatable_type,this.membershipsCount=e.memberships_count,this.slug=e.slug,this.title=e.title,this.status=e.status,this.description=e.description,this.threadingEnabled=e.threading_enabled,this.autoJoinUsers=e.auto_join_users,this.allowChannelWideMentions=e.allow_channel_wide_mentions,this.currentUserMembership=e.current_user_membership,this.lastMessage=e.last_message,this.meta=e.meta,this.chatable=this.#ja(e.chatable??[]),this.tracking=new u.default((0,i.getOwnerWithFallback)(this)),(e.archive_completed||e.archive_failed)&&(this.archive=l.default.create(e))}get unreadThreadsCountSinceLastViewed(){return Array.from(this.threadsManager.unreadThreadOverview.values()).filter((e=>e>=this.currentUserMembership.lastViewedAt)).length}get unreadThreadsCount(){return Array.from(this.threadsManager.unreadThreadOverview.values()).length}get watchedThreadsUnreadCount(){return this.threadsManager.threads.reduce(((e,t)=>e+t.tracking.watchedThreadsUnreadCount),0)}updateLastViewedAt(){this.currentUserMembership.lastViewedAt=new Date}get canDeleteSelf(){return this.meta.can_delete_self}get canDeleteOthers(){return this.meta.can_delete_others}get canFlag(){return this.meta.can_flag}get userSilenced(){return this.meta.user_silenced}get canModerate(){return this.meta.can_moderate}get escapedTitle(){return(0,a.escapeExpression)(this.title)}get escapedDescription(){return(0,a.escapeExpression)(this.description)}get slugifiedTitle(){return this.slug||(0,c.default)(this)}get routeModels(){return[this.slugifiedTitle,this.id]}get isDirectMessageChannel(){return this.chatableType===m.directMessageChannel}get isCategoryChannel(){return this.chatableType===m.categoryChannel}get isOpen(){return!this.status||this.status===g.open}get isReadOnly(){return this.status===g.readOnly}get isClosed(){return this.status===g.closed}get isArchived(){return this.status===g.archived}get isJoinable(){return this.isOpen&&!this.isArchived}get isFollowing(){return this.currentUserMembership.following}get canJoin(){return this.meta.can_join_chat_channel}async stageMessage(e){e.id=(0,s.default)(),e.staged=!0,e.processed=!1,e.draft=!1,e.createdAt=new Date,e.channel=this,e.inReplyTo&&this.threadingEnabled||this.messagesManager.addMessages([e]),e.manager=this.messagesManager}resetDraft(e){this.draft=h.default.createDraftMessage(this,{user:e})}canModifyMessages(e){return e.staff?!f.includes(this.status):!_.includes(this.status)}get currentUserMembership(){return this._currentUserMembership}set currentUserMembership(e){e instanceof p.default?this._currentUserMembership=e:this._currentUserMembership=p.default.create(e)}get lastMessage(){return this._lastMessage}set lastMessage(e){e?e instanceof h.default?this._lastMessage=e:this._lastMessage=h.default.create(this,e):this._lastMessage=null}#ja(e){return!e||e instanceof n.default||e instanceof d.default?e:this.isDirectMessageChannel?d.default.create({users:e?.users,group:e?.group}):n.default.create(e)}}e.default=b})),define("discourse/plugins/chat/discourse/models/chat-chatable",["exports","@glimmer/tracking","@ember/service","discourse/models/category","discourse/models/group","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o{static create(){return new o(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static createUser(e){return new o({type:"user",model:e,identifier:`u-${e.id}`})}static createGroup(e){return new o({type:"group",model:e,identifier:`g-${e.id}`})}static createChannel(e){return new o({type:"channel",model:e,identifier:`c-${e.id}`})}static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[s.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#s=(()=>dt7948.g(this.prototype,"identifier",[t.tracked]))()
#Ea=(()=>{dt7948.i(this,"identifier")})()
static#n=(()=>dt7948.g(this.prototype,"type",[t.tracked]))()
#Pa=(()=>{dt7948.i(this,"type")})()
static#r=(()=>dt7948.g(this.prototype,"model",[t.tracked]))()
#Aa=(()=>{dt7948.i(this,"model")})()
static#c=(()=>dt7948.g(this.prototype,"enabled",[t.tracked],(function(){return!0})))()
#Oa=(()=>{dt7948.i(this,"enabled")})()
static#l=(()=>dt7948.g(this.prototype,"tracking",[t.tracked]))()
#wa=(()=>{dt7948.i(this,"tracking")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
switch(this.identifier=e.identifier,this.type=e.type,this.type){case"channel":if(1===e.model.chatable?.users?.length&&(this.enabled=e.model.chatable?.users[0].has_chat_enabled),e.model instanceof r.default){this.model=e.model
break}this.model=r.default.create(e.model)
break
case"user":if(this.enabled=e.model.has_chat_enabled,e.model instanceof i.default){this.model=e.model
break}this.model=i.default.create(e.model)
break
case"group":if(this.enabled=e.model.can_chat,e.model instanceof n.default){this.model=e.model
break}this.model=n.default.create(e.model)}}get isUser(){return"user"===this.type}get isGroup(){return"group"===this.type}get isCategory(){return this instanceof a.default}}e.default=o})),define("discourse/plugins/chat/discourse/models/chat-direct-message",["exports","@glimmer/tracking","discourse/models/user","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n{static create(){return new n(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"users",[t.tracked]))()
#Ua=(()=>{dt7948.i(this,"users")})()
static#s=(()=>dt7948.g(this.prototype,"group",[t.tracked]))()
#Da=(()=>{dt7948.i(this,"group")})()
type=(()=>a.CHATABLE_TYPES.directMessageChannel)()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.group=e.group??!1,this.users=this.#La(e.users||[])}#La(e){return e.map((e=>!e||e instanceof s.default?e:s.default.create(e)))}}e.default=n})),define("discourse/plugins/chat/discourse/models/chat-message-reaction",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/models/user"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.REACTIONS=void 0
e.REACTIONS={add:"add",remove:"remove"}
class n{static create(){return new n(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"count",[t.tracked]))()
#Ia=(()=>{dt7948.i(this,"count")})()
static#s=(()=>dt7948.g(this.prototype,"reacted",[t.tracked]))()
#Ra=(()=>{dt7948.i(this,"reacted")})()
static#n=(()=>dt7948.g(this.prototype,"users",[t.tracked]))()
#Ua=(()=>{dt7948.i(this,"users")})()
static#r=(()=>dt7948.g(this.prototype,"emoji",[t.tracked]))()
#Na=(()=>{dt7948.i(this,"emoji")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.count=e.count,this.emoji=e.emoji,this.reacted=e.reacted,this.users=this.#Fa(e.users)}#Fa(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]
return new s.TrackedArray(e.map((e=>e instanceof a.default?e:a.default.create(e))))}}e.default=n})),define("discourse/plugins/chat/discourse/models/chat-message",["exports","@glimmer/tracking","@ember-compat/tracked-built-ins","discourse/lib/text","discourse/models/bookmark","discourse/models/user","discourse-common/lib/get-owner","discourse-common/lib/later","discourse/plugins/chat/discourse/lib/transform-auto-links","discourse/plugins/chat/discourse/models/chat-message-reaction"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d{static cookFunction=null
static create(e){return new d(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static createDraftMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return t.draft=!0,d.create(e,t)}static#e=(()=>dt7948.g(this.prototype,"id",[t.tracked]))()
#Ba=(()=>{dt7948.i(this,"id")})()
static#s=(()=>dt7948.g(this.prototype,"error",[t.tracked]))()
#Ha=(()=>{dt7948.i(this,"error")})()
static#n=(()=>dt7948.g(this.prototype,"selected",[t.tracked]))()
#za=(()=>{dt7948.i(this,"selected")})()
static#r=(()=>dt7948.g(this.prototype,"channel",[t.tracked]))()
#Ws=(()=>{dt7948.i(this,"channel")})()
static#c=(()=>dt7948.g(this.prototype,"staged",[t.tracked]))()
#Wa=(()=>{dt7948.i(this,"staged")})()
static#l=(()=>dt7948.g(this.prototype,"processed",[t.tracked]))()
#$a=(()=>{dt7948.i(this,"processed")})()
static#d=(()=>dt7948.g(this.prototype,"draftSaved",[t.tracked]))()
#Va=(()=>{dt7948.i(this,"draftSaved")})()
static#h=(()=>dt7948.g(this.prototype,"draft",[t.tracked]))()
#ka=(()=>{dt7948.i(this,"draft")})()
static#u=(()=>dt7948.g(this.prototype,"createdAt",[t.tracked]))()
#qa=(()=>{dt7948.i(this,"createdAt")})()
static#p=(()=>dt7948.g(this.prototype,"uploads",[t.tracked]))()
#Ga=(()=>{dt7948.i(this,"uploads")})()
static#j=(()=>dt7948.g(this.prototype,"excerpt",[t.tracked]))()
#Ka=(()=>{dt7948.i(this,"excerpt")})()
static#P=(()=>dt7948.g(this.prototype,"reactions",[t.tracked]))()
#Ja=(()=>{dt7948.i(this,"reactions")})()
static#O=(()=>dt7948.g(this.prototype,"reviewableId",[t.tracked]))()
#Ya=(()=>{dt7948.i(this,"reviewableId")})()
static#D=(()=>dt7948.g(this.prototype,"user",[t.tracked]))()
#qt=(()=>{dt7948.i(this,"user")})()
static#I=(()=>dt7948.g(this.prototype,"inReplyTo",[t.tracked]))()
#Za=(()=>{dt7948.i(this,"inReplyTo")})()
static#R=(()=>dt7948.g(this.prototype,"expanded",[t.tracked]))()
#Xa=(()=>{dt7948.i(this,"expanded")})()
static#N=(()=>dt7948.g(this.prototype,"bookmark",[t.tracked]))()
#Qa=(()=>{dt7948.i(this,"bookmark")})()
static#B=(()=>dt7948.g(this.prototype,"userFlagStatus",[t.tracked]))()
#en=(()=>{dt7948.i(this,"userFlagStatus")})()
static#H=(()=>dt7948.g(this.prototype,"hidden",[t.tracked]))()
#tn=(()=>{dt7948.i(this,"hidden")})()
static#z=(()=>dt7948.g(this.prototype,"version",[t.tracked],(function(){return 0})))()
#sn=(()=>{dt7948.i(this,"version")})()
static#ne=(()=>dt7948.g(this.prototype,"edited",[t.tracked]))()
#an=(()=>{dt7948.i(this,"edited")})()
static#re=(()=>dt7948.g(this.prototype,"editing",[t.tracked]))()
#nn=(()=>{dt7948.i(this,"editing")})()
static#ce=(()=>dt7948.g(this.prototype,"chatWebhookEvent",[t.tracked]))()
#in=(()=>{dt7948.i(this,"chatWebhookEvent")})()
static#de=(()=>dt7948.g(this.prototype,"mentionWarning",[t.tracked]))()
#rn=(()=>{dt7948.i(this,"mentionWarning")})()
static#ue=(()=>dt7948.g(this.prototype,"availableFlags",[t.tracked]))()
#on=(()=>{dt7948.i(this,"availableFlags")})()
static#me=(()=>dt7948.g(this.prototype,"newest",[t.tracked]))()
#cn=(()=>{dt7948.i(this,"newest")})()
static#ge=(()=>dt7948.g(this.prototype,"highlighted",[t.tracked]))()
#ln=(()=>{dt7948.i(this,"highlighted")})()
static#_e=(()=>dt7948.g(this.prototype,"firstOfResults",[t.tracked]))()
#dn=(()=>{dt7948.i(this,"firstOfResults")})()
static#be=(()=>dt7948.g(this.prototype,"message",[t.tracked]))()
#$s=(()=>{dt7948.i(this,"message")})()
static#ve=(()=>dt7948.g(this.prototype,"manager",[t.tracked]))()
#hn=(()=>{dt7948.i(this,"manager")})()
static#ye=(()=>dt7948.g(this.prototype,"deletedById",[t.tracked]))()
#un=(()=>{dt7948.i(this,"deletedById")})()
static#Me=(()=>dt7948.g(this.prototype,"streaming",[t.tracked]))()
#pn=(()=>{dt7948.i(this,"streaming")})()
static#Ce=(()=>dt7948.g(this.prototype,"_deletedAt",[t.tracked]))()
#mn=(()=>{dt7948.i(this,"_deletedAt")})()
static#we=(()=>dt7948.g(this.prototype,"_cooked",[t.tracked]))()
#gn=(()=>{dt7948.i(this,"_cooked")})()
static#Se=(()=>dt7948.g(this.prototype,"_thread",[t.tracked]))()
#fn=(()=>{dt7948.i(this,"_thread")})()
constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this.id=t.id,this.channel=e,this.streaming=t.streaming,this.manager=t.manager,this.newest=t.newest??!1,this.draftSaved=t.draftSaved??t.draft_saved??!1,this.firstOfResults=t.firstOfResults??t.first_of_results??!1,this.staged=t.staged??!1,this.processed=t.processed??!0,this.edited=t.edited??!1,this.editing=t.editing??!1,this.availableFlags=t.availableFlags??t.available_flags,this.hidden=t.hidden??!1,this.chatWebhookEvent=t.chatWebhookEvent??t.chat_webhook_event,this.createdAt=t.created_at?new Date(t.created_at):new Date(t.createdAt),this.deletedById=t.deletedById||t.deleted_by_id,this._deletedAt=t.deletedAt||t.deleted_at,this.expanded=!this.hidden&&!this._deletedAt&&(t.expanded??!0),this.excerpt=t.excerpt,this.reviewableId=t.reviewableId??t.reviewable_id,this.userFlagStatus=t.userFlagStatus??t.user_flag_status,this.draft=t.draft,this.message=t.message??"",this._cooked=t.cooked??"",this.inReplyTo=t.inReplyTo??(t.in_reply_to??t.replyToMsg?d.create(e,t.in_reply_to??t.replyToMsg):null),this.reactions=this.#_n(t.reactions),this.uploads=new s.TrackedArray(t.uploads||[]),this.user=this.#bn(t.user),this.bookmark=t.bookmark?n.default.create(t.bookmark):null,this.mentionedUsers=this.#vn(t.mentioned_users)
t.thread&&(this.thread=t.thread)}get persisted(){return!!this.id&&!this.staged}get replyable(){return!this.staged&&!this.error}get editable(){return!this.staged&&!this.error}get thread(){return this._thread}set thread(e){this._thread=e?this.channel.threadsManager.add(this.channel,e,{replace:!0}):null}get deletedAt(){return this._deletedAt}set deletedAt(e){this._deletedAt=e,this.incrementVersion()}get cooked(){return this._cooked}set cooked(e){e!==this._cooked&&(this._cooked=e,this.incrementVersion())}async cook(){this.isDestroyed||this.isDestroying||(await this.#yn(),this.cooked=d.cookFunction(this.message))}get read(){return this.channel.currentUserMembership?.lastReadMessageId>=this.id}get isOriginalThreadMessage(){return this.thread?.originalMessage?.id===this.id}get index(){return this.manager?.messages?.indexOf(this)}static#Te=(()=>dt7948.n(this.prototype,"index",[t.cached]))()
get previousMessage(){return this.manager?.messages?.objectAt?.(this.index-1)}static#xe=(()=>dt7948.n(this.prototype,"previousMessage",[t.cached]))()
get nextMessage(){return this.manager?.messages?.objectAt?.(this.index+1)}static#Ee=(()=>dt7948.n(this.prototype,"nextMessage",[t.cached]))()
highlight(){this.highlighted=!0,(0,o.default)((()=>{this.isDestroying||this.isDestroyed||(this.highlighted=!1)}),2e3)}incrementVersion(){this.version++}async parseMentions(){return await(0,a.parseMentions)(this.message,this.#Mn)}toJSONDraft(){if(0===this.message?.length&&0===this.uploads?.length&&!this.inReplyTo)return null
const e={}
return this.uploads?.length>0&&(e.uploads=this.uploads),this.message?.length>0&&(e.message=this.message),this.inReplyTo&&(e.replyToMsg={id:this.inReplyTo.id,excerpt:this.inReplyTo.excerpt,user:{id:this.inReplyTo.user.id,name:this.inReplyTo.user.name,avatar_template:this.inReplyTo.user.avatar_template,username:this.inReplyTo.user.username}}),this.editing&&(e.editing=!0,e.id=this.id,e.excerpt=this.excerpt),JSON.stringify(e)}react(e,t,s,a){const n=s.id===a,i=this.reactions.find((t=>t.emoji===e))
if(i)if("add"===t){if(n&&i.reacted)return
if(i.users.find((e=>e.id===s.id)))return
i.count=i.count+1,n&&(i.reacted=!0),i.users.pushObject(s)}else{const e=i.users.find((e=>e.id===s.id))
if(!e)return
n&&(i.reacted=!1),1===i.count?this.reactions.removeObject(i):(i.count=i.count-1,i.users.removeObject(e))}else"add"===t&&this.reactions.pushObject(l.default.create({count:1,emoji:e,reacted:n,users:[s]}))}async#yn(){if(d.cookFunction)return
const e=await(0,a.generateCookFunction)(this.#Mn)
d.cookFunction=t=>(0,c.default)(e(t))}get#Mn(){const e=(0,r.getOwnerWithFallback)(this).lookup("service:site")
return{featuresOverride:e.markdown_additional_options?.chat?.limited_pretty_text_features,markdownItRules:e.markdown_additional_options?.chat?.limited_pretty_text_markdown_rules,hashtagTypesInPriorityOrder:e.hashtag_configurations?.["chat-composer"],hashtagIcons:e.hashtag_icons}}#_n(){return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).map((e=>l.default.create(e)))}#vn(e){const t=new Map
return e&&e.forEach((e=>{const s=i.default.create(e)
t.set(s.id,s)})),t}#bn(e){return!e||e instanceof i.default?e:i.default.create(e)}}e.default=d})),define("discourse/plugins/chat/discourse/models/chat-notice",["exports","@glimmer/tracking"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s{static create(){return new s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"channelId",[t.tracked]))()
#Cn=(()=>{dt7948.i(this,"channelId")})()
static#s=(()=>dt7948.g(this.prototype,"textContent",[t.tracked]))()
#wn=(()=>{dt7948.i(this,"textContent")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.channelId=e.channel_id,this.textContent=e.text_content,this.type=e.notice_type,this.data=e.data}}e.default=s})),define("discourse/plugins/chat/discourse/models/chat-thread-preview",["exports","@glimmer/tracking"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s{static create(){return new s(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"replyCount",[t.tracked]))()
#Sn=(()=>{dt7948.i(this,"replyCount")})()
static#s=(()=>dt7948.g(this.prototype,"lastReplyId",[t.tracked]))()
#kn=(()=>{dt7948.i(this,"lastReplyId")})()
static#n=(()=>dt7948.g(this.prototype,"lastReplyCreatedAt",[t.tracked]))()
#Tn=(()=>{dt7948.i(this,"lastReplyCreatedAt")})()
static#r=(()=>dt7948.g(this.prototype,"lastReplyExcerpt",[t.tracked]))()
#xn=(()=>{dt7948.i(this,"lastReplyExcerpt")})()
static#c=(()=>dt7948.g(this.prototype,"lastReplyUser",[t.tracked]))()
#jn=(()=>{dt7948.i(this,"lastReplyUser")})()
static#l=(()=>dt7948.g(this.prototype,"participantCount",[t.tracked]))()
#En=(()=>{dt7948.i(this,"participantCount")})()
static#d=(()=>dt7948.g(this.prototype,"participantUsers",[t.tracked]))()
#Pn=(()=>{dt7948.i(this,"participantUsers")})()
constructor(e){this.update(e||{})}get otherParticipantCount(){return this.participantCount-this.participantUsers.length}update(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.replyCount=e.reply_count??e.replyCount??0,this.lastReplyId=e.last_reply_id??e.lastReplyId,this.lastReplyCreatedAt=new Date(e.last_reply_created_at??e.lastReplyCreatedAt),this.lastReplyExcerpt=e.last_reply_excerpt??e.lastReplyExcerpt,this.participantCount=e.participant_count??e.participantCount??0
const t=e.last_reply_user??e.lastReplyUser
t?.id!==this.lastReplyUser?.id&&(this.lastReplyUser=t)
const s=e.participant_users??e.participantUsers??[]
s?.map((e=>e.id)).join(",")!==this.participantUsers?.map((e=>e.id)).join(",")&&(this.participantUsers=s)}}e.default=s}))
define("discourse/plugins/chat/discourse/models/chat-thread",["exports","@glimmer/tracking","pretty-text/guid","discourse-common/lib/get-owner","discourse/plugins/chat/discourse/lib/chat-messages-manager","discourse/plugins/chat/discourse/models/chat-message","discourse/plugins/chat/discourse/models/chat-thread-preview","discourse/plugins/chat/discourse/models/chat-tracking-state","discourse/plugins/chat/discourse/models/user-chat-thread-membership"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.THREAD_STATUSES=void 0
e.THREAD_STATUSES={open:"open",readOnly:"read_only",closed:"closed",archived:"archived"}
class l{static create(e){return new l(e,arguments.length>1&&void 0!==arguments[1]?arguments[1]:{})}static#e=(()=>dt7948.g(this.prototype,"id",[t.tracked]))()
#Ba=(()=>{dt7948.i(this,"id")})()
static#s=(()=>dt7948.g(this.prototype,"title",[t.tracked]))()
#ha=(()=>{dt7948.i(this,"title")})()
static#n=(()=>dt7948.g(this.prototype,"status",[t.tracked]))()
#ma=(()=>{dt7948.i(this,"status")})()
static#r=(()=>dt7948.g(this.prototype,"draft",[t.tracked]))()
#ka=(()=>{dt7948.i(this,"draft")})()
static#c=(()=>dt7948.g(this.prototype,"staged",[t.tracked]))()
#Wa=(()=>{dt7948.i(this,"staged")})()
static#l=(()=>dt7948.g(this.prototype,"channel",[t.tracked]))()
#Ws=(()=>{dt7948.i(this,"channel")})()
static#d=(()=>dt7948.g(this.prototype,"originalMessage",[t.tracked]))()
#An=(()=>{dt7948.i(this,"originalMessage")})()
static#h=(()=>dt7948.g(this.prototype,"lastMessageId",[t.tracked]))()
#On=(()=>{dt7948.i(this,"lastMessageId")})()
static#u=(()=>dt7948.g(this.prototype,"threadMessageBusLastId",[t.tracked]))()
#Un=(()=>{dt7948.i(this,"threadMessageBusLastId")})()
static#p=(()=>dt7948.g(this.prototype,"replyCount",[t.tracked]))()
#Sn=(()=>{dt7948.i(this,"replyCount")})()
static#j=(()=>dt7948.g(this.prototype,"tracking",[t.tracked]))()
#wa=(()=>{dt7948.i(this,"tracking")})()
static#P=(()=>dt7948.g(this.prototype,"currentUserMembership",[t.tracked]))()
#Dn=(()=>{dt7948.i(this,"currentUserMembership")})()
static#O=(()=>dt7948.g(this.prototype,"preview",[t.tracked]))()
#Ln=(()=>{dt7948.i(this,"preview")})()
static#D=(()=>dt7948.g(this.prototype,"force",[t.tracked]))()
#In=(()=>{dt7948.i(this,"force")})()
messagesManager=(()=>new n.default((0,a.getOwnerWithFallback)(this)))()
constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
this.id=t.id,this.channel=e,this.status=t.status,this.staged=t.staged,this.replyCount=t.reply_count,this.force=t.force,this.originalMessage=t.original_message?i.default.create(e,t.original_message):null,this.originalMessage&&(this.originalMessage.thread=this),this.lastMessageId=t.last_message_id,this.title=t.title,t.current_user_membership&&(this.currentUserMembership=c.default.create(t.current_user_membership)),this.tracking=new o.default((0,a.getOwnerWithFallback)(this)),this.preview=r.default.create(t.preview)}resetDraft(e){this.draft=i.default.createDraftMessage(this.channel,{user:e,thread:this})}async stageMessage(e){e.id=(0,s.default)(),e.staged=!0,e.processed=!1,e.draft=!1,e.createdAt=new Date,e.thread=this,this.messagesManager.addMessages([e]),e.manager=this.messagesManager}get routeModels(){return[...this.channel.routeModels,this.id]}}e.default=l})),define("discourse/plugins/chat/discourse/models/chat-tracking-state",["exports","@glimmer/tracking","@ember/owner","@ember/service"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n{static#e=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[a.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
static#s=(()=>dt7948.g(this.prototype,"_unreadCount",[t.tracked]))()
#Rn=(()=>{dt7948.i(this,"_unreadCount")})()
static#n=(()=>dt7948.g(this.prototype,"_mentionCount",[t.tracked]))()
#Nn=(()=>{dt7948.i(this,"_mentionCount")})()
static#r=(()=>dt7948.g(this.prototype,"_watchedThreadsUnreadCount",[t.tracked]))()
#Fn=(()=>{dt7948.i(this,"_watchedThreadsUnreadCount")})()
constructor(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};(0,s.setOwner)(this,e),this._unreadCount=t.unreadCount??0,this._mentionCount=t.mentionCount??0,this._watchedThreadsUnreadCount=t.watchedThreadsUnreadCount??0}reset(){this._unreadCount=0,this._mentionCount=0,this._watchedThreadsUnreadCount=0}get unreadCount(){return this._unreadCount}set unreadCount(e){this._unreadCount!==e&&(this._unreadCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}get mentionCount(){return this._mentionCount}set mentionCount(e){this._mentionCount!==e&&(this._mentionCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}get watchedThreadsUnreadCount(){return this._watchedThreadsUnreadCount}set watchedThreadsUnreadCount(e){this._watchedThreadsUnreadCount!==e&&(this._watchedThreadsUnreadCount=e,this.chatTrackingStateManager.triggerNotificationsChanged())}}e.default=n})),define("discourse/plugins/chat/discourse/models/user-chat-channel-membership",["exports","@glimmer/tracking","discourse/models/user"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a{static create(){return new a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"following",[t.tracked]))()
#Bn=(()=>{dt7948.i(this,"following")})()
static#s=(()=>dt7948.g(this.prototype,"muted",[t.tracked]))()
#Hn=(()=>{dt7948.i(this,"muted")})()
static#n=(()=>dt7948.g(this.prototype,"notificationLevel",[t.tracked]))()
#zn=(()=>{dt7948.i(this,"notificationLevel")})()
static#r=(()=>dt7948.g(this.prototype,"lastReadMessageId",[t.tracked]))()
#Wn=(()=>{dt7948.i(this,"lastReadMessageId")})()
static#c=(()=>dt7948.g(this.prototype,"lastViewedAt",[t.tracked]))()
#$n=(()=>{dt7948.i(this,"lastViewedAt")})()
static#l=(()=>dt7948.g(this.prototype,"user",[t.tracked]))()
#qt=(()=>{dt7948.i(this,"user")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.following=e.following,this.muted=e.muted,this.notificationLevel=e.notification_level,this.lastReadMessageId=e.last_read_message_id,this.lastViewedAt=new Date(e.last_viewed_at),this.user=this.#bn(e.user)}#bn(e){return!e||e instanceof s.default?e:s.default.create(e)}}e.default=a})),define("discourse/plugins/chat/discourse/models/user-chat-thread-membership",["exports","@glimmer/tracking","discourse/lib/notification-levels"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a{static create(){return new a(arguments.length>0&&void 0!==arguments[0]?arguments[0]:{})}static#e=(()=>dt7948.g(this.prototype,"lastReadMessageId",[t.tracked]))()
#Wn=(()=>{dt7948.i(this,"lastReadMessageId")})()
static#s=(()=>dt7948.g(this.prototype,"notificationLevel",[t.tracked]))()
#zn=(()=>{dt7948.i(this,"notificationLevel")})()
static#n=(()=>dt7948.g(this.prototype,"threadTitlePromptSeen",[t.tracked]))()
#Vn=(()=>{dt7948.i(this,"threadTitlePromptSeen")})()
constructor(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.lastReadMessageId=e.last_read_message_id,this.notificationLevel=e.notification_level,this.threadTitlePromptSeen=e.thread_title_prompt_seen}get isQuiet(){return this.notificationLevel===s.NotificationLevels.REGULAR||this.notificationLevel===s.NotificationLevels.MUTED}}e.default=a})),define("discourse/plugins/chat/discourse/modifiers/chat/emoji-picker-scroll-listener",["exports","@ember/destroyable","@ember/service","ember-modifier"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{static#e=(()=>dt7948.g(this.prototype,"emojiPickerScrollObserver",[s.service]))()
#et=(()=>{dt7948.i(this,"emojiPickerScrollObserver")})()
element=null
constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.element=e,this.emojiPickerScrollObserver.observe(e)}cleanup(){this.emojiPickerScrollObserver.unobserve(this.element)}}e.default=n})),define("discourse/plugins/chat/discourse/modifiers/chat/later-fn",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/lib/later"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends a.default{constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[s,a]=t
this.handler=(0,n.default)((()=>{s?.(e)}),a)}cleanup(){(0,s.cancel)(this.handler)}}e.default=i})),define("discourse/plugins/chat/discourse/modifiers/chat/on-animation-end",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends a.default{constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[a]=t
this.element=e,this.fn=a,this.handler=(0,s.schedule)("afterRender",(()=>{this.element.addEventListener("animationend",this.handleAnimationEnd)}))}handleAnimationEnd(){this.isDestroying||this.isDestroyed||this.fn?.(this.element)}static#e=(()=>dt7948.n(this.prototype,"handleAnimationEnd",[n.bind]))()
cleanup(){(0,s.cancel)(this.handler),this.element?.removeEventListener("animationend",this.handleAnimationEnd)}}e.default=i})),define("discourse/plugins/chat/discourse/modifiers/chat/on-long-press",["exports","@ember/destroyable","@ember/runloop","@ember/service","ember-modifier","discourse-common/lib/later","discourse-common/utils/decorators"],(function(e,t,s,a,n,i,r){"use strict"
function o(e){e.stopPropagation()}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends n.default{static#e=(()=>dt7948.g(this.prototype,"capabilities",[a.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#s=(()=>dt7948.g(this.prototype,"site",[a.service]))()
#b=(()=>{dt7948.i(this,"site")})()
constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}get enabled(){return this.capabilities.touch&&this.site.mobileView}modify(e,t){let[s,a,n]=t
this.enabled&&(this.element=e,this.onLongPressStart=s||(()=>{}),this.onLongPressEnd=a||(()=>{}),this.onLongPressCancel=n||(()=>{}),this.element.addEventListener("touchstart",this.handleTouchStart,{passive:!0}))}onCancel(){(0,s.cancel)(this.timeout),this.capabilities.touch&&(this.element.removeEventListener("touchmove",this.onCancel,{passive:!0}),this.element.removeEventListener("touchend",this.onCancel),this.element.removeEventListener("touchcancel",this.onCancel)),this.onLongPressCancel(this.element)}static#n=(()=>dt7948.n(this.prototype,"onCancel",[r.bind]))()
handleTouchStart(e){e.touches.length>1?this.onCancel():(this.onLongPressStart(this.element,e),this.element.addEventListener("touchmove",this.onCancel,{passive:!0}),this.element.addEventListener("touchend",this.onCancel),this.element.addEventListener("touchcancel",this.onCancel),this.timeout=(0,i.default)((()=>{this.isDestroying||this.isDestroyed||(this.element.addEventListener("touchend",o,{once:!0,passive:!0}),this.onLongPressEnd(this.element,e))}),400))}static#r=(()=>dt7948.n(this.prototype,"handleTouchStart",[r.bind]))()
cleanup(){this.enabled&&(this.element.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),this.onCancel())}}e.default=c})),define("discourse/plugins/chat/discourse/modifiers/chat/on-resize",["exports","@ember/destroyable","@ember/runloop","ember-modifier"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[a,n={}]=t
this.resizeObserver=new ResizeObserver((e=>{this.throttleHandler=(0,s.throttle)(this,a,e,n.delay??0,n.immediate??!1)})),this.resizeObserver.observe(e)}cleanup(){(0,s.cancel)(this.throttleHandler),this.resizeObserver?.disconnect()}}e.default=n})),define("discourse/plugins/chat/discourse/modifiers/chat/on-scroll",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends a.default{constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[s,a]=t
this.element=e,this.callback=s,this.options=a,this.element.addEventListener("scroll",this.throttledCallback,{passive:!0})}throttledCallback(e){this.throttledHandler=(0,s.throttle)(this,this.callback,e,this.options.delay??100,this.options.immediate??!1)}static#e=(()=>dt7948.n(this.prototype,"throttledCallback",[n.bind]))()
cleanup(){(0,s.cancel)(this.throttledHandler),this.element.removeEventListener("scroll",this.throttledCallback)}}e.default=i})),define("discourse/plugins/chat/discourse/modifiers/chat/resizable-node",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/utils/decorators"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends a.default{element=null
resizerSelector=null
didResizeContainer=null
options=null
_originalWidth=0
_originalHeight=0
_originalX=0
_originalY=0
_originalPageX=0
_originalPageY=0
constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[s,a,n={}]=t
this.resizerSelector=s,this.element=e,this.didResizeContainer=a,this.options=Object.assign({vertical:!0,horizontal:!0,position:!0,mutate:!0,resetOnWindowResize:!1},n),this.element.querySelector(this.resizerSelector)?.addEventListener("touchstart",this._startResize),this.element.querySelector(this.resizerSelector)?.addEventListener("mousedown",this._startResize),window.addEventListener("resize",this._resizeWindow)}cleanup(){this.element.querySelector(this.resizerSelector)?.removeEventListener("touchstart",this._startResize),this.element.querySelector(this.resizerSelector)?.removeEventListener("mousedown",this._startResize),window.removeEventListener("resize",this._resizeWindow),(0,s.cancel)(this._throttledResizeHandler)}_startResize(e){e.preventDefault(),this._minimumWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("min-width").replace("px","")||20),this._minimumHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("min-height").replace("px","")||20),this._originalWidth=parseFloat(getComputedStyle(this.element,null).getPropertyValue("width").replace("px","")),this._originalHeight=parseFloat(getComputedStyle(this.element,null).getPropertyValue("height").replace("px","")),this._originalX=this.element.getBoundingClientRect().left,this._originalY=this.element.getBoundingClientRect().top,this._originalPageX=this._eventValueForProperty(e,"pageX"),this._originalPageY=this._eventValueForProperty(e,"pageY"),window.addEventListener("touchmove",this._resize),window.addEventListener("touchend",this._stopResize),window.addEventListener("mousemove",this._resize),window.addEventListener("mouseup",this._stopResize)}static#e=(()=>dt7948.n(this.prototype,"_startResize",[n.bind]))()
_resize(e){let t=this._originalWidth,s=this._eventValueForProperty(e,"pageX")-this._originalPageX
t=document.documentElement.classList.contains("rtl")?Math.ceil(t+s):Math.ceil(t-s)
const a=Math.ceil(this._originalHeight-(this._eventValueForProperty(e,"pageY")-this._originalPageY)),n={}
this.options.horizontal&&t>=this._minimumWidth&&(n.width=t+"px",this.options.position&&(n.left=Math.ceil(this._originalX+(this._eventValueForProperty(e,"pageX")-this._originalPageX))+"px")),this.options.vertical&&a>=this._minimumHeight&&(n.height=a+"px",this.options.position&&(n.top=Math.ceil(this._originalY+(this._eventValueForProperty(e,"pageY")-this._originalPageY))+"px")),this.options.mutate&&Object.assign(this.element.style,n),this.didResizeContainer?.(this.element,{width:t>=this._minimumWidth?t:this._minimumWidth,height:a>=this._minimumHeight?a:this._minimumHeight})}static#s=(()=>dt7948.n(this.prototype,"_resize",[n.bind]))()
_resizeWindow(){this.options.resetOnWindowResize&&(this._throttledResizeHandler=(0,s.throttle)(this,this._throttledResize,100))}static#n=(()=>dt7948.n(this.prototype,"_resizeWindow",[n.bind]))()
_throttledResize(){const e={}
this.options.vertical&&(e.height="auto"),this.options.horizontal&&(e.width="auto"),Object.assign(this.element.style,e)}static#r=(()=>dt7948.n(this.prototype,"_throttledResize",[n.bind]))()
_stopResize(){window.removeEventListener("touchmove",this._resize),window.removeEventListener("touchend",this._stopResize),window.removeEventListener("mousemove",this._resize),window.removeEventListener("mouseup",this._stopResize)}static#c=(()=>dt7948.n(this.prototype,"_stopResize",[n.bind]))()
_eventValueForProperty(e,t){return e.changedTouches?e.changedTouches[0][t]:e[t]}}e.default=i})),define("discourse/plugins/chat/discourse/modifiers/chat/scrollable-list",["exports","@ember/destroyable","@ember/runloop","ember-modifier","discourse-common/lib/later","discourse-common/utils/decorators","discourse/plugins/chat/discourse/helpers/first-visible-message-id"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o="down"
class c extends a.default{constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[s]=t
this.element=e,this.options=s,this.lastScrollTop=this.computeInitialScrollTop(),this.element.addEventListener("scroll",this.handleScroll,{passive:!0}),this.element.addEventListener("wheel",this.handleWheel,{passive:!0}),this.throttleComputeScroll()}handleScroll(){this.throttleComputeScroll()}static#e=(()=>dt7948.n(this.prototype,"handleScroll",[i.bind]))()
handleWheel(){this.throttleComputeScroll()}static#s=(()=>dt7948.n(this.prototype,"handleWheel",[i.bind]))()
computeScroll(){const e=this.element.scrollTop
this.options.onScroll?.(this.computeState()),this.lastScrollTop=e}static#n=(()=>dt7948.n(this.prototype,"computeScroll",[i.bind]))()
throttleComputeScroll(){(0,s.cancel)(this.scrollTimer),this.throttleTimer=(0,s.throttle)(this,this.computeScroll,50,!0),this.scrollTimer=(0,n.default)((()=>{this.options.onScrollEnd?.(Object.assign(this.computeState(),{firstVisibleId:(0,r.default)(this.element)}))}),this.options.delay||250)}cleanup(){(0,s.cancel)(this.scrollTimer),(0,s.cancel)(this.throttleTimer),this.element.removeEventListener("scroll",this.handleScroll),this.element.removeEventListener("wheel",this.handleWheel)}computeState(){const e=this.computeScrollDirection(),t=this.computeDistanceToBottom(),s=this.computeDistanceToTop()
return{up:"up"===e,down:e===o,distanceToBottom:t,distanceToTop:s,atBottom:t.pixels<=1,atTop:s.pixels<=1}}computeInitialScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight:this.element.scrollTop}computeScrollTop(){return this.options.reverse?this.element.scrollHeight-this.element.clientHeight-this.element.scrollTop:this.element.scrollTop}computeDistanceToTop(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?t-Math.abs(this.element.scrollTop):Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeDistanceToBottom(){let e
const t=this.element.scrollHeight-this.element.clientHeight
return e=this.options.reverse?-this.element.scrollTop:t-Math.abs(this.element.scrollTop),{pixels:e,percentage:Math.round(e/t*100)}}computeScrollDirection(){return this.element.scrollTop===this.lastScrollTop?null:this.element.scrollTop<this.lastScrollTop?"up":o}}e.default=c})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message-separator-date",["exports","@ember/destroyable","ember-modifier"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const a="is-pinned"
class n extends s.default{constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e){this.intersectionObserver=new IntersectionObserver((e=>{let[t]=e
t.isIntersecting&&t.intersectionRatio<1&&t.boundingClientRect.y<t.intersectionRect.y?t.target.classList.add(a):t.target.classList.remove(a)}),{threshold:[0,1]}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}}e.default=n})),define("discourse/plugins/chat/discourse/modifiers/chat/track-message",["exports","@ember/destroyable","ember-modifier","discourse-common/utils/decorators"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{didEnterViewport=null
didLeaveViewport=null
constructor(e,s){super(e,s),(0,t.registerDestructor)(this,(e=>e.cleanup()))}modify(e,t){let[s,a]=t
this.didEnterViewport=s,this.didLeaveViewport=a,this.intersectionObserver=new IntersectionObserver(this._intersectionObserverCallback,{root:document,threshold:0}),this.intersectionObserver.observe(e)}cleanup(){this.intersectionObserver?.disconnect()}_intersectionObserverCallback(e){e.forEach((e=>{e.isIntersecting?this.didEnterViewport?.():this.didLeaveViewport?.()}))}static#e=(()=>dt7948.n(this.prototype,"_intersectionObserverCallback",[a.bind]))()}e.default=n})),define("discourse/plugins/chat/discourse/pre-initializers/chat-plugin-api",["exports","discourse/lib/plugin-api","discourse/plugins/chat/discourse/components/chat-message","discourse/plugins/chat/discourse/lib/chat-composer-buttons","discourse/plugins/chat/discourse/lib/chat-message-interactor","discourse/plugins/chat/discourse/services/chat-state-manager"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={name:"chat-plugin-api",after:"inject-discourse-objects",initialize(){(0,t.withPluginApi)("1.2.0",(e=>{const t=Object.getPrototypeOf(e)
t.hasOwnProperty("decorateChatMessage")||Object.defineProperty(t,"decorateChatMessage",{value(e){(0,s.addChatMessageDecorator)(e)}}),t.hasOwnProperty("registerChatComposerButton")||Object.defineProperty(t,"registerChatComposerButton",{value(e){(0,a.registerChatComposerButton)(e)}}),t.hasOwnProperty("addChatDrawerStateCallback")||Object.defineProperty(t,"addChatDrawerStateCallback",{value(e){(0,i.addChatDrawerStateCallback)(e)}}),t.hasOwnProperty("sendChatMessage")||Object.defineProperty(t,"sendChatMessage",{async value(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.container.lookup("service:chat-api").sendMessage(e,{thread_id:t.threadId,post_ids:t.postIds,topic_id:t.topicId,message:t.message,uploads:t.uploads})}}),t.hasOwnProperty("removeChatComposerSecondaryActions")||Object.defineProperty(t,"removeChatComposerSecondaryActions",{value(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];(0,n.removeChatComposerSecondaryActions)(t)}})}))},teardown(){(0,s.resetChatMessageDecorators)()}}})),define("discourse/plugins/chat/discourse/preferences-chat-route-map",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default={resource:"user.preferences",map(){this.route("chat")}}})),define("discourse/plugins/chat/discourse/routes/chat-browse-archived",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
afterModel(){this.siteSettings.chat_allow_archiving_channels||this.router.replaceWith("chat.browse")}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-browse-index",["exports","@ember/service","discourse/lib/utilities","discourse/routes/discourse"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#n=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
beforeModel(){if(!this.siteSettings.enable_public_channels)return this.router.transitionTo(`discovery.${(0,s.defaultHomepage)()}`)}activate(){this.chat.activeChannel=null}afterModel(){this.router.replaceWith("chat.browse.open")}}e.default=n})),define("discourse/plugins/chat/discourse/routes/chat-channel-decorator",["exports","@ember/service"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=function(e){return class extends e{static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#s=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#n=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
async model(e){return this.chatChannelsManager.find(e.channelId)}titleToken(){if(this.currentModel)return this.currentModel.isDirectMessageChannel?`${this.currentModel.title}`:`#${this.currentModel.title}`}afterModel(e){if(super.afterModel?.(...arguments),this.chat.activeChannel=e,!e)return this.router.replaceWith("chat")
let{channelTitle:t}=this.paramsFor(this.routeName)
if(t&&t!==e.slugifiedTitle){if("chat.channel.info"===this.routeName)return this.router.replaceWith("chat.channel.info",...e.routeModels)
const t=this.paramsFor("chat.channel.near-message").messageId,s=this.paramsFor("chat.channel.thread").threadId
if(s){const t=this.paramsFor("chat.channel.thread.near-message").messageId
t?this.router.replaceWith("chat.channel.thread.near-message",...e.routeModels,s,t):this.router.replaceWith("chat.channel.thread",...e.routeModels,s)}else t?this.router.replaceWith("chat.channel.near-message",...e.routeModels,t):this.router.replaceWith("chat.channel",...e.routeModels)}else this.controllerFor("chat-channel").set("targetMessageId",null)}}}})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-index",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
afterModel(){this.router.replaceWith("chat.channel.info.settings")}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-info-members",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
afterModel(e){if(!e.isOpen)return this.router.replaceWith("chat.channel.info.settings")}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-info",["exports","@ember/service","discourse/routes/discourse","discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=dt7948.c(class extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatChannelInfoRouteOriginManager",[t.service]))()
#Ts=(()=>{dt7948.i(this,"chatChannelInfoRouteOriginManager")})()
activate(e){const t=e?.from?.name
t&&(this.chatChannelInfoRouteOriginManager.origin=t.startsWith("chat.browse")?a.ORIGINS.browse:a.ORIGINS.channel)}deactivate(){this.chatChannelInfoRouteOriginManager.origin=null}},[n.default])
e.default=i})),define("discourse/plugins/chat/discourse/routes/chat-channel-legacy",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
redirect(){const{channelTitle:e,channelId:t,messageId:s}=this.paramsFor(this.routeName)
this.router.replaceWith("chat.channel",e,t,{queryParams:{messageId:s}})}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-near-message-with-thread",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"site",[t.service]))()
#b=(()=>{dt7948.i(this,"site")})()
beforeModel(){const e=this.modelFor("chat-channel"),{messageId:t,threadId:s}=this.paramsFor(this.routeName)
this.controllerFor("chat-channel").set("messageId",null),(t||this.controllerFor("chat-channel").get("targetMessageId"))&&this.controllerFor("chat-channel").set("targetMessageId",t),s&&this.site.desktopView&&this.router.replaceWith("chat.channel.thread",...e.routeModels,s)}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-near-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
beforeModel(){const e=this.modelFor("chat-channel"),{messageId:t}=this.paramsFor(this.routeName)
this.controllerFor("chat-channel").set("messageId",null),(t||this.controllerFor("chat-channel").get("targetMessageId"))&&this.controllerFor("chat-channel").set("targetMessageId",t),this.router.replaceWith("chat.channel",...e.routeModels)}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread-near-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
beforeModel(){const e=this.modelFor("chat-channel-thread"),{messageId:t}=this.paramsFor(this.routeName);(t||this.controllerFor("chat-channel-thread").get("targetMessageId"))&&this.controllerFor("chat-channel-thread").set("targetMessageId",t),this.router.replaceWith("chat.channel.thread",...e.routeModels)}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-channel-thread",["exports","@ember/object","@ember/service","discourse/routes/discourse"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{static#e=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#r=(()=>dt7948.g(this.prototype,"chatThreadPane",[s.service]))()
#pt=(()=>{dt7948.i(this,"chatThreadPane")})()
redirectToChannel(e,t){t.abort(),this.chatStateManager.closeSidePanel(),this.router.transitionTo("chat.channel",...e.routeModels)}model(e,t){const s=this.modelFor("chat.channel")
return s.threadsManager.find(s.id,e.threadId).catch((()=>{this.redirectToChannel(s,t)}))}afterModel(e,t){const s=this.modelFor("chat.channel")
s.threadingEnabled||e.force?s.activeThread=e:this.redirectToChannel(s,t)}willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName&&e.targetName.startsWith("chat")||this.chatStateManager.closeSidePanel()}static#c=(()=>dt7948.n(this.prototype,"willTransition",[t.action]))()
beforeModel(){const{messageId:e}=this.paramsFor(this.routeName+".near-message")
!e&&this.controllerFor("chat-channel-thread").get("targetMessageId")&&this.controllerFor("chat-channel-thread").set("targetMessageId",null),this.chatStateManager.openSidePanel()}}e.default=n})),define("discourse/plugins/chat/discourse/routes/chat-channel-threads",["exports","@ember/object","@ember/service","discourse/routes/discourse"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{static#e=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"chatThreadListPane",[s.service]))()
#qn=(()=>{dt7948.i(this,"chatThreadListPane")})()
static#n=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
beforeModel(e){const t=this.modelFor("chat.channel")
if(!t.threadingEnabled)return e.abort(),void this.router.transitionTo("chat.channel",...t.routeModels)
this.chatStateManager.openSidePanel()}activate(){this.chat.activeMessage=null}static#c=(()=>dt7948.n(this.prototype,"activate",[t.action]))()
willTransition(e){"chat.channel.index"!==e.targetName&&"chat.channel.near-message"!==e.targetName&&"chat.index"!==e.targetName&&e.targetName.startsWith("chat")||this.chatStateManager.closeSidePanel()}static#l=(()=>dt7948.n(this.prototype,"willTransition",[t.action]))()}e.default=n})),define("discourse/plugins/chat/discourse/routes/chat-channel",["exports","@ember/service","discourse/routes/discourse","discourse/plugins/chat/discourse/routes/chat-channel-decorator"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=dt7948.c(class extends s.default{static#e=(()=>dt7948.g(this.prototype,"site",[t.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#s=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
redirect(e){if(this.site.mobileView)return
const t=this.paramsFor("chat.channel.near-message").messageId,s=this.paramsFor("chat.channel.thread").threadId
e.threadingEnabled&&!t&&!s&&e.threadsManager.unreadThreadCount>0&&this.router.transitionTo("chat.channel.threads",...e.routeModels)}},[a.default])
e.default=n})),define("discourse/plugins/chat/discourse/routes/chat-channels",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
activate(){this.chat.activeChannel=null}beforeModel(){const e=this.currentUser.custom_fields.last_chat_channel_id
this.site.desktopView&&(e?this.chatChannelsManager.find(e).then((e=>this.router.replaceWith("chat.channel",...e.routeModels))):this.router.replaceWith("chat.browse.open"))}model(){return this.chatChannelsManager.publicMessageChannels}}e.default=a}))
define("discourse/plugins/chat/discourse/routes/chat-direct-messages",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
activate(){this.chat.activeChannel=null}beforeModel(){if(this.site.desktopView)if(0===this.chatChannelsManager.directMessageChannels.length)this.router.replaceWith("chat.direct-messages")
else{const e=this.currentUser.custom_fields.last_chat_channel_id
this.chatChannelsManager.find(e).then((e=>this.router.replaceWith("chat.channel",...e.routeModels)))}}model(){return this.chatChannelsManager.directMessageChannels}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-draft-channel",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
beforeModel(){this.chat.userCanDirectMessage||this.router.transitionTo("chat")}activate(){this.chat.activeChannel=null}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-index",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#n=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#c=(()=>dt7948.g(this.prototype,"currentUser",[t.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
get hasThreads(){return!!this.siteSettings.chat_threads_enabled&&this.chatChannelsManager.hasThreadedChannels}get hasDirectMessages(){return this.chat.userCanAccessDirectMessages}get isPublicChannelsEnabled(){return this.siteSettings.enable_public_channels}activate(){this.chat.activeChannel=null}async model(){return await this.chat.loadChannels()}async redirect(){return"my_threads"===this.siteSettings.chat_preferred_index&&this.hasThreads?this.router.replaceWith("chat.threads"):"direct_messages"===this.siteSettings.chat_preferred_index&&this.hasDirectMessages?this.router.replaceWith("chat.direct-messages"):"channels"===this.siteSettings.chat_preferred_index&&this.isPublicChannelsEnabled?this.router.replaceWith("chat.channels"):!this.isPublicChannelsEnabled&&this.hasDirectMessages?this.router.replaceWith("chat.direct-messages"):this.router.replaceWith("chat.browse.open")}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-new-message",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
beforeModel(e){const t=this.paramsFor(this.routeName).recipients?.split(",")
if(!t)return e.abort(),this.router.transitionTo("chat")
this.chat.upsertDmChannel({usernames:t}).then((e=>{this.router.transitionTo("chat.channel",e.title,e.id)}))}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat-threads",["exports","@ember/service","discourse/routes/discourse"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatStateManager",[t.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
activate(){this.chat.activeChannel=null,this.chatStateManager.closeSidePanel()}}e.default=a})),define("discourse/plugins/chat/discourse/routes/chat",["exports","@ember/runloop","@ember/service","discourse/lib/plugin-api","discourse/lib/utilities","discourse/mixins/scroll-top","discourse/routes/discourse","discourse-i18n","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,s,a,n,i,r,o,c,l){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class d extends r.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"chatDrawerRouter",[s.service]))()
#Qe=(()=>{dt7948.i(this,"chatDrawerRouter")})()
static#c=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
titleToken(){return o.default.t("chat.title_capitalized")}beforeModel(e){if(!this.chat.userCanChat)return this.router.transitionTo(`discovery.${(0,n.defaultHomepage)()}`)
if(e.from&&this.chatStateManager.isDrawerPreferred&&this.chatDrawerRouter.routeNames.includes(e.targetName)){if(e.abort(),this.chatDrawerRouter.currentRouteName===e.targetName)return
let t=e.intent.url
return e.targetName.startsWith("chat.channel")?t??=this.router.urlFor(e.targetName,...e.intent.contexts):t??=this.router.urlFor(e.targetName),void this.appEvents.trigger("chat:open-url",t)}this.appEvents.trigger("chat:toggle-close")}activate(){(0,a.withPluginApi)("1.8.0",(e=>{e.setSidebarPanel(l.CHAT_PANEL);(0,c.getUserChatSeparateSidebarMode)(this.currentUser).never?(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons()):e.setSeparatedSidebarMode()})),this.chatStateManager.storeAppURL(),this.chat.updatePresence(),(0,t.schedule)("afterRender",(()=>{document.body.classList.add("has-full-page-chat"),document.documentElement.classList.add("has-full-page-chat"),(0,i.scrollTop)()}))}deactivate(e){if((0,a.withPluginApi)("1.8.0",(e=>{(0,l.initSidebarState)(e,this.currentUser)})),e){let t=this.router.urlFor(e.from.name)
"/"!==this.router.rootURL&&(t=t.replace(new RegExp(`^${this.router.rootURL}`),"/")),this.chatStateManager.storeChatURL(t)}this.chat.activeChannel=null,this.chat.updatePresence(),(0,t.schedule)("afterRender",(()=>{document.body.classList.remove("has-full-page-chat"),document.documentElement.classList.remove("has-full-page-chat")}))}}e.default=d})),define("discourse/plugins/chat/discourse/routes/preferences-chat",["exports","@ember/service","discourse/lib/utilities","discourse/routes/restricted-user"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#n=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[t.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
showFooter=!0
setupController(e,t){if(!this.siteSettings.chat_enabled||!t.can_chat&&!this.currentUser?.admin)return this.router.transitionTo(`discovery.${(0,s.defaultHomepage)()}`)
e.set("model",t)}}e.default=n})),define("discourse/plugins/chat/discourse/services/chat-admin-api",["exports","@ember/service","discourse/lib/ajax"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{async exportMessages(){await this.#Gn("/export/messages")}get#Kn(){return"/chat/admin"}#Gn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Kn}${e}`,{type:"POST",data:t})}}e.default=a})),define("discourse/plugins/chat/discourse/services/chat-api",["exports","@ember/service","discourse/lib/ajax","discourse/plugins/chat/discourse/models/user-chat-channel-membership","discourse/plugins/chat/discourse/lib/collection"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
channel(e){return this.#Jn(`/channels/${e}`)}channelThreadMessages(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return this.#Jn(`/channels/${e}/threads/${t}/messages?${new URLSearchParams(s).toString()}`)}channelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.#Jn(`/channels/${e}/messages?${new URLSearchParams(t).toString()}`)}flagMessage(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return this.#Yn(`/channels/${e}/messages/${t}/flags`,s)}thread(e,t){return this.#Jn(`/channels/${e}/threads/${t}`)}threads(e,t){return new n.default(`${this.#Kn}/channels/${e}/threads`,t)}channels(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return new n.default(`${this.#Kn}/channels`,(e=>e.channels.map((e=>this.chatChannelsManager.store(e)))),e)}moveChannelMessages(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.#Yn(`/channels/${e}/messages/moves`,{move:t})}destroyChannel(e){return this.#Zn(`/channels/${e}`)}createChannel(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return this.#Yn("/channels",{channel:e}).then((e=>this.chatChannelsManager.store(e.channel)))}categoryPermissions(e){return this.#Jn(`/category-chatables/${e}/permissions`)}sendMessage(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`/chat/${e}`,{ignoreUnsent:!1,type:"POST",data:t})}stopMessageStreaming(e,t){return this.#Zn(`/channels/${e}/messages/${t}/streaming`)}trashMessage(e,t){return this.#Zn(`/channels/${e}/messages/${t}`)}trashMessages(e,t){return this.#Zn(`/channels/${e}/messages`,{message_ids:t})}createChannelArchive(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.#Yn(`/channels/${e}/archives`,{archive:t})}updateChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.#Xn(`/channels/${e}`,{channel:t})}createThread(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return this.#Yn(`/channels/${e}/threads`,{title:s.title,original_message_id:t})}updateChannelStatus(e,t){return this.#Xn(`/channels/${e}/status`,{status:t})}listChannelMemberships(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return new n.default(`${this.#Kn}/channels/${e}/memberships`,(e=>e.memberships.map((e=>a.default.create(e)))),t)}listCurrentUserChannels(){return this.#Jn("/me/channels")}followChannel(e){return this.#Yn(`/channels/${e}/memberships/me`).then((e=>a.default.create(e.membership)))}unfollowChannel(e){return this.#Zn(`/channels/${e}/memberships/me/follows`).then((e=>a.default.create(e.membership)))}async leaveChannel(e){await this.#Zn(`/channels/${e}/memberships/me`)
const t=await this.chatChannelsManager.find(e,{fetchIfNotFound:!1})
t&&this.chatChannelsManager.remove(t)}userThreads(e){return new n.default(`${this.#Kn}/me/threads`,e)}updateCurrentUserChannelNotificationsSettings(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return this.#Xn(`/channels/${e}/notifications-settings/me`,{notifications_settings:t})}updateCurrentUserThreadNotificationsSettings(e,t,s){return this.#Xn(`/channels/${e}/threads/${t}/notifications-settings/me`,{notification_level:s.notificationLevel})}updateCurrentUserThreadTitlePrompt(e,t){return this.#Yn(`/channels/${e}/threads/${t}/mark-thread-title-prompt-seen/me`)}saveDraft(e,t){let a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=`/chat/api/channels/${e}`
return a.threadId&&(n+=`/threads/${a.threadId}`),n+="/drafts",(0,s.ajax)(n,{type:"POST",data:{data:t},ignoreUnsent:!1}).then((()=>{this.chat.markNetworkAsReliable()})).catch((e=>{e.jqXHR?.responseJSON?.errors?.length||this.chat.markNetworkAsUnreliable()}))}publishReaction(e,t,a,n){return(0,s.ajax)(`/chat/${e}/react/${t}`,{type:"PUT",data:{react_action:n,emoji:a}})}restoreMessage(e,t){return this.#Xn(`/channels/${e}/messages/${t}/restore`)}rebakeMessage(e,t){return(0,s.ajax)(`/chat/${e}/${t}/rebake`,{type:"PUT"})}editMessage(e,t,s){return this.#Xn(`/channels/${e}/messages/${t}`,s)}markAllChannelsAsRead(){return this.#Xn("/channels/read")}chatables(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
return this.#Jn("/chatables",e)}markChannelAsRead(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
return this.#Xn(`/channels/${e}/read?message_id=${t}`)}markThreadAsRead(e,t,s){return this.#Xn(`/channels/${e}/threads/${t}/read?message_id=${s}`)}editThread(e,t,s){return this.#Xn(`/channels/${e}/threads/${t}`,s)}generateQuote(e,t){return(0,s.ajax)(`/chat/${e}/quote`,{type:"POST",data:{message_ids:t}})}invite(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{}
return this.#Yn(`/channels/${e}/invites`,{user_ids:t,message_id:s.messageId})}addMembersToChannel(e,t){return this.#Yn(`/channels/${e}/memberships`,{usernames:t.usernames,groups:t.groups})}get#Kn(){return"/chat/api"}#Jn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Kn}${e}`,{type:"GET",data:t})}#Xn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Kn}${e}`,{type:"PUT",data:t})}#Yn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Kn}${e}`,{type:"POST",data:t})}#Zn(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}
return(0,s.ajax)(`${this.#Kn}${e}`,{type:"DELETE",data:t})}}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-audio-manager",["exports","@ember/service","discourse-common/config/environment","discourse-common/lib/get-url"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.CHAT_SOUNDS=void 0
const n=e.CHAT_SOUNDS={bell:[{src:"/plugins/chat/audio/bell.mp3",type:"audio/mpeg"}],ding:[{src:"/plugins/chat/audio/ding.mp3",type:"audio/mpeg"}]}
class i extends t.default{canPlay=!0
async play(e){this.canPlay&&(await this.#Qn(e),this.canPlay=!1,setTimeout((()=>{this.canPlay=!0}),3e3))}async#Qn(e){const t=(0,a.getURLWithCDN)((n[e]||n.bell)[0].src),i=new Audio(t)
try{await i.play()}catch(r){(0,s.isTesting)()||console.info("[chat] User needs to interact with DOM before we can play notification sounds.")}}}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-channel-composer",["exports","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","discourse/lib/body-scroll-lock"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends n.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatApi",[n.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#n=(()=>dt7948.g(this.prototype,"currentUser",[n.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#r=(()=>dt7948.g(this.prototype,"router",[n.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#c=(()=>dt7948.g(this.prototype,"threadComposer",[(0,n.service)("chat-thread-composer")]))()
#ei=(()=>{dt7948.i(this,"threadComposer")})()
static#l=(()=>dt7948.g(this.prototype,"loadingSlider",[n.service]))()
#Lt=(()=>{dt7948.i(this,"loadingSlider")})()
static#d=(()=>dt7948.g(this.prototype,"capabilities",[n.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#h=(()=>dt7948.g(this.prototype,"appEvents",[n.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#u=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#p=(()=>dt7948.g(this.prototype,"textarea",[t.tracked]))()
#ti=(()=>{dt7948.i(this,"textarea")})()
static#j=(()=>dt7948.g(this.prototype,"scroller",[t.tracked]))()
#si=(()=>{dt7948.i(this,"scroller")})()
init(){super.init(...arguments),this.appEvents.on("discourse:focus-changed",this,this.blur)}willDestroy(){super.willDestroy(...arguments),this.appEvents.off("discourse:focus-changed",this,this.blur)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e),(0,a.schedule)("afterRender",(()=>{this.capabilities.isIOS&&!this.capabilities.isIpadOS&&(0,i.disableBodyScroll)(this.scroller,{reverse:!0})}))}static#P=(()=>dt7948.n(this.prototype,"focus",[s.action]))()
blur(){this.textarea?.blur()}static#O=(()=>dt7948.n(this.prototype,"blur",[s.action]))()
edit(e){this.chat.activeMessage=null,e.editing=!0,e.channel.draft=e,this.site.desktopView&&this.focus({refreshHeight:!0,ensureAtEnd:!0})}static#D=(()=>dt7948.n(this.prototype,"edit",[s.action]))()
async replyTo(e){if(this.chat.activeMessage=null,e.channel.threadingEnabled){if(!e.thread?.id)try{this.loadingSlider.transitionStarted()
const t=await this.chatApi.createThread(e.channel.id,e.id)
e.thread=e.channel.threadsManager.add(e.channel,t)}finally{this.loadingSlider.transitionEnded()}e.channel.resetDraft(this.currentUser)
try{await this.router.transitionTo("chat.channel.thread",...e.thread.routeModels)}catch(t){if("TransitionAborted"!==t.name)throw t}this.threadComposer.focus({ensureAtEnd:!0,refreshHeight:!0})}else e.channel.draft.inReplyTo=e,this.focus({ensureAtEnd:!0,refreshHeight:!0})}static#I=(()=>dt7948.n(this.prototype,"replyTo",[s.action]))()}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-channel-emoji-picker-manager",["exports","discourse/plugins/chat/discourse/services/chat-emoji-picker-manager"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{}e.default=s})),define("discourse/plugins/chat/discourse/services/chat-channel-info-route-origin-manager",["exports","@ember/service","@ember/utils","discourse/lib/key-value-store"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=e.ORIGINS=e.INFO_ROUTE_NAMESPACE=e.BACK_KEY=void 0
const n=e.BACK_KEY="back",i=e.INFO_ROUTE_NAMESPACE="discourse_chat_info_route",r=e.ORIGINS={channel:"channel",browse:"browse"}
class o extends t.default{store=(()=>new a.default(i))()
get origin(){const e=this.store.getObject(n)
if(e)return r[e]}set origin(e){this.store.setObject({key:n,value:e})}get isBrowse(){return this.origin===r.browse}get isChannel(){return this.origin===r.channel||(0,s.isEmpty)(this.origin)}}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-channel-notices-manager",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins","discourse/plugins/chat/discourse/models/chat-notice"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class i extends s.default{static#e=(()=>dt7948.g(this.prototype,"notices",[t.tracked],(function(){return new a.TrackedArray})))()
#ai=(()=>{dt7948.i(this,"notices")})()
handleNotice(e){this.notices.pushObject(n.default.create(e))}clearNotice(e){this.notices.removeObject(e)}}e.default=i})),define("discourse/plugins/chat/discourse/services/chat-channel-pane",["exports","@glimmer/tracking","@ember/object","@ember/service"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends a.default{static#e=(()=>dt7948.g(this.prototype,"chat",[a.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"reacting",[t.tracked],(function(){return!1})))()
#ni=(()=>{dt7948.i(this,"reacting")})()
static#n=(()=>dt7948.g(this.prototype,"selectingMessages",[t.tracked],(function(){return!1})))()
#ii=(()=>{dt7948.i(this,"selectingMessages")})()
static#r=(()=>dt7948.g(this.prototype,"lastSelectedMessage",[t.tracked],(function(){return null})))()
#ri=(()=>{dt7948.i(this,"lastSelectedMessage")})()
static#c=(()=>dt7948.g(this.prototype,"sending",[t.tracked],(function(){return!1})))()
#se=(()=>{dt7948.i(this,"sending")})()
get channel(){return this.chat.activeChannel}get selectedMessageIds(){return this.channel.messagesManager.selectedMessages.mapBy("id")}cancelSelecting(){this.selectingMessages=!1,this.channel.messagesManager.clearSelectedMessages()}static#l=(()=>dt7948.n(this.prototype,"cancelSelecting",[s.action]))()
onSelectMessage(e){this.lastSelectedMessage=e,this.selectingMessages=!0}static#d=(()=>dt7948.n(this.prototype,"onSelectMessage",[s.action]))()}e.default=n})),define("discourse/plugins/chat/discourse/services/chat-channel-scroll-positions",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"positions",[t.tracked],(function(){return new a.TrackedMap})))()
#oi=(()=>{dt7948.i(this,"positions")})()
get(e){return this.positions.get(e)}set(e,t){this.positions.set(e,t)}delete(e){this.positions.has(e)&&this.positions.delete(e)}}e.default=n})),define("discourse/plugins/chat/discourse/services/chat-channels-manager",["exports","@glimmer/tracking","@ember/service","@ember-compat/tracked-built-ins","rsvp","discourse/lib/ajax-error","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-channel"],(function(e,t,s,a,n,i,r,o){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class c extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[s.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"chatSubscriptionsManager",[s.service]))()
#ci=(()=>{dt7948.i(this,"chatSubscriptionsManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[s.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#l=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#d=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#h=(()=>dt7948.g(this.prototype,"_cached",[t.tracked],(function(){return new a.TrackedObject})))()
#Qs=(()=>{dt7948.i(this,"_cached")})()
async find(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{fetchIfNotFound:!0}
const s=this.#li(e)
return s?n.default.resolve(s):t.fetchIfNotFound?this.#di(e):n.default.resolve()}get channels(){return Object.values(this._cached)}static#u=(()=>dt7948.n(this.prototype,"channels",[t.cached]))()
store(e){let t
return(arguments.length>1&&void 0!==arguments[1]?arguments[1]:{}).replace||(t=this.#li(e.id)),t||(t=e instanceof o.default?e:o.default.create(e),this.#aa(t)),void 0!==e.meta?.message_bus_last_ids?.channel_message_bus_last_id&&(t.channelMessageBusLastId=e.meta.message_bus_last_ids.channel_message_bus_last_id),t}async follow(e){return this.chatSubscriptionsManager.startChannelSubscription(e),e.currentUserMembership.following?e:this.chatApi.followChannel(e.id).then((t=>(e.currentUserMembership=t,e)))}async unfollow(e){try{return this.chatSubscriptionsManager.stopChannelSubscription(e),e.currentUserMembership=await this.chatApi.unfollowChannel(e.id),e}catch(t){(0,i.popupAjaxError)(t)}}async markAllChannelsRead(){return this.chatApi.markAllChannelsAsRead()}static#p=(()=>dt7948.n(this.prototype,"markAllChannelsRead",[(0,r.debounce)(300)]))()
remove(e){e&&(this.chatSubscriptionsManager.stopChannelSubscription(e),delete this._cached[e.id])}get hasThreadedChannels(){return this.publicMessageChannels?.some((e=>e.threadingEnabled))}static#j=(()=>dt7948.n(this.prototype,"hasThreadedChannels",[t.cached]))()
get allChannels(){return[...this.publicMessageChannels,...this.directMessageChannels].sort(((e,t)=>t?.currentUserMembership?.lastViewedAt?.localeCompare?.(e?.currentUserMembership?.lastViewedAt)))}get publicMessageChannels(){return this.channels.filter((e=>e.isCategoryChannel&&e.currentUserMembership.following)).sort(((e,t)=>e?.slug?.localeCompare?.(t?.slug)))}static#P=(()=>dt7948.n(this.prototype,"publicMessageChannels",[t.cached]))()
get publicMessageChannelsByActivity(){return this.#hi(this.publicMessageChannels)}get directMessageChannels(){return this.#ui(this.channels.filter((e=>{const t=e.currentUserMembership
return e.isDirectMessageChannel&&t.following})))}static#O=(()=>dt7948.n(this.prototype,"directMessageChannels",[t.cached]))()
get truncatedDirectMessageChannels(){return this.directMessageChannels.slice(0,20)}async#di(e){try{const t=await this.chatApi.channel(e)
return this.store(t.channel)}catch(t){(0,i.popupAjaxError)(t)}}get publicMessageChannelsEmpty(){return 0===this.publicMessageChannels?.length&&this.chatStateManager.hasPreloadedChannels}get displayPublicChannels(){return!!this.siteSettings.enable_public_channels&&(!!this.chatStateManager.hasPreloadedChannels&&(!this.publicMessageChannelsEmpty||(this.currentUser?.staff||this.currentUser?.has_joinable_public_channels)))}#aa(e){e&&(this._cached[e.id]=e)}#li(e){return this._cached[e]}#hi(e){return e.sort(((e,t)=>e.tracking.mentionCount>0&&t.tracking.mentionCount>0?e.slug?.localeCompare?.(t.slug):e.tracking.mentionCount>0||t.tracking.mentionCount>0?e.tracking.mentionCount>t.tracking.mentionCount?-1:1:e.tracking.unreadCount>0&&t.tracking.unreadCount>0?e.slug?.localeCompare?.(t.slug):e.tracking.unreadCount>0||t.tracking.unreadCount>0?e.tracking.unreadCount>t.tracking.unreadCount?-1:1:e.slug?.localeCompare?.(t.slug)))}#ui(e){return e.sort(((e,t)=>e.lastMessage.id?t.lastMessage.id?e.tracking.unreadCount===t.tracking.unreadCount?new Date(e.lastMessage.createdAt)>new Date(t.lastMessage.createdAt)?-1:1:e.tracking.unreadCount>t.tracking.unreadCount?-1:1:-1:1))}}e.default=c})),define("discourse/plugins/chat/discourse/services/chat-composer-presence-manager",["exports","@ember/runloop","@ember/service","discourse-common/config/environment"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"presence",[s.service]))()
#bt=(()=>{dt7948.i(this,"presence")})()
willDestroy(){this.leave()}notifyState(e,s){s?(this._channelName!==e&&(this._enter(e),this._channelName=e),(0,a.isTesting)()||(this._autoLeaveTimer=(0,t.debounce)(this,this.leave,1e4))):this.leave()}leave(){this._presentChannel?.leave(),this._presentChannel=null,this._channelName=null,this._autoLeaveTimer&&((0,t.cancel)(this._autoLeaveTimer),this._autoLeaveTimer=null)}_enter(e){this.leave(),this._presentChannel=this.presence.getChannel(e),this._presentChannel.enter()}}e.default=n})),define("discourse/plugins/chat/discourse/services/chat-composer-warnings-tracker",["exports","@glimmer/tracking","@ember/runloop","@ember/service","discourse/lib/ajax","discourse-common/lib/debounce","discourse-common/utils/decorators"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const o=-1,c=0,l=1
class d extends a.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[a.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#s=(()=>dt7948.g(this.prototype,"unreachableGroupMentions",[t.tracked],(function(){return[]})))()
#pi=(()=>{dt7948.i(this,"unreachableGroupMentions")})()
static#n=(()=>dt7948.g(this.prototype,"overMembersLimitGroupMentions",[t.tracked],(function(){return[]})))()
#mi=(()=>{dt7948.i(this,"overMembersLimitGroupMentions")})()
static#r=(()=>dt7948.g(this.prototype,"tooManyMentions",[t.tracked],(function(){return!1})))()
#gi=(()=>{dt7948.i(this,"tooManyMentions")})()
static#c=(()=>dt7948.g(this.prototype,"channelWideMentionDisallowed",[t.tracked],(function(){return!1})))()
#fi=(()=>{dt7948.i(this,"channelWideMentionDisallowed")})()
static#l=(()=>dt7948.g(this.prototype,"mentionsCount",[t.tracked],(function(){return 0})))()
#_i=(()=>{dt7948.i(this,"mentionsCount")})()
static#d=(()=>dt7948.g(this.prototype,"mentionsTimer",[t.tracked],(function(){return null})))()
#bi=(()=>{dt7948.i(this,"mentionsTimer")})()
_mentionWarningsSeen={}
willDestroy(){(0,s.cancel)(this.mentionsTimer)}reset(){this.#vi(),this.mentionsCount=0,(0,s.cancel)(this.mentionsTimer)}static#h=(()=>dt7948.n(this.prototype,"reset",[r.bind]))()
trackMentions(e,t){if(t)return this._trackMentions(e)
this.mentionsTimer=(0,i.default)(this,this._trackMentions,e,1e3)}static#u=(()=>dt7948.n(this.prototype,"trackMentions",[r.bind]))()
_trackMentions(e){this.siteSettings.enable_mentions&&e.parseMentions().then((t=>{if(this.mentionsCount=t?.length,this.mentionsCount>0){if(this.tooManyMentions=this.mentionsCount>this.siteSettings.max_mentions_per_chat_message,!this.tooManyMentions){const s=t.filter((e=>!(e in this._mentionWarningsSeen)))
this.channelWideMentionDisallowed=!e.channel.allowChannelWideMentions&&(t.includes("here")||t.includes("all")),s?.length>0?this.#yi(s,t):this.#Mi(t)}}else this.#vi()}))}static#p=(()=>dt7948.n(this.prototype,"_trackMentions",[r.bind]))()
#vi(){this.tooManyMentions=!1,this.channelWideMentionDisallowed=!1,this.unreachableGroupMentions=[],this.overMembersLimitGroupMentions=[]}#yi(e,t){(0,n.ajax)("/chat/api/mentions/groups.json",{data:{mentions:e}}).then((e=>{e.unreachable.forEach((e=>{this._mentionWarningsSeen[e]=c})),e.over_members_limit.forEach((e=>{this._mentionWarningsSeen[e]=l})),e.invalid.forEach((e=>{this._mentionWarningsSeen[e]=o})),this.#Mi(t)})).catch(this.#Mi(t))}#Mi(e){const t=e.reduce(((e,t)=>(t in this._mentionWarningsSeen&&this._mentionWarningsSeen[t]!==o&&(this._mentionWarningsSeen[t]===c?e[0].push(t):e[1].push(t)),e)),[[],[]])
this.unreachableGroupMentions=t[0],this.overMembersLimitGroupMentions=t[1]}}e.default=d})),define("discourse/plugins/chat/discourse/services/chat-drafts-manager",["exports","@ember/runloop","@ember/service"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[s.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
drafts={}
async add(e,t,s){try{this.drafts[this.key(t,s)]=e,await this.persistDraft(e,t,s)}catch(a){console.log("Couldn't save draft",a)}}get(e,t){return this.drafts[this.key(e,t)]}remove(e,t){delete this.drafts[this.key(e,t)]}reset(){this.drafts={}}key(e,t){let s=`c-${e}`
return t&&(s+=`:t-${t}`),s.toString()}async persistDraft(e,t,s){try{await this.chatApi.saveDraft(t,e.toJSONDraft(),{threadId:s}),e.draftSaved=!0}catch(a){}}willDestroy(){(0,t.cancel)(this?._persistHandler)}}e.default=a})),define("discourse/plugins/chat/discourse/services/chat-drawer-router",["exports","@glimmer/tracking","@ember/service","discourse/plugins/chat/discourse/components/chat/drawer-routes/browse","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-info-members","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-info-settings","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-thread","discourse/plugins/chat/discourse/components/chat/drawer-routes/channel-threads","discourse/plugins/chat/discourse/components/chat/drawer-routes/channels","discourse/plugins/chat/discourse/components/chat/drawer-routes/direct-messages","discourse/plugins/chat/discourse/components/chat/drawer-routes/threads"],(function(e,t,s,a,n,i,r,o,c,l,d,h){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const u={chat:{name:l.default,redirect:e=>"my_threads"===e.siteSettings.chat_preferred_index&&e.hasThreads?"/chat/threads":"direct_messages"===e.siteSettings.chat_preferred_index&&e.hasDirectMessages?"/chat/direct-messages":e.siteSettings.enable_public_channels?void 0:"/chat/direct-messages"},"chat.index":{name:l.default},"chat.browse":{name:a.default,extractParams:()=>({currentTab:"open"})},"chat.browse.index":{name:a.default,extractParams:()=>({currentTab:"open"})},"chat.browse.open":{name:a.default,extractParams:e=>({currentTab:e.localName})},"chat.browse.archived":{name:a.default,extractParams:e=>({currentTab:e.localName})},"chat.browse.closed":{name:a.default,extractParams:e=>({currentTab:e.localName})},"chat.browse.all":{name:a.default,extractParams:e=>({currentTab:e.localName})},"chat.channels":{name:l.default},"chat.channel":{name:n.default},"chat.channel.index":{name:n.default},"chat.channel.thread":{name:o.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.index":{name:o.default,extractParams:e=>({channelId:e.parent.params.channelId,threadId:e.params.threadId})},"chat.channel.thread.near-message":{name:o.default,extractParams:e=>({channelId:e.parent.parent.params.channelId,threadId:e.parent.params.threadId,messageId:e.params.messageId})},"chat.channel.threads":{name:c.default,extractParams:e=>({channelId:e.parent.params.channelId})},"chat.direct-messages":{name:d.default},"chat.threads":{name:h.default},"chat.channel.near-message":{name:n.default,extractParams:e=>({channelId:e.parent.params.channelId,messageId:e.params.messageId})},"chat.channel.near-message-with-thread":{name:n.default,extractParams:e=>({channelId:e.parent.params.channelId,messageId:e.params.messageId})},"chat.channel.info.settings":{name:r.default,extractParams:e=>({channelId:e.parent.params.channelId})},"chat.channel.info.members":{name:i.default,extractParams:e=>({channelId:e.parent.params.channelId})},"chat.channel-legacy":{name:n.default,extractParams:e=>({channelId:e.params.channelId,messageId:e.queryParams.messageId})}}
class p extends s.default{static#e=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#s=(()=>dt7948.g(this.prototype,"chatHistory",[s.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#n=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#r=(()=>dt7948.g(this.prototype,"siteSettings",[s.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
static#c=(()=>dt7948.g(this.prototype,"chatStateManager",[s.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#l=(()=>dt7948.g(this.prototype,"chatChannelsManager",[s.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#d=(()=>dt7948.g(this.prototype,"component",[t.tracked],(function(){return null})))()
#Ci=(()=>{dt7948.i(this,"component")})()
static#h=(()=>dt7948.g(this.prototype,"drawerRoute",[t.tracked],(function(){return null})))()
#wi=(()=>{dt7948.i(this,"drawerRoute")})()
static#u=(()=>dt7948.g(this.prototype,"params",[t.tracked],(function(){return null})))()
#Si=(()=>{dt7948.i(this,"params")})()
static#p=(()=>dt7948.g(this.prototype,"currentRouteName",[t.tracked],(function(){return null})))()
#ki=(()=>{dt7948.i(this,"currentRouteName")})()
routeNames=(()=>Object.keys(u))()
get hasThreads(){return!!this.siteSettings.chat_threads_enabled&&this.chatChannelsManager.hasThreadedChannels}get hasDirectMessages(){return this.chat.userCanAccessDirectMessages}stateFor(e){this.drawerRoute?.deactivate?.(this.chatHistory.currentRoute),this.chatHistory.visit(e),this.drawerRoute=u[e.name],this.params=this.drawerRoute?.extractParams?.(e)||e.params,this.component=this.drawerRoute?.name||l.default,this.currentRouteName=e.name,this.drawerRoute.activate?.(e)
const t=this.drawerRoute.redirect?.(this)
t&&this.stateFor(this.#Ti(t))}#Ti(e){let t=this.router.recognize(e)
return"index"===t.localName&&(t=t.parent),t}}e.default=p})),define("discourse/plugins/chat/discourse/services/chat-drawer-size",["exports","@ember/service","discourse/lib/key-value-store"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends t.default{STORE_NAMESPACE="discourse_chat_drawer_size_"
MIN_HEIGHT=300
MIN_WIDTH=250
store=(()=>new s.default(this.STORE_NAMESPACE))()
get size(){return{width:this.store.getObject("width")||400,height:this.store.getObject("height")||530}}set size(e){let{width:t,height:s}=e
this.store.setObject({key:"width",value:this.#xi(t,this.MIN_WIDTH)}),this.store.setObject({key:"height",value:this.#xi(s,this.MIN_HEIGHT)})}#xi(e,t){return Math.max(e,t)}}e.default=a})),define("discourse/plugins/chat/discourse/services/chat-emoji-picker-manager",["exports","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","rsvp","discourse/lib/ajax","discourse/lib/ajax-error","discourse-common/config/environment","discourse-common/lib/helpers","discourse-common/utils/decorators"],(function(e,t,s,a,n,i,r,o,c,l,d){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const h=(0,c.isTesting)()?0:125,u=["favorites","smileys_&_emotion"],p="favorites"
class m extends n.default{static#e=(()=>dt7948.g(this.prototype,"appEvents",[n.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#s=(()=>dt7948.g(this.prototype,"closing",[t.tracked],(function(){return!1})))()
#ji=(()=>{dt7948.i(this,"closing")})()
static#n=(()=>dt7948.g(this.prototype,"loading",[t.tracked],(function(){return!1})))()
#Vt=(()=>{dt7948.i(this,"loading")})()
static#r=(()=>dt7948.g(this.prototype,"picker",[t.tracked],(function(){return null})))()
#Ei=(()=>{dt7948.i(this,"picker")})()
static#c=(()=>dt7948.g(this.prototype,"emojis",[t.tracked],(function(){return null})))()
#Pi=(()=>{dt7948.i(this,"emojis")})()
static#l=(()=>dt7948.g(this.prototype,"visibleSections",[t.tracked],(function(){return u})))()
#Ai=(()=>{dt7948.i(this,"visibleSections")})()
static#d=(()=>dt7948.g(this.prototype,"lastVisibleSection",[t.tracked],(function(){return p})))()
#Oi=(()=>{dt7948.i(this,"lastVisibleSection")})()
static#h=(()=>dt7948.g(this.prototype,"element",[t.tracked],(function(){return null})))()
#Ui=(()=>{dt7948.i(this,"element")})()
get sections(){return!this.loading&&this.emojis?Object.keys(this.emojis):[]}closeExisting(){this.visibleSections=u,this.lastVisibleSection=p,this.picker=null}static#u=(()=>dt7948.n(this.prototype,"closeExisting",[d.bind]))()
close(){this.closing=!0,(0,a.later)((()=>{this.isDestroyed||this.isDestroying||(this.visibleSections=u,this.lastVisibleSection=p,this.closing=!1,this.picker=null)}),h)}static#p=(()=>dt7948.n(this.prototype,"close",[d.bind]))()
addVisibleSections(e){this.visibleSections=(0,l.makeArray)(this.visibleSections).concat((0,l.makeArray)(e)).uniq()}open(e){this.loadEmojis(),this.picker?this.picker.trigger===e.trigger?this.closeExisting():(this.closeExisting(),this.picker=e):this.picker=e}loadEmojis(){return this.emojis?i.Promise.resolve():(this.loading=!0,(0,r.ajax)("/chat/emojis.json").then((e=>{this.emojis=e})).catch(o.popupAjaxError).finally((()=>{this.loading=!1})))}static#j=(()=>dt7948.n(this.prototype,"loadEmojis",[s.action]))()}e.default=m})),define("discourse/plugins/chat/discourse/services/chat-emoji-reaction-store",["exports","@ember/service","discourse/lib/implicit-injections","discourse/lib/key-value-store"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const n=dt7948.c(class extends t.default{static#e=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
STORE_NAMESPACE="discourse_chat_emoji_reaction_"
MAX_DISPLAYED_EMOJIS=20
MAX_TRACKED_EMOJIS=(()=>2*this.MAX_DISPLAYED_EMOJIS)()
SKIN_TONE_STORE_KEY="emojiSelectedDiversity"
USER_EMOJIS_STORE_KEY="emojiUsage"
store=(()=>new a.default(this.STORE_NAMESPACE))()
constructor(){super(...arguments),this.store.getObject(this.USER_EMOJIS_STORE_KEY)||(this.storedFavorites=[])}get diversity(){return this.store.getObject(this.SKIN_TONE_STORE_KEY)||1}set diversity(e){void 0===e&&(e=1),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:e}),this.notifyPropertyChange("diversity")}get storedFavorites(){let e=this.store.getObject(this.USER_EMOJIS_STORE_KEY)||[]
return e.length<1&&(e=this.siteSettings.default_emoji_reactions?this.siteSettings.default_emoji_reactions.split("|").filter(Boolean):[],this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})),e}set storedFavorites(e){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e}),this.notifyPropertyChange("favorites")}get favorites(){return[...new Set(this._frequencySort(this.storedFavorites))].slice(0,this.MAX_DISPLAYED_EMOJIS)}set favorites(e){void 0===e&&(e=[]),this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:e})}track(e){const t=e.replace(/(^:)|(:$)/g,"")
let s=this.storedFavorites
s.unshift(t),s.length=Math.min(s.length,this.MAX_TRACKED_EMOJIS),this.storedFavorites=s}reset(){this.store.setObject({key:this.USER_EMOJIS_STORE_KEY,value:[]}),this.store.setObject({key:this.SKIN_TONE_STORE_KEY,value:1})}_frequencySort(){const e=(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).reduce(((e,t)=>(e[t]=(e[t]||0)+1,e)),{})
return Object.keys(e).sort(((t,s)=>e[s]-e[t]))}},[s.disableImplicitInjections])
e.default=n})),define("discourse/plugins/chat/discourse/services/chat-guardian",["exports","@ember/service"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{static#e=(()=>dt7948.g(this.prototype,"currentUser",[t.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#s=(()=>dt7948.g(this.prototype,"siteSettings",[t.service]))()
#i=(()=>{dt7948.i(this,"siteSettings")})()
canEditChatChannel(){return this.canUseChat()&&this.currentUser.staff}canArchiveChannel(e){return this.canEditChatChannel()&&this.siteSettings.chat_allow_archiving_channels&&!e.isArchived&&!e.isReadOnly}canUseChat(){return this.currentUser?.has_chat_enabled&&this.siteSettings?.chat_enabled}}e.default=s})),define("discourse/plugins/chat/discourse/services/chat-history",["exports","@glimmer/tracking","@ember/service"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"history",[t.tracked]))()
#Di=(()=>{dt7948.i(this,"history")})()
get previousRoute(){if(this.history?.length>1)return this.history[this.history.length-2]}get currentRoute(){if(this.history?.length>0)return this.history[this.history.length-1]}visit(e){this.history=(this.history||[]).slice(-9).concat([e])}}e.default=a})),define("discourse/plugins/chat/discourse/services/chat-notification-manager",["exports","@ember/service","discourse/lib/desktop-notifications","discourse/lib/plugin-api","discourse-common/config/environment","discourse-common/utils/decorators"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends t.default{static#e=(()=>dt7948.g(this.prototype,"presence",[t.service]))()
#bt=(()=>{dt7948.i(this,"presence")})()
static#s=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#n=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#r=(()=>dt7948.g(this.prototype,"chatStateManager",[t.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#c=(()=>dt7948.g(this.prototype,"currentUser",[t.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#l=(()=>dt7948.g(this.prototype,"appEvents",[t.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#d=(()=>dt7948.g(this.prototype,"site",[t.service]))()
#b=(()=>{dt7948.i(this,"site")})()
_subscribedToCore=!0
_subscribedToChat=!1
_countChatInDocTitle=!0
start(){this._shouldRun()&&(this.set("_chatPresenceChannel",this.presence.getChannel(`/chat-user/chat/${this.currentUser.id}`)),this.set("_corePresenceChannel",this.presence.getChannel(`/chat-user/core/${this.currentUser.id}`)),this._chatPresenceChannel.subscribe(),this._corePresenceChannel.subscribe(),(0,a.withPluginApi)("0.12.1",(e=>{e.onPageChange(this._pageChanged)})),this._pageChanged(),this._chatPresenceChannel.on("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.on("change",this._subscribeToCorrectNotifications))}willDestroy(){super.willDestroy(...arguments),this._shouldRun()&&(this._chatPresenceChannel.off("change",this._subscribeToCorrectNotifications),this._chatPresenceChannel.unsubscribe(),this._chatPresenceChannel.leave(),this._corePresenceChannel.off("change",this._subscribeToCorrectNotifications),this._corePresenceChannel.unsubscribe(),this._corePresenceChannel.leave())}shouldCountChatInDocTitle(){return this._countChatInDocTitle}_pageChanged(){this.chatStateManager.isActive?(this._chatPresenceChannel.enter({onlyWhileActive:!1}),this._corePresenceChannel.leave()):(this._chatPresenceChannel.leave(),this._corePresenceChannel.enter({onlyWhileActive:!1}))}static#h=(()=>dt7948.n(this.prototype,"_pageChanged",[i.bind]))()
_coreAlertChannel(){return(0,s.alertChannel)(this.currentUser)}_chatAlertChannel(){return`/chat${(0,s.alertChannel)(this.currentUser)}`}_subscribeToCorrectNotifications(){this._chatPresenceChannel.count>0&&this._corePresenceChannel.count>0?this.chatStateManager.isActive?this._subscribeToChat({only:!0}):this._subscribeToCore({only:!0}):this._subscribeToBoth()}static#u=(()=>dt7948.n(this.prototype,"_subscribeToCorrectNotifications",[i.bind]))()
_subscribeToBoth(){this._subscribeToChat(),this._subscribeToCore()}_subscribeToChat(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
this.set("_countChatInDocTitle",!0),this._subscribedToChat||(this.messageBus.subscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!0)),e.only&&this._subscribedToCore&&(this.messageBus.unsubscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!1))}_subscribeToCore(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{only:!1}
e.only&&this.set("_countChatInDocTitle",!1),this._subscribedToCore||(this.messageBus.subscribe(this._coreAlertChannel(),this.onMessage),this.set("_subscribedToCore",!0)),e.only&&this._subscribedToChat&&(this.messageBus.unsubscribe(this._chatAlertChannel(),this.onMessage),this.set("_subscribedToChat",!1))}async onMessage(e){if(e.channel_id!==this.chat.activeChannel?.id)return this.site.desktopView?(0,s.onNotification)(e,this.siteSettings,this.currentUser,this.appEvents):void 0}static#p=(()=>dt7948.n(this.prototype,"onMessage",[i.bind]))()
_shouldRun(){return this.chat.userCanChat&&!(0,n.isTesting)()}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat-state-manager",["exports","@glimmer/tracking","@ember/service","discourse/lib/key-value-store","discourse/lib/plugin-api","discourse/lib/sidebar/panels","discourse/lib/utilities","discourse/plugins/chat/discourse/lib/get-user-chat-separate-sidebar-mode","discourse/plugins/chat/discourse/lib/init-sidebar-state"],(function(e,t,s,a,n,i,r,o,c){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.addChatDrawerStateCallback=function(e){u.push(e)},e.default=void 0,e.resetChatDrawerStateCallbacks=function(){u=[]}
const l="preferred_mode",d="FULL_PAGE_CHAT",h="DRAWER_CHAT"
let u=[]
class p extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[s.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"chatHistory",[s.service]))()
#at=(()=>{dt7948.i(this,"chatHistory")})()
static#n=(()=>dt7948.g(this.prototype,"router",[s.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#r=(()=>dt7948.g(this.prototype,"site",[s.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#c=(()=>dt7948.g(this.prototype,"chatDrawerRouter",[s.service]))()
#Qe=(()=>{dt7948.i(this,"chatDrawerRouter")})()
static#l=(()=>dt7948.g(this.prototype,"isSidePanelExpanded",[t.tracked],(function(){return!1})))()
#Li=(()=>{dt7948.i(this,"isSidePanelExpanded")})()
static#d=(()=>dt7948.g(this.prototype,"isDrawerExpanded",[t.tracked],(function(){return!1})))()
#Ii=(()=>{dt7948.i(this,"isDrawerExpanded")})()
static#h=(()=>dt7948.g(this.prototype,"isDrawerActive",[t.tracked],(function(){return!1})))()
#Ri=(()=>{dt7948.i(this,"isDrawerActive")})()
static#u=(()=>dt7948.g(this.prototype,"hasPreloadedChannels",[t.tracked],(function(){return!1})))()
#Ni=(()=>{dt7948.i(this,"hasPreloadedChannels")})()
static#p=(()=>dt7948.g(this.prototype,"_chatURL",[t.tracked],(function(){return null})))()
#Fi=(()=>{dt7948.i(this,"_chatURL")})()
static#j=(()=>dt7948.g(this.prototype,"_appURL",[t.tracked],(function(){return null})))()
#Bi=(()=>{dt7948.i(this,"_appURL")})()
_store=(()=>new a.default("discourse_chat_"))()
reset(){this._store.remove(l),this._chatURL=null,this._appURL=null}prefersFullPage(){this._store.setObject({key:l,value:d})}prefersDrawer(){this._store.setObject({key:l,value:h})}openSidePanel(){this.isSidePanelExpanded=!0}closeSidePanel(){this.isSidePanelExpanded=!1}didOpenDrawer(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null;(0,n.withPluginApi)("1.8.0",(e=>{e.getSidebarPanel()?.key!==i.MAIN_PANEL&&e.getSidebarPanel()?.key!==c.CHAT_PANEL||((0,o.getUserChatSeparateSidebarMode)(this.currentUser).always?(e.setSeparatedSidebarMode(),e.hideSidebarSwitchPanelButtons()):e.setCombinedSidebarMode())})),this.isDrawerActive=!0,this.isDrawerExpanded=!0,e&&this.storeChatURL(e),this.chat.updatePresence(),this.#Hi()}didCloseDrawer(){(0,n.withPluginApi)("1.8.0",(e=>{if(e.getSidebarPanel()?.key===i.MAIN_PANEL||e.getSidebarPanel()?.key===c.CHAT_PANEL){const t=(0,o.getUserChatSeparateSidebarMode)(this.currentUser)
e.setSidebarPanel(i.MAIN_PANEL),t.fullscreen?(e.setCombinedSidebarMode(),e.showSidebarSwitchPanelButtons()):t.always?(e.setSeparatedSidebarMode(),e.showSidebarSwitchPanelButtons()):(e.setCombinedSidebarMode(),e.hideSidebarSwitchPanelButtons())}})),this.chatDrawerRouter.currentRouteName=null,this.isDrawerActive=!1,this.isDrawerExpanded=!1,this.chat.updatePresence(),this.#Hi()}didExpandDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!0,this.chat.updatePresence()}didCollapseDrawer(){this.isDrawerActive=!0,this.isDrawerExpanded=!1,this.#Hi()}didToggleDrawer(){this.isDrawerExpanded=!this.isDrawerExpanded,this.isDrawerActive=!0,this.#Hi()}get isFullPagePreferred(){return!(!this.site.mobileView&&this._store.getObject(l)!==d)}get isDrawerPreferred(){return!(this.isFullPagePreferred&&(!this.site.desktopView||this._store.getObject(l)&&this._store.getObject(l)!==h))}get isFullPageActive(){return this.router.currentRouteName?.startsWith("chat")}get isActive(){return this.isFullPageActive||this.isDrawerActive}storeAppURL(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:null
e?this._appURL=e:this.router.currentURL?.startsWith("/chat")?this._appURL="/":this._appURL=this.router.currentURL}storeChatURL(e){this._chatURL=e}get lastKnownAppURL(){const e=this._appURL
return e&&"/"!==e?e:this.router.urlFor(`discovery.${(0,r.defaultHomepage)()}`)}get lastKnownChatURL(){return this._chatURL||"/chat"}#Hi(){const e={isDrawerActive:this.isDrawerActive,isDrawerExpanded:this.isDrawerExpanded}
u.forEach((t=>t(e)))}}e.default=p})),define("discourse/plugins/chat/discourse/services/chat-subscriptions-manager",["exports","@ember/service","discourse/lib/notification-levels","discourse-common/utils/decorators","discourse-i18n","discourse/plugins/chat/discourse/models/chat-channel","discourse/plugins/chat/discourse/models/chat-channel-archive"],(function(e,t,s,a,n,i,r){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class o extends t.default{static#e=(()=>dt7948.g(this.prototype,"store",[t.service]))()
#Be=(()=>{dt7948.i(this,"store")})()
static#s=(()=>dt7948.g(this.prototype,"chatChannelsManager",[t.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#n=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[t.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
static#r=(()=>dt7948.g(this.prototype,"currentUser",[t.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#c=(()=>dt7948.g(this.prototype,"appEvents",[t.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#l=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#d=(()=>dt7948.g(this.prototype,"dialog",[t.service]))()
#ee=(()=>{dt7948.i(this,"dialog")})()
static#h=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
_channelSubscriptions=(()=>new Set)()
startChannelSubscription(e){e.currentUserMembership.muted||this._channelSubscriptions.has(e.id)||(this._channelSubscriptions.add(e.id),this._startChannelMentionsSubscription(e),e.isDirectMessageChannel||this._startKickFromChannelSubscription(e),this._startChannelNewMessagesSubscription(e))}stopChannelSubscription(e){this.messageBus.unsubscribe(`/chat/${e.id}/new-messages`,this._onNewMessages),e.isDirectMessageChannel||(this.messageBus.unsubscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions),this.messageBus.unsubscribe(`/chat/${e.id}/kick`,this._onKickFromChannel)),this._channelSubscriptions.delete(e.id)}startChannelsSubscriptions(e){this._startNewChannelSubscription(e.new_channel),this._startChannelArchiveStatusSubscription(e.archive_status),this._startUserTrackingStateSubscription(e.user_tracking_state),this._startChannelsEditsSubscription(e.channel_edits),this._startChannelsStatusChangesSubscription(e.channel_status),this._startChannelsMetadataChangesSubscription(e.channel_metadata)}stopChannelsSubscriptions(){this._stopNewChannelSubscription(),this._stopChannelArchiveStatusSubscription(),this._stopUserTrackingStateSubscription(),this._stopChannelsEditsSubscription(),this._stopChannelsStatusChangesSubscription(),this._stopChannelsMetadataChangesSubscription(),(this.chatChannelsManager.channels||[]).forEach((e=>{this.stopChannelSubscription(e)}))}_startChannelArchiveStatusSubscription(e){this.currentUser.admin&&this.messageBus.subscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate,e)}_stopChannelArchiveStatusSubscription(){this.currentUser.admin&&this.messageBus.unsubscribe("/chat/channel-archive-status",this._onChannelArchiveStatusUpdate)}_startChannelMentionsSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-mentions`,this._onNewMentions,e.meta.message_bus_last_ids.new_mentions)}_startKickFromChannelSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/kick`,this._onKickFromChannel,e.meta.message_bus_last_ids.kick)}_onChannelArchiveStatusUpdate(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.archive=r.default.create(e))}))}static#u=(()=>dt7948.n(this.prototype,"_onChannelArchiveStatusUpdate",[a.bind]))()
_onNewMentions(e){this.chatChannelsManager.find(e.channel_id).then((t=>{const s=t.currentUserMembership
e.message_id>s?.lastReadMessageId&&t.tracking.mentionCount++}))}static#p=(()=>dt7948.n(this.prototype,"_onNewMentions",[a.bind]))()
_onKickFromChannel(e){this.chatChannelsManager.find(e.channel_id).then((e=>{this.chat.activeChannel.id===e.id?this.dialog.alert({message:n.default.t("chat.kicked_from_channel"),didConfirm:()=>{this.chatChannelsManager.remove(e)
const t=this.chatChannelsManager.publicMessageChannels[0]
t?this.router.transitionTo("chat.channel",...t.routeModels):this.router.transitionTo("chat.browse")}}):this.chatChannelsManager.remove(e)}))}static#j=(()=>dt7948.n(this.prototype,"_onKickFromChannel",[a.bind]))()
_startChannelNewMessagesSubscription(e){this.messageBus.subscribe(`/chat/${e.id}/new-messages`,this._onNewMessages,e.meta.message_bus_last_ids.new_messages)}_onNewMessages(e){switch(e.type){case"channel":this._onNewChannelMessage(e)
break
case"thread":this._onNewThreadMessage(e)}}static#P=(()=>dt7948.n(this.prototype,"_onNewMessages",[a.bind]))()
_onNewChannelMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{t.lastMessage=e.message
const s=e.message.user
s.id===this.currentUser.id||this.currentUser.ignored_users.includes(s.username)?t.currentUserMembership.lastReadMessageId=t.lastMessage.id:(t.lastMessage.id>(t.currentUserMembership.lastReadMessageId||0)&&t.tracking.unreadCount++,e.thread_id&&t.threadingEnabled&&t.threadsManager.find(t.id,e.thread_id).then((s=>{s.currentUserMembership&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),this._updateActiveLastViewedAt(t))})))}))}_onNewThreadMessage(e){this.chatChannelsManager.find(e.channel_id).then((t=>{(t.threadingEnabled||e.force_thread)&&t.threadsManager.find(e.channel_id,e.thread_id).then((a=>{a.lastMessageId=e.message.id,e.message.user.id===this.currentUser.id?a.currentUserMembership&&(t.threadsManager.unreadThreadOverview.delete(parseInt(e.thread_id,10)),a.currentUserMembership.lastReadMessageId=e.message.id):this.currentUser.ignored_users.includes(e.message.user.username)?a.currentUserMembership&&(a.currentUserMembership.lastReadMessageId=e.message.id):a.currentUserMembership&&e.message.id>(a.currentUserMembership.lastReadMessageId||0)&&!a.currentUserMembership.isQuiet&&(t.threadsManager.markThreadUnread(e.thread_id,e.message.created_at),a.currentUserMembership.notificationLevel===s.NotificationLevels.WATCHING?(a.tracking.watchedThreadsUnreadCount++,t.tracking.watchedThreadsUnreadCount++):a.tracking.unreadCount++,this._updateActiveLastViewedAt(t))}))}))}_updateActiveLastViewedAt(e){this.chat.activeChannel?.id===e.id&&e.updateLastViewedAt()}_startUserTrackingStateSubscription(e){this.currentUser&&(this.messageBus.subscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate,e),this.messageBus.subscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate,e))}_stopUserTrackingStateSubscription(){this.currentUser&&(this.messageBus.unsubscribe(`/chat/user-tracking-state/${this.currentUser.id}`,this._onUserTrackingStateUpdate),this.messageBus.unsubscribe(`/chat/bulk-user-tracking-state/${this.currentUser.id}`,this._onBulkUserTrackingStateUpdate))}_onBulkUserTrackingStateUpdate(e){Object.keys(e).forEach((t=>{this._updateChannelTrackingData(t,e[t])}))}static#O=(()=>dt7948.n(this.prototype,"_onBulkUserTrackingStateUpdate",[a.bind]))()
_onUserTrackingStateUpdate(e){this._updateChannelTrackingData(e.channel_id,e)}static#D=(()=>dt7948.n(this.prototype,"_onUserTrackingStateUpdate",[a.bind]))()
_updateChannelTrackingData(e,t){this.chatChannelsManager.find(e).then((s=>{t.thread_id||(s.currentUserMembership.lastReadMessageId=t.last_read_message_id),s.tracking.unreadCount=t.unread_count,s.tracking.mentionCount=t.mention_count,s.tracking.watchedThreadsUnreadCount=t.watched_threads_unread_count,t.hasOwnProperty("unread_thread_overview")&&s.threadingEnabled&&(s.threadsManager.unreadThreadOverview=t.unread_thread_overview),t.thread_id&&t.hasOwnProperty("thread_tracking")&&s.threadingEnabled&&s.threadsManager.find(e,t.thread_id).then((e=>{e.currentUserMembership&&!e.currentUserMembership.isQuiet&&(e.currentUserMembership.lastReadMessageId=t.last_read_message_id,e.tracking.unreadCount=t.thread_tracking.unread_count,e.tracking.mentionCount=t.thread_tracking.mention_count,e.tracking.watchedThreadsUnreadCount=t.thread_tracking.watched_threads_unread_count)}))}))}static#I=(()=>dt7948.n(this.prototype,"_updateChannelTrackingData",[a.bind]))()
_startNewChannelSubscription(e){this.messageBus.subscribe("/chat/new-channel",this._onNewChannelSubscription,e)}_stopNewChannelSubscription(){this.messageBus.unsubscribe("/chat/new-channel",this._onNewChannelSubscription)}_onNewChannelSubscription(e){this.chatChannelsManager.find(e.channel.id).then((t=>{t.meta=e.channel.meta,t.currentUserMembership=e.channel.current_user_membership,t.isDirectMessageChannel&&!t.currentUserMembership.following&&(t.tracking.unreadCount=1),this.chatChannelsManager.follow(t)}))}static#R=(()=>dt7948.n(this.prototype,"_onNewChannelSubscription",[a.bind]))()
_startChannelsMetadataChangesSubscription(e){this.messageBus.subscribe("/chat/channel-metadata",this._onChannelMetadata,e)}_startChannelsEditsSubscription(e){this.messageBus.subscribe("/chat/channel-edits",this._onChannelEdits,e)}_startChannelsStatusChangesSubscription(e){this.messageBus.subscribe("/chat/channel-status",this._onChannelStatus,e)}_stopChannelsStatusChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-status",this._onChannelStatus)}_stopChannelsEditsSubscription(){this.messageBus.unsubscribe("/chat/channel-edits",this._onChannelEdits)}_stopChannelsMetadataChangesSubscription(){this.messageBus.unsubscribe("/chat/channel-metadata",this._onChannelMetadata)}_onChannelMetadata(e){this.chatChannelsManager.find(e.chat_channel_id,{fetchIfNotFound:!1}).then((t=>{t&&(t.membershipsCount=e.memberships_count,this.appEvents.trigger("chat:refresh-channel-members"))}))}static#N=(()=>dt7948.n(this.prototype,"_onChannelMetadata",[a.bind]))()
_onChannelEdits(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t&&(t.title=e.name,t.description=e.description,t.slug=e.slug)}))}static#B=(()=>dt7948.n(this.prototype,"_onChannelEdits",[a.bind]))()
_onChannelStatus(e){this.chatChannelsManager.find(e.chat_channel_id).then((t=>{t.status=e.status,e.status===i.CHANNEL_STATUSES.archived&&t.tracking.reset()}))}static#H=(()=>dt7948.n(this.prototype,"_onChannelStatus",[a.bind]))()}e.default=o})),define("discourse/plugins/chat/discourse/services/chat-thread-composer",["exports","@glimmer/tracking","@ember/object","@ember/runloop","@ember/service","discourse/lib/body-scroll-lock"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends n.default{static#e=(()=>dt7948.g(this.prototype,"chat",[n.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"capabilities",[n.service]))()
#w=(()=>{dt7948.i(this,"capabilities")})()
static#n=(()=>dt7948.g(this.prototype,"appEvents",[n.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#r=(()=>dt7948.g(this.prototype,"site",[n.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#c=(()=>dt7948.g(this.prototype,"textarea",[t.tracked]))()
#ti=(()=>{dt7948.i(this,"textarea")})()
static#l=(()=>dt7948.g(this.prototype,"scroller",[t.tracked]))()
#si=(()=>{dt7948.i(this,"scroller")})()
init(){super.init(...arguments),this.appEvents.on("discourse:focus-changed",this,this.blur)}willDestroy(){super.willDestroy(...arguments),this.appEvents.off("discourse:focus-changed",this,this.blur)}focus(){let e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{}
this.textarea?.focus(e),(0,a.schedule)("afterRender",(()=>{this.capabilities.isIOS&&!this.capabilities.isIpadOS&&(0,i.disableBodyScroll)(this.scroller,{reverse:!0})}))}static#d=(()=>dt7948.n(this.prototype,"focus",[s.action]))()
blur(){this.textarea?.blur()}static#h=(()=>dt7948.n(this.prototype,"blur",[s.action]))()
edit(e){this.chat.activeMessage=null,e.editing=!0,e.thread.draft=e,this.site.desktopView&&this.focus({refreshHeight:!0,ensureAtEnd:!0})}static#u=(()=>dt7948.n(this.prototype,"edit",[s.action]))()
replyTo(){this.chat.activeMessage=null}static#p=(()=>dt7948.n(this.prototype,"replyTo",[s.action]))()}e.default=r}))
define("discourse/plugins/chat/discourse/services/chat-thread-list-pane",["exports","@ember/service"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class s extends t.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get isOpened(){return"chat.channel.threads"===this.router.currentRoute.name}async close(){await this.router.transitionTo("chat.channel",...this.chat.activeChannel.routeModels)}async open(){await this.router.transitionTo("chat.channel.threads",...this.chat.activeChannel.routeModels)}}e.default=s})),define("discourse/plugins/chat/discourse/services/chat-thread-pane",["exports","@ember/service","discourse/plugins/chat/discourse/services/chat-channel-pane"],(function(e,t,s){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class a extends s.default{static#e=(()=>dt7948.g(this.prototype,"chat",[t.service]))()
#g=(()=>{dt7948.i(this,"chat")})()
static#s=(()=>dt7948.g(this.prototype,"router",[t.service]))()
#y=(()=>{dt7948.i(this,"router")})()
get thread(){return this.channel?.activeThread}get isOpened(){return"chat.channel.thread"===this.router.currentRoute.name}get selectedMessageIds(){return this.thread.messagesManager.selectedMessages.mapBy("id")}async close(){await this.router.transitionTo("chat.channel",...this.channel.routeModels)}async open(e){await this.router.transitionTo("chat.channel.thread",...e.routeModels)}}e.default=a})),define("discourse/plugins/chat/discourse/services/chat-tracking-state-manager",["exports","@ember/owner","@ember/runloop","@ember/service","discourse-common/lib/debounce","discourse/plugins/chat/discourse/models/chat-tracking-state"],(function(e,t,s,a,n,i){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class r extends a.default{static#e=(()=>dt7948.g(this.prototype,"chatChannelsManager",[a.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#s=(()=>dt7948.g(this.prototype,"appEvents",[a.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
setupWithPreloadedState(e){let{channel_tracking:t={}}=e
this.chatChannelsManager.channels.forEach((e=>{t[e.id.toString()]&&this.#zi(e,t[e.id.toString()])}))}setupChannelThreadState(e,t){e.threadsManager.threads.forEach((e=>{const s=t[e.id.toString()]
s&&this.#zi(e,s)}))}get publicChannelUnreadCount(){return this.#Wi.reduce(((e,t)=>e+t.tracking.unreadCount),0)}get directMessageUnreadCount(){return this.#$i.reduce(((e,t)=>e+t.tracking.unreadCount),0)}get publicChannelMentionCount(){return this.#Wi.reduce(((e,t)=>e+t.tracking.mentionCount),0)}get directMessageMentionCount(){return this.#$i.reduce(((e,t)=>e+t.tracking.mentionCount),0)}get allChannelMentionCount(){return this.publicChannelMentionCount+this.directMessageMentionCount}get allChannelUrgentCount(){return this.publicChannelMentionCount+this.directMessageUnreadCount+this.watchedThreadsUnreadCount}get hasUnreadThreads(){return this.#Wi.some((e=>e.unreadThreadsCount>0))}get watchedThreadsUnreadCount(){return this.#Wi.reduce(((e,t)=>e+t.tracking.watchedThreadsUnreadCount),0)}willDestroy(){super.willDestroy(...arguments),(0,s.cancel)(this._onTriggerNotificationDebounceHandler)}triggerNotificationsChanged(){this._onTriggerNotificationDebounceHandler=(0,n.default)(this,this.#Vi,100)}#Vi(){this.appEvents.trigger("notifications:changed")}#zi(e,s){e.tracking||(e.tracking=new i.default((0,t.getOwner)(this))),e.tracking.unreadCount=s.unread_count,e.tracking.mentionCount=s.mention_count,e.tracking.watchedThreadsUnreadCount=s.watched_threads_unread_count}get#Wi(){return this.chatChannelsManager.publicMessageChannels}get#$i(){return this.chatChannelsManager.directMessageChannels}}e.default=r})),define("discourse/plugins/chat/discourse/services/chat",["exports","@glimmer/tracking","@ember/object","@ember/object/computed","@ember/runloop","@ember/service","discourse/lib/ajax","discourse/lib/ajax-error","discourse/lib/user-presence","discourse-common/lib/deprecated","discourse-common/lib/later","discourse-common/utils/decorators","discourse/plugins/chat/discourse/models/chat-message"],(function(e,t,s,a,n,i,r,o,c,l,d,h,u){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const p={userUnseenTime:3e5,browserHiddenTime:3e5}
class m extends i.default{static#e=(()=>dt7948.g(this.prototype,"chatApi",[i.service]))()
#t=(()=>{dt7948.i(this,"chatApi")})()
static#s=(()=>dt7948.g(this.prototype,"appEvents",[i.service]))()
#K=(()=>{dt7948.i(this,"appEvents")})()
static#n=(()=>dt7948.g(this.prototype,"currentUser",[i.service]))()
#m=(()=>{dt7948.i(this,"currentUser")})()
static#r=(()=>dt7948.g(this.prototype,"chatNotificationManager",[i.service]))()
#qi=(()=>{dt7948.i(this,"chatNotificationManager")})()
static#c=(()=>dt7948.g(this.prototype,"chatSubscriptionsManager",[i.service]))()
#ci=(()=>{dt7948.i(this,"chatSubscriptionsManager")})()
static#l=(()=>dt7948.g(this.prototype,"chatStateManager",[i.service]))()
#_=(()=>{dt7948.i(this,"chatStateManager")})()
static#d=(()=>dt7948.g(this.prototype,"chatDraftsManager",[i.service]))()
#Y=(()=>{dt7948.i(this,"chatDraftsManager")})()
static#h=(()=>dt7948.g(this.prototype,"presence",[i.service]))()
#bt=(()=>{dt7948.i(this,"presence")})()
static#u=(()=>dt7948.g(this.prototype,"router",[i.service]))()
#y=(()=>{dt7948.i(this,"router")})()
static#p=(()=>dt7948.g(this.prototype,"site",[i.service]))()
#b=(()=>{dt7948.i(this,"site")})()
static#j=(()=>dt7948.g(this.prototype,"chatChannelsManager",[i.service]))()
#f=(()=>{dt7948.i(this,"chatChannelsManager")})()
static#P=(()=>dt7948.g(this.prototype,"chatTrackingStateManager",[i.service]))()
#v=(()=>{dt7948.i(this,"chatTrackingStateManager")})()
cook=null
presenceChannel=null
sidebarActive=!1
isNetworkUnreliable=!1
static#O=(()=>dt7948.g(this.prototype,"userCanChat",[(0,a.and)("currentUser.has_chat_enabled","siteSettings.chat_enabled")]))()
#Gi=(()=>{dt7948.i(this,"userCanChat")})()
static#D=(()=>dt7948.g(this.prototype,"_activeMessage",[t.tracked],(function(){return null})))()
#Ki=(()=>{dt7948.i(this,"_activeMessage")})()
static#I=(()=>dt7948.g(this.prototype,"_activeChannel",[t.tracked],(function(){return null})))()
#Ji=(()=>{dt7948.i(this,"_activeChannel")})()
get activeChannel(){return this._activeChannel}set activeChannel(e){e||(this._activeMessage=null),this._activeChannel&&(this._activeChannel.activeThread=null),this._activeChannel=e}get userCanDirectMessage(){return!!this.currentUser&&(this.currentUser.staff||this.currentUser.can_direct_message)}static#R=(()=>dt7948.n(this.prototype,"userCanDirectMessage",[(0,s.computed)("currentUser.staff","currentUser.groups.[]")]))()
get userHasDirectMessages(){return this.chatChannelsManager.directMessageChannels?.length>0}static#N=(()=>dt7948.n(this.prototype,"userHasDirectMessages",[(0,s.computed)("chatChannelsManager.directMessageChannels")]))()
get userCanAccessDirectMessages(){return this.userCanDirectMessage||this.userHasDirectMessages}get userCanInteractWithChat(){return!this.activeChannel?.userSilenced}static#B=(()=>dt7948.n(this.prototype,"userCanInteractWithChat",[(0,s.computed)("activeChannel.userSilenced")]))()
get activeMessage(){return this._activeMessage}set activeMessage(e){this._activeMessage=e||null}init(){super.init(...arguments),this.userCanChat&&(this.presenceChannel=this.presence.getChannel("/chat/online"),(0,c.onPresenceChange)({callback:this.onPresenceChangeCallback,browserHiddenTime:15e4,userUnseenTime:15e4}))}onPresenceChangeCallback(e){e&&this.chatApi.listCurrentUserChannels().then((e=>{this.chatSubscriptionsManager.stopChannelsSubscriptions(),this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),[...e.public_channels,...e.direct_message_channels].forEach((t=>{this.chatChannelsManager.find(t.id,{fetchIfNotFound:!1}).then((s=>{if(!s)return
s.meta.message_bus_last_ids=t.meta.message_bus_last_ids
const a=e.tracking.channel_tracking[s.id]
s.tracking.unreadCount=a.unread_count,s.tracking.mentionCount=a.mention_count,s.tracking.watchedThreadsUnreadCount=a.watched_threads_unread_count,s.currentUserMembership=t.current_user_membership,this.chatSubscriptionsManager.startChannelSubscription(s)}))}))}))}static#H=(()=>dt7948.n(this.prototype,"onPresenceChangeCallback",[h.bind]))()
markNetworkAsUnreliable(){(0,n.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!0),this._networkCheckHandler=(0,d.default)((()=>{this.isDestroyed||this.isDestroying||this.markNetworkAsReliable()}),3e4)}markNetworkAsReliable(){(0,n.cancel)(this._networkCheckHandler),this.set("isNetworkUnreliable",!1)}async loadChannels(){try{if(this.chatStateManager.hasPreloadedChannels)return
if(this.loadingChannels)return this.loadingChannels
this.loadingChannels=new Promise((e=>{this.chatApi.listCurrentUserChannels().then((t=>{this.setupWithPreloadedChannels(t),this.chatStateManager.hasPreloadedChannels=!0,e()}))}))}catch(e){(0,o.popupAjaxError)(e)}}setupWithPreloadedChannels(e){this.chatSubscriptionsManager.startChannelsSubscriptions(e.meta.message_bus_last_ids),this.presenceChannel.subscribe(e.global_presence_channel_state),[...e.public_channels,...e.direct_message_channels].forEach((t=>{const s=this.chatChannelsManager.store(t)
return(this.currentUser?.chat_drafts||[]).filter((e=>e.channel_id===s.id)).forEach((e=>{this.chatDraftsManager.add(u.default.createDraftMessage(s,Object.assign({user:this.currentUser},JSON.parse(e.data))),e.channel_id,e.thread_id)})),e.unread_thread_overview?.[s.id]&&(s.threadsManager.unreadThreadOverview=e.unread_thread_overview[s.id]),this.chatChannelsManager.follow(s)})),this.chatTrackingStateManager.setupWithPreloadedState(e.tracking)}willDestroy(){super.willDestroy(...arguments),this.userCanChat&&(this.chatSubscriptionsManager.stopChannelsSubscriptions(),(0,c.removeOnPresenceChange)(this.onPresenceChangeCallback))}updatePresence(){(0,n.next)((()=>{this.isDestroyed||this.isDestroying||this.currentUser.user_option?.hide_profile_and_presence||(this.chatStateManager.isActive?this.presenceChannel.enter({activeOptions:p}):this.presenceChannel.leave())}))}getDocumentTitleCount(){return this.chatNotificationManager.shouldCountChatInDocTitle()?this.chatTrackingStateManager.allChannelUrgentCount:0}switchChannelUpOrDown(e){const{activeChannel:t}=this
if(!t)return
let s,a
t.isDirectMessageChannel?(s=this.chatChannelsManager.truncatedDirectMessageChannels,a=this.chatChannelsManager.publicMessageChannels):(s=this.chatChannelsManager.publicMessageChannels,a=this.chatChannelsManager.truncatedDirectMessageChannels)
const n="up"===e,i=s.findIndex((e=>e.id===t.id))
let r=s[i+(n?-1:1)]
if(r)return this.router.transitionTo("chat.channel",...r.routeModels)
const o=a.length?a:s,c=n?o[o.length-1]:o[0]
return c.id!==t.id?this.router.transitionTo("chat.channel",...c.routeModels):void 0}_fireOpenFloatAppEvent(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
t?this.router.transitionTo("chat.channel.near-message",...e.routeModels,t):this.router.transitionTo("chat.channel",...e.routeModels)}async followChannel(e){return this.chatChannelsManager.follow(e)}async unfollowChannel(e){return this.chatChannelsManager.unfollow(e).then((()=>{e===this.activeChannel&&e.isDirectMessageChannel&&this.router.transitionTo("chat")}))}upsertDmChannelForUser(e,t){const s=(e.chatable.users||[]).mapBy("username").concat(t.username).uniq()
return this.upsertDmChannel({usernames:s})}createDmChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{name:null,upsert:!1}
return(0,r.ajax)("/chat/api/direct-message-channels.json",{method:"POST",data:{target_usernames:e.usernames?.uniq(),target_groups:e.groups?.uniq(),upsert:t.upsert,name:t.name}}).then((e=>{const t=this.chatChannelsManager.store(e.channel)
return this.chatChannelsManager.follow(t),t})).catch(o.popupAjaxError)}upsertDmChannel(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null
return this.createDmChannel(e,{name:t,upsert:!0})}getDmChannelForUsernames(e){return(0,r.ajax)("/chat/direct_messages.json",{data:{usernames:e.uniq().join(",")}})}addToolbarButton(){(0,l.default)("Use the new chat API `api.registerChatComposerButton` instead of `chat.addToolbarButton`",{id:"discourse.chat.addToolbarButton"})}toggleDrawer(){this.chatStateManager.didToggleDrawer(),this.appEvents.trigger("chat:toggle-expand",this.chatStateManager.isDrawerExpanded)}static#z=(()=>dt7948.n(this.prototype,"toggleDrawer",[s.action]))()}e.default=m})),define("discourse/plugins/chat/discourse/services/emoji-picker-scroll-observer",["exports","@glimmer/tracking","@ember/service","discourse-common/utils/decorators"],(function(e,t,s,a){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
class n extends s.default{static#e=(()=>dt7948.g(this.prototype,"chatEmojiPickerManager",[s.service]))()
#M=(()=>{dt7948.i(this,"chatEmojiPickerManager")})()
static#s=(()=>dt7948.g(this.prototype,"enabled",[t.tracked],(function(){return!0})))()
#Oa=(()=>{dt7948.i(this,"enabled")})()
direction="up"
prevYPosition=0
_observerCallback(e){if(!this.enabled)return
this._setScrollDirection(e.target)
const t=[...document.querySelectorAll(".chat-emoji-picker__section")].filter((t=>this._isSectionVisibleInPicker(t,e.target)))
if(t?.length){let e
e="up"===this.direction||this.prevYPosition<50?t.firstObject:t.lastObject,this.chatEmojiPickerManager.lastVisibleSection=e.dataset.section,this.chatEmojiPickerManager.addVisibleSections(t.map((e=>e.dataset.section)))}}static#n=(()=>dt7948.n(this.prototype,"_observerCallback",[a.bind]))()
observe(e){e.addEventListener("scroll",this._observerCallback)}unobserve(e){e.removeEventListener("scroll",this._observerCallback)}_setScrollDirection(e){e.scrollTop>this.prevYPosition?this.direction="down":this.direction="up",this.prevYPosition=e.scrollTop}_isSectionVisibleInPicker(e,t){const{bottom:s,height:a,top:n}=e.getBoundingClientRect(),i=t.getBoundingClientRect()
return n<=i.top?i.top-n<=a:s-i.bottom<=a}}e.default=n})),define("discourse/plugins/chat/discourse/templates/chat-browse-all",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"gKPEawyy",block:'[[[8,[39,0],null,[["@currentTab"],["all"]],null]],[],false,["browse-channels"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-all.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-archived",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"yiqdZ7cr",block:'[[[8,[39,0],null,[["@currentTab"],["archived"]],null]],[],false,["browse-channels"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-archived.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-closed",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"A3+TpdHR",block:'[[[8,[39,0],null,[["@currentTab"],["closed"]],null]],[],false,["browse-channels"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-closed.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse-open",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"cR0DJys2",block:'[[[8,[39,0],null,[["@currentTab"],["open"]],null]],[],false,["browse-channels"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse-open.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-browse",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6/d5UOVO",block:'[[[10,0],[14,0,"c-routes --browse"],[12],[1,"\\n  "],[8,[39,0],null,null,[["default"],[[[[1,"\\n    "],[8,[30,1,["BackButton"]],null,null,null],[1,"\\n    "],[8,[30,1,["Title"]],null,[["@title"],[[28,[37,1],["chat.browse.title"],null]]],null],[1,"\\n\\n    "],[8,[30,1,["Actions"]],null,null,[["default"],[[[[1,"\\n      "],[8,[30,2,["NewChannelButton"]],null,null,null],[1,"\\n      "],[8,[30,2,["OpenDrawerButton"]],null,null,null],[1,"\\n    "]],[2]]]]],[1,"\\n  "]],[1]]]]],[1,"\\n\\n  "],[46,[28,[37,3],null,null],null,null,null],[1,"\\n"],[13]],["navbar","a"],false,["chat/navbar","i18n","component","-outlet"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-browse.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-members",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"F/Of0pmn",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-info-members"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-members.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info-settings",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"mUrk0Olg",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-info-settings"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info-settings.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-info",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Ap9/cIrL",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-info"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-info.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-thread",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dBCndVuI",block:'[[[8,[39,0],null,[["@thread","@targetMessageId"],[[30,0,["model"]],[30,0,["targetMessageId"]]]],null]],[],false,["chat/routes/channel-thread"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-thread.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel-threads",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"neA2/I/Y",block:'[[[8,[39,0],null,[["@channel"],[[30,0,["model"]]]],null]],[],false,["chat/routes/channel-threads"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel-threads.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channel",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"H/iqPgyD",block:'[[[8,[39,0],null,[["@channel","@targetMessageId"],[[30,0,["model"]],[30,0,["targetMessageId"]]]],null]],[],false,["chat/routes/channel"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channel.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-channels",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"0JNfhKtv",block:'[[[8,[39,0],null,null,null]],[],false,["chat/routes/channels"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-channels.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-direct-messages",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"VIb67ytl",block:'[[[8,[39,0],null,null,null]],[],false,["chat/routes/direct-messages"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-direct-messages.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-index",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"Okro16df",block:'[[[8,[39,0],null,null,null]],[],false,["channels-list"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-index.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat-threads",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"xde66Ckc",block:'[[[8,[39,0],null,null,null]],[],false,["chat/routes/threads"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat-threads.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"nO++sRB0",block:'[[[10,0],[14,1,"chat-progress-bar-container"],[12],[13],[1,"\\n\\n"],[41,[30,0,["chat","sidebarActive"]],[[[1,"  "],[10,0],[14,0,"full-page-chat teams-sidebar-on"],[12],[1,"\\n    "],[46,[28,[37,2],null,null],null,null,null],[1,"\\n  "],[13],[1,"\\n"]],[]],[[[1,"  "],[10,0],[15,0,[28,[37,3],["full-page-chat",[52,[30,0,["shouldUseCoreSidebar"]],"full-page-chat-sidebar-enabled"]],null]],[12],[1,"\\n"],[41,[30,0,["shouldUseChatSidebar"]],[[[1,"      "],[8,[39,4],null,null,null],[1,"\\n"]],[]],null],[1,"\\n    "],[10,0],[14,1,"main-chat-outlet"],[15,0,[28,[37,3],["main-chat-outlet",[30,0,["mainOutletModifierClasses"]]],null]],[12],[1,"\\n      "],[46,[28,[37,2],null,null],null,null,null],[1,"\\n"],[41,[30,0,["shouldUseChatFooter"]],[[[1,"        "],[8,[39,5],null,null,null],[1,"\\n"]],[]],null],[1,"    "],[13],[1,"\\n  "],[13],[1,"\\n"]],[]]]],[],false,["if","component","-outlet","concat-class","channels-list","chat-footer"]]',moduleName:"discourse/plugins/chat/discourse/templates/chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"yzyIVLUg",block:'[[[8,[39,0],null,null,null]],[],false,["chat-channel-message-emoji-picker"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-channel-message-emoji-picker-connector.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"dBkEnbeG",block:'[[[10,0],[14,0,"chat-drawer-outlet-container"],[12],[1,"\\n  "],[8,[39,0],null,null,null],[1,"\\n"],[13]],[],false,["chat-drawer"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-drawer-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"6ho8SpDw",block:'[[[8,[39,0],null,null,null]],[],false,["chat-message-actions-desktop"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/below-footer/chat-message-actions-desktop-outlet.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/home-logo-wrapper/chat-header-connector",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"edqwta3S",block:'[[[8,[39,0],null,null,[["default"],[[[[18,1,null]],[]]]]]],["&default"],false,["chat-header","yield"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/home-logo-wrapper/chat-header-connector.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"ynZgkvKG",block:'[[[41,[30,0,["user","can_chat_user"]],[[[1,"  "],[8,[39,1],null,[["@user","@modal"],[[30,0,["user"]],true]],null],[1,"\\n"]],[]],null]],[],false,["if","chat/direct-message-button"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-card-below-message-button/chat-button.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/connectors/user-profile-controls/chat-button",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"cuKvLOv5",block:'[[[41,[30,0,["model","can_chat_user"]],[[[1,"  "],[8,[39,1],null,[["@user"],[[30,0,["model"]]]],null],[1,"\\n"]],[]],null]],[],false,["if","chat/direct-message-button"]]',moduleName:"discourse/plugins/chat/discourse/templates/connectors/user-profile-controls/chat-button.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/discourse/templates/preferences/chat",["exports","@ember/template-factory"],(function(e,t){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
e.default=(0,t.createTemplateFactory)({id:"P6AwNQea",block:'[[[10,"label"],[14,0,"control-label"],[12],[1,[28,[35,0],["chat.title_capitalized"],null]],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_enabled"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_enabled"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","chat_enabled"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.enable"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_only_push_notifications"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_only_push_notifications"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","only_chat_push_notifications"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.only_chat_push_notifications.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting"],[14,"data-setting-name","user_chat_ignore_channel_wide_mention"],[12],[1,"\\n  "],[10,"label"],[14,0,"controls"],[12],[1,"\\n    "],[8,[39,1],[[24,1,"user_chat_ignore_channel_wide_mention"]],[["@type","@checked"],["checkbox",[30,0,["model","user_option","ignore_channel_wide_mention"]]]],null],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[10,1],[14,0,"control-instructions"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.ignore_channel_wide_mention.description"],null]],[1,"\\n  "],[13],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_sounds"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_sounds"],[12],[1,[28,[35,0],["chat.sound.title"],null]],[13],[1,"\\n  "],[8,[39,2],null,[["@options","@valueProperty","@content","@value","@id","@onChange"],[[28,[37,3],null,[["none"],["chat.sounds.none"]]],"value",[30,0,["chatSounds"]],[30,0,["model","user_option","chat_sound"]],"user_chat_sounds",[28,[37,4],[[30,0],"onChangeChatSound"],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_email_frequency"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_email_frequency"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.email_frequency.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["emailFrequencyOptions"]],[30,0,["model","user_option","chat_email_frequency"]],"user_chat_email_frequency",[28,[37,5],[[28,[37,6],[[30,0,["model","user_option","chat_email_frequency"]]],null]],null]]],null],[1,"\\n"],[41,[28,[37,8],[[30,0,["model","user_option","chat_email_frequency"]],"when_away"],null],[[[1,"    "],[10,0],[14,0,"control-instructions"],[12],[1,"\\n      "],[1,[28,[35,0],["chat.email_frequency.description"],null]],[1,"\\n    "],[13],[1,"\\n"]],[]],null],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_header_indicator_preference"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_header_indicator_preference"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.header_indicator_preference.title"],null]],[1,"\\n  "],[13],[1,"\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["headerIndicatorOptions"]],[30,0,["model","user_option","chat_header_indicator_preference"]],"user_chat_header_indicator_preference",[28,[37,4],[[30,0],[28,[37,6],[[30,0,["model","user_option","chat_header_indicator_preference"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[10,0],[14,0,"control-group chat-setting controls-dropdown"],[14,"data-setting-name","user_chat_separate_sidebar_mode"],[12],[1,"\\n  "],[10,"label"],[14,"for","user_chat_separate_sidebar_mode"],[12],[1,"\\n    "],[1,[28,[35,0],["chat.separate_sidebar_mode.title"],null]],[1,"\\n  "],[13],[1,"\\n\\n  "],[8,[39,2],null,[["@valueProperty","@content","@value","@id","@onChange"],["value",[30,0,["chatSeparateSidebarModeOptions"]],[30,0,["chatSeparateSidebarMode"]],"user_chat_separate_sidebar_mode",[28,[37,5],[[28,[37,6],[[30,0,["model","user_option","chat_separate_sidebar_mode"]]],null]],null]]],null],[1,"\\n"],[13],[1,"\\n\\n"],[8,[39,9],null,[["@id","@model","@action","@saved"],["user_chat_preference_save",[30,0,["model"]],[28,[37,4],[[30,0],"save"],null],[30,0,["saved"]]]],null]],[],false,["i18n","input","combo-box","hash","action","fn","mut","if","eq","save-controls"]]',moduleName:"discourse/plugins/chat/discourse/templates/preferences/chat.hbs",isStrictMode:!1})})),define("discourse/plugins/chat/lib/discourse-markdown/chat-html-inline",["exports"],(function(e){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.registerPlugin((e=>{e.options.discourse.features["chat-html-inline"]&&e.inline.ruler.push("chat-html-inline",a)}))}
const t=["kbd","mark"].join("|"),s=new RegExp("^(?:"+`<(${t})(?:\\s+[a-zA-Z_:][a-zA-Z0-9:._-]*(?:\\s*=\\s*(?:[^"'=<>\`\\x00-\\x20]+|'[^']*'|"[^"]*"))?)*\\s*\\/?>`+"|"+`<\\/(${t})\\s*>`+"|\x3c!---?>|\x3c!--(?:[^-]|-[^-]|--[^>])*--\x3e|<[?][\\s\\S]*?[?]>|<![A-Za-z][^>]*>|<!\\[CDATA\\[[\\s\\S]*?\\]\\]>)")
function a(e,t){let a,n,i,r,o=e.pos
return!!e.md.options.html&&(i=e.posMax,!(60!==e.src.charCodeAt(o)||o+2>=i)&&(a=e.src.charCodeAt(o+1),!(33!==a&&63!==a&&47!==a&&!function(e){let t=32|e
return t>=97&&t<=122}(a))&&(n=e.src.slice(o).match(s),!!n&&(t||(r=e.push("html_inline","",0),r.content=n[0],c=r.content,/^<a[>\s]/i.test(c)&&e.linkLevel++,function(e){return/^<\/a\s*>/i.test(e)}(r.content)&&e.linkLevel--),e.pos+=n[0].length,!0))))
var c}})),define("discourse/plugins/chat/lib/discourse-markdown/chat-transcript",["exports","pretty-text/emoji","discourse-i18n"],(function(e,t,s){"use strict"
let a
Object.defineProperty(e,"__esModule",{value:!0}),e.setup=function(e){e.allowList(["svg[class=fa d-icon d-icon-discourse-threads svg-icon svg-node]","use[href=#discourse-threads]","div[class=chat-transcript]","details[class=chat-transcript]","div[class=chat-transcript chat-transcript-chained]","details[class=chat-transcript chat-transcript-chained]","div.chat-transcript-meta","div.chat-transcript-user","div.chat-transcript-username","div.chat-transcript-user-avatar","div.chat-transcript-messages","div.chat-transcript-datetime","div.chat-transcript-reactions","div.chat-transcript-reaction","span[title]","div[data-message-id]","div[data-channel-name]","div[data-channel-id]","div[data-username]","div[data-datetime]","a.chat-transcript-channel","div.chat-transcript-thread","div.chat-transcript-thread-header","span.chat-transcript-thread-header__title"]),e.registerOptions(((e,t)=>{e.features["chat-transcript"]=!!t.chat_enabled})),e.registerPlugin((e=>{e.options.discourse.features["chat-transcript"]&&e.block.bbcode.ruler.push("chat-transcript",n)})),e.buildCookFunction(((e,t)=>{if(!e.discourse.additionalOptions?.chat)return
const s=e.discourse.additionalOptions.chat,n=s.limited_pretty_text_markdown_rules.concat("image")
t({featuresOverride:s.limited_pretty_text_features,markdownItRules:n,hashtagLookup:e.discourse.hashtagLookup,hashtagTypesInPriorityOrder:s.hashtag_configurations["chat-composer"],hashtagIcons:e.discourse.hashtagIcons},(e=>{a=e}))}))}
const n={tag:"chat",replace:function(e,n,i){if(!a)return
const r=e.md.options.discourse,[o,c,l]=n.attrs.quote&&n.attrs.quote.split(";")||[],d=n.attrs.reactions,h=!!n.attrs.multiQuote,u=!!n.attrs.noLink,p=n.attrs.channel,m=n.attrs.channelId,g=n.attrs.threadId,f=n.attrs.threadTitle,_=m?r.getURL(`/chat/c/-/${m}`):null
if(!o||!c||!l)return
const b=g&&i.includes("[chat")
let v=e.push("div_chat_transcript_wrap","div",1)
if(p&&h){e.push("div_chat_transcript_meta","div",1).attrs=[["class","chat-transcript-meta"]]
const a=e.push("html_inline","",0),n=(0,t.performEmojiUnescape)(p,{getURL:r.getURL,emojiSet:r.emojiSet,emojiCDNUrl:r.emojiCDNUrl,enableEmojiShortcuts:r.enableEmojiShortcuts,inlineEmoji:r.inlineEmoji,lazy:!0})
a.content=s.default.t("chat.quote.original_channel",{channel:n,channelLink:_}),e.push("div_chat_transcript_meta","div",-1)}if(b){e.push("details_chat_transcript_wrap_open","details",1),e.push("summary_chat_transcript_open","summary",1)
e.push("div_thread_open","div",1).attrs=[["class","chat-transcript-thread"]]
e.push("div_thread_header_open","div",1).attrs=[["class","chat-transcript-thread-header"]]
const a=e.push("svg_thread_header_open","svg",1)
a.block=!1,a.attrs=[["class","fa d-icon d-icon-discourse-threads svg-icon svg-node"]],e.push(a)
let n=e.push("use_svg_thread_open","use",1)
n.block=!1,n.attrs=[["href","#discourse-threads"]],e.push(n),e.push(e.push("use_svg_thread_close","use",-1)),e.push(e.push("svg_thread_header_close","svg",-1))
e.push("span_thread_title_open","span",1).attrs=[["class","chat-transcript-thread-header__title"]]
const i=e.push("html_inline","",0),o=(0,t.performEmojiUnescape)(f,{getURL:r.getURL,emojiSet:r.emojiSet,emojiCDNUrl:r.emojiCDNUrl,enableEmojiShortcuts:r.enableEmojiShortcuts,inlineEmoji:r.inlineEmoji,lazy:!0})
i.content=o||s.default.t("chat.quote.default_thread_title"),e.push("span_thread_title_close","span",-1),e.push("div_thread_header_close","div",-1)}let y,M,C=["chat-transcript"]
if(n.attrs.chained&&C.push("chat-transcript-chained"),v.attrs=[["class",C.join(" ")]],v.attrs.push(["data-message-id",c]),v.attrs.push(["data-username",o]),v.attrs.push(["data-datetime",l]),d&&v.attrs.push(["data-reactions",d]),p&&v.attrs.push(["data-channel-name",p]),m&&v.attrs.push(["data-channel-id",m]),e.push("div_chat_transcript_user","div",1).attrs=[["class","chat-transcript-user"]],e.push("div_chat_transcript_user_avatar","div",1).attrs=[["class","chat-transcript-user-avatar"]],r.lookupAvatar&&(y=r.lookupAvatar(o)),y){e.push("html_inline","",0).content=y}e.push("div_chat_transcript_user_avatar","div",-1),e.push("div_chat_transcript_username","div",1).attrs=[["class","chat-transcript-username"]],M=r.formatUsername?r.formatUsername(o):o
if(e.push("html_inline","",0).content=M,e.push("div_chat_transcript_username","div",-1),e.push("div_chat_transcript_datetime","div",1).attrs=[["class","chat-transcript-datetime"]],u||!_){let t=e.push("span_open","span",1)
if(t.attrs=[["title",l]],t.block=!1,p&&!h){let t=e.push("link_open","a",1)
t.attrs=[["class","chat-transcript-channel"],["href",_]],e.push("html_inline","",0).content=`#${p}`,t=e.push("link_close","a",-1),t.block=!1}t=e.push("span_close","span",-1),t.block=!1}else{let t=e.push("link_open","a",1)
t.attrs=[["href",`${_}/${c}`],["title",l]],t.block=!1,t=e.push("link_close","a",-1),t.block=!1}if(e.push("div_chat_transcript_datetime","div",-1),p&&!h){let t=e.push("link_open","a",1)
t.attrs=[["class","chat-transcript-channel"],["href",_]],e.push("html_inline","",0).content=`#${p}`,t=e.push("link_close","a",-1),t.block=!1}if(e.push("div_chat_transcript_user","div",-1),e.push("div_chat_transcript_messages","div",1).attrs=[["class","chat-transcript-messages"]],b){const t=/\[chat/i.exec(i)
if(t){e.push("html_raw","",1).content=a(i.substring(0,t.index)),e.push("html_raw","",-1),e.push("div_thread_close","div",-1),e.push("summary_chat_transcript_close","summary",-1)
e.push("html_raw","",1).content=a(i.substring(t.index)),e.push("html_raw","",-1),e.push("details_chat_transcript_wrap_close","details",-1)}}else{e.push("html_raw","",1).content=a(i),e.push("html_raw","",-1)}if(d){let s={}
e.push("div_chat_transcript_reactions","div",1).attrs=[["class","chat-transcript-reactions"]],d.split(";").forEach((a=>{const n=a.split(":"),i=n[0],o=n[1].split(",")
e.push("div_chat_transcript_reaction","div",1).attrs=[["class","chat-transcript-reaction"]]
const c=e.push("html_inline","",0)
s[i]||(s[i]=(0,t.performEmojiUnescape)(`:${i}:`,{getURL:r.getURL,emojiSet:r.emojiSet,emojiCDNUrl:r.emojiCDNUrl,enableEmojiShortcuts:r.enableEmojiShortcuts,inlineEmoji:r.inlineEmoji,lazy:!0})),c.content=`${s[i]} ${o.length.toString()}`,e.push("div_chat_transcript_reaction","div",-1)})),e.push("div_chat_transcript_reactions","div",-1)}return e.push("div_chat_transcript_messages","div",-1),e.push("div_chat_transcript_wrap","div",-1),!0}}}))
define("discourse/plugins/chat/select-kit/addons/components/thread-notifications-button",["exports","@ember-decorators/component","select-kit/components/notifications-button","select-kit/components/select-kit","discourse/plugins/chat/discourse/lib/chat-notification-levels"],(function(e,t,s,a,n){"use strict"
Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0
const i=dt7948.c(class extends s.default{content=(()=>n.threadNotificationButtonLevels)()},[(0,a.pluginApiIdentifiers)("thread-notifications-button"),(0,a.selectKitOptions)({i18nPrefix:"chat.thread.notifications",showFullTitle:!1,btnCustomClasses:"btn-flat"}),(0,t.classNames)("thread-notifications-button")])
e.default=i}))

//# sourceMappingURL=chat-961d6034850f57ef4aa631d397fec56b7f64082966e9fa6d16c4f27d7252b0c2.map
//!

;
